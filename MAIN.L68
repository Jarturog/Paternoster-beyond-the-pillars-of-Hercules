00003A36 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 15/01/2023 12:45:13

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002D01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/14)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000                            37  ;no lo usas SNDPLTN     EQU     3                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000                            45  
00001000  =00000004                 46  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 47  PLAYERWIDTH     EQU     32
00001000  =00000020                 48  PLAYERHEIGHT    EQU     32
00001000                            49  
00001000                            50  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            51  
00001000  =00000010                 52  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 53  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 54  PROJSPEEDX      EQU     8
00001000  =00000008                 55  PROJSPEEDY      EQU     8
00001000                            56  
00001000                            57  ; --- MUSIC RELATED CONSTANTS --------------------------------------------------
00001000                            58  
00001000= 53 4E 44 2F 4D 55 ...     59  HEAVENSOUND DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     60  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     61  HELLSOUND   DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     62  PROJ_SOUND  DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            63  
00001048                            64  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001048                            65  
00001048  =FFFFFFFF                 66  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001048                            67  
00001048                            68  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001048                            69  
00001048  =00000014                 70  BLOCKSROW   EQU     20                      ; BLOCKS PER ROW
00001048  =0000000F                 71  BLOCKSCOL   EQU     15                      ; BLOCKS PER COLUMN
00001048  =00000020                 72  BLOCKSIZE   EQU     32                      ; BLOCK SIZE IN PIXELS
00001048                            73  
00001048                            74  ; --- ELEVATOR RELATED CONSTANTS -----------------------------------------------
00001048                            75  
00001048  =000000CC                 76  COLBUTHL    EQU     $000000CC
00001048  =00EEEEEE                 77  COLBUTHV    EQU     $00EEEEEE
00001048                            78  
00001048                            79  
00001048                            80  
00001048                            81  
00001048                            82  
00001048                            83  
00001048                            84  
00001048                            85  
00001048                            86  
00001048                            87  
00001048                            88  
00001048                            89  -------------------- end include --------------------
00001048                            90              INCLUDE "LIB/DMMCONST.X68"
00001048                            91  ; =============================================================================
00001048                            92  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                            93  ; =============================================================================
00001048                            94  
00001048  =00000040                 95  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                 96  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                 97  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                 98  -------------------- end include --------------------
00001048                            99              INCLUDE "LIB/UTLCONST.X68"         
00001048                           100  ; ==============================================================================
00001048                           101  ; UTIL CONSTANTS
00001048                           102  ; ==============================================================================
00001048                           103  
00001048  =00000008                104  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001048  =00000008                105  -------------------- end include --------------------
00001048                           106              INCLUDE "LIB/DMMCODE.X68"
00001048                           107  ; =============================================================================
00001048                           108  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                           109  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                           110  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                           111  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                           112  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                           113  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                           114  ; =============================================================================
00001048                           115  
00001048                           116  ; -----------------------------------------------------------------------------
00001048                           117  DMMINIT
00001048                           118  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                           119  ; INPUT    - NONE
00001048                           120  ; OUTPUT   - NONE
00001048                           121  ; MODIFIES - NONE
00001048                           122  ; -----------------------------------------------------------------------------
00001048  48E7 8080                123              MOVEM.L D0/A0,-(A7)
0000104C  41F9 00003AC0            124              LEA     DMMDATA,A0
00001052  303C 0031                125              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                126  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            127              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                128              DBRA.W  D0,.LOOP
00001064  4CDF 0101                129              MOVEM.L (A7)+,D0/A0
00001068  4E75                     130              RTS
0000106A                           131  
0000106A                           132  ; -----------------------------------------------------------------------------
0000106A                           133  DMMFIRST
0000106A                           134  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           135  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           136  ; INPUT    - NONE
0000106A                           137  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           138  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           139  ; -----------------------------------------------------------------------------
0000106A  41F9 00003AC0            140              LEA     DMMDATA,A0
00001070  4A58                     141  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                142              BNE     DMMFRFND
00001076  D1FC 0000003E            143              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 0000473F            144  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     145              BLT     DMMFRLOP
00001084  207C 00000000            146              MOVE.L  #0,A0
0000108A  4E75                     147  DMMFRFND    RTS
0000108C                           148  
0000108C                           149  ; -----------------------------------------------------------------------------
0000108C                           150  DMMNEXT
0000108C                           151  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           152  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           153  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           154  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           155  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           156  ; -----------------------------------------------------------------------------
0000108C  2F00                     157              MOVE.L  D0,-(A7)
0000108E  2008                     158              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            159              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            160              ADD.L   #DMMBSIZE,D0
0000109C  2040                     161              MOVE.L  D0,A0
0000109E  201F                     162              MOVE.L  (A7)+,D0
000010A0  60DA                     163              BRA     DMMFRCOM
000010A2                           164  
000010A2                           165  ; -----------------------------------------------------------------------------
000010A2                           166  DMMFRSTO
000010A2                           167  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           168  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           169  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           170  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           171  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           172  ; -----------------------------------------------------------------------------
000010A2  41F9 00003AC0            173              LEA     DMMDATA,A0
000010A8  B058                     174  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                175              BEQ     DMMFFND
000010AE  D1FC 0000003E            176              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 0000473F            177  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     178              BLT     DMMFLOOP
000010BC  207C 00000000            179              MOVE.L  #0,A0
000010C2  4E75                     180  DMMFFND     RTS
000010C4                           181  
000010C4                           182  ; -----------------------------------------------------------------------------
000010C4                           183  DMMNEXTO
000010C4                           184  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           185  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           186  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           187  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           188  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           189  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           190  ; -----------------------------------------------------------------------------
000010C4  2F00                     191              MOVE.L  D0,-(A7)
000010C6  2008                     192              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            193              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            194              ADD.L   #DMMBSIZE,D0
000010D4  2040                     195              MOVE.L  D0,A0
000010D6  201F                     196              MOVE.L  (A7)+,D0
000010D8  60DA                     197              BRA     DMMFCOM
000010DA                           198  
000010DA                           199  ; -----------------------------------------------------------------------------
000010DA                           200  DMMALLOC
000010DA                           201  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           202  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           203  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           204  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           205  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           206  ; -----------------------------------------------------------------------------
000010DA  3F00                     207              MOVE.W  D0,-(A7)
000010DC  4240                     208              CLR.W   D0
000010DE  4EB8 10A2                209              JSR     DMMFRSTO
000010E2  301F                     210              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            211              CMP.L   #0,A0
000010EA  6700 0006                212              BEQ     .END
000010EE  3140 FFFE                213              MOVE.W  D0,-2(A0)
000010F2  4E75                     214  .END        RTS
000010F4                           215  
000010F4                           216  ; -----------------------------------------------------------------------------
000010F4                           217  DMMFREE
000010F4                           218  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           219  ; SYSTEM (0)
000010F4                           220  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           221  ; OUTPUT   - NONE
000010F4                           222  ; MODIFIES - NONE
000010F4                           223  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                224              MOVEM.L D0/A0,-(A7)
000010F8  2008                     225              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            226              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     227              MOVE.L  D0,A0
00001102  4250                     228              CLR.W   (A0)
00001104  4CDF 0101                229              MOVEM.L (A7)+,D0/A0
00001108  4E75                     230              RTS
00001108  4E75                     231  -------------------- end include --------------------
0000110A                           232              INCLUDE "SYSTEM.X68"
0000110A                           233  ; ==============================================================================
0000110A                           234  ; SYSTEM
0000110A                           235  ; ==============================================================================
0000110A                           236              
0000110A                           237  ; ------------------------------------------------------------------------------
0000110A                           238  SYSINIT
0000110A                           239  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           240  ; INPUT    : NONE
0000110A                           241  ; OUTPUT   : NONE
0000110A                           242  ; MODIFIES : NONE
0000110A                           243  ; ------------------------------------------------------------------------------
0000110A                           244  
0000110A  21FC 00001198 0080       245              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000126E 0084       246              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 00001240 0064       247              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001122  21FC 0000124E 0068       248              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
0000112A                           249              
0000112A  4EB8 1048                250              JSR     DMMINIT
0000112E  4EB9 00001142            251              JSR     SCRINIT
00001134  4EB9 00001260            252              JSR     KBDINIT 
0000113A                           253              
0000113A  40E7                     254              MOVE.W  SR,-(A7)
0000113C  0257 D8FF                255              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
00001140  4E73                     256              RTE
00001142                           257              
00001142                           258  ; ------------------------------------------------------------------------------
00001142                           259  SCRINIT
00001142                           260  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001142                           261  ; ENABLE DOUBLE BUFFER.
00001142                           262  ; INPUT    : NONE
00001142                           263  ; OUTPUT   : NONE
00001142                           264  ; MODIFIES : NONE
00001142                           265  ; ------------------------------------------------------------------------------
00001142                           266  
00001142  48E7 F000                267              MOVEM.L D0-D3,-(A7)
00001146                           268  
00001146                           269              ; SET SCREEN RESOLUTION
00001146  103C 0021                270              MOVE.B  #33,D0
0000114A  223C 028001E0            271              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001150  4E4F                     272              TRAP    #15
00001152                           273              
00001152                           274              ; SET WINDOWED MODE
00001152  7201                     275              MOVE.L  #1,D1
00001154  4E4F                     276              TRAP    #15
00001156                           277              
00001156                           278              ; CLEAR SCREEN
00001156  103C 000B                279              MOVE.B  #11,D0
0000115A  323C FF00                280              MOVE.W  #$FF00,D1
0000115E  4E4F                     281              TRAP    #15
00001160                           282  
00001160                           283              ; ENABLE DOUBLE BUFFER
00001160  103C 005C                284              MOVE.B  #92,D0
00001164  123C 0011                285              MOVE.B  #17,D1
00001168  4E4F                     286              TRAP    #15
0000116A                           287              
0000116A                           288              ; ENABLE BOTH TIMED INTERRUPT
0000116A  103C 0020                289              MOVE.B  #32,D0
0000116E  123C 0006                290              MOVE.B  #6,D1
00001172  143C 0081                291              MOVE.B  #$80|SCRINTN,D2
00001176  7614                     292              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001178  4E4F                     293              TRAP    #15
0000117A  143C 0082                294              MOVE.B  #$80|SCRINTFPSN,D2
0000117E  263C 000003E8            295              MOVE.L  #1000,D3
00001184  4E4F                     296              TRAP    #15
00001186                           297              
00001186                           298              ; CLEAR INTERRUPT COUNTER
00001186  4279 00003A6A            299              CLR.W   (SCRINTCT)
0000118C  4239 00003A6C            300              CLR.B   (SCRINTFPS) 
00001192                           301              
00001192  4CDF 000F                302              MOVEM.L (A7)+,D0-D3
00001196                           303              
00001196  4E75                     304              RTS
00001198                           305  
00001198                           306  ; ------------------------------------------------------------------------------
00001198                           307  SCRPLOT
00001198                           308  ; UPDATES DOUBLE BUFFER
00001198                           309  ; INPUT    : NONE
00001198                           310  ; OUTPUT   : NONE
00001198                           311  ; MODIFIES : NONE
00001198                           312  ; ------------------------------------------------------------------------------
00001198  48E7 E000                313              MOVEM.L D0-D2,-(A7)
0000119C  2F09                     314              MOVE.L  A1,-(A7)
0000119E                           315              
0000119E                           316              ; PLOT ACTUAL FPS AND GOAL FPS
0000119E                           317              
0000119E  103C 0051                318              MOVE.B  #81,D0
000011A2  7200                     319              MOVE.L  #$00000000,D1 ; FILL COLOR
000011A4  4E4F                     320              TRAP    #15
000011A6                           321              
000011A6  103C 0050                322              MOVE.B  #80,D0
000011AA  223C 00FFFFFF            323              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011B0  4E4F                     324              TRAP    #15
000011B2                           325              
000011B2  103C 000B                326              MOVE.B  #11,D0
000011B6  223C 00002D01            327              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011BC  4E4F                     328              TRAP    #15
000011BE                           329              
000011BE  43F9 00003A86            330              LEA.L   STRFPS1,A1 
000011C4  103C 000E                331              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011C8  4E4F                     332              TRAP    #15
000011CA                           333              
000011CA  103C 000B                334              MOVE.B  #11,D0
000011CE  323C 3601                335              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011D2  4E4F                     336              TRAP    #15
000011D4                           337              
000011D4  5E89                     338              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011D6  103C 000E                339              MOVE.B  #14,D0  
000011DA  4E4F                     340              TRAP    #15 
000011DC                           341              
000011DC  103C 000B                342              MOVE.B  #11,D0
000011E0  323C 4701                343              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E4  4E4F                     344              TRAP    #15
000011E6                           345              
000011E6  D3FC 0000000F            346              ADDA.L  #15,A1 ; PLOT 'FPS'
000011EC  103C 000E                347              MOVE.B  #14,D0 
000011F0  4E4F                     348              TRAP    #15
000011F2                           349              
000011F2  0643 0014                350              ADD.W   #20,D3
000011F6  103C 000B                351              MOVE.B  #11,D0
000011FA  323C 3301                352              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
000011FE  4E4F                     353              TRAP    #15
00001200                           354              
00001200  7232                     355              MOVE.L  #FRAMES_PER_SECOND,D1
00001202  740A                     356              MOVE.L  #10,D2
00001204  103C 000F                357              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001208  4E4F                     358              TRAP    #15
0000120A                           359              
0000120A  0643 0014                360              ADD.W   #20,D3
0000120E  103C 000B                361              MOVE.B  #11,D0
00001212  323C 4401                362              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001216  4E4F                     363              TRAP    #15
00001218                           364              
00001218  4281                     365              CLR.L   D1
0000121A  1239 00003A84            366              MOVE.B  (REALFPS),D1
00001220  740A                     367              MOVE.L  #10,D2
00001222  103C 000F                368              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001226  4E4F                     369              TRAP    #15
00001228                           370              
00001228                           371              ; SWITCH BUFFERS
00001228  103C 005E                372              MOVE.B  #94,D0
0000122C  4E4F                     373              TRAP    #15
0000122E                           374              
0000122E                           375              ; CLEAR HIDDEN BUFFER
0000122E  103C 000B                376              MOVE.B  #11,D0
00001232  323C FF00                377              MOVE.W  #$FF00,D1
00001236  4E4F                     378              TRAP    #15
00001238                           379              
00001238  225F                     380              MOVE.L  (A7)+,A1
0000123A  4CDF 0007                381              MOVEM.L (A7)+,D0-D2
0000123E  4E73                     382              RTE
00001240                           383              
00001240                           384  ; ------------------------------------------------------------------------------
00001240                           385  SCRTIM
00001240                           386  ; TIMED INTERRUPT SERVICE ROUTINE
00001240                           387  ; INPUT    : NONE
00001240                           388  ; OUTPUT   : NONE
00001240                           389  ; MODIFIES : NONE
00001240                           390  ; ------------------------------------------------------------------------------
00001240  5239 00003A6A            391              ADDQ.B  #1,(SCRINTCT)
00001246  5239 00003A6B            392              ADDQ.B  #1,(SCRCYCCT)
0000124C  4E73                     393              RTE
0000124E                           394              
0000124E                           395  ; ------------------------------------------------------------------------------
0000124E                           396  SCRTIM1S
0000124E                           397  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000124E                           398  ; INPUT    : NONE
0000124E                           399  ; OUTPUT   : NONE
0000124E                           400  ; MODIFIES : NONE
0000124E                           401  ; ------------------------------------------------------------------------------
0000124E  13F9 00003A6C 00003A84   402              MOVE.B  (SCRINTFPS),REALFPS
00001258  4239 00003A6C            403              CLR.B   SCRINTFPS
0000125E  4E73                     404              RTE
00001260                           405  
00001260                           406  ; ------------------------------------------------------------------------------
00001260                           407  KBDINIT
00001260                           408  ; INIT KEYBOARD
00001260                           409  ; INPUT    : NONE
00001260                           410  ; OUTPUT   : NONE
00001260                           411  ; MODIFIES : NONE
00001260                           412  ; ------------------------------------------------------------------------------
00001260  4239 00003A68            413              CLR.B   (KBDVAL)
00001266  4239 00003A69            414              CLR.B   (KBDEDGE)
0000126C  4E75                     415              RTS
0000126E                           416  
0000126E                           417  ; ------------------------------------------------------------------------------
0000126E                           418  KBDUPD
0000126E                           419  ; UPDATE KEYBOARD INFO.  
0000126E                           420  ; 7 -> FIRE DOWN
0000126E                           421  ; 6 -> FIRE RIGHT
0000126E                           422  ; 5 -> FIRE UP
0000126E                           423  ; 4 -> FIRE LEFT
0000126E                           424  ; 3 -> DOWN
0000126E                           425  ; 2 -> RIGHT
0000126E                           426  ; 1 -> UP
0000126E                           427  ; 0 -> LEFT
0000126E                           428  ; INPUT    : NONE
0000126E                           429  ; OUTPUT   : NONE
0000126E                           430  ; MODIFIES : NONE
0000126E                           431  ; ------------------------------------------------------------------------------
0000126E                           432  
0000126E  48E7 F000                433              MOVEM.L D0-D3,-(A7)
00001272                           434  
00001272                           435              ; READ FIRST PART
00001272  103C 0013                436              MOVE.B  #19,D0
00001276  223C 28272625            437              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000127C  4E4F                     438              TRAP    #15
0000127E                           439              
0000127E                           440              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000127E  4EB9 000012AE            441              JSR     .PACK
00001284                           442  
00001284                           443              ; READ SECOND PART
00001284  223C 53445741            444              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000128A  4E4F                     445              TRAP    #15
0000128C                           446  
0000128C                           447              ; CONVERT TO DESIRED FORMAT
0000128C  4EB9 000012AE            448              JSR     .PACK
00001292                           449              
00001292                           450              ; COMPUTE KBDEDGE
00001292  1039 00003A68            451              MOVE.B  (KBDVAL),D0
00001298  4600                     452              NOT.B   D0
0000129A  C002                     453              AND.B   D2,D0
0000129C  13C0 00003A69            454              MOVE.B  D0,(KBDEDGE)
000012A2                           455              
000012A2                           456              ; STORE KBDVAL
000012A2  13C2 00003A68            457              MOVE.B  D2,(KBDVAL)
000012A8                           458              
000012A8  4CDF 000F                459              MOVEM.L (A7)+,D0-D3
000012AC                           460  
000012AC  4E73                     461              RTE
000012AE                           462              
000012AE  363C 0003                463  .PACK       MOVE.W  #3,D3
000012B2  E189                     464  .LOOP       LSL.L   #8,D1
000012B4  E312                     465              ROXL.B  #1,D2
000012B6  51CB FFFA                466              DBRA.W  D3,.LOOP
000012BA  4E75                     467              RTS
000012BC                           468  
000012BC                           469  
000012BC                           470  
000012BC                           471  -------------------- end include --------------------
000012BC                           472              INCLUDE "LIB/AGLCODE.X68"
000012BC                           473  ; =============================================================================
000012BC                           474  ; AGENT MANAGEMENT
000012BC                           475  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012BC                           476  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012BC                           477  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012BC                           478  ; +8:END    : DATA (AGENT SPECIFIC)
000012BC                           479  ; =============================================================================
000012BC                           480  
000012BC                           481  ; -----------------------------------------------------------------------------
000012BC                           482  AGLADD
000012BC                           483  ; CREATES A NEW AGENT
000012BC                           484  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012BC                           485  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012BC                           486  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012BC                           487  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012BC                           488  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012BC                           489  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012BC                           490  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012BC                           491  ; OUTPUT   - NONE
000012BC                           492  ; MODIFIES - NONE
000012BC                           493  ; -----------------------------------------------------------------------------
000012BC  2F08                     494              MOVE.L  A0,-(A7)
000012BE  4EB8 10DA                495              JSR     DMMALLOC
000012C2  B1FC 00000000            496              CMP.L   #0,A0
000012C8  6700 0008                497              BEQ     .END
000012CC  20CA                     498              MOVE.L  A2,(A0)+
000012CE  20CB                     499              MOVE.L  A3,(A0)+
000012D0  4E91                     500              JSR     (A1)
000012D2  205F                     501  .END        MOVE.L  (A7)+,A0
000012D4  4E75                     502              RTS
000012D6                           503  
000012D6                           504  ; -----------------------------------------------------------------------------
000012D6                           505  AGLUPD
000012D6                           506  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012D6                           507  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012D6                           508  ; INPUT    - NONE
000012D6                           509  ; OUTPUT   - NONE
000012D6                           510  ; MODIFIES - NONE
000012D6                           511  ; -----------------------------------------------------------------------------
000012D6  48E7 00C0                512              MOVEM.L A0-A1,-(A7)
000012DA  4EB8 106A                513              JSR     DMMFIRST
000012DE  B1FC 00000000            514  .LOOP       CMP.L   #0,A0
000012E4  6700 000E                515              BEQ     .END
000012E8  2250                     516              MOVE.L  (A0),A1
000012EA  5088                     517              ADD.L   #8,A0
000012EC  4E91                     518              JSR     (A1)
000012EE  4EB8 108C                519              JSR     DMMNEXT
000012F2  60EA                     520              BRA     .LOOP
000012F4  4CDF 0300                521  .END        MOVEM.L (A7)+,A0-A1
000012F8  4E75                     522              RTS
000012FA                           523  
000012FA                           524  ; -----------------------------------------------------------------------------
000012FA                           525  AGLPLOT
000012FA                           526  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012FA                           527  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012FA                           528  ; INPUT    - NONE
000012FA                           529  ; OUTPUT   - NONE
000012FA                           530  ; MODIFIES - NONE
000012FA                           531  ; -----------------------------------------------------------------------------
000012FA  48E7 00C0                532              MOVEM.L A0-A1,-(A7)
000012FE  4EB8 106A                533              JSR     DMMFIRST
00001302  B1FC 00000000            534  .LOOP       CMP.L   #0,A0
00001308  6700 0010                535              BEQ     .END
0000130C  2268 0004                536              MOVE.L  4(A0),A1
00001310  5088                     537              ADD.L   #8,A0
00001312  4E91                     538              JSR     (A1)
00001314  4EB8 108C                539              JSR     DMMNEXT
00001318  60E8                     540              BRA     .LOOP
0000131A  4CDF 0300                541  .END        MOVEM.L (A7)+,A0-A1
0000131E  4E75                     542              RTS
00001320                           543  
00001320                           544  ; -----------------------------------------------------------------------------
00001320  =000010F4                545  AGLKILL     EQU     DMMFREE
00001320                           546  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001320                           547  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001320                           548  ; OUTPUT   - NONE
00001320                           549  ; MODIFIES - NONE
00001320                           550  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001320                           551  ; -----------------------------------------------------------------------------
00001320                           552  -------------------- end include --------------------
00001320                           553              INCLUDE "LIB/UTLCODE.X68"
00001320                           554  ; =============================================================================
00001320                           555  ; UTILITY CODE
00001320                           556  ; =============================================================================
00001320                           557  
00001320                           558  ; -----------------------------------------------------------------------------
00001320                           559  UTLINIT
00001320                           560  ; INITIALIZES UTILITY CODE
00001320                           561  ; INPUT    - NONE
00001320                           562  ; OUTPUT   - NONE
00001320                           563  ; MODIFIES - NONE
00001320                           564  ; -----------------------------------------------------------------------------
00001320  48E7 C000                565              MOVEM.L D0-D1,-(A7)
00001324  103C 0008                566              MOVE.B  #8,D0
00001328  4E4F                     567              TRAP    #15
0000132A  13C1 00003AA4            568              MOVE.B  D1,(UTLRNDIX)
00001330  4CDF 0003                569              MOVEM.L (A7)+,D0-D1
00001334  4E75                     570              RTS
00001336                           571  
00001336                           572  ; -----------------------------------------------------------------------------
00001336                           573  UTLPRINT
00001336                           574  ; PRINT SCREEN CENTERED TEXT
00001336                           575  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001336                           576  ;            D0.B SCREEN ROW TO PRINT TEXT
00001336                           577  ; OUTPUT   : D0.B NEXT ROW
00001336                           578  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001336                           579  ; -----------------------------------------------------------------------------
00001336  48E7 C0C0                580              MOVEM.L D0-D1/A0-A1,-(A7)
0000133A  4201                     581              CLR.B   D1
0000133C  2248                     582              MOVE.L  A0,A1
0000133E  4A18                     583  .LOOP       TST.B   (A0)+
00001340  6700 0006                584              BEQ     .ENDLOOP
00001344  5201                     585              ADDQ.B  #1,D1
00001346  60F6                     586              BRA     .LOOP
00001348  E209                     587  .ENDLOOP    LSR.B   #1,D1
0000134A  0401 0028                588              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000134E  4401                     589              NEG.B   D1
00001350  E141                     590              ASL.W   #8,D1
00001352  8240                     591              OR.W    D0,D1
00001354  103C 000B                592              MOVE.B  #11,D0
00001358  4E4F                     593              TRAP    #15
0000135A  103C 000D                594              MOVE.B  #13,D0
0000135E  4E4F                     595              TRAP    #15
00001360  4CDF 0303                596              MOVEM.L (A7)+,D0-D1/A0-A1
00001364  5200                     597              ADDQ.B  #1,D0
00001366  4E75                     598              RTS
00001368                           599  
00001368                           600  ; -----------------------------------------------------------------------------
00001368                           601  UTLRAND
00001368                           602  ; PROVIDES A PSEUDO-RANDOM BYTE
00001368                           603  ; INPUT    - NONE
00001368                           604  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001368                           605  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001368                           606  ; -----------------------------------------------------------------------------
00001368  2F08                     607              MOVE.L  A0,-(A7)
0000136A  41F9 00001386            608              LEA     .RANDVEC,A0
00001370  4280                     609              CLR.L   D0
00001372  1039 00003AA4            610              MOVE.B  (UTLRNDIX),D0
00001378  1030 0800                611              MOVE.B  (A0,D0.L),D0
0000137C  5239 00003AA4            612              ADDQ.B  #1,(UTLRNDIX)
00001382  205F                     613              MOVE.L  (A7)+,A0
00001384  4E75                     614              RTS
00001386                           615  
00001386                           616  
00001386= A2 EE 9A 0C F5 24 ...    617  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000138E= 2A A3 51 26 E0 AC ...    618              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001396= 75 51 CA FD 33 EB ...    619              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000139E= 60 CC E7 B8 9A EB ...    620              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013A6= 1D 76 B5 95 B0 89 ...    621              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013AE= 39 15 48 C9 6E CA ...    622              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013B6= 43 E7 E2 7C 37 25 ...    623              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013BE= E9 94 CE E9 E4 52 ...    624              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013C6= 37 6D 9A 84 A2 28 ...    625              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013CE= 19 E2 C6 77 80 D4 ...    626              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013D6= 0A 5A 32 67 33 C2 ...    627              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013DE= 59 80 DC 0E 57 FC ...    628              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013E6= 8A AB BC F7 07 4D ...    629              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013EE= EF D5 77 6E 1E BB ...    630              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013F6= D6 E0 2A 8F BD 28 ...    631              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013FE= 13 4F 66 EC 0A 64 ...    632              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001406= 56 52 9A 16 9B 90 ...    633              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000140E= 06 8A A4 F7 01 DA ...    634              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001416= F2 E7 77 28 B1 76 ...    635              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000141E= A4 42 E3 81 B1 67 ...    636              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001426= BF CE FA 16 BF 38 ...    637              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000142E= D1 8B 50 0C 5F 49 ...    638              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001436= DE 4C 14 A2 40 DC ...    639              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000143E= B6 9B 0A 38 5D AB ...    640              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001446= E2 1B DD 75 15 82 ...    641              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000144E= 8A 26 51 30 9F 47 ...    642              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001456= 1E 8A BB 71 C6 6E ...    643              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000145E= 9F 47 E5 34 94 27 ...    644              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001466= 7D 06 D6 BA 30 0F ...    645              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000146E= EC 7F 7E 03 CF 2D ...    646              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001476= 94 5B 23 F2 8B CD ...    647              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000147E= 74 33 EC B9 0F D5 ...    648              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001486                           649  
00001486                           650  -------------------- end include --------------------
00001486                           651              INCLUDE "BLOCKS.X68"
00001486                           652  
00001486                           653  ; -----------------------------------------------------------------------------
00001486                           654  ISBLWHICHCOLL 
00001486                           655  ; CHECKS IF THE BLOCK IN D4 PRODUCES COLLISIONS
00001486                           656  ; INPUT    - D4.B
00001486                           657  ; OUTPUT   - ALL 1'S IF D4.L PRODUCES COLLISIONS, ALL 0'S IF NOT
00001486                           658  ; MODIFIES - D4.L, A0
00001486                           659  ; -----------------------------------------------------------------------------
00001486  41F9 00003A80            660              LEA.L   BLWHICHCOLL, A0
0000148C  B810                     661  .BNEXTCHCK  CMP.B   (A0),D4
0000148E  6708                     662              BEQ.B   .BCOLL
00001490  4A10                     663              TST.B   (A0)
00001492  670E                     664              BEQ.B   .BNOCOLL
00001494  5288                     665              ADDA.L  #1,A0
00001496  60F4                     666              BRA     .BNEXTCHCK
00001498  0084 FFFFFFFF            667  .BCOLL      ORI.L   #$FFFFFFFF, D4
0000149E  6000 0004                668              BRA     .BEND
000014A2  4280                     669  .BNOCOLL    CLR.L   D0
000014A4                           670  .BEND
000014A4  4E75                     671              RTS
000014A6                           672  
000014A6                           673  ; -----------------------------------------------------------------------------
000014A6                           674  BLKCOLL 
000014A6                           675  ; DETECTS BLOCK COLLISIONS
000014A6                           676  ; INPUT    - D0 TOP LEFT CORNER OF OBJECT, D1 BOTTOM RIGHT, WHERE UPPER WORD
000014A6                           677  ;            IS THE X COORDINATE AND LOWER WORD Y COORDINATE
000014A6                           678  ; OUTPUT   - ALL 1'S IN THE THE REGISTER THAT COLLIDES WITH A BLOCK
000014A6                           679  ;            THAT CANNOT BE TRAVERSED. THESE ARE D0 FOR LEFT UPPER BLOCK,
000014A6                           680  ;            D1 FOR RIGHT UPPER BLOCK, D2 FOR LEFT LOWER BLOCK AND D3 FOR 
000014A6                           681  ;            RIGHT LOWER BLOCK
000014A6                           682  ; MODIFIES - D0.L, D1.L, D2.L, D3.L
000014A6                           683  ; -----------------------------------------------------------------------------
000014A6  48E7 0C80                684              MOVEM.L D4-D5/A0,-(A7)
000014AA                           685              
000014AA  7810                     686              MOVE.L  #16,D4
000014AC  3400                     687              MOVE.W  D0,D2   ; D2 CONTAINS X LEFT
000014AE  E8A8                     688              LSR.L   D4,D0   ; D0 CONTAINS Y UPPER
000014B0  3601                     689              MOVE.W  D1,D3   ; D3 CONTAINS X RIGHT
000014B2  E8A9                     690              LSR.L   D4,D1   ; D1 CONTAINS Y LOWER
000014B4                           691              
000014B4  80FC 0020                692              DIVU.W  #BLOCKSIZE,D0   ; UPPER BLOCK
000014B8  82FC 0020                693              DIVU.W  #BLOCKSIZE,D1   ; LOWER BLOCK
000014BC  84FC 0020                694              DIVU.W  #BLOCKSIZE,D2   ; LEFT BLOCK
000014C0  86FC 0020                695              DIVU.W  #BLOCKSIZE,D3   ; RIGHT BLOCK
000014C4                           696              
000014C4  48C0                     697              EXT.L   D0
000014C6  48C1                     698              EXT.L   D1
000014C8  48C2                     699              EXT.L   D2
000014CA  48C3                     700              EXT.L   D3
000014CC                           701              
000014CC  7815                     702              MOVE.L  #BLOCKSROW+1,D4 ; +1 BECAUSE OF NULL
000014CE  C8C0                     703              MULU.W  D0,D4           ; INDEX OF COLUMN OF UPPER LEFT AND RIGHT BLOCKS
000014D0  7A15                     704              MOVE.L  #BLOCKSROW+1,D5 ; +1 BECAUSE OF NULL
000014D2  CAC1                     705              MULU.W  D1,D5           ; INDEX OF COLUMN OF LOWER LEFT AND RIGHT BLOCKS
000014D4                           706              
000014D4  41F9 00003A7E            707              LEA.L   LOADEDMAP,A0
000014DA  D1C4                     708              ADDA.L  D4,A0   
000014DC  D1C2                     709              ADDA.L  D2,A0           ; LEFT UPPER BLOCK
000014DE  1010                     710              MOVE.B  (A0),D0         ; STORING TOP LEFT BLOCK IN D0
000014E0                           711              
000014E0  91C2                     712              SUBA.L  D2,A0   
000014E2  D1C3                     713              ADDA.L  D3,A0           ; RIGHT UPPER BLOCK
000014E4  1210                     714              MOVE.B  (A0),D1         ; STORING TOP RIGHT BLOCK IN D1
000014E6                           715              
000014E6  41F9 00003A7E            716              LEA.L   LOADEDMAP,A0
000014EC  D1C5                     717              ADDA.L  D5,A0   
000014EE  D1C2                     718              ADDA.L  D2,A0           ; LEFT LOWER BLOCK
000014F0  1410                     719              MOVE.B  (A0),D2         ; STORING BOTTOM LEFT BLOCK IN D2
000014F2                           720              
000014F2  41F9 00003A7E            721              LEA.L   LOADEDMAP,A0
000014F8  D1C5                     722              ADDA.L  D5,A0   
000014FA  D1C3                     723              ADDA.L  D3,A0           ; RIGHT LOWER BLOCK
000014FC  1610                     724              MOVE.B  (A0),D3         ; STORING BOTTOM RIGHT BLOCK IN D3
000014FE                           725              
000014FE  1800                     726              MOVE.B  D0,D4
00001500  4EB8 1486                727              JSR     ISBLWHICHCOLL
00001504  2004                     728              MOVE.L  D4,D0
00001506                           729              
00001506  1801                     730              MOVE.B  D1,D4
00001508  4EB8 1486                731              JSR     ISBLWHICHCOLL
0000150C  2204                     732              MOVE.L  D4,D1
0000150E                           733              
0000150E  1802                     734              MOVE.B  D2,D4
00001510  4EB8 1486                735              JSR     ISBLWHICHCOLL
00001514  2404                     736              MOVE.L  D4,D2
00001516                           737              
00001516  1803                     738              MOVE.B  D3,D4
00001518  4EB8 1486                739              JSR     ISBLWHICHCOLL
0000151C  2604                     740              MOVE.L  D4,D3
0000151E                           741              
0000151E  4CDF 0130                742              MOVEM.L (A7)+,D4-D5/A0
00001522                           743              
00001522  4E75                     744              RTS
00001524                           745  
00001524                           746  ; -----------------------------------------------------------------------------
00001524                           747  MAPPLOT
00001524                           748  ; INPUT    - 
00001524                           749  ; OUTPUT   - 
00001524                           750  ; MODIFIES - 
00001524                           751  ; -----------------------------------------------------------------------------
00001524                           752  
00001524  48E7 FF00                753          MOVEM.L D0-D7, -(A7)
00001528  48E7 00FE                754          MOVEM.L A0-A6, -(A7)
0000152C  3239 00003A7E            755             MOVE.W LOADEDMAP, D1
00001532  C2FC 000C                756             MULU #12, D1
00001536  3241                     757             MOVEA.W D1, A1
00001538  4EE9 153C                758             JMP MAPSEL(A1)
0000153C                           759  MAPSEL:
0000153C  4EF9 000027CC            760             JMP ELEVATORPLOT
00001542  4EF9 000015F4            761             JMP NEXT
00001548  41F9 00001DDC            762             LEA HEAVEN_0, A0
0000154E  4EF9 000015F4            763             JMP NEXT
00001554  41F9 00001F2C            764             LEA HEAVEN_1, A0
0000155A  4EF9 000015F4            765             JMP NEXT
00001560  41F9 00002067            766             LEA HEAVEN_END, A0
00001566  4EF9 000015F4            767             JMP NEXT
0000156C  41F9 000021A2            768             LEA HEAVEN_ROOM, A0
00001572  4EF9 000015F4            769             JMP NEXT
00001578  41F9 000022DD            770             LEA HELL_0, A0
0000157E  4EF9 000015F4            771             JMP NEXT
00001584  41F9 00002418            772             LEA HELL_1, A0
0000158A  4EF9 000015F4            773             JMP NEXT
00001590  41F9 00002553            774             LEA HELL_END, A0
00001596  4EF9 000015F4            775             JMP NEXT
0000159C  41F9 0000268E            776             LEA HELL_ROOM, A0
000015A2  4EF9 000015F4            777             JMP NEXT
000015A8                           778  ; -----------------------------------------------------------------------------
000015A8                           779  MAPUPD
000015A8                           780  ; INPUT    - 
000015A8                           781  ; OUTPUT   - 
000015A8                           782  ; MODIFIES - 
000015A8                           783  ; -----------------------------------------------------------------------------
000015A8                           784              
000015A8  3F00                     785              MOVE.W D0, -(A7)
000015AA  3039 00003A7E            786              MOVE.W LOADEDMAP, D0
000015B0  B07C 0001                787              CMP #1, D0
000015B4  6700 0460                788              BEQ MAPA1
000015B8  B07C 0002                789              CMP #2, D0
000015BC  6700 04A0                790              BEQ MAPA2
000015C0  B07C 0003                791              CMP #3, D0
000015C4  6700 0598                792              BEQ MAPA3
000015C8  B07C 0004                793              CMP #4, D0
000015CC  6700 05DE                794              BEQ MAPA4
000015D0  B07C 0005                795              CMP #5, D0
000015D4  6700 061E                796              BEQ MAPA5
000015D8  B07C 0006                797              CMP #6, D0
000015DC  6700 065E                798              BEQ MAPA6
000015E0  B07C 0007                799              CMP #7, D0
000015E4  6700 0756                800              BEQ MAPA7
000015E8  B07C 0008                801              CMP #8, D0
000015EC  6700 079E                802              BEQ MAPA8
000015F0  301F                     803              MOVE.W (A7)+, D0
000015F2  4E75                     804              RTS
000015F4                           805  
000015F4                           806      
000015F4                           807              
000015F4                           808  NEXT
000015F4  4281                     809             CLR.L D1
000015F6  1218                     810             MOVE.B (A0)+,D1
000015F8  C2FC 0006                811             MULU #6, D1
000015FC  2241                     812             MOVEA.L D1, A1
000015FE  4EE9 1602                813             JMP JMPLIST(A1)
00001602                           814             
00001602                           815  JMPLIST: 
00001602  4EF9 000019B6            816              JMP NEWLINE ; 0 = END OF ROW
00001608  4EF9 0000168A            817              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
0000160E  4EF9 00001720            818              JMP DBHL    ; 2 = DRAW BRICK HELL
00001614  4EF9 00001794            819              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
0000161A  4EF9 00001808            820              JMP DGHL    ; 4 = DRAW GRASS HELL
00001620  4EF9 0000189E            821              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
00001626  4EF9 000018BE            822              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
0000162C  4EF9 000018DE            823              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
00001632  4EF9 0000164A            824              JMP DDHL    ; 8 = DRAW DOOR HELL
00001638  4EF9 0000166A            825              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
0000163E  4EF9 00001930            826              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
00001644  4EF9 000019EC            827              JMP ENDMAP  ; 11 = END OF THE MAP
0000164A                           828              
0000164A                           829  DDHL
0000164A  2F3C 00111111            830      MOVE.L #$00111111, -(A7)
00001650  2F3C 00111111            831      MOVE.L #$00111111, -(A7)
00001656  4EB9 00001982            832      JSR DRAWBLOCK
0000165C  2C1F                     833      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000165E  2C1F                     834      MOVE.L (A7)+, D6    
00001660  4EB9 000019DA            835      JSR ENDBLOCK
00001666  4EF8 15F4                836      JMP NEXT
0000166A                           837  DDHV
0000166A  2F3C 00FFFFFF            838      MOVE.L #$00FFFFFF, -(A7)
00001670  2F3C 00FFFFFF            839      MOVE.L #$00FFFFFF, -(A7)
00001676  4EB9 00001982            840      JSR DRAWBLOCK
0000167C  2C1F                     841      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000167E  2C1F                     842      MOVE.L (A7)+, D6
00001680  4EB9 000019DA            843      JSR ENDBLOCK
00001686  4EF8 15F4                844      JMP NEXT
0000168A                           845  DGHE ;DRAW-GRASS-HEAVEN vvvR
0000168A  2F3C 0099FF99            846      MOVE.L #$0099FF99, -(A7)
00001690  2F3C 0099FF99            847      MOVE.L #$0099FF99, -(A7)
00001696  4EB9 00001982            848      JSR DRAWBLOCK
0000169C  2C1F                     849      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000169E  2C1F                     850      MOVE.L (A7)+, D6
000016A0                           851      ; SET PEN COLOR 
000016A0  103C 0050                852      MOVE.B #80, D0
000016A4  223C 0000CC00            853      MOVE.L #$0000CC00, D1
000016AA  4E4F                     854      TRAP #15
000016AC                           855      ;DRAW LINES   
000016AC  103C 0054                856      MOVE.B #84, D0 
000016B0                           857      ;LINEA 11 
000016B0  3239 00003A76            858      MOVE.W BPOSX1,D1
000016B6  5C41                     859      ADD.W #6, D1
000016B8  3439 00003A78            860      MOVE.W BPOSY1, D2
000016BE  5A42                     861      ADD.W #5, D2
000016C0  3639 00003A76            862      MOVE.W BPOSX1, D3
000016C6  0643 0009                863      ADD.W #9, D3
000016CA  3839 00003A78            864      MOVE.W BPOSY1, D4
000016D0  0644 000A                865      ADD.W #10, D4
000016D4  4E4F                     866      TRAP #15
000016D6                           867      ;LINEA 12
000016D6  5041                     868      ADD.W #8, D1    
000016D8  5043                     869      ADD.W #8, D3
000016DA  4E4F                     870      TRAP #15
000016DC                           871      ;LINEA 13
000016DC  5041                     872      ADD.W #8, D1    
000016DE  5043                     873      ADD.W #8, D3
000016E0  4E4F                     874      TRAP #15
000016E2                           875      ;LINEA 21
000016E2  3239 00003A76            876      MOVE.W BPOSX1,D1
000016E8  5C41                     877      ADD.W #6, D1
000016EA  3439 00003A78            878      MOVE.W BPOSY1, D2
000016F0  0642 0014                879      ADD.W #20, D2
000016F4  3639 00003A76            880      MOVE.W BPOSX1, D3
000016FA  0643 0009                881      ADD.W #9, D3
000016FE  3839 00003A78            882      MOVE.W BPOSY1, D4
00001704  0644 0019                883      ADD.W #25, D4
00001708  4E4F                     884      TRAP #15
0000170A                           885      ;LINEA 22
0000170A  5041                     886      ADD.W #8, D1    
0000170C  5043                     887      ADD.W #8, D3
0000170E  4E4F                     888      TRAP #15
00001710                           889      ;LINEA 23
00001710  5041                     890      ADD.W #8, D1    
00001712  5043                     891      ADD.W #8, D3
00001714  4E4F                     892      TRAP #15
00001716  4EB9 000019DA            893      JSR ENDBLOCK
0000171C  4EF8 15F4                894      JMP NEXT
00001720                           895  DBHL ;DRAW BRICK-HELL vvvR
00001720                           896      
00001720  2F3C 00010101            897      MOVE.L #$00010101, -(A7)
00001726  2F3C 00666666            898      MOVE.L #$00666666, -(A7)
0000172C  4EB9 00001982            899      JSR DRAWBLOCK
00001732  2C1F                     900      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001734  2C1F                     901      MOVE.L (A7)+, D6
00001736                           902      ;DRAW HORIZONTAL LINE
00001736  103C 0054                903      MOVE.B #84, D0 
0000173A  3239 00003A76            904      MOVE.W BPOSX1, D1
00001740  3439 00003A78            905      MOVE.W BPOSY1, D2
00001746  0642 0010                906      ADD.W #16, D2
0000174A  3639 00003A76            907      MOVE.W BPOSX1, D3
00001750  0643 0020                908      ADD.W #32, D3
00001754  3839 00003A78            909      MOVE.W BPOSY1, D4
0000175A  0644 0010                910      ADD.W #16, D4
0000175E  4E4F                     911      TRAP #15
00001760                           912      ;DRAW VERTICAL LINE 
00001760  3239 00003A76            913      MOVE.W BPOSX1, D1
00001766  0641 0010                914      ADD.W #16, D1
0000176A  3439 00003A78            915      MOVE.W BPOSY1, D2
00001770  0642 0010                916      ADD.W #16, D2
00001774  3639 00003A76            917      MOVE.W BPOSX1, D3
0000177A  0643 0010                918      ADD.W #16, D3
0000177E  3839 00003A78            919      MOVE.W BPOSY1, D4
00001784  0644 0020                920      ADD.W #32, D4
00001788  4E4F                     921      TRAP #15
0000178A  4EB9 000019DA            922      JSR ENDBLOCK    
00001790  4EF8 15F4                923      JMP NEXT
00001794                           924  DBHV ;DRAW BRICK-HEAVEN vvvR
00001794                           925      
00001794  2F3C 00CCCCCC            926      MOVE.L #$00CCCCCC, -(A7)
0000179A  2F3C 00D7EBFA            927      MOVE.L #$00D7EBFA, -(A7)
000017A0  4EB9 00001982            928      JSR DRAWBLOCK
000017A6  2C1F                     929      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000017A8  2C1F                     930      MOVE.L (A7)+, D6
000017AA                           931      ;DRAW HORIZONTAL LINE
000017AA  103C 0054                932      MOVE.B #84, D0 
000017AE  3239 00003A76            933      MOVE.W BPOSX1, D1
000017B4  3439 00003A78            934      MOVE.W BPOSY1, D2
000017BA  0642 0010                935      ADD.W #16, D2
000017BE  3639 00003A76            936      MOVE.W BPOSX1, D3
000017C4  0643 0020                937      ADD.W #32, D3
000017C8  3839 00003A78            938      MOVE.W BPOSY1, D4
000017CE  0644 0010                939      ADD.W #16, D4
000017D2  4E4F                     940      TRAP #15
000017D4                           941      ;DRAW VERTICAL LINE 
000017D4  3239 00003A76            942      MOVE.W BPOSX1, D1
000017DA  0641 0010                943      ADD.W #16, D1
000017DE  3439 00003A78            944      MOVE.W BPOSY1, D2
000017E4  0642 0010                945      ADD.W #16, D2
000017E8  3639 00003A76            946      MOVE.W BPOSX1, D3
000017EE  0643 0010                947      ADD.W #16, D3
000017F2  3839 00003A78            948      MOVE.W BPOSY1, D4
000017F8  0644 0020                949      ADD.W #32, D4
000017FC  4E4F                     950      TRAP #15 
000017FE  4EB9 000019DA            951      JSR ENDBLOCK
00001804  4EF8 15F4                952      JMP NEXT
00001808                           953  DGHL ;DRAW GRASS HELL vvvR
00001808                           954  
00001808  2F3C 002255EE            955      MOVE.L #$002255EE, -(A7)
0000180E  2F3C 002255EE            956      MOVE.L #$002255EE, -(A7)
00001814  4EB9 00001982            957      JSR DRAWBLOCK
0000181A  2C1F                     958      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000181C  2C1F                     959      MOVE.L (A7)+, D6
0000181E                           960      ; SET PEN COLOR 
0000181E  103C 0050                961      MOVE.B #80, D0
00001822  223C 000000CC            962      MOVE.L #$000000CC, D1
00001828  4E4F                     963      TRAP #15
0000182A                           964      ;DRAW LINES   
0000182A  103C 0054                965      MOVE.B #84, D0 
0000182E                           966      ;LINEA 11 
0000182E  3239 00003A76            967      MOVE.W BPOSX1,D1
00001834  5C41                     968      ADD.W #6, D1
00001836  3439 00003A78            969      MOVE.W BPOSY1, D2
0000183C  5A42                     970      ADD.W #5, D2
0000183E  3639 00003A76            971      MOVE.W BPOSX1, D3
00001844  0643 0009                972      ADD.W #9, D3
00001848  3839 00003A78            973      MOVE.W BPOSY1, D4
0000184E  0644 000A                974      ADD.W #10, D4
00001852  4E4F                     975      TRAP #15
00001854                           976      ;LINEA 12
00001854  5041                     977      ADD.W #8, D1    
00001856  5043                     978      ADD.W #8, D3
00001858  4E4F                     979      TRAP #15
0000185A                           980      ;LINEA 13
0000185A  5041                     981      ADD.W #8, D1    
0000185C  5043                     982      ADD.W #8, D3
0000185E  4E4F                     983      TRAP #15
00001860                           984      ;LINEA 21
00001860  3239 00003A76            985      MOVE.W BPOSX1,D1
00001866  5C41                     986      ADD.W #6, D1
00001868  3439 00003A78            987      MOVE.W BPOSY1, D2
0000186E  0642 0014                988      ADD.W #20, D2
00001872  3639 00003A76            989      MOVE.W BPOSX1, D3
00001878  0643 0009                990      ADD.W #9, D3
0000187C  3839 00003A78            991      MOVE.W BPOSY1, D4
00001882  0644 0019                992      ADD.W #25, D4
00001886  4E4F                     993      TRAP #15
00001888                           994      ;LINEA 22
00001888  5041                     995      ADD.W #8, D1    
0000188A  5043                     996      ADD.W #8, D3
0000188C  4E4F                     997      TRAP #15
0000188E                           998      ;LINEA 23
0000188E  5041                     999      ADD.W #8, D1    
00001890  5043                    1000      ADD.W #8, D3
00001892  4E4F                    1001      TRAP #15
00001894  4EB9 000019DA           1002      JSR ENDBLOCK
0000189A  4EF8 15F4               1003      JMP NEXT
0000189E                          1004  
0000189E                          1005  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
0000189E  2F3C 00CCCCCC           1006      MOVE.L #$00CCCCCC, -(A7)
000018A4  2F3C 00C6DAE9           1007      MOVE.L #$00C6DAE9, -(A7)
000018AA  4EB9 00001982           1008      JSR DRAWBLOCK
000018B0  2C1F                    1009      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018B2  2C1F                    1010      MOVE.L (A7)+, D6
000018B4  4EB9 000019DA           1011      JSR ENDBLOCK
000018BA  4EF8 15F4               1012      JMP NEXT
000018BE                          1013  DF1HL ; DRAW FLOOR_1 HELL vvvR 
000018BE  2F3C 00010101           1014      MOVE.L #$00010101, -(A7)
000018C4  2F3C 00777777           1015      MOVE.L #$00777777, -(A7)
000018CA  4EB9 00001982           1016      JSR DRAWBLOCK
000018D0  2C1F                    1017      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018D2  2C1F                    1018      MOVE.L (A7)+, D6
000018D4                          1019  
000018D4  4EB9 000019DA           1020      JSR ENDBLOCK
000018DA  4EF8 15F4               1021      JMP NEXT
000018DE                          1022      
000018DE                          1023  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
000018DE  2F3C 00CCCCCC           1024      MOVE.L #$00CCCCCC, -(A7)
000018E4  2F3C 00C6DAE9           1025      MOVE.L #$00C6DAE9, -(A7)
000018EA  4EB9 00001982           1026      JSR DRAWBLOCK
000018F0  2C1F                    1027      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018F2  2C1F                    1028      MOVE.L (A7)+, D6
000018F4                          1029      ;SET NEW FILL COLOR  
000018F4  103C 0051               1030      MOVE.B #81, D0
000018F8  223C 00D7EBFA           1031      MOVE.L #$00D7EBFA, D1
000018FE  4E4F                    1032      TRAP #15 
00001900                          1033      ;DRAW INSIDE SQUARE 
00001900  103C 0057               1034      MOVE.B #87, D0
00001904  3239 00003A76           1035      MOVE.W BPOSX1, D1
0000190A  5041                    1036      ADD.W #8, D1
0000190C  3439 00003A78           1037      MOVE.W BPOSY1, D2
00001912  5042                    1038      ADD.W #8, D2
00001914  3639 00003A7A           1039      MOVE.W BPOSX2, D3
0000191A  5143                    1040      SUB.W #8, D3
0000191C  3839 00003A7C           1041      MOVE.W BPOSY2, D4
00001922  5144                    1042      SUB.W #8, D4
00001924  4E4F                    1043      TRAP #15
00001926  4EB9 000019DA           1044      JSR ENDBLOCK
0000192C  4EF8 15F4               1045      JMP NEXT
00001930                          1046  DF2HL ; DRAW FLOOR_2 HELL vvvR
00001930  2F3C 00010101           1047      MOVE.L #$00010101, -(A7)
00001936  2F3C 00777777           1048      MOVE.L #$00777777, -(A7)
0000193C  4EB9 00001982           1049      JSR DRAWBLOCK
00001942  2C1F                    1050      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001944  2C1F                    1051      MOVE.L (A7)+, D6
00001946                          1052      ;SET NEW FILL COLOR  
00001946  103C 0051               1053      MOVE.B #81, D0
0000194A  223C 00666666           1054      MOVE.L #$00666666, D1
00001950  4E4F                    1055      TRAP #15 
00001952                          1056  ;DRAW INSIDE SQUARE 
00001952  103C 0057               1057      MOVE.B #87, D0
00001956  3239 00003A76           1058      MOVE.W BPOSX1, D1
0000195C  5041                    1059      ADD.W #8, D1
0000195E  3439 00003A78           1060      MOVE.W BPOSY1, D2
00001964  5042                    1061      ADD.W #8, D2
00001966  3639 00003A7A           1062      MOVE.W BPOSX2, D3
0000196C  5143                    1063      SUB.W #8, D3
0000196E  3839 00003A7C           1064      MOVE.W BPOSY2, D4
00001974  5144                    1065      SUB.W #8, D4
00001976  4E4F                    1066      TRAP #15
00001978  4EB9 000019DA           1067      JSR ENDBLOCK
0000197E  4EF8 15F4               1068      JMP NEXT    
00001982                          1069      
00001982                          1070  DRAWBLOCK 
00001982                          1071  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPUS COMO LONGS. 
00001982                          1072      
00001982                          1073      ;SET FILL COLOR  
00001982  103C 0051               1074      MOVE.B #81, D0
00001986  222F 0004               1075      MOVE.L 4(A7), D1
0000198A  4E4F                    1076      TRAP #15 
0000198C                          1077      
0000198C                          1078      ; SET PEN COLOR 
0000198C  103C 0050               1079      MOVE.B #80, D0
00001990  222F 0008               1080      MOVE.L 8(A7), D1
00001994  4E4F                    1081      TRAP #15 
00001996                          1082  
00001996                          1083      ;DRAW BLOCK 
00001996  103C 0057               1084      MOVE.B #87, D0
0000199A  3239 00003A76           1085      MOVE.W BPOSX1, D1
000019A0  3439 00003A78           1086      MOVE.W BPOSY1, D2
000019A6  3639 00003A7A           1087      MOVE.W BPOSX2, D3
000019AC  3839 00003A7C           1088      MOVE.W BPOSY2, D4
000019B2  4E4F                    1089      TRAP #15
000019B4  4E75                    1090      RTS
000019B6                          1091  
000019B6                          1092  NEWLINE
000019B6                          1093      ;RESET X POSITION
000019B6  33FC 0000 00003A76      1094      MOVE.W #0, BPOSX1
000019BE  33FC 0020 00003A7A      1095      MOVE.W #32, BPOSX2
000019C6                          1096      ;ADD 33 TO Y POSITION
000019C6  0679 0020 00003A78      1097      ADD.W #32, BPOSY1
000019CE  0679 0020 00003A7C      1098      ADD.W #32, BPOSY2
000019D6  4EF8 15F4               1099      JMP NEXT
000019DA                          1100     
000019DA                          1101  ENDBLOCK
000019DA                          1102      ;SET NEW BLOCK POSITION
000019DA  0679 0020 00003A76      1103      ADD.W #32, BPOSX1
000019E2  0679 0020 00003A7A      1104      ADD.W #32, BPOSX2
000019EA  4E75                    1105      RTS
000019EC                          1106  ENDMAP
000019EC                          1107      ;SET DEFAULT BLOCK POSITION
000019EC  33FC 0000 00003A76      1108      MOVE.W #0, BPOSX1
000019F4  33FC 0000 00003A78      1109      MOVE.W #0, BPOSY1
000019FC  33FC 0020 00003A7A      1110      MOVE.W #32, BPOSX2
00001A04  33FC 0020 00003A7C      1111      MOVE.W #32, BPOSY2
00001A0C  4CDF 7F00               1112      MOVEM.L (A7)+, A0-A6
00001A10  4CDF 00FF               1113      MOVEM.L (A7)+, D0-D7
00001A14  4E75                    1114      RTS
00001A16                          1115      
00001A16                          1116  
00001A16                          1117  
00001A16                          1118  MAPA1
00001A16  301F                    1119      MOVE.W (A7)+, D0
00001A18  48A7 F800               1120      MOVEM.W D0-D4, -(A7)
00001A1C  3039 00003A70           1121      MOVE.W PLAYERPOSX, D0
00001A22  3239 00003A72           1122      MOVE.W PLAYERPOSY, D1
00001A28                          1123      ;GO TO THE NEXT ROOM DOOR
00001A28                          1124      ;FIRST LETS CHECH POS X
00001A28  B07C 0160               1125      CMP #352, D0  ; BGT = 352 > D0
00001A2C  6E00 002A               1126      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A30  B07C 0120               1127      CMP #288, D0
00001A34  6D00 0022               1128      BLT MAP1NODOOR
00001A38                          1129      ;NOW WE CHECK POS Y 
00001A38  B27C 01E0               1130      CMP #480, D1  ; 
00001A3C  6E00 001A               1131      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A40  B27C 01C0               1132      CMP #448, D1
00001A44  6D00 0012               1133      BLT MAP1NODOOR
00001A48  33FC 0020 00003A72      1134      MOVE.W #32, PLAYERPOSY
00001A50  33FC 0002 00003A7E      1135      MOVE.W #2, LOADEDMAP
00001A58                          1136  MAP1NODOOR
00001A58  4C9F 001F               1137      MOVEM.W (A7)+, D0-D4
00001A5C  4E75                    1138      RTS
00001A5E                          1139      
00001A5E                          1140  MAPA2
00001A5E  301F                    1141      MOVE.W (A7)+, D0
00001A60  48A7 F800               1142      MOVEM.W D0-D4, -(A7)
00001A64  3039 00003A70           1143      MOVE.W PLAYERPOSX, D0
00001A6A  3239 00003A72           1144      MOVE.W PLAYERPOSY, D1
00001A70                          1145      ;GO TO THE NEXT ROOM DOOR
00001A70                          1146      ;FIRST LETS CHECK POS X
00001A70  B07C 0160               1147      CMP #352, D0  ; BGT = 352 > D0
00001A74  6E00 0030               1148      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A78  B07C 0120               1149      CMP #288, D0
00001A7C  6D00 0028               1150      BLT MAP2NODOOR1
00001A80                          1151      ;NOW WE CHECK POS Y 
00001A80  B27C 01E0               1152      CMP #480, D1  ; 
00001A84  6E00 0020               1153      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A88  B27C 01C0               1154      CMP #448, D1
00001A8C  6D00 0018               1155      BLT MAP2NODOOR1
00001A90  33FC 0020 00003A72      1156      MOVE.W #32, PLAYERPOSY
00001A98  33FC 0003 00003A7E      1157      MOVE.W #3, LOADEDMAP
00001AA0  4C9F 001F               1158      MOVEM.W (A7)+, D0-D4
00001AA4  4E75                    1159      RTS
00001AA6                          1160  MAP2NODOOR1
00001AA6                          1161      ;GO TO THE PREVIOUS ROOM DOOR
00001AA6                          1162      ;FIRST LETS CHECK POS X
00001AA6  B07C 0160               1163      CMP #352, D0  ; BGT = 352 > D0
00001AAA  6E00 0030               1164      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AAE  B07C 0120               1165      CMP #288, D0
00001AB2  6D00 0028               1166      BLT MAP2NODOOR2
00001AB6                          1167      ;NOW WE CHECK POS Y 
00001AB6  B27C 0020               1168      CMP #32, D1  ; 
00001ABA  6E00 0020               1169      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ABE  B27C 0000               1170      CMP #0, D1
00001AC2  6D00 0018               1171      BLT MAP2NODOOR2
00001AC6  33FC 01A0 00003A72      1172      MOVE.W  #416, PLAYERPOSY
00001ACE  33FC 0001 00003A7E      1173      MOVE.W #1, LOADEDMAP
00001AD6  4C9F 001F               1174      MOVEM.W (A7)+, D0-D4
00001ADA  4E75                    1175      RTS
00001ADC                          1176  
00001ADC                          1177  MAP2NODOOR2
00001ADC                          1178      ;GO TO THE LEFT HEAVEN'S ROOM
00001ADC  B07C 00A0               1179      CMP #160, D0  ; BGT = 352 > D0
00001AE0  6E00 0038               1180      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AE4  B07C 0080               1181      CMP #128, D0
00001AE8  6D00 0030               1182      BLT MAP2NODOOR3
00001AEC                          1183      ;NOW WE CHECK POS Y 
00001AEC  B27C 00AA               1184      CMP #170, D1  ; 
00001AF0  6E00 0028               1185      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AF4  B27C 0078               1186      CMP #120, D1
00001AF8  6D00 0020               1187      BLT MAP2NODOOR3
00001AFC  33FC 0130 00003A70      1188      MOVE.W #$130, PLAYERPOSX
00001B04  33FC 00B0 00003A72      1189      MOVE.W #$0B0, PLAYERPOSY
00001B0C  33FC 0004 00003A7E      1190      MOVE.W #4, LOADEDMAP
00001B14  4C9F 001F               1191      MOVEM.W (A7)+, D0-D4
00001B18  4E75                    1192      RTS
00001B1A                          1193  MAP2NODOOR3
00001B1A                          1194      ;GO TO THE RIGHT HEAVEN'S ROOM
00001B1A  B07C 01E0               1195      CMP #480, D0  ; BGT = 352 > D0
00001B1E  6E00 0038               1196      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B22  B07C 01C0               1197      CMP #448, D0
00001B26  6D00 0030               1198      BLT MAP2NODOOR4
00001B2A                          1199      ;NOW WE CHECK POS Y 
00001B2A  B27C 00AA               1200      CMP #170, D1  ; 
00001B2E  6E00 0028               1201      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B32  B27C 0078               1202      CMP #120, D1
00001B36  6D00 0020               1203      BLT MAP2NODOOR4
00001B3A  33FC 0130 00003A70      1204      MOVE.W #$130, PLAYERPOSX
00001B42  33FC 00B0 00003A72      1205      MOVE.W #$0B0, PLAYERPOSY
00001B4A  33FC 0004 00003A7E      1206      MOVE.W #4, LOADEDMAP
00001B52  4C9F 001F               1207      MOVEM.W (A7)+, D0-D4
00001B56  4E75                    1208      RTS
00001B58                          1209  MAP2NODOOR4
00001B58  4C9F 001F               1210      MOVEM.W (A7)+, D0-D4
00001B5C  4E75                    1211      RTS
00001B5E                          1212  MAPA3 
00001B5E  301F                    1213      MOVE.W (A7)+, D0
00001B60  48A7 F800               1214      MOVEM.W D0-D4, -(A7)
00001B64  3039 00003A70           1215      MOVE.W PLAYERPOSX, D0
00001B6A  3239 00003A72           1216      MOVE.W PLAYERPOSY, D1
00001B70                          1217      ;GO TO THE PREVIOUS ROOM DOOR
00001B70                          1218      ;FIRST LETS CHECK POS X
00001B70  B07C 0160               1219      CMP #352, D0  ; BGT = 352 > D0
00001B74  6E00 0030               1220      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B78  B07C 0120               1221      CMP #288, D0
00001B7C  6D00 0028               1222      BLT MAP3NODOOR
00001B80                          1223      ;NOW WE CHECK POS Y 
00001B80  B27C 0020               1224      CMP #32, D1  ; 
00001B84  6E00 0020               1225      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B88  B27C 0000               1226      CMP #0, D1
00001B8C  6D00 0018               1227      BLT MAP3NODOOR
00001B90  33FC 01A0 00003A72      1228      MOVE.W  #416, PLAYERPOSY
00001B98  33FC 0002 00003A7E      1229      MOVE.W #2, LOADEDMAP
00001BA0  4C9F 001F               1230      MOVEM.W (A7)+, D0-D4
00001BA4  4E75                    1231      RTS
00001BA6                          1232  MAP3NODOOR
00001BA6  4C9F 001F               1233      MOVEM.W (A7)+, D0-D4
00001BAA  4E75                    1234      RTS
00001BAC                          1235  MAPA4
00001BAC  301F                    1236      MOVE.W (A7)+, D0
00001BAE  48A7 F800               1237      MOVEM.W D0-D4, -(A7)
00001BB2  3039 00003A70           1238      MOVE.W PLAYERPOSX, D0
00001BB8  3239 00003A72           1239      MOVE.W PLAYERPOSY, D1
00001BBE                          1240      ;GO BACK TO 2ND HEAVEN'S ROOM
00001BBE  B07C 0180               1241      CMP #384, D0  ; BGT = 352 > D0
00001BC2  6E00 002A               1242      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BC6  B07C 0104               1243      CMP #260, D0
00001BCA  6D00 0022               1244      BLT MAP4NODOOR
00001BCE                          1245      ;NOW WE CHECK POS Y 
00001BCE  B27C 0080               1246      CMP #128, D1  ; 
00001BD2  6E00 001A               1247      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BD6  B27C 0060               1248      CMP #96, D1
00001BDA  6D00 0012               1249      BLT MAP4NODOOR
00001BDE  33FC 00E0 00003A70      1250      MOVE.W  #224, PLAYERPOSX
00001BE6  33FC 0002 00003A7E      1251      MOVE.W #2, LOADEDMAP
00001BEE                          1252  MAP4NODOOR
00001BEE  4C9F 001F               1253      MOVEM.W (A7)+, D0-D4
00001BF2  4E75                    1254      RTS
00001BF4                          1255  ;;;;;;;;;;HELL
00001BF4                          1256  MAPA5
00001BF4  301F                    1257      MOVE.W (A7)+, D0
00001BF6  48A7 F800               1258      MOVEM.W D0-D4, -(A7)
00001BFA  3039 00003A70           1259      MOVE.W PLAYERPOSX, D0
00001C00  3239 00003A72           1260      MOVE.W PLAYERPOSY, D1
00001C06                          1261      ;GO TO THE NEXT ROOM DOOR
00001C06                          1262      ;FIRST LETS CHECH POS X
00001C06  B07C 0160               1263      CMP #352, D0  ; BGT = 352 > D0
00001C0A  6E00 002A               1264      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C0E  B07C 0120               1265      CMP #288, D0
00001C12  6D00 0022               1266      BLT MAP5NODOOR
00001C16                          1267      ;NOW WE CHECK POS Y 
00001C16  B27C 01E0               1268      CMP #480, D1  ; 
00001C1A  6E00 001A               1269      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C1E  B27C 01C0               1270      CMP #448, D1
00001C22  6D00 0012               1271      BLT MAP5NODOOR
00001C26  33FC 0020 00003A72      1272      MOVE.W #32, PLAYERPOSY
00001C2E  33FC 0006 00003A7E      1273      MOVE.W #6, LOADEDMAP
00001C36                          1274  MAP5NODOOR
00001C36  4C9F 001F               1275      MOVEM.W (A7)+, D0-D4
00001C3A  4E75                    1276      RTS
00001C3C                          1277      
00001C3C                          1278  MAPA6
00001C3C  301F                    1279      MOVE.W (A7)+, D0
00001C3E  48A7 F800               1280      MOVEM.W D0-D4, -(A7)
00001C42  3039 00003A70           1281      MOVE.W PLAYERPOSX, D0
00001C48  3239 00003A72           1282      MOVE.W PLAYERPOSY, D1
00001C4E                          1283      ;GO TO THE NEXT ROOM DOOR
00001C4E                          1284      ;FIRST LETS CHECK POS X
00001C4E  B07C 0160               1285      CMP #352, D0  ; BGT = 352 > D0
00001C52  6E00 0030               1286      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C56  B07C 0120               1287      CMP #288, D0
00001C5A  6D00 0028               1288      BLT MAP6NODOOR1
00001C5E                          1289      ;NOW WE CHECK POS Y 
00001C5E  B27C 01E0               1290      CMP #480, D1  ; 
00001C62  6E00 0020               1291      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C66  B27C 01C0               1292      CMP #448, D1
00001C6A  6D00 0018               1293      BLT MAP6NODOOR1
00001C6E  33FC 0020 00003A72      1294      MOVE.W #32, PLAYERPOSY
00001C76  33FC 0007 00003A7E      1295      MOVE.W #7, LOADEDMAP
00001C7E  4C9F 001F               1296      MOVEM.W (A7)+, D0-D4
00001C82  4E75                    1297      RTS
00001C84                          1298  MAP6NODOOR1
00001C84                          1299      ;GO TO THE PREVIOUS ROOM DOOR
00001C84                          1300      ;FIRST LETS CHECK POS X
00001C84  B07C 0160               1301      CMP #352, D0  ; BGT = 352 > D0
00001C88  6E00 0030               1302      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C8C  B07C 0120               1303      CMP #288, D0
00001C90  6D00 0028               1304      BLT MAP6NODOOR2
00001C94                          1305      ;NOW WE CHECK POS Y 
00001C94  B27C 0020               1306      CMP #32, D1  ; 
00001C98  6E00 0020               1307      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C9C  B27C 0000               1308      CMP #0, D1
00001CA0  6D00 0018               1309      BLT MAP6NODOOR2
00001CA4  33FC 01A0 00003A72      1310      MOVE.W  #416, PLAYERPOSY
00001CAC  33FC 0005 00003A7E      1311      MOVE.W #5, LOADEDMAP
00001CB4  4C9F 001F               1312      MOVEM.W (A7)+, D0-D4
00001CB8  4E75                    1313      RTS
00001CBA                          1314  MAP6NODOOR2
00001CBA                          1315      ;CHECK FOR LEFT HELL ROOM
00001CBA  B07C 0060               1316      CMP #96, D0  ; BGT = 352 > D0
00001CBE  6E00 0038               1317      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CC2  B07C 0040               1318      CMP #64, D0
00001CC6  6D00 0030               1319      BLT MAP6NODOOR3
00001CCA                          1320      ;NOW WE CHECK POS Y 
00001CCA  B27C 0180               1321      CMP #384, D1  ; 
00001CCE  6E00 0028               1322      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CD2  B27C 0140               1323      CMP #320, D1
00001CD6  6D00 0020               1324      BLT MAP6NODOOR3
00001CDA  33FC 0130 00003A70      1325      MOVE.W #$130, PLAYERPOSX
00001CE2  33FC 00B0 00003A72      1326      MOVE.W #$0B0, PLAYERPOSY
00001CEA  33FC 0008 00003A7E      1327      MOVE.W #8, LOADEDMAP
00001CF2  4C9F 001F               1328      MOVEM.W (A7)+, D0-D4
00001CF6  4E75                    1329      RTS
00001CF8                          1330  MAP6NODOOR3
00001CF8                          1331      ;CHECK FOR THE RIGHT HELL ROOM
00001CF8  B07C 0240               1332      CMP #576, D0  ; BGT = 352 > D0
00001CFC  6E00 0038               1333      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D00  B07C 021C               1334      CMP #540, D0
00001D04  6D00 0030               1335      BLT MAP6NODOOR4
00001D08                          1336      ;NOW WE CHECK POS Y 
00001D08  B27C 0180               1337      CMP #384, D1  ; 
00001D0C  6E00 0028               1338      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D10  B27C 0140               1339      CMP #320, D1
00001D14  6D00 0020               1340      BLT MAP6NODOOR4
00001D18  33FC 0130 00003A70      1341      MOVE.W #$130, PLAYERPOSX
00001D20  33FC 00B0 00003A72      1342      MOVE.W #$0B0, PLAYERPOSY
00001D28  33FC 0008 00003A7E      1343      MOVE.W #8, LOADEDMAP
00001D30  4C9F 001F               1344      MOVEM.W (A7)+, D0-D4
00001D34  4E75                    1345      RTS
00001D36                          1346  MAP6NODOOR4
00001D36  4C9F 001F               1347      MOVEM.W (A7)+, D0-D4
00001D3A  4E75                    1348      RTS
00001D3C                          1349  MAPA7 
00001D3C  301F                    1350      MOVE.W (A7)+, D0
00001D3E  48A7 F800               1351      MOVEM.W D0-D4, -(A7)
00001D42  3039 00003A70           1352      MOVE.W PLAYERPOSX, D0
00001D48  3239 00003A72           1353      MOVE.W PLAYERPOSY, D1
00001D4E                          1354      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D4E  B07C 0180               1355      CMP #384, D0  ; BGT = 352 > D0
00001D52  6E00 0032               1356      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D56  B07C 0104               1357      CMP #260, D0
00001D5A  6D00 002A               1358      BLT MAP7NODOOR
00001D5E                          1359      ;NOW WE CHECK POS Y 
00001D5E  B27C 0020               1360      CMP #32, D1  ; 
00001D62  6E00 0022               1361      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D66  B27C 0000               1362      CMP #0, D1
00001D6A  6D00 001A               1363      BLT MAP7NODOOR
00001D6E  33FC 0140 00003A70      1364      MOVE.W  #320, PLAYERPOSX
00001D76  33FC 01A0 00003A72      1365      MOVE.W #416, PLAYERPOSY
00001D7E  33FC 0006 00003A7E      1366      MOVE.W #6, LOADEDMAP
00001D86                          1367  MAP7NODOOR
00001D86  4C9F 001F               1368      MOVEM.W (A7)+, D0-D4
00001D8A  4E75                    1369      RTS
00001D8C                          1370  MAPA8
00001D8C                          1371       ;HELLS ROOM
00001D8C  301F                    1372      MOVE.W (A7)+, D0
00001D8E  48A7 F800               1373      MOVEM.W D0-D4, -(A7)
00001D92  3039 00003A70           1374      MOVE.W PLAYERPOSX, D0
00001D98  3239 00003A72           1375      MOVE.W PLAYERPOSY, D1
00001D9E                          1376      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D9E  B07C 0180               1377      CMP #384, D0  ; BGT = 352 > D0
00001DA2  6E00 0032               1378      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001DA6  B07C 0104               1379      CMP #260, D0
00001DAA  6D00 002A               1380      BLT MAP8NODOOR1
00001DAE                          1381      ;NOW WE CHECK POS Y 
00001DAE  B27C 0080               1382      CMP #128, D1  ; 
00001DB2  6E00 0022               1383      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001DB6  B27C 0060               1384      CMP #96, D1
00001DBA  6D00 001A               1385      BLT MAP8NODOOR1
00001DBE  33FC 0140 00003A70      1386      MOVE.W  #320, PLAYERPOSX
00001DC6  33FC 0080 00003A72      1387      MOVE.W #128, PLAYERPOSY
00001DCE  33FC 0006 00003A7E      1388      MOVE.W #6, LOADEDMAP
00001DD6                          1389  MAP8NODOOR1
00001DD6  4C9F 001F               1390      MOVEM.W (A7)+, D0-D4
00001DDA  4E75                    1391      RTS
00001DDC                          1392  
00001DDC                          1393  
00001DDC                          1394  
00001DDC                          1395  
00001DDC                          1396  
00001DDC                          1397  
00001DDC                          1398  
00001DDC                          1399  
00001DDC                          1400  
00001DDC                          1401  
00001DDC                          1402  
00001DDC                          1403  
00001DDC                          1404  
00001DDC                          1405  
00001DDC                          1406  
00001DDC                          1407  
00001DDC                          1408  -------------------- end include --------------------
00001DDC                          1409              INCLUDE "MAPS.X68"
00001DDC                          1410  
00001DDC                          1411  ;MAP 0 INDICATES THAT WE ARE IN THE ELEVATOR MENU. 
00001DDC                          1412  
00001DDC                          1413  HEAVEN_0    ;MAP 1
00001DDC= 03 03 03 03 03 03 ...   1414      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00001DF1= 03 01 01 01 01 01 ...   1415      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
00001E06= 03 01 03 03 03 03 ...   1416      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
00001E1B= 03 01 03 05 05 05 ...   1417      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00001E30= 03 01 03 05 05 05 ...   1418      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E45= 03 01 03 05 05 05 ...   1419      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E5A= 03 01 03 05 05 05 ...   1420      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001E6F= 03 01 03 05 05 05 ...   1421      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001E84= 03 01 03 05 05 05 ...   1422      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E99= 03 01 03 05 05 05 ...   1423      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001EAE= 03 01 03 05 05 05 ...   1424      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001EC3= 03 01 03 05 05 05 ...   1425      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001ED8= 03 01 03 05 05 05 ...   1426      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001EED= 03 01 03 03 03 03 ...   1427      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00001F02= 03 01 01 01 01 01 ...   1428      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001F17= 03 03 03 03 03 03 ...   1429      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001F2C                          1430          
00001F2C                          1431  HEAVEN_1    ;MAP 2
00001F2C= 03 03 03 03 03 03 ...   1432      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001F41= 03 03 01 01 01 01 ...   1433      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
00001F56= 03 03 03 03 03 03 ...   1434      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
00001F6B= 03 07 07 07 07 03 ...   1435      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F80= 03 07 07 07 07 03 ...   1436      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F95= 03 07 07 07 07 09 ...   1437      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
00001FAA= 03 07 07 07 07 03 ...   1438      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00001FBF= 03 07 07 07 07 03 ...   1439      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001FD4= 03 03 03 03 03 03 ...   1440      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
00001FE9= 03 01 01 01 01 03 ...   1441      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00001FFE= 03 01 01 01 01 01 ...   1442      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00002013= 03 01 01 01 01 01 ...   1443      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00002028= 03 01 01 01 01 01 ...   1444      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
0000203D= 03 01 01 01 01 01 ...   1445      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00002052= 03 03 03 03 03 03 ...   1446      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00002067                          1447      
00002067                          1448  HEAVEN_END  ;MAP 3
00002067= 03 03 03 03 03 03 ...   1449      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
0000207C= 03 05 05 05 05 05 ...   1450      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00002091= 03 05 05 07 05 05 ...   1451      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000020A6= 03 05 07 07 07 05 ...   1452      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
000020BB= 03 05 05 07 05 05 ...   1453      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
000020D0= 03 05 05 07 05 05 ...   1454      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
000020E5= 03 05 05 05 05 05 ...   1455      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020FA= 03 05 05 05 05 05 ...   1456      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
0000210F= 03 05 05 05 05 05 ...   1457      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00002124= 03 05 05 07 05 05 ...   1458      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002139= 03 05 07 07 07 05 ...   1459      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
0000214E= 03 05 05 07 05 05 ...   1460      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002163= 03 05 05 07 05 05 ...   1461      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002178= 03 05 05 05 05 05 ...   1462      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
0000218D= 03 03 03 03 03 03 ...   1463      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
000021A2                          1464      
000021A2                          1465  HEAVEN_ROOM ;MAP 4
000021A2= 09 09 09 09 09 09 ...   1466      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021B7= 09 09 09 09 09 09 ...   1467      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021CC= 09 09 09 09 09 09 ...   1468      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021E1= 09 09 09 09 09 09 ...   1469      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021F6= 09 09 09 09 09 03 ...   1470      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
0000220B= 09 09 09 09 09 03 ...   1471      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002220= 09 09 09 09 09 03 ...   1472      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002235= 09 09 09 09 09 03 ...   1473      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000224A= 09 09 09 09 09 03 ...   1474      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000225F= 09 09 09 09 09 03 ...   1475      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002274= 09 09 09 09 09 03 ...   1476      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
00002289= 09 09 09 09 09 09 ...   1477      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000229E= 09 09 09 09 09 09 ...   1478      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000022B3= 09 09 09 09 09 09 ...   1479      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000022C8= 09 09 09 09 09 09 ...   1480      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
000022DD                          1481      
000022DD                          1482  HELL_0  ;MAP 5
000022DD= 02 02 02 02 02 02 ...   1483      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
000022F2= 02 06 06 06 06 06 ...   1484      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002307= 02 06 06 04 06 06 ...   1485      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
0000231C= 02 06 06 04 06 06 ...   1486      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00002331= 02 06 04 04 04 06 ...   1487      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
00002346= 02 06 06 04 06 06 ...   1488      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
0000235B= 02 06 06 06 06 06 ...   1489      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002370= 02 02 02 02 02 02 ...   1490      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
00002385= 02 06 06 06 06 06 ...   1491      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000239A= 02 06 06 06 06 06 ...   1492      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023AF= 02 06 06 06 06 06 ...   1493      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023C4= 02 06 06 06 06 06 ...   1494      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023D9= 02 06 06 06 06 06 ...   1495      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023EE= 02 06 06 06 06 06 ...   1496      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002403= 02 02 02 02 02 02 ...   1497      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002418                          1498          
00002418                          1499  HELL_1      ;MAP 6
00002418= 02 02 02 02 02 02 ...   1500      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
0000242D= 02 06 06 06 06 06 ...   1501      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002442= 02 06 06 06 06 06 ...   1502      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002457= 02 06 06 06 06 06 ...   1503      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000246C= 02 06 06 06 06 06 ...   1504      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002481= 02 06 06 06 06 06 ...   1505      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00002496= 02 06 06 06 06 06 ...   1506      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
000024AB= 02 06 06 06 06 06 ...   1507      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
000024C0= 02 06 06 06 06 06 ...   1508      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000024D5= 02 06 06 06 06 06 ...   1509      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024EA= 02 02 08 02 02 02 ...   1510      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
000024FF= 02 06 06 06 02 02 ...   1511      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002514= 02 06 06 06 02 02 ...   1512      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002529= 02 06 06 06 02 02 ...   1513      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
0000253E= 02 02 02 02 02 02 ...   1514      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002553                          1515          
00002553                          1516  HELL_END    ;MAP 7
00002553= 02 02 02 02 02 02 ...   1517      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00002568= 02 06 06 06 06 06 ...   1518      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000257D= 02 06 06 06 06 06 ...   1519      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002592= 02 06 06 06 06 06 ...   1520      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025A7= 02 06 06 06 06 06 ...   1521      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025BC= 02 06 06 06 06 06 ...   1522      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025D1= 02 06 06 06 06 06 ...   1523      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025E6= 02 06 06 06 06 06 ...   1524      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025FB= 02 06 06 06 06 06 ...   1525      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002610= 02 06 06 06 06 06 ...   1526      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002625= 02 06 06 06 06 06 ...   1527      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000263A= 02 06 06 06 06 06 ...   1528      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000264F= 02 06 06 06 06 06 ...   1529      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002664= 02 06 06 06 06 06 ...   1530      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002679= 02 02 02 02 02 02 ...   1531      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
0000268E                          1532      
0000268E                          1533  HELL_ROOM   ;MAP 8
0000268E= 08 08 08 08 08 08 ...   1534      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026A3= 08 08 08 08 08 08 ...   1535      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026B8= 08 08 08 08 08 08 ...   1536      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026CD= 08 08 08 08 08 08 ...   1537      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026E2= 08 08 08 08 08 02 ...   1538      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
000026F7= 08 08 08 08 08 02 ...   1539      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000270C= 08 08 08 08 08 02 ...   1540      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002721= 08 08 08 08 08 02 ...   1541      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002736= 08 08 08 08 08 02 ...   1542      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000274B= 08 08 08 08 08 02 ...   1543      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002760= 08 08 08 08 08 02 ...   1544      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
00002775= 08 08 08 08 08 08 ...   1545      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000278A= 08 08 08 08 08 08 ...   1546      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000279F= 08 08 08 08 08 08 ...   1547      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000027B4= 08 08 08 08 08 08 ...   1548      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
000027C9                          1549  
000027CA= 0000                    1550      DC.W    0
000027CC                          1551  
000027CC                          1552  
000027CC                          1553  
000027CC                          1554  
000027CC                          1555  
000027CC                          1556  
000027CC                          1557  
000027CC                          1558  -------------------- end include --------------------
000027CC                          1559              INCLUDE "ELEVATOR_MENU.X68"           
000027CC                          1560  
000027CC                          1561  
000027CC                          1562  ELEVATORPLOT
000027CC                          1563      
000027CC  48E7 FFFE               1564      MOVEM.L D0-D7/A0-A6,-(A7)
000027D0                          1565  
000027D0                          1566  
000027D0                          1567  ;SET PEN COLOR  
000027D0  103C 0050               1568      MOVE.B #80, D0
000027D4  223C 00010101           1569      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
000027DA  4E4F                    1570      TRAP #15
000027DC                          1571      
000027DC                          1572  ;END SET PEN COLOR 
000027DC                          1573  
000027DC                          1574      ;DRAW LINES
000027DC                          1575  ;DRAW LINE 1 
000027DC  103C 0054               1576      MOVE.B #84, D0
000027E0  323C 0000               1577      MOVE.W #0, D1
000027E4  343C 0000               1578      MOVE.W #0, D2
000027E8  363C 00A0               1579      MOVE.W #160, D3
000027EC  383C 0078               1580      MOVE.W #120, D4
000027F0  4E4F                    1581      TRAP #15
000027F2                          1582  
000027F2                          1583  ;DRAW LINE 2
000027F2  103C 0054               1584      MOVE.B #84, D0
000027F6  323C 00A0               1585      MOVE.W #160, D1
000027FA  343C 0078               1586      MOVE.W #120, D2
000027FE  363C 00A0               1587      MOVE.W #160, D3
00002802  383C 01E0               1588      MOVE.W #480, D4
00002806  4E4F                    1589      TRAP #15
00002808                          1590      
00002808                          1591  ;DRAW LINE 3
00002808  103C 0054               1592      MOVE.B #84, D0
0000280C  323C 00A0               1593      MOVE.W #160, D1
00002810  343C 0078               1594      MOVE.W #120, D2
00002814  363C 01E0               1595      MOVE.W #480, D3
00002818  383C 0078               1596      MOVE.W #120, D4
0000281C  4E4F                    1597      TRAP #15
0000281E                          1598      
0000281E                          1599  ;DRAW LINE 4
0000281E  103C 0054               1600      MOVE.B #84, D0
00002822  323C 01E0               1601      MOVE.W #480, D1
00002826  343C 0078               1602      MOVE.W #120, D2
0000282A  363C 0280               1603      MOVE.W #640, D3
0000282E  383C 0000               1604      MOVE.W #0, D4
00002832  4E4F                    1605      TRAP #15
00002834                          1606      
00002834                          1607  ;DRAW LINE 5
00002834  103C 0054               1608      MOVE.B #84, D0
00002838  323C 01E0               1609      MOVE.W #480, D1
0000283C  343C 0078               1610      MOVE.W #120, D2
00002840  363C 01E0               1611      MOVE.W #480, D3
00002844  383C 01E0               1612      MOVE.W #480, D4
00002848  4E4F                    1613      TRAP #15
0000284A                          1614  
0000284A                          1615  ;DRAW LINE 6 (TO GIVE SHADE) 
0000284A  103C 0054               1616      MOVE.B #84, D0
0000284E  323C 0119               1617      MOVE.W #281, D1
00002852  343C 015A               1618      MOVE.W #346, D2
00002856  363C 0167               1619      MOVE.W #359, D3
0000285A  383C 015A               1620      MOVE.W #346, D4
0000285E  4E4F                    1621      TRAP #15
00002860                          1622      
00002860                          1623  ;DRAW LINE 7 (TO GIVE SHADE) 
00002860  103C 0054               1624      MOVE.B #84, D0
00002864  323C 011A               1625      MOVE.W #282, D1
00002868  343C 015B               1626      MOVE.W #347, D2
0000286C  363C 0166               1627      MOVE.W #358, D3
00002870  383C 015B               1628      MOVE.W #347, D4
00002874  4E4F                    1629      TRAP #15
00002876                          1630      
00002876                          1631      ;END DRAW LINES
00002876                          1632      
00002876                          1633  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
00002876  103C 0057               1634      MOVE.B #87, D0
0000287A  323C 0118               1635      MOVE.W #280, D1
0000287E  343C 00D2               1636      MOVE.W #210, D2
00002882  363C 0168               1637      MOVE.W #360, D3
00002886  383C 0159               1638      MOVE.W #345, D4
0000288A  4E4F                    1639      TRAP #15
0000288C                          1640      
0000288C                          1641  ;DRAW ELLIPSE FOR THE LIGHT
0000288C  103C 005B               1642      MOVE.B #91, D0
00002890  323C 00FA               1643      MOVE.W #250, D1
00002894  343C 0028               1644      MOVE.W #40, D2
00002898  363C 0186               1645      MOVE.W #390, D3
0000289C  383C 0050               1646      MOVE.W #80, D4
000028A0  4E4F                    1647      TRAP #15
000028A2                          1648      ;FILL SEGMENTS
000028A2                          1649  ;FILL SEGMENT 1 LEFT WALL
000028A2                          1650    ;SET FILL COLOR TO DARKER GREY, FOR W
000028A2  103C 0051               1651      MOVE.B #81, D0
000028A6                          1652      ;MOVE.L #$00969696, D1
000028A6  223C 0020202F           1653      MOVE.L #$0020202F, D1
000028AC  4E4F                    1654      TRAP #15
000028AE                          1655      ;END SET FILL COLOR
000028AE  103C 0059               1656      MOVE.B #89, D0
000028B2  323C 0064               1657      MOVE.W #100, D1
000028B6  343C 0064               1658      MOVE.W #100, D2
000028BA  4E4F                    1659      TRAP #15
000028BC                          1660      
000028BC                          1661  ;FILL SEGMENT 2 CEILING
000028BC                          1662    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
000028BC  103C 0051               1663      MOVE.B #81, D0
000028C0                          1664      ;MOVE.L #$00C0C0C0, D1
000028C0  223C 00141424           1665      MOVE.L #$00141424,D1
000028C6  4E4F                    1666      TRAP #15
000028C8                          1667      ;END SET FILL COLOR
000028C8  103C 0059               1668      MOVE.B #89, D0
000028CC  323C 0064               1669      MOVE.W #100, D1
000028D0  343C 0032               1670      MOVE.W #50, D2
000028D4  4E4F                    1671      TRAP #15
000028D6                          1672      
000028D6                          1673  ;FILL SEGMENT 3 RIGHT WALL
000028D6                          1674    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
000028D6  103C 0051               1675      MOVE.B #81, D0
000028DA                          1676      ;MOVE.L #$00969696, D1
000028DA  223C 0020202F           1677      MOVE.L #$0020202F,D1
000028E0  4E4F                    1678      TRAP #15
000028E2                          1679      ;END SET FILL COLOR
000028E2  103C 0059               1680      MOVE.B #89, D0
000028E6  323C 0276               1681      MOVE.W #630, D1
000028EA  343C 01D6               1682      MOVE.W #470, D2
000028EE  4E4F                    1683      TRAP #15
000028F0                          1684      
000028F0                          1685  ;FILL SEGMENT 4 BACKGROUND WALL
000028F0                          1686    ;SET FILL COLOR TO 
000028F0  103C 0051               1687      MOVE.B #81, D0
000028F4                          1688      ;MOVE.L #$00ABABAB, D1
000028F4  223C 001A1A2A           1689      MOVE.L #$001A1A2A, D1
000028FA  4E4F                    1690      TRAP #15
000028FC                          1691      ;END SET FILL COLOR
000028FC  103C 0059               1692      MOVE.B #89, D0
00002900  323C 00F0               1693      MOVE.W #240, D1
00002904  343C 0140               1694      MOVE.W #320, D2
00002908  4E4F                    1695      TRAP #15
0000290A                          1696      
0000290A                          1697  ;FILL SEGMENT 5 PANEL 
0000290A                          1698    ;SET FILL COLOR TO 
0000290A  103C 0051               1699      MOVE.B #81, D0
0000290E                          1700      ;MOVE.L #$00AFAFAF, D1
0000290E  223C 001F1F2F           1701      MOVE.L #$001F1F2F, D1
00002914  4E4F                    1702      TRAP #15
00002916                          1703      ;END SET FILL COLOR
00002916  103C 0059               1704      MOVE.B #89, D0
0000291A  323C 011D               1705      MOVE.W #285, D1
0000291E  343C 00D7               1706      MOVE.W #215, D2
00002922  4E4F                    1707      TRAP #15
00002924                          1708      
00002924                          1709  ;FILL ELLIPSE LIGHT 
00002924                          1710    ;SET FILL COLOR TO 
00002924  103C 0051               1711      MOVE.B #81, D0
00002928                          1712      ;MOVE.L #$00A1E9E9, D1
00002928  223C 000000FF           1713      MOVE.L #$000000FF, D1
0000292E  4E4F                    1714      TRAP #15
00002930                          1715      ;END SET FILL COLOR
00002930  103C 0059               1716      MOVE.B #89, D0
00002934  323C 0140               1717      MOVE.W #320, D1
00002938  343C 003C               1718      MOVE.W #60, D2
0000293C  4E4F                    1719      TRAP #15
0000293E                          1720  
0000293E                          1721  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
0000293E                          1722      ;SET FILL COLOR 
0000293E  103C 0051               1723      MOVE.B #81, D0
00002942  223C 000000CC           1724      MOVE.L #COLBUTHL, D1
00002948  4E4F                    1725      TRAP #15
0000294A                          1726      ;END SET FILL COLOR
0000294A  3F3C 0135               1727      MOVE.W #309, -(A7) ;COORDENADA Y 
0000294E  3F3C 0136               1728      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00002952  3F3C 0016               1729      MOVE.W #22, -(A7)
00002956  4EB9 0000298C           1730      JSR TRIANGLE
0000295C  3C1F                    1731      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
0000295E  3C1F                    1732      MOVE.W (A7)+, D6
00002960  3C1F                    1733      MOVE.W (A7)+, D6
00002962                          1734  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
00002962                          1735     ;SET FILL COLOR
00002962  103C 0051               1736     MOVE.B #81, D0
00002966  223C 00EEEEEE           1737     MOVE.L #COLBUTHV, D1
0000296C  4E4F                    1738     TRAP #15
0000296E                          1739     
0000296E                          1740      ;END SET FILL COLOR
0000296E  3F3C 00F9               1741     MOVE.W #249, -(A7) ;COORDENADA Y 
00002972  3F3C 0136               1742     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00002976  3F3C FFEA               1743     MOVE.W #-22, -(A7)
0000297A  4EB9 0000298C           1744     JSR TRIANGLE
00002980  3C1F                    1745     MOVE.W (A7)+, D6
00002982  3C1F                    1746     MOVE.W (A7)+, D6
00002984  3C1F                    1747     MOVE.W (A7)+, D6
00002986  4CDF 7FFF               1748     MOVEM.L (A7)+, D0-D7/A0-A6
0000298A                          1749  
0000298A  4E75                    1750     RTS
0000298C                          1751  ; ------------------------------------------------------------------------------
0000298C                          1752  TRIANGLE
0000298C                          1753  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
0000298C                          1754  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
0000298C                          1755  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
0000298C                          1756  ;            SIDES LENGTH (WORD) IN THAT ORDER
0000298C                          1757  ; OUTPUT   : NONE
0000298C                          1758  ; MODIFIES : NONE
0000298C                          1759  ; ------------------------------------------------------------------------------
0000298C  48A7 F800               1760      MOVEM.W D0-D4, -(A7)
00002990                          1761      ; LINE FROM LEFT TO RIGHT
00002990  103C 0054               1762      MOVE.B  #84,D0      ; TASK NUMBER
00002994  322F 0010               1763      MOVE.W  16(A7),D1   ; X POSITION FROM
00002998  342F 0012               1764      MOVE.W  18(A7),D2   ; Y POSITION FROM
0000299C  3802                    1765      MOVE.W  D2,D4       ; Y POSITION TO
0000299E  362F 000E               1766      MOVE.W  14(A7),D3   ; LENGTH
000029A2                          1767      
000029A2  6A00 0004               1768      BPL.W   .UPWARDS
000029A6  4443                    1769      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
000029A8                          1770  .UPWARDS
000029A8  D641                    1771      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
000029AA  4E4F                    1772      TRAP    #15         ; HORIZONTAL LINE DRAWN
000029AC                          1773      ; LINE FROM RIGHT TO UP/DOWN
000029AC  9641                    1774      SUB.W   D1,D3       ; I GET LENGTH IN D3
000029AE  3001                    1775      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
000029B0  D243                    1776      ADD.W   D3,D1       ; X POSITION FROM
000029B2  E24B                    1777      LSR.W   #1,D3       ; LENGTH/2
000029B4  D640                    1778      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
000029B6                          1779      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
000029B6  D86F 000E               1780      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
000029BA  103C 0054               1781      MOVE.B  #84,D0
000029BE  4E4F                    1782      TRAP    #15
000029C0                          1783      ; LINE FROM LEFT TO UP/DOWN
000029C0  322F 0010               1784      MOVE.W  16(A7),D1   ; X POSITION FROM
000029C4  4E4F                    1785      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
000029C6                          1786      
000029C6                          1787      ; FILLING TRIANGLE
000029C6  103C 0059               1788      MOVE.B  #89,D0
000029CA  5241                    1789      ADDQ.W  #1,D1
000029CC  363C 0001               1790      MOVE.W  #1,D3
000029D0  4A6F 000E               1791      TST.W   14(A7)
000029D4  6A00 0004               1792      BPL.W   .ISPOSITIVE
000029D8  4443                    1793      NEG.W   D3
000029DA                          1794  .ISPOSITIVE
000029DA  D443                    1795      ADD.W   D3,D2
000029DC  4E4F                    1796      TRAP    #15
000029DE                          1797      
000029DE  4C9F 001F               1798      MOVEM.W (A7)+,D0-D4
000029E2  4E75                    1799      RTS
000029E4                          1800      
000029E4                          1801  ; ------------------------------------------------------------------------------
000029E4                          1802  ELEVATORUPDATE ; 1 = up 3 = down
000029E4                          1803  ; INPUT    : 
000029E4                          1804  ; OUTPUT   : 
000029E4                          1805  ; MODIFIES : 
000029E4                          1806  ; ------------------------------------------------------------------------------
000029E4  0839 0005 00003A68      1807      BTST #5, KBDVAL
000029EC  6600 002A               1808      BNE .HLSEL
000029F0  0839 0007 00003A68      1809      BTST #7, KBDVAL
000029F8  6600 0004               1810      BNE .HVSEL
000029FC  4E75                    1811      RTS
000029FE                          1812  .HVSEL  ;LOAD 1ST HEAVEN MAP
000029FE  33FC 0002 00003AA2      1813      MOVE.W  #2,(STANEXT)
00002A06  13FC 0000 00003A82      1814      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
00002A0E  33FC 0001 00003A7E      1815      MOVE.W #1, LOADEDMAP    
00002A16  4E75                    1816      RTS
00002A18                          1817  .HLSEL  ;LOAD 1ST HELL MAP
00002A18  33FC 0002 00003AA2      1818      MOVE.W  #2,(STANEXT)
00002A20  13FC 0000 00003A82      1819      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
00002A28  33FC 0005 00003A7E      1820      MOVE.W #5, LOADEDMAP
00002A30  4E75                    1821      RTS
00002A32                          1822      
00002A32                          1823          
00002A32                          1824  
00002A32                          1825  
00002A32                          1826  
00002A32                          1827  
00002A32                          1828  
00002A32                          1829  
00002A32                          1830  
00002A32                          1831  -------------------- end include --------------------
00002A32                          1832              INCLUDE "PLAYER.X68"    
00002A32                          1833  ; ==============================================================================
00002A32                          1834  ; PLAYER MANAGEMENT
00002A32                          1835  ; ==============================================================================
00002A32                          1836              
00002A32                          1837  ; ------------------------------------------------------------------------------
00002A32                          1838  PLAYERINIT
00002A32                          1839  ; INITIALIZE PLAYER.
00002A32                          1840  ; INPUT    : NONE 
00002A32                          1841  ; OUTPUT   : NONE
00002A32                          1842  ; MODIFIES : NONE
00002A32                          1843  ; ------------------------------------------------------------------------------
00002A32  4E75                    1844              RTS
00002A34                          1845              
00002A34                          1846  ; ------------------------------------------------------------------------------
00002A34                          1847  PLAYERUPD
00002A34                          1848  ; UPDATES THE PLAYER.
00002A34                          1849  ; INPUT    : NONE 
00002A34                          1850  ; OUTPUT   : NONE
00002A34                          1851  ; MODIFIES : NONE
00002A34                          1852  ; ------------------------------------------------------------------------------
00002A34                          1853              ;;CHECK LIMITS IN MAPS
00002A34  3F00                    1854                  MOVE.W D0, -(A7)
00002A36  3039 00003A7E           1855              MOVE.W LOADEDMAP, D0
00002A3C  B07C 0000               1856              CMP #0, D0
00002A40  6700 0046               1857              BEQ NOLIMITMENU
00002A44  B07C 0001               1858              CMP #1, D0
00002A48  6700 0056               1859              BEQ LIMAPA1
00002A4C  B07C 0002               1860              CMP #2, D0
00002A50  6700 014C               1861              BEQ LIMAPA2
00002A54  B07C 0003               1862              CMP #3, D0
00002A58  6700 0354               1863              BEQ LIMAPA3
00002A5C  B07C 0004               1864              CMP #4, D0
00002A60  6700 0444               1865              BEQ LIMAPA4
00002A64  B07C 0005               1866              CMP #5, D0
00002A68  6700 0534               1867              BEQ LIMAPA5
00002A6C  B07C 0006               1868              CMP #6, D0
00002A70  6700 06D4               1869              BEQ LIMAPA6
00002A74  B07C 0007               1870              CMP #7, D0
00002A78  6700 0880               1871              BEQ LIMAPA7
00002A7C  B07C 0008               1872              CMP #8, D0
00002A80  6700 0970               1873              BEQ LIMAPA8
00002A84  301F                    1874              MOVE.W (A7)+, D0
00002A86                          1875  
00002A86  4E75                    1876              RTS
00002A88                          1877  NOLIMITMENU
00002A88  33FC 0080 00003A70      1878      MOVE.W #128, PLAYERPOSX
00002A90  33FC 0080 00003A72      1879      MOVE.W #128, PLAYERPOSY
00002A98  301F                    1880      MOVE.W (A7)+, D0
00002A9A  4EF9 000034EA           1881      JMP NOLIMIT
00002AA0                          1882  LIMAPA1
00002AA0  301F                    1883      MOVE.W (A7)+, D0
00002AA2  48A7 F800               1884      MOVEM.W D0-D4, -(A7)
00002AA6  3039 00003A70           1885      MOVE.W PLAYERPOSX, D0
00002AAC  3239 00003A72           1886      MOVE.W PLAYERPOSY, D1
00002AB2                          1887      ;CHECK FOR WALLS IN MAP 1
00002AB2                          1888      ;CHECK UPPER WALL 
00002AB2  B07C 0280               1889      CMP #640, D0  ; BGT = 352 > D0
00002AB6  6E00 0026               1890      BGT MAP1NOLIMIT1   
00002ABA  B07C 0000               1891      CMP #0, D0
00002ABE  6D00 001E               1892      BLT MAP1NOLIMIT1
00002AC2                          1893      ;NOW WE CHECK POS Y 
00002AC2  B27C 0060               1894      CMP #96, D1  ; 
00002AC6  6E00 0016               1895      BGT MAP1NOLIMIT1    
00002ACA  B27C 0000               1896      CMP #0, D1
00002ACE  6D00 000E               1897      BLT MAP1NOLIMIT1
00002AD2                          1898      ;;;; AQUI PISA EL LIMITE
00002AD2  4C9F 001F               1899      MOVEM.W (A7)+, D0-D4
00002AD6  5279 00003A72           1900      ADD.W #1, PLAYERPOSY
00002ADC  4E75                    1901      RTS
00002ADE                          1902  MAP1NOLIMIT1
00002ADE                          1903      ;CHECK FOR RIGHT WALL   
00002ADE  B07C 0220               1904      CMP #544, D0  ; BGT = 352 > D0
00002AE2  6E00 0026               1905      BGT MAP1NOLIMIT2    
00002AE6  B07C 0200               1906      CMP #512, D0
00002AEA  6D00 001E               1907      BLT MAP1NOLIMIT2
00002AEE                          1908      ;NOW WE CHECK POS Y 
00002AEE  B27C 0280               1909      CMP #640, D1  ; 
00002AF2  6E00 0016               1910      BGT MAP1NOLIMIT2    
00002AF6  B27C 0000               1911      CMP #0, D1
00002AFA  6D00 000E               1912      BLT MAP1NOLIMIT2
00002AFE                          1913      ;;;; AQUI PISA EL LIMITE
00002AFE  4C9F 001F               1914      MOVEM.W (A7)+, D0-D4
00002B02  5379 00003A70           1915      SUB.W #1, PLAYERPOSX
00002B08  4E75                    1916      RTS
00002B0A                          1917  MAP1NOLIMIT2 
00002B0A                          1918      ;CHECK FOR BOTTOM-RIGHT WALL
00002B0A  B07C 0280               1919      CMP #640, D0  ; BGT = 352 > D0
00002B0E  6E00 002C               1920      BGT MAP1NOLIMIT3    
00002B12  B07C 0140               1921      CMP #320, D0
00002B16  6D00 0024               1922      BLT MAP1NOLIMIT3
00002B1A                          1923      ;NOW WE CHECK POS Y 
00002B1A  B27C 01E0               1924      CMP #480, D1  ; 
00002B1E  6E00 001C               1925      BGT MAP1NOLIMIT3    
00002B22  B27C 0180               1926      CMP #384, D1
00002B26  6D00 0014               1927      BLT MAP1NOLIMIT3
00002B2A                          1928      ;;;; AQUI PISA EL LIMITE
00002B2A  4C9F 001F               1929      MOVEM.W (A7)+, D0-D4
00002B2E  5279 00003A70           1930      ADD.W #1, PLAYERPOSX
00002B34  5379 00003A72           1931      SUB.W #1, PLAYERPOSY
00002B3A  4E75                    1932      RTS
00002B3C                          1933  MAP1NOLIMIT3
00002B3C                          1934      ;CHECK FOR BOTTOM-LEFT WALL 
00002B3C  B07C 0120               1935      CMP #288, D0  ; BGT = 352 > D0
00002B40  6E00 0026               1936      BGT MAP1NOLIMIT4    
00002B44  B07C 0000               1937      CMP #0, D0
00002B48  6D00 001E               1938      BLT MAP1NOLIMIT4
00002B4C                          1939      ;NOW WE CHECK POS Y 
00002B4C  B27C 01E0               1940      CMP #480, D1  ; 
00002B50  6E00 0016               1941      BGT MAP1NOLIMIT4    
00002B54  B27C 0180               1942      CMP #384, D1
00002B58  6D00 000E               1943      BLT MAP1NOLIMIT4
00002B5C                          1944      ;;;; AQUI PISA EL LIMITE
00002B5C  4C9F 001F               1945      MOVEM.W (A7)+, D0-D4
00002B60  5379 00003A72           1946      SUB.W #1, PLAYERPOSY
00002B66  4E75                    1947      RTS
00002B68                          1948  MAP1NOLIMIT4 
00002B68                          1949      ;CHECK FOR BOTTOM-LEFT WALL 
00002B68  B07C 0060               1950      CMP #96, D0  ; BGT = 352 > D0
00002B6C  6E00 0026               1951      BGT MAP1NOLIMITEND    
00002B70  B07C 0000               1952      CMP #0, D0
00002B74  6D00 001E               1953      BLT MAP1NOLIMITEND
00002B78                          1954      ;NOW WE CHECK POS Y 
00002B78  B27C 0280               1955      CMP #640, D1  ; 
00002B7C  6E00 0016               1956      BGT MAP1NOLIMITEND    
00002B80  B27C 0000               1957      CMP #0, D1
00002B84  6D00 000E               1958      BLT MAP1NOLIMITEND
00002B88                          1959      ;;;; AQUI PISA EL LIMITE
00002B88  4C9F 001F               1960      MOVEM.W (A7)+, D0-D4
00002B8C  5279 00003A70           1961      ADD.W #1, PLAYERPOSX
00002B92  4E75                    1962      RTS
00002B94                          1963  MAP1NOLIMITEND
00002B94  4C9F 001F               1964      MOVEM.W (A7)+, D0-D4
00002B98  4EF9 000034EA           1965      JMP NOLIMIT
00002B9E                          1966      
00002B9E                          1967  LIMAPA2
00002B9E  301F                    1968      MOVE.W (A7)+, D0
00002BA0  48A7 F800               1969      MOVEM.W D0-D4, -(A7)
00002BA4  3039 00003A70           1970      MOVE.W PLAYERPOSX, D0
00002BAA  3239 00003A72           1971      MOVE.W PLAYERPOSY, D1
00002BB0                          1972      ;CHECK FOR TOP-LEFT WALL 
00002BB0  B07C 0120               1973      CMP #288, D0  ; BGT = 352 > D0
00002BB4  6E00 002C               1974      BGT MAP2NOLIMIT1    
00002BB8  B07C 0000               1975      CMP #0, D0
00002BBC  6D00 0024               1976      BLT MAP2NOLIMIT1
00002BC0                          1977      ;NOW WE CHECK POS Y 
00002BC0  B27C 0060               1978      CMP #96, D1  ; 
00002BC4  6E00 001C               1979      BGT MAP2NOLIMIT1    
00002BC8  B27C 0000               1980      CMP #0, D1
00002BCC  6D00 0014               1981      BLT MAP2NOLIMIT1
00002BD0                          1982      ;;;; AQUI PISA EL LIMITE
00002BD0  4C9F 001F               1983      MOVEM.W (A7)+, D0-D4
00002BD4  5279 00003A72           1984      ADD.W #1, PLAYERPOSY
00002BDA  5279 00003A70           1985      ADD.W #1, PLAYERPOSX
00002BE0  4E75                    1986      RTS
00002BE2                          1987  MAP2NOLIMIT1
00002BE2                          1988      ;CHECK FOR LEFT-UPPER-DOOR WALL
00002BE2  B07C 00C0               1989      CMP #192, D0  ; BGT = 352 > D0
00002BE6  6E00 002C               1990      BGT MAP2NOLIMIT2    
00002BEA  B07C 0000               1991      CMP #0, D0
00002BEE  6D00 0024               1992      BLT MAP2NOLIMIT2
00002BF2                          1993      ;NOW WE CHECK POS Y 
00002BF2  B27C 009F               1994      CMP #159, D1  ; 
00002BF6  6E00 001C               1995      BGT MAP2NOLIMIT2    
00002BFA  B27C 0000               1996      CMP #0, D1
00002BFE  6D00 0014               1997      BLT MAP2NOLIMIT2
00002C02                          1998      ;;;; AQUI PISA EL LIMITE
00002C02  4C9F 001F               1999      MOVEM.W (A7)+, D0-D4
00002C06  5279 00003A70           2000      ADD.W #1, PLAYERPOSX
00002C0C  5279 00003A72           2001      ADD.W #1, PLAYERPOSY
00002C12  4E75                    2002      RTS
00002C14                          2003  MAP2NOLIMIT2
00002C14                          2004      ;CHECK FOR LEFT-BOTTOM-DOOR WALL
00002C14  B07C 00C0               2005      CMP #192, D0  ; BGT = 352 > D0
00002C18  6E00 002C               2006      BGT MAP2NOLIMIT3    
00002C1C  B07C 0000               2007      CMP #0, D0
00002C20  6D00 0024               2008      BLT MAP2NOLIMIT3
00002C24                          2009      ;NOW WE CHECK POS Y 
00002C24  B27C 01E0               2010      CMP #480, D1  ; 
00002C28  6E00 001C               2011      BGT MAP2NOLIMIT3    
00002C2C  B27C 00A2               2012      CMP #162, D1
00002C30  6D00 0014               2013      BLT MAP2NOLIMIT3
00002C34                          2014      ;;;; AQUI PISA EL LIMITE
00002C34  4C9F 001F               2015      MOVEM.W (A7)+, D0-D4
00002C38  5279 00003A70           2016      ADD.W #1, PLAYERPOSX
00002C3E  5379 00003A72           2017      SUB.W #1, PLAYERPOSY
00002C44  4E75                    2018      RTS
00002C46                          2019  MAP2NOLIMIT3
00002C46                          2020      ;CHECK FOR LEFT CORNER
00002C46  B07C 00E0               2021      CMP #224, D0  ; BGT = 352 > D0
00002C4A  6E00 002C               2022      BGT MAP2NOLIMIT4    
00002C4E  B07C 0000               2023      CMP #0, D0
00002C52  6D00 0024               2024      BLT MAP2NOLIMIT4
00002C56                          2025      ;NOW WE CHECK POS Y 
00002C56  B27C 01E0               2026      CMP #480, D1  ; 
00002C5A  6E00 001C               2027      BGT MAP2NOLIMIT4    
00002C5E  B27C 0100               2028      CMP #256, D1
00002C62  6D00 0014               2029      BLT MAP2NOLIMIT4
00002C66                          2030      ;;;; AQUI PISA EL LIMITE
00002C66  4C9F 001F               2031      MOVEM.W (A7)+, D0-D4
00002C6A  5279 00003A70           2032      ADD.W #1, PLAYERPOSX
00002C70  5379 00003A72           2033      SUB.W #1, PLAYERPOSY
00002C76  4E75                    2034      RTS
00002C78                          2035  MAP2NOLIMIT4
00002C78                          2036      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002C78  B07C 0120               2037      CMP #288, D0  ; BGT = 352 > D0
00002C7C  6E00 002C               2038      BGT MAP2NOLIMIT5    
00002C80  B07C 00E0               2039      CMP #224, D0
00002C84  6D00 0024               2040      BLT MAP2NOLIMIT5
00002C88                          2041      ;NOW WE CHECK POS Y 
00002C88  B27C 01E0               2042      CMP #480, D1  ; 
00002C8C  6E00 001C               2043      BGT MAP2NOLIMIT5    
00002C90  B27C 0120               2044      CMP #288, D1
00002C94  6D00 0014               2045      BLT MAP2NOLIMIT5
00002C98                          2046      ;;;; AQUI PISA EL LIMITE
00002C98  4C9F 001F               2047      MOVEM.W (A7)+, D0-D4
00002C9C  5279 00003A70           2048      ADD.W #1, PLAYERPOSX
00002CA2  5379 00003A72           2049      SUB.W #1, PLAYERPOSY
00002CA8  4E75                    2050      RTS
00002CAA                          2051  MAP2NOLIMIT5
00002CAA                          2052      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002CAA  B07C 0280               2053      CMP #640, D0  ; BGT = 352 > D0
00002CAE  6E00 002C               2054      BGT MAP2NOLIMIT6    
00002CB2  B07C 0140               2055      CMP #320, D0
00002CB6  6D00 0024               2056      BLT MAP2NOLIMIT6
00002CBA                          2057      ;NOW WE CHECK POS Y 
00002CBA  B27C 01E0               2058      CMP #480, D1  ; 
00002CBE  6E00 001C               2059      BGT MAP2NOLIMIT6    
00002CC2  B27C 0120               2060      CMP #288, D1
00002CC6  6D00 0014               2061      BLT MAP2NOLIMIT6
00002CCA                          2062      ;;;; AQUI PISA EL LIMITE
00002CCA  4C9F 001F               2063      MOVEM.W (A7)+, D0-D4
00002CCE  5379 00003A70           2064      SUB.W #1, PLAYERPOSX
00002CD4  5379 00003A72           2065      SUB.W #1, PLAYERPOSY
00002CDA  4E75                    2066      RTS
00002CDC                          2067  MAP2NOLIMIT6
00002CDC                          2068  ;CHECK FOR RIGHT CORNER
00002CDC  B07C 0280               2069      CMP #640, D0  ; BGT = 352 > D0
00002CE0  6E00 002C               2070      BGT MAP2NOLIMIT7    
00002CE4  B07C 0180               2071      CMP #384, D0
00002CE8  6D00 0024               2072      BLT MAP2NOLIMIT7
00002CEC                          2073      ;NOW WE CHECK POS Y 
00002CEC  B27C 01E0               2074      CMP #480, D1  ; 
00002CF0  6E00 001C               2075      BGT MAP2NOLIMIT7    
00002CF4  B27C 0100               2076      CMP #256, D1
00002CF8  6D00 0014               2077      BLT MAP2NOLIMIT7
00002CFC                          2078      ;;;; AQUI PISA EL LIMITE
00002CFC  4C9F 001F               2079      MOVEM.W (A7)+, D0-D4
00002D00  5379 00003A70           2080      SUB.W #1, PLAYERPOSX
00002D06  5379 00003A72           2081      SUB.W #1, PLAYERPOSY
00002D0C  4E75                    2082      RTS
00002D0E                          2083  MAP2NOLIMIT7
00002D0E                          2084      ;CHECK FOR RIGHT-BOTTOM-DOOR WALL
00002D0E  B07C 0280               2085      CMP #640, D0  ; BGT = 352 > D0
00002D12  6E00 002C               2086      BGT MAP2NOLIMIT8    
00002D16  B07C 01A0               2087      CMP #416, D0
00002D1A  6D00 0024               2088      BLT MAP2NOLIMIT8
00002D1E                          2089      ;NOW WE CHECK POS Y 
00002D1E  B27C 01E0               2090      CMP #480, D1  ; 
00002D22  6E00 001C               2091      BGT MAP2NOLIMIT8    
00002D26  B27C 00A2               2092      CMP #162, D1
00002D2A  6D00 0014               2093      BLT MAP2NOLIMIT8
00002D2E                          2094      ;;;; AQUI PISA EL LIMITE
00002D2E  4C9F 001F               2095      MOVEM.W (A7)+, D0-D4
00002D32  5379 00003A70           2096      SUB.W #1, PLAYERPOSX
00002D38  5379 00003A72           2097      SUB.W #1, PLAYERPOSY
00002D3E  4E75                    2098      RTS
00002D40                          2099  MAP2NOLIMIT8
00002D40                          2100  ;CHECK FOR RIGHT-TOP-DOOR WALL
00002D40  B07C 0280               2101      CMP #640, D0  ; BGT = 352 > D0
00002D44  6E00 002C               2102      BGT MAP2NOLIMIT9    
00002D48  B07C 01A0               2103      CMP #416, D0
00002D4C  6D00 0024               2104      BLT MAP2NOLIMIT9
00002D50                          2105      ;NOW WE CHECK POS Y 
00002D50  B27C 00A0               2106      CMP #160, D1  ; 
00002D54  6E00 001C               2107      BGT MAP2NOLIMIT9    
00002D58  B27C 0000               2108      CMP #0, D1
00002D5C  6D00 0014               2109      BLT MAP2NOLIMIT9
00002D60                          2110      ;;;; AQUI PISA EL LIMITE
00002D60  4C9F 001F               2111      MOVEM.W (A7)+, D0-D4
00002D64  5379 00003A70           2112      SUB.W #1, PLAYERPOSX
00002D6A  5279 00003A72           2113      ADD.W #1, PLAYERPOSY
00002D70  4E75                    2114      RTS
00002D72                          2115  MAP2NOLIMIT9
00002D72                          2116      ;CHECK FOR TOP RIGHT CORNER
00002D72  B07C 0280               2117      CMP #640, D0  ; BGT = 352 > D0
00002D76  6E00 002C               2118      BGT MAP2NOLIMIT10    
00002D7A  B07C 0140               2119      CMP #320, D0
00002D7E  6D00 0024               2120      BLT MAP2NOLIMIT10
00002D82                          2121      ;NOW WE CHECK POS Y 
00002D82  B27C 0060               2122      CMP #96, D1  ; 
00002D86  6E00 001C               2123      BGT MAP2NOLIMIT10   
00002D8A  B27C 0000               2124      CMP #0, D1
00002D8E  6D00 0014               2125      BLT MAP2NOLIMIT10
00002D92                          2126      ;;;; AQUI PISA EL LIMITE
00002D92  4C9F 001F               2127      MOVEM.W (A7)+, D0-D4
00002D96  5379 00003A70           2128      SUB.W #1, PLAYERPOSX
00002D9C  5279 00003A72           2129      ADD.W #1, PLAYERPOSY
00002DA2  4E75                    2130      RTS
00002DA4                          2131  MAP2NOLIMIT10
00002DA4  4C9F 001F               2132      MOVEM.W (A7)+, D0-D4
00002DA8  4EF9 000034EA           2133      JMP NOLIMIT
00002DAE                          2134  LIMAPA3
00002DAE  301F                    2135      MOVE.W (A7)+, D0
00002DB0  48A7 F800               2136      MOVEM.W D0-D4, -(A7)
00002DB4  3039 00003A70           2137      MOVE.W PLAYERPOSX, D0
00002DBA  3239 00003A72           2138      MOVE.W PLAYERPOSY, D1
00002DC0                          2139      ;CHECK FOR TOP-LEFT WALL 
00002DC0  B07C 0120               2140      CMP #288, D0  ; BGT = 352 > D0
00002DC4  6E00 0026               2141      BGT MAP3NOLIMIT1    
00002DC8  B07C 0000               2142      CMP #0, D0
00002DCC  6D00 001E               2143      BLT MAP3NOLIMIT1
00002DD0                          2144      ;NOW WE CHECK POS Y 
00002DD0  B27C 0020               2145      CMP #32, D1  ; 
00002DD4  6E00 0016               2146      BGT MAP3NOLIMIT1    
00002DD8  B27C 0000               2147      CMP #0, D1
00002DDC  6D00 000E               2148      BLT MAP3NOLIMIT1
00002DE0                          2149      ;;;; AQUI PISA EL LIMITE
00002DE0  5279 00003A72           2150      ADD.W #1, PLAYERPOSY
00002DE6  4C9F 001F               2151      MOVEM.W (A7)+, D0-D4
00002DEA  4E75                    2152      RTS
00002DEC                          2153  MAP3NOLIMIT1
00002DEC                          2154      ;CHECK FOR LEFT WALL
00002DEC  B07C 0020               2155      CMP #32, D0  ; BGT = 352 > D0
00002DF0  6E00 0026               2156      BGT MAP3NOLIMIT2    
00002DF4  B07C 0000               2157      CMP #0, D0
00002DF8  6D00 001E               2158      BLT MAP3NOLIMIT2
00002DFC                          2159      ;NOW WE CHECK POS Y 
00002DFC  B27C 01E0               2160      CMP #480, D1  ; 
00002E00  6E00 0016               2161      BGT MAP3NOLIMIT2    
00002E04  B27C 0000               2162      CMP #0, D1
00002E08  6D00 000E               2163      BLT MAP3NOLIMIT2
00002E0C                          2164      ;;;; AQUI PISA EL LIMITE
00002E0C  5279 00003A70           2165      ADD.W #1, PLAYERPOSX
00002E12  4C9F 001F               2166      MOVEM.W (A7)+, D0-D4
00002E16  4E75                    2167      RTS
00002E18                          2168  MAP3NOLIMIT2
00002E18                          2169      ;CHECK FOR BOTTOM WALL
00002E18  B07C 0280               2170      CMP #640, D0  ; BGT = 352 > D0
00002E1C  6E00 0026               2171      BGT MAP3NOLIMIT3    
00002E20  B07C 0000               2172      CMP #0, D0
00002E24  6D00 001E               2173      BLT MAP3NOLIMIT3
00002E28                          2174      ;NOW WE CHECK POS Y 
00002E28  B27C 01E0               2175      CMP #480, D1  ; 
00002E2C  6E00 0016               2176      BGT MAP3NOLIMIT3    
00002E30  B27C 01A0               2177      CMP #416, D1
00002E34  6D00 000E               2178      BLT MAP3NOLIMIT3
00002E38                          2179      ;;;; AQUI PISA EL LIMITE
00002E38  5379 00003A72           2180      SUB.W #1, PLAYERPOSY
00002E3E  4C9F 001F               2181      MOVEM.W (A7)+, D0-D4
00002E42  4E75                    2182      RTS
00002E44                          2183  MAP3NOLIMIT3
00002E44                          2184      ;CHECK FOR RIGHT WALL
00002E44  B07C 0280               2185      CMP #640, D0  ; BGT = 352 > D0
00002E48  6E00 0026               2186      BGT MAP3NOLIMIT4    
00002E4C  B07C 0240               2187      CMP #576, D0
00002E50  6D00 001E               2188      BLT MAP3NOLIMIT4
00002E54                          2189      ;NOW WE CHECK POS Y 
00002E54  B27C 01E0               2190      CMP #480, D1  ; 
00002E58  6E00 0016               2191      BGT MAP3NOLIMIT4    
00002E5C  B27C 0000               2192      CMP #0, D1
00002E60  6D00 000E               2193      BLT MAP3NOLIMIT4
00002E64                          2194      ;;;; AQUI PISA EL LIMITE
00002E64  5379 00003A70           2195      SUB.W #1, PLAYERPOSX
00002E6A  4C9F 001F               2196      MOVEM.W (A7)+, D0-D4
00002E6E  4E75                    2197      RTS
00002E70                          2198  MAP3NOLIMIT4
00002E70                          2199      ;CHECK TOP-RIGHT WALL
00002E70  B07C 0280               2200      CMP #640, D0  ; BGT = 352 > D0
00002E74  6E00 0026               2201      BGT MAP3NOLIMIT5    
00002E78  B07C 0160               2202      CMP #352, D0
00002E7C  6D00 001E               2203      BLT MAP3NOLIMIT5
00002E80                          2204      ;NOW WE CHECK POS Y 
00002E80  B27C 0020               2205      CMP #32, D1  ; 
00002E84  6E00 0016               2206      BGT MAP3NOLIMIT5    
00002E88  B27C 0000               2207      CMP #0, D1
00002E8C  6D00 000E               2208      BLT MAP3NOLIMIT5
00002E90                          2209      ;;;; AQUI PISA EL LIMITE
00002E90  5279 00003A72           2210      ADD.W #1, PLAYERPOSY
00002E96  4C9F 001F               2211      MOVEM.W (A7)+, D0-D4
00002E9A  4E75                    2212      RTS
00002E9C                          2213  MAP3NOLIMIT5
00002E9C  4C9F 001F               2214      MOVEM.W (A7)+, D0-D4
00002EA0  4EF9 000034EA           2215      JMP NOLIMIT
00002EA6                          2216      
00002EA6                          2217  LIMAPA4
00002EA6  301F                    2218      MOVE.W (A7)+, D0
00002EA8  48A7 F800               2219      MOVEM.W D0-D4, -(A7)
00002EAC  3039 00003A70           2220      MOVE.W PLAYERPOSX, D0
00002EB2  3239 00003A72           2221      MOVE.W PLAYERPOSY, D1
00002EB8                          2222      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00002EB8                          2223      ;CHECK UPPER LEFT WALL 
00002EB8  B07C 0120               2224      CMP #288, D0  ; BGT = 352 > D0
00002EBC  6E00 0026               2225      BGT MAP4NOLIMIT1   
00002EC0  B07C 0000               2226      CMP #0, D0
00002EC4  6D00 001E               2227      BLT MAP4NOLIMIT1
00002EC8                          2228      ;NOW WE CHECK POS Y 
00002EC8  B27C 00A0               2229      CMP #160, D1  ; 
00002ECC  6E00 0016               2230      BGT MAP4NOLIMIT1    
00002ED0  B27C 0000               2231      CMP #0, D1
00002ED4  6D00 000E               2232      BLT MAP4NOLIMIT1
00002ED8                          2233      ;;;; AQUI PISA EL LIMITE
00002ED8  4C9F 001F               2234      MOVEM.W (A7)+, D0-D4
00002EDC  5279 00003A72           2235      ADD.W #1, PLAYERPOSY
00002EE2  4E75                    2236      RTS
00002EE4                          2237  MAP4NOLIMIT1
00002EE4                          2238      ;CHECK BOTTOM WALL
00002EE4  B07C 0280               2239      CMP #640, D0  ; BGT = 352 > D0
00002EE8  6E00 0026               2240      BGT MAP4NOLIMIT2   
00002EEC  B07C 0000               2241      CMP #0, D0
00002EF0  6D00 001E               2242      BLT MAP4NOLIMIT2
00002EF4                          2243      ;NOW WE CHECK POS Y 
00002EF4  B27C 01E0               2244      CMP #480, D1  ; 
00002EF8  6E00 0016               2245      BGT MAP4NOLIMIT2    
00002EFC  B27C 0120               2246      CMP #288, D1
00002F00  6D00 000E               2247      BLT MAP4NOLIMIT2
00002F04                          2248      ;;;; AQUI PISA EL LIMITE
00002F04  4C9F 001F               2249      MOVEM.W (A7)+, D0-D4
00002F08  5379 00003A72           2250      SUB.W #1, PLAYERPOSY
00002F0E  4E75                    2251      RTS
00002F10                          2252  MAP4NOLIMIT2
00002F10                          2253      ;CHECK LEFT WALL
00002F10  B07C 00C0               2254      CMP #192, D0  ; BGT = 352 > D0
00002F14  6E00 0026               2255      BGT MAP4NOLIMIT3   
00002F18  B07C 0000               2256      CMP #0, D0
00002F1C  6D00 001E               2257      BLT MAP4NOLIMIT3
00002F20                          2258      ;NOW WE CHECK POS Y 
00002F20  B27C 01E0               2259      CMP #480, D1  ; 
00002F24  6E00 0016               2260      BGT MAP4NOLIMIT3    
00002F28  B27C 0000               2261      CMP #0, D1
00002F2C  6D00 000E               2262      BLT MAP4NOLIMIT3
00002F30                          2263      ;;;; AQUI PISA EL LIMITE
00002F30  4C9F 001F               2264      MOVEM.W (A7)+, D0-D4
00002F34  5279 00003A70           2265      ADD.W #1, PLAYERPOSX
00002F3A  4E75                    2266      RTS
00002F3C                          2267  MAP4NOLIMIT3
00002F3C                          2268      ;CHECK RIGHT WALL
00002F3C  B07C 0280               2269      CMP #640, D0  ; BGT = 352 > D0
00002F40  6E00 0026               2270      BGT MAP4NOLIMIT4   
00002F44  B07C 01A0               2271      CMP #416, D0
00002F48  6D00 001E               2272      BLT MAP4NOLIMIT4
00002F4C                          2273      ;NOW WE CHECK POS Y 
00002F4C  B27C 01E0               2274      CMP #480, D1  ; 
00002F50  6E00 0016               2275      BGT MAP4NOLIMIT4    
00002F54  B27C 0000               2276      CMP #0, D1
00002F58  6D00 000E               2277      BLT MAP4NOLIMIT4
00002F5C                          2278      ;;;; AQUI PISA EL LIMITE
00002F5C  4C9F 001F               2279      MOVEM.W (A7)+, D0-D4
00002F60  5379 00003A70           2280      SUB.W #1, PLAYERPOSX
00002F66  4E75                    2281      RTS
00002F68                          2282  MAP4NOLIMIT4
00002F68                          2283  ;CHECK TOP RIGHT WALL
00002F68  B07C 0280               2284      CMP #640, D0  ; BGT = 352 > D0
00002F6C  6E00 0026               2285      BGT MAP4NOLIMIT5   
00002F70  B07C 0160               2286      CMP #352, D0
00002F74  6D00 001E               2287      BLT MAP4NOLIMIT5
00002F78                          2288      ;NOW WE CHECK POS Y 
00002F78  B27C 00A0               2289      CMP #160, D1  ; 
00002F7C  6E00 0016               2290      BGT MAP4NOLIMIT5    
00002F80  B27C 0000               2291      CMP #0, D1
00002F84  6D00 000E               2292      BLT MAP4NOLIMIT5
00002F88                          2293      ;;;; AQUI PISA EL LIMITE
00002F88  4C9F 001F               2294      MOVEM.W (A7)+, D0-D4
00002F8C  5279 00003A72           2295      ADD.W #1, PLAYERPOSY
00002F92  4E75                    2296      RTS
00002F94                          2297  MAP4NOLIMIT5
00002F94  4C9F 001F               2298      MOVEM.W (A7)+, D0-D4
00002F98  4EF9 000034EA           2299      JMP NOLIMIT
00002F9E                          2300  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;END HEAVEN MAPS
00002F9E                          2301  LIMAPA5
00002F9E  301F                    2302      MOVE.W (A7)+, D0
00002FA0  48A7 F800               2303      MOVEM.W D0-D4, -(A7)
00002FA4  3039 00003A70           2304      MOVE.W PLAYERPOSX, D0
00002FAA  3239 00003A72           2305      MOVE.W PLAYERPOSY, D1
00002FB0                          2306      ;CHECK FOR WALLS IN MAP 5
00002FB0                          2307      ;CHECK UPPER WALL 
00002FB0  B07C 0280               2308      CMP #640, D0  ; BGT = 352 > D0
00002FB4  6E00 0026               2309      BGT MAP5NOLIMIT1   
00002FB8  B07C 0000               2310      CMP #0, D0
00002FBC  6D00 001E               2311      BLT MAP5NOLIMIT1
00002FC0                          2312      ;NOW WE CHECK POS Y 
00002FC0  B27C 0020               2313      CMP #32, D1  ; 
00002FC4  6E00 0016               2314      BGT MAP5NOLIMIT1    
00002FC8  B27C 0000               2315      CMP #0, D1
00002FCC  6D00 000E               2316      BLT MAP5NOLIMIT1
00002FD0                          2317      ;;;; AQUI PISA EL LIMITE
00002FD0  4C9F 001F               2318      MOVEM.W (A7)+, D0-D4
00002FD4  5279 00003A72           2319      ADD.W #1, PLAYERPOSY
00002FDA  4E75                    2320      RTS
00002FDC                          2321  MAP5NOLIMIT1
00002FDC                          2322      ;CHECK FOR RIGHT WALL 
00002FDC  B07C 0280               2323      CMP #640, D0  ; BGT = 352 > D0
00002FE0  6E00 0026               2324      BGT MAP5NOLIMIT2    
00002FE4  B07C 0240               2325      CMP #576, D0
00002FE8  6D00 001E               2326      BLT MAP5NOLIMIT2
00002FEC                          2327      ;NOW WE CHECK POS Y 
00002FEC  B27C 01E0               2328      CMP #480, D1  ; 
00002FF0  6E00 0016               2329      BGT MAP5NOLIMIT2    
00002FF4  B27C 0000               2330      CMP #0, D1
00002FF8  6D00 000E               2331      BLT MAP5NOLIMIT2
00002FFC                          2332      ;;;; AQUI PISA EL LIMITE
00002FFC  5379 00003A70           2333      SUB.W #1, PLAYERPOSX
00003002  4C9F 001F               2334      MOVEM.W (A7)+, D0-D4
00003006  4E75                    2335      RTS
00003008                          2336  MAP5NOLIMIT2
00003008                          2337      ;CHECK LEFT WALL
00003008  B07C 0020               2338          CMP #32, D0  ; BGT = 352 > D0
0000300C  6E00 0026               2339      BGT MAP5NOLIMIT3    
00003010  B07C 0000               2340      CMP #0, D0
00003014  6D00 001E               2341      BLT MAP5NOLIMIT3
00003018                          2342      ;NOW WE CHECK POS Y 
00003018  B27C 01E0               2343      CMP #480, D1  ; 
0000301C  6E00 0016               2344      BGT MAP5NOLIMIT3    
00003020  B27C 0000               2345      CMP #0, D1
00003024  6D00 000E               2346      BLT MAP5NOLIMIT3
00003028                          2347      ;;;; AQUI PISA EL LIMITE
00003028  5279 00003A70           2348      ADD.W #1, PLAYERPOSX
0000302E  4C9F 001F               2349      MOVEM.W (A7)+, D0-D4
00003032  4E75                    2350      RTS
00003034                          2351  MAP5NOLIMIT3
00003034                          2352      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00003034  B07C 0120               2353      CMP #288, D0  ; BGT = 352 > D0
00003038  6E00 0026               2354      BGT MAP5NOLIMIT4    
0000303C  B07C 0000               2355      CMP #0, D0
00003040  6D00 001E               2356      BLT MAP5NOLIMIT4
00003044                          2357      ;NOW WE CHECK POS Y 
00003044  B27C 01E0               2358      CMP #480, D1  ; 
00003048  6E00 0016               2359      BGT MAP5NOLIMIT4    
0000304C  B27C 01A0               2360      CMP #416, D1
00003050  6D00 000E               2361      BLT MAP5NOLIMIT4
00003054                          2362      ;;;; AQUI PISA EL LIMITE
00003054  4C9F 001F               2363      MOVEM.W (A7)+, D0-D4
00003058  5379 00003A72           2364      SUB.W #1, PLAYERPOSY
0000305E  4E75                    2365      RTS
00003060                          2366  MAP5NOLIMIT4
00003060                          2367      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00003060  B07C 0280               2368      CMP #640, D0  ; BGT = 352 > D0
00003064  6E00 0026               2369      BGT MAP5NOLIMIT5    
00003068  B07C 0140               2370      CMP #320, D0
0000306C  6D00 001E               2371      BLT MAP5NOLIMIT5
00003070                          2372      ;NOW WE CHECK POS Y 
00003070  B27C 01E0               2373      CMP #480, D1  ; 
00003074  6E00 0016               2374      BGT MAP5NOLIMIT5    
00003078  B27C 01A0               2375      CMP #416, D1
0000307C  6D00 000E               2376      BLT MAP5NOLIMIT5
00003080                          2377      ;;;; AQUI PISA EL LIMITE
00003080  4C9F 001F               2378      MOVEM.W (A7)+, D0-D4
00003084  5379 00003A72           2379      SUB.W #1, PLAYERPOSY
0000308A  4E75                    2380      RTS
0000308C                          2381  MAP5NOLIMIT5
0000308C                          2382      ;CHECK FOR MIDDLE-LEFT WALL 1
0000308C  B07C 0120               2383      CMP #288, D0  ; BGT = 352 > D0
00003090  6E00 0026               2384      BGT MAP5NOLIMIT6    
00003094  B07C 0000               2385      CMP #0, D0
00003098  6D00 001E               2386      BLT MAP5NOLIMIT6
0000309C                          2387      ;NOW WE CHECK POS Y 
0000309C  B27C 00F0               2388      CMP #240, D1  ; 
000030A0  6E00 0016               2389      BGT MAP5NOLIMIT6    
000030A4  B27C 00C0               2390      CMP #192, D1 ;224
000030A8  6D00 000E               2391      BLT MAP5NOLIMIT6
000030AC                          2392      ;;;; AQUI PISA EL LIMITE
000030AC  4C9F 001F               2393      MOVEM.W (A7)+, D0-D4
000030B0  5379 00003A72           2394      SUB.W #1, PLAYERPOSY
000030B6  4E75                    2395      RTS
000030B8                          2396  MAP5NOLIMIT6
000030B8                          2397      ;CHECK FOR MIDDLE-RIGHT WALL 1
000030B8  B07C 0280               2398      CMP #640, D0  ; BGT = 352 > D0
000030BC  6E00 0026               2399      BGT MAP5NOLIMIT7    
000030C0  B07C 0140               2400      CMP #320 , D0
000030C4  6D00 001E               2401      BLT MAP5NOLIMIT7
000030C8                          2402      ;NOW WE CHECK POS Y 
000030C8  B27C 00F0               2403      CMP #240, D1  ; 
000030CC  6E00 0016               2404      BGT MAP5NOLIMIT7    
000030D0  B27C 00C0               2405      CMP #192, D1 ;224
000030D4  6D00 000E               2406      BLT MAP5NOLIMIT7
000030D8                          2407      ;;;; AQUI PISA EL LIMITE
000030D8  4C9F 001F               2408      MOVEM.W (A7)+, D0-D4
000030DC  5379 00003A72           2409      SUB.W #1, PLAYERPOSY
000030E2  4E75                    2410      RTS
000030E4                          2411  MAP5NOLIMIT7
000030E4                          2412      ;CHECK FOR MIDDLE-RIGHT WALL 2
000030E4  B07C 0280               2413      CMP #640, D0  ; BGT = 352 > D0
000030E8  6E00 0026               2414      BGT MAP5NOLIMIT8    
000030EC  B07C 0140               2415      CMP #320 , D0
000030F0  6D00 001E               2416      BLT MAP5NOLIMIT8
000030F4                          2417      ;NOW WE CHECK POS Y 
000030F4  B27C 0100               2418      CMP #256, D1  ; 
000030F8  6E00 0016               2419      BGT MAP5NOLIMIT8    
000030FC  B27C 00F0               2420      CMP #240, D1 ;192
00003100  6D00 000E               2421      BLT MAP5NOLIMIT8
00003104                          2422      ;;;; AQUI PISA EL LIMITE
00003104  4C9F 001F               2423      MOVEM.W (A7)+, D0-D4
00003108  5279 00003A72           2424      ADD.W #1, PLAYERPOSY
0000310E  4E75                    2425      RTS
00003110                          2426  MAP5NOLIMIT8
00003110                          2427      ;CHECK FOR MIDDLE-LEFT WALL 2
00003110  B07C 0120               2428      CMP #288, D0  ; BGT = 352 > D0
00003114  6E00 0026               2429      BGT MAP5NOLIMIT9    
00003118  B07C 0000               2430      CMP #0, D0
0000311C  6D00 001E               2431      BLT MAP5NOLIMIT9
00003120                          2432      ;NOW WE CHECK POS Y 
00003120  B27C 0100               2433      CMP #256, D1  ; 
00003124  6E00 0016               2434      BGT MAP5NOLIMIT9    
00003128  B27C 00F0               2435      CMP #240, D1 ;224
0000312C  6D00 000E               2436      BLT MAP5NOLIMIT9
00003130                          2437      ;;;; AQUI PISA EL LIMITE
00003130  4C9F 001F               2438      MOVEM.W (A7)+, D0-D4
00003134  5279 00003A72           2439      ADD.W #1, PLAYERPOSY
0000313A  4E75                    2440      RTS
0000313C                          2441  MAP5NOLIMIT9
0000313C  4C9F 001F               2442      MOVEM.W (A7)+, D0-D4
00003140  4EF9 000034EA           2443      JMP NOLIMIT
00003146                          2444  
00003146                          2445      
00003146                          2446  LIMAPA6
00003146  301F                    2447      MOVE.W (A7)+, D0
00003148  48A7 F800               2448      MOVEM.W D0-D4, -(A7)
0000314C  3039 00003A70           2449      MOVE.W PLAYERPOSX, D0
00003152  3239 00003A72           2450      MOVE.W PLAYERPOSY, D1
00003158                          2451      ;CHECK FOR WALLS IN MAP 5
00003158                          2452      ;CHECK LEFT UPPER WALL 
00003158  B07C 0120               2453      CMP #288, D0  ; BGT = 352 > D0
0000315C  6E00 0026               2454      BGT MAP6NOLIMIT1   
00003160  B07C 0000               2455      CMP #0, D0
00003164  6D00 001E               2456      BLT MAP6NOLIMIT1
00003168                          2457      ;NOW WE CHECK POS Y 
00003168  B27C 0020               2458      CMP #32, D1  ; 
0000316C  6E00 0016               2459      BGT MAP6NOLIMIT1    
00003170  B27C 0000               2460      CMP #0, D1
00003174  6D00 000E               2461      BLT MAP6NOLIMIT1
00003178                          2462      ;;;; AQUI PISA EL LIMITE
00003178  4C9F 001F               2463      MOVEM.W (A7)+, D0-D4
0000317C  5279 00003A72           2464      ADD.W #1, PLAYERPOSY
00003182  4E75                    2465      RTS
00003184                          2466  MAP6NOLIMIT1
00003184                          2467      ;CHECK LEFT WALL
00003184  B07C 0020               2468      CMP #32, D0  ; BGT = 352 > D0
00003188  6E00 0026               2469      BGT MAP6NOLIMIT2    
0000318C  B07C 0000               2470      CMP #0, D0
00003190  6D00 001E               2471      BLT MAP6NOLIMIT2
00003194                          2472      ;NOW WE CHECK POS Y 
00003194  B27C 01E0               2473      CMP #480, D1  ; 
00003198  6E00 0016               2474      BGT MAP6NOLIMIT2    
0000319C  B27C 0000               2475      CMP #0, D1
000031A0  6D00 000E               2476      BLT MAP6NOLIMIT2
000031A4                          2477      ;;;; AQUI PISA EL LIMITE
000031A4  5279 00003A70           2478      ADD.W #1, PLAYERPOSX
000031AA  4C9F 001F               2479      MOVEM.W (A7)+, D0-D4
000031AE  4E75                    2480      RTS
000031B0                          2481  MAP6NOLIMIT2
000031B0                          2482      ;CHECK FOR RIGHT WALL 
000031B0  B07C 0280               2483      CMP #640, D0  ; BGT = 352 > D0
000031B4  6E00 0026               2484      BGT MAP6NOLIMIT3    
000031B8  B07C 0240               2485      CMP #576, D0
000031BC  6D00 001E               2486      BLT MAP6NOLIMIT3
000031C0                          2487      ;NOW WE CHECK POS Y 
000031C0  B27C 01E0               2488      CMP #480, D1  ; 
000031C4  6E00 0016               2489      BGT MAP6NOLIMIT3    
000031C8  B27C 0000               2490      CMP #0, D1
000031CC  6D00 000E               2491      BLT MAP6NOLIMIT3
000031D0                          2492      ;;;; AQUI PISA EL LIMITE
000031D0  5379 00003A70           2493      SUB.W #1, PLAYERPOSX
000031D6  4C9F 001F               2494      MOVEM.W (A7)+, D0-D4
000031DA  4E75                    2495      RTS
000031DC                          2496  MAP6NOLIMIT3
000031DC                          2497      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
000031DC  B07C 0120               2498      CMP #288, D0  ; BGT = 352 > D0
000031E0  6E00 0026               2499      BGT MAP6NOLIMIT5   
000031E4  B07C 0000               2500      CMP #0, D0
000031E8  6D00 001E               2501      BLT MAP6NOLIMIT5
000031EC                          2502      ;NOW WE CHECK POS Y 
000031EC  B27C 01E0               2503      CMP #480, D1  ; 
000031F0  6E00 0016               2504      BGT MAP6NOLIMIT5    
000031F4  B27C 01A0               2505      CMP #416, D1
000031F8  6D00 000E               2506      BLT MAP6NOLIMIT5
000031FC                          2507      ;;;; AQUI PISA EL LIMITE
000031FC  4C9F 001F               2508      MOVEM.W (A7)+, D0-D4
00003200  5379 00003A72           2509      SUB.W #1, PLAYERPOSY
00003206  4E75                    2510      RTS
00003208                          2511  MAP6NOLIMIT5
00003208                          2512      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00003208  B07C 0280               2513      CMP #640, D0  ; BGT = 352 > D0
0000320C  6E00 0026               2514      BGT MAP6NOLIMIT6    
00003210  B07C 0140               2515      CMP #320, D0
00003214  6D00 001E               2516      BLT MAP6NOLIMIT6
00003218                          2517      ;NOW WE CHECK POS Y 
00003218  B27C 01E0               2518      CMP #480, D1  ; 
0000321C  6E00 0016               2519      BGT MAP6NOLIMIT6    
00003220  B27C 01A0               2520      CMP #416, D1
00003224  6D00 000E               2521      BLT MAP6NOLIMIT6
00003228                          2522      ;;;; AQUI PISA EL LIMITE
00003228  4C9F 001F               2523      MOVEM.W (A7)+, D0-D4
0000322C  5379 00003A72           2524      SUB.W #1, PLAYERPOSY
00003232  4E75                    2525      RTS
00003234                          2526  MAP6NOLIMIT6
00003234                          2527      ;CHECK RIGHT-RIGHT ROOM WALL
00003234  B07C 0280               2528      CMP #640, D0  ; BGT = 352 > D0
00003238  6E00 0026               2529      BGT MAP6NOLIMIT7    
0000323C  B07C 0222               2530      CMP #546, D0
00003240  6D00 001E               2531      BLT MAP6NOLIMIT7
00003244                          2532      ;NOW WE CHECK POS Y 
00003244  B27C 01E0               2533      CMP #480, D1  ; 
00003248  6E00 0016               2534      BGT MAP6NOLIMIT7    
0000324C  B27C 0120               2535      CMP #288, D1
00003250  6D00 000E               2536      BLT MAP6NOLIMIT7
00003254                          2537      ;;;; AQUI PISA EL LIMITE
00003254  4C9F 001F               2538      MOVEM.W (A7)+, D0-D4
00003258  5379 00003A72           2539      SUB.W #1, PLAYERPOSY
0000325E  4E75                    2540      RTS
00003260                          2541  MAP6NOLIMIT7
00003260                          2542      ;CHECK FOR LEFT-RIGHT ROOM WALL
00003260  B07C 0218               2543      CMP #536, D0  ; BGT = 352 > D0
00003264  6E00 002C               2544      BGT MAP6NOLIMIT8    
00003268  B07C 0160               2545      CMP #352, D0
0000326C  6D00 0024               2546      BLT MAP6NOLIMIT8
00003270                          2547      ;NOW WE CHECK POS Y 
00003270  B27C 01E0               2548      CMP #480, D1  ; 
00003274  6E00 001C               2549      BGT MAP6NOLIMIT8    
00003278  B27C 0120               2550      CMP #288, D1
0000327C  6D00 0014               2551      BLT MAP6NOLIMIT8
00003280                          2552      ;;;; AQUI PISA EL LIMITE
00003280  4C9F 001F               2553      MOVEM.W (A7)+, D0-D4
00003284  5379 00003A70           2554      SUB.W #1, PLAYERPOSX
0000328A  5379 00003A72           2555      SUB.W #1, PLAYERPOSY
00003290  4E75                    2556      RTS
00003292                          2557  MAP6NOLIMIT8
00003292                          2558      ;CHECK LEFT-LEFT ROOM WALL
00003292  B07C 003E               2559      CMP #62, D0  ; BGT = 352 > D0
00003296  6E00 0026               2560      BGT MAP6NOLIMIT9    
0000329A  B07C 0000               2561      CMP #0, D0
0000329E  6D00 001E               2562      BLT MAP6NOLIMIT9
000032A2                          2563      ;NOW WE CHECK POS Y 
000032A2  B27C 01E0               2564      CMP #480, D1  ; 
000032A6  6E00 0016               2565      BGT MAP6NOLIMIT9    
000032AA  B27C 0120               2566      CMP #288, D1
000032AE  6D00 000E               2567      BLT MAP6NOLIMIT9
000032B2                          2568      ;;;; AQUI PISA EL LIMITE
000032B2  4C9F 001F               2569      MOVEM.W (A7)+, D0-D4
000032B6  5379 00003A72           2570      SUB.W #1, PLAYERPOSY
000032BC  4E75                    2571      RTS
000032BE                          2572  MAP6NOLIMIT9
000032BE                          2573      ;CHECK FOR RIGHT-LEFT ROOM WALL
000032BE  B07C 0100               2574      CMP #256, D0  ; BGT = 352 > D0
000032C2  6E00 002C               2575      BGT MAP6NOLIMIT10   
000032C6  B07C 0044               2576      CMP #68, D0
000032CA  6D00 0024               2577      BLT MAP6NOLIMIT10
000032CE                          2578      ;NOW WE CHECK POS Y 
000032CE  B27C 01E0               2579      CMP #480, D1  ; 
000032D2  6E00 001C               2580      BGT MAP6NOLIMIT10   
000032D6  B27C 0120               2581      CMP #288, D1
000032DA  6D00 0014               2582      BLT MAP6NOLIMIT10
000032DE                          2583      ;;;; AQUI PISA EL LIMITE
000032DE  4C9F 001F               2584      MOVEM.W (A7)+, D0-D4
000032E2  5279 00003A70           2585      ADD.W #1, PLAYERPOSX
000032E8  5379 00003A72           2586      SUB.W #1, PLAYERPOSY
000032EE  4E75                    2587      RTS
000032F0                          2588  MAP6NOLIMIT10
000032F0  4C9F 001F               2589      MOVEM.W (A7)+, D0-D4
000032F4  4EF9 000034EA           2590      JMP NOLIMIT
000032FA                          2591  LIMAPA7
000032FA  301F                    2592      MOVE.W (A7)+, D0
000032FC  48A7 F800               2593      MOVEM.W D0-D4, -(A7)
00003300  3039 00003A70           2594      MOVE.W PLAYERPOSX, D0
00003306  3239 00003A72           2595      MOVE.W PLAYERPOSY, D1
0000330C                          2596      ;CHECK FOR TOP-LEFT WALL 
0000330C  B07C 0120               2597      CMP #288, D0  ; BGT = 352 > D0
00003310  6E00 0026               2598      BGT MAP7NOLIMIT1    
00003314  B07C 0000               2599      CMP #0, D0
00003318  6D00 001E               2600      BLT MAP7NOLIMIT1
0000331C                          2601      ;NOW WE CHECK POS Y 
0000331C  B27C 0020               2602      CMP #32, D1  ; 
00003320  6E00 0016               2603      BGT MAP7NOLIMIT1    
00003324  B27C 0000               2604      CMP #0, D1
00003328  6D00 000E               2605      BLT MAP7NOLIMIT1
0000332C                          2606      ;;;; AQUI PISA EL LIMITE
0000332C  5279 00003A72           2607      ADD.W #1, PLAYERPOSY
00003332  4C9F 001F               2608      MOVEM.W (A7)+, D0-D4
00003336  4E75                    2609      RTS
00003338                          2610  MAP7NOLIMIT1
00003338                          2611      ;CHECK FOR LEFT WALL
00003338  B07C 0020               2612      CMP #32, D0  ; BGT = 352 > D0
0000333C  6E00 0026               2613      BGT MAP7NOLIMIT2    
00003340  B07C 0000               2614      CMP #0, D0
00003344  6D00 001E               2615      BLT MAP7NOLIMIT2
00003348                          2616      ;NOW WE CHECK POS Y 
00003348  B27C 01E0               2617      CMP #480, D1  ; 
0000334C  6E00 0016               2618      BGT MAP7NOLIMIT2    
00003350  B27C 0000               2619      CMP #0, D1
00003354  6D00 000E               2620      BLT MAP7NOLIMIT2
00003358                          2621      ;;;; AQUI PISA EL LIMITE
00003358  5279 00003A70           2622      ADD.W #1, PLAYERPOSX
0000335E  4C9F 001F               2623      MOVEM.W (A7)+, D0-D4
00003362  4E75                    2624      RTS
00003364                          2625  MAP7NOLIMIT2
00003364                          2626      ;CHECK FOR BOTTOM WALL
00003364  B07C 0280               2627      CMP #640, D0  ; BGT = 352 > D0
00003368  6E00 0026               2628      BGT MAP7NOLIMIT3    
0000336C  B07C 0000               2629      CMP #0, D0
00003370  6D00 001E               2630      BLT MAP7NOLIMIT3
00003374                          2631      ;NOW WE CHECK POS Y 
00003374  B27C 01E0               2632      CMP #480, D1  ; 
00003378  6E00 0016               2633      BGT MAP7NOLIMIT3    
0000337C  B27C 01A0               2634      CMP #416, D1
00003380  6D00 000E               2635      BLT MAP7NOLIMIT3
00003384                          2636      ;;;; AQUI PISA EL LIMITE
00003384  5379 00003A72           2637      SUB.W #1, PLAYERPOSY
0000338A  4C9F 001F               2638      MOVEM.W (A7)+, D0-D4
0000338E  4E75                    2639      RTS
00003390                          2640  MAP7NOLIMIT3
00003390                          2641      ;CHECK FOR RIGHT WALL
00003390  B07C 0280               2642      CMP #640, D0  ; BGT = 352 > D0
00003394  6E00 0026               2643      BGT MAP7NOLIMIT4    
00003398  B07C 0240               2644      CMP #576, D0
0000339C  6D00 001E               2645      BLT MAP7NOLIMIT4
000033A0                          2646      ;NOW WE CHECK POS Y 
000033A0  B27C 01E0               2647      CMP #480, D1  ; 
000033A4  6E00 0016               2648      BGT MAP7NOLIMIT4    
000033A8  B27C 0000               2649      CMP #0, D1
000033AC  6D00 000E               2650      BLT MAP7NOLIMIT4
000033B0                          2651      ;;;; AQUI PISA EL LIMITE
000033B0  5379 00003A70           2652      SUB.W #1, PLAYERPOSX
000033B6  4C9F 001F               2653      MOVEM.W (A7)+, D0-D4
000033BA  4E75                    2654      RTS
000033BC                          2655  MAP7NOLIMIT4
000033BC                          2656      ;CHECK TOP-RIGHT WALL
000033BC  B07C 0280               2657      CMP #640, D0  ; BGT = 352 > D0
000033C0  6E00 0026               2658      BGT MAP7NOLIMIT5    
000033C4  B07C 0160               2659      CMP #352, D0
000033C8  6D00 001E               2660      BLT MAP7NOLIMIT5
000033CC                          2661      ;NOW WE CHECK POS Y 
000033CC  B27C 0020               2662      CMP #32, D1  ; 
000033D0  6E00 0016               2663      BGT MAP7NOLIMIT5    
000033D4  B27C 0000               2664      CMP #0, D1
000033D8  6D00 000E               2665      BLT MAP7NOLIMIT5
000033DC                          2666      ;;;; AQUI PISA EL LIMITE
000033DC  5279 00003A72           2667      ADD.W #1, PLAYERPOSY
000033E2  4C9F 001F               2668      MOVEM.W (A7)+, D0-D4
000033E6  4E75                    2669      RTS
000033E8                          2670  MAP7NOLIMIT5
000033E8  4C9F 001F               2671      MOVEM.W (A7)+, D0-D4
000033EC  4EF9 000034EA           2672      JMP NOLIMIT
000033F2                          2673      
000033F2                          2674  LIMAPA8
000033F2  301F                    2675      MOVE.W (A7)+, D0
000033F4  48A7 F800               2676      MOVEM.W D0-D4, -(A7)
000033F8  3039 00003A70           2677      MOVE.W PLAYERPOSX, D0
000033FE  3239 00003A72           2678      MOVE.W PLAYERPOSY, D1
00003404                          2679      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00003404                          2680      ;CHECK UPPER LEFT WALL 
00003404  B07C 0120               2681      CMP #288, D0  ; BGT = 352 > D0
00003408  6E00 0026               2682      BGT MAP8NOLIMIT1   
0000340C  B07C 0000               2683      CMP #0, D0
00003410  6D00 001E               2684      BLT MAP8NOLIMIT1
00003414                          2685      ;NOW WE CHECK POS Y 
00003414  B27C 00A0               2686      CMP #160, D1  ; 
00003418  6E00 0016               2687      BGT MAP8NOLIMIT1    
0000341C  B27C 0000               2688      CMP #0, D1
00003420  6D00 000E               2689      BLT MAP8NOLIMIT1
00003424                          2690      ;;;; AQUI PISA EL LIMITE
00003424  4C9F 001F               2691      MOVEM.W (A7)+, D0-D4
00003428  5279 00003A72           2692      ADD.W #1, PLAYERPOSY
0000342E  4E75                    2693      RTS
00003430                          2694  MAP8NOLIMIT1
00003430                          2695      ;CHECK BOTTOM WALL
00003430  B07C 0280               2696      CMP #640, D0  ; BGT = 352 > D0
00003434  6E00 0026               2697      BGT MAP8NOLIMIT2   
00003438  B07C 0000               2698      CMP #0, D0
0000343C  6D00 001E               2699      BLT MAP8NOLIMIT2
00003440                          2700      ;NOW WE CHECK POS Y 
00003440  B27C 01E0               2701      CMP #480, D1  ; 
00003444  6E00 0016               2702      BGT MAP8NOLIMIT2    
00003448  B27C 0120               2703      CMP #288, D1
0000344C  6D00 000E               2704      BLT MAP8NOLIMIT2
00003450                          2705      ;;;; AQUI PISA EL LIMITE
00003450  4C9F 001F               2706      MOVEM.W (A7)+, D0-D4
00003454  5379 00003A72           2707      SUB.W #1, PLAYERPOSY
0000345A  4E75                    2708      RTS
0000345C                          2709  MAP8NOLIMIT2
0000345C                          2710      ;CHECK LEFT WALL
0000345C  B07C 00C0               2711      CMP #192, D0  ; BGT = 352 > D0
00003460  6E00 0026               2712      BGT MAP8NOLIMIT3   
00003464  B07C 0000               2713      CMP #0, D0
00003468  6D00 001E               2714      BLT MAP8NOLIMIT3
0000346C                          2715      ;NOW WE CHECK POS Y 
0000346C  B27C 01E0               2716      CMP #480, D1  ; 
00003470  6E00 0016               2717      BGT MAP8NOLIMIT3    
00003474  B27C 0000               2718      CMP #0, D1
00003478  6D00 000E               2719      BLT MAP8NOLIMIT3
0000347C                          2720      ;;;; AQUI PISA EL LIMITE
0000347C  4C9F 001F               2721      MOVEM.W (A7)+, D0-D4
00003480  5279 00003A70           2722      ADD.W #1, PLAYERPOSX
00003486  4E75                    2723      RTS
00003488                          2724  MAP8NOLIMIT3
00003488                          2725      ;CHECK RIGHT WALL
00003488  B07C 0280               2726      CMP #640, D0  ; BGT = 352 > D0
0000348C  6E00 0026               2727      BGT MAP8NOLIMIT4   
00003490  B07C 01A0               2728      CMP #416, D0
00003494  6D00 001E               2729      BLT MAP8NOLIMIT4
00003498                          2730      ;NOW WE CHECK POS Y 
00003498  B27C 01E0               2731      CMP #480, D1  ; 
0000349C  6E00 0016               2732      BGT MAP8NOLIMIT4    
000034A0  B27C 0000               2733      CMP #0, D1
000034A4  6D00 000E               2734      BLT MAP8NOLIMIT4
000034A8                          2735      ;;;; AQUI PISA EL LIMITE
000034A8  4C9F 001F               2736      MOVEM.W (A7)+, D0-D4
000034AC  5379 00003A70           2737      SUB.W #1, PLAYERPOSX
000034B2  4E75                    2738      RTS
000034B4                          2739  MAP8NOLIMIT4
000034B4                          2740  ;CHECK TOP RIGHT WALL
000034B4  B07C 0280               2741      CMP #640, D0  ; BGT = 352 > D0
000034B8  6E00 0026               2742      BGT MAP8NOLIMIT5   
000034BC  B07C 0160               2743      CMP #352, D0
000034C0  6D00 001E               2744      BLT MAP8NOLIMIT5
000034C4                          2745      ;NOW WE CHECK POS Y 
000034C4  B27C 00A0               2746      CMP #160, D1  ; 
000034C8  6E00 0016               2747      BGT MAP8NOLIMIT5    
000034CC  B27C 0000               2748      CMP #0, D1
000034D0  6D00 000E               2749      BLT MAP8NOLIMIT5
000034D4                          2750      ;;;; AQUI PISA EL LIMITE
000034D4  4C9F 001F               2751      MOVEM.W (A7)+, D0-D4
000034D8  5279 00003A72           2752      ADD.W #1, PLAYERPOSY
000034DE  4E75                    2753      RTS
000034E0                          2754  MAP8NOLIMIT5
000034E0  4C9F 001F               2755      MOVEM.W (A7)+, D0-D4
000034E4  4EF9 000034EA           2756      JMP NOLIMIT
000034EA                          2757      
000034EA                          2758  NOLIMIT
000034EA  3F00                    2759              MOVE.W  D0,-(A7)
000034EC  0839 0000 00003A68      2760        BTST #0, KBDVAL         
000034F4  6700 000C               2761              BEQ .UP    
000034F8  303C FFFC               2762              MOVE.W  #-PLAYERSPEED,D0     
000034FC  4EB9 00003548           2763        JSR   MOVEHOR 
00003502  0839 0001 00003A68      2764  .UP   BTST #1, KBDVAL           
0000350A  6700 000C               2765        BEQ   .RIGHT  
0000350E  303C FFFC               2766              MOVE.W  #-PLAYERSPEED,D0      
00003512  4EB9 0000356E           2767        JSR   MOVEVER
00003518  0839 0002 00003A68      2768  .RIGHT    BTST #2, KBDVAL
00003520  6700 000C               2769        BEQ   .DOWN  
00003524  303C 0004               2770              MOVE.W  #PLAYERSPEED,D0     
00003528  4EB9 00003548           2771        JSR   MOVEHOR
0000352E  0839 0003 00003A68      2772  .DOWN     BTST #3, KBDVAL
00003536  6700 000C               2773        BEQ   .NOTMOVED  
0000353A  303C 0004               2774              MOVE.W  #PLAYERSPEED,D0       
0000353E  4EB9 0000356E           2775        JSR   MOVEVER
00003544  301F                    2776  .NOTMOVED     MOVE.W  (A7)+,D0
00003546  4E75                    2777              RTS
00003548                          2778  
00003548  D179 00003A70           2779  MOVEHOR     ADD.W   D0,(PLAYERPOSX)
0000354E  6A00 0008               2780              BPL.W   .NOTLEFTEDGE
00003552  4279 00003A70           2781              CLR.W   (PLAYERPOSX)
00003558                          2782  .NOTLEFTEDGE
00003558  0C79 0260 00003A70      2783              CMP.W   #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
00003560  6D00 000A               2784              BLT.W   .NORIGHTEDGE
00003564  33FC 0260 00003A70      2785              MOVE.W  #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
0000356C                          2786  .NORIGHTEDGE 
0000356C  4E75                    2787              RTS
0000356E                          2788              
0000356E  D179 00003A72           2789  MOVEVER     ADD.W   D0,(PLAYERPOSY)
00003574  6A00 0008               2790              BPL.W   .NOTUPPEREDGE
00003578  4279 00003A72           2791              CLR.W   (PLAYERPOSY)
0000357E                          2792  .NOTUPPEREDGE
0000357E  0C79 01C0 00003A72      2793              CMP.W   #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
00003586  6D00 000A               2794              BLT.W   .NOLOWEREDGE
0000358A  33FC 01C0 00003A72      2795              MOVE.W  #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
00003592                          2796  .NOLOWEREDGE 
00003592  4E75                    2797              RTS
00003594                          2798          
00003594                          2799  ; ------------------------------------------------------------------------------
00003594                          2800  PLAYERPLOT
00003594                          2801  ; PLOT THE PLAYER.
00003594                          2802  ; INPUT    : NONE 
00003594                          2803  ; OUTPUT   : NONE
00003594                          2804  ; MODIFIES : NONE
00003594                          2805  ; ------------------------------------------------------------------------------
00003594                          2806              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
00003594  1F00                    2807              MOVE.B  D0,-(A7)
00003596  2F01                    2808              MOVE.L  D1,-(A7)
00003598  48A7 3800               2809        MOVEM.W D2-D4, -(A7)
0000359C                          2810        
0000359C  223C 00CC954E           2811        MOVE.L #$00CC954E,D1 ;PEN COLOR
000035A2  103C 0050               2812        MOVE.B #80,D0
000035A6  4E4F                    2813        TRAP #15
000035A8  223C 00B53866           2814        MOVE.L #$00B53866,D1 ;FILL COLOR
000035AE  103C 0051               2815        MOVE.B #81,D0
000035B2  4E4F                    2816        TRAP #15
000035B4                          2817        ; SE DIBUJA EL CUADRADO
000035B4  3239 00003A70           2818        MOVE.W (PLAYERPOSX),D1    
000035BA  3439 00003A72           2819        MOVE.W (PLAYERPOSY),D2      
000035C0  3601                    2820        MOVE.W D1,D3
000035C2  0643 0020               2821              ADD.W  #PLAYERWIDTH,D3  
000035C6  3802                    2822        MOVE.W D2,D4
000035C8  0644 0020               2823              ADD.W  #PLAYERHEIGHT,D4
000035CC  103C 0057               2824        MOVE.B #87,D0
000035D0  4E4F                    2825        TRAP #15
000035D2                          2826        
000035D2  4C9F 001C               2827              MOVEM.W (A7)+,D2-D4
000035D6  221F                    2828              MOVE.L  (A7)+,D1      
000035D8  101F                    2829              MOVE.B  (A7)+,D0
000035DA                          2830    
000035DA  4E75                    2831        RTS
000035DC                          2832  
000035DC                          2833  
000035DC                          2834  
000035DC                          2835  
000035DC                          2836  -------------------- end include --------------------
000035DC                          2837              INCLUDE "PROJECTILE.X68"
000035DC                          2838  ; ==============================================================================
000035DC                          2839  ; PROJECTILE MANAGEMENT (AGENT)
000035DC                          2840  ; PROJPOSX (W)  (A0)
000035DC                          2841  ; PROJPOSY (W) 2(A0)
000035DC                          2842  ; PROJVELX (W) 4(A0)
000035DC                          2843  ; PROJVELY (W) 6(A0)
000035DC                          2844  ; ==============================================================================
000035DC                          2845  
000035DC                          2846  ; ------------------------------------------------------------------------------
000035DC                          2847  PROJINIT 
000035DC                          2848  ; INITIALIZES THE PROJECTILE.
000035DC                          2849  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
000035DC                          2850  ; OUTPUT   : NONE
000035DC                          2851  ; MODIFIES : NONE
000035DC                          2852  ; ------------------------------------------------------------------------------
000035DC  2F00                    2853             MOVE.L  D0,-(A7)
000035DE                          2854             
000035DE  4280                    2855              CLR.L   D0
000035E0  0839 0004 00003A69      2856              BTST #4, (KBDEDGE)    
000035E8  6700 0008               2857              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
000035EC  0680 FFF80000           2858              ADD.L   #-PROJSPEEDX<<16,D0
000035F2  0839 0005 00003A69      2859  .FUP        BTST #5, (KBDEDGE)      
000035FA  6700 0006               2860              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
000035FE  0640 FFF8               2861              ADD.W   #-PROJSPEEDY,D0 
00003602  0839 0006 00003A69      2862  .FRIGHT     BTST #6, (KBDEDGE)
0000360A  6700 0008               2863              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
0000360E  0680 00080000           2864              ADD.L   #PROJSPEEDX<<16,D0
00003614  0839 0007 00003A69      2865  .FDOWN      BTST #7, (KBDEDGE)
0000361C  6700 0004               2866              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
00003620  5040                    2867              ADD.W   #PROJSPEEDY,D0
00003622  4A80                    2868  .NOTFDOWN   TST.L   D0
00003624  6600 0006               2869              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
00003628  303C 0008               2870              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
0000362C  20B9 00003A70           2871  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
00003632  2140 0004               2872              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
00003636  5279 00003A74           2873              ADD.W   #1,(NPROJ)
0000363C  201F                    2874              MOVE.L  (A7)+,D0
0000363E  4E75                    2875              RTS
00003640                          2876    
00003640                          2877  ; ------------------------------------------------------------------------------
00003640                          2878  PROJUPD 
00003640                          2879  ; UPDATES THE PROJECTILE.
00003640                          2880  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00003640                          2881  ; OUTPUT   : NONE
00003640                          2882  ; MODIFIES : NONE
00003640                          2883  ; ------------------------------------------------------------------------------
00003640  48E7 F000               2884              MOVEM.L  D0-D3,-(A7)
00003644  2028 0004               2885              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
00003648  D168 0002               2886              ADD.W   D0,2(A0)
0000364C  E088                    2887              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
0000364E  E088                    2888              LSR.L   #8,D0
00003650  D150                    2889              ADD.W   D0,(A0) 
00003652                          2890              
00003652                          2891              ; CHECK COLLISIONS
00003652                          2892              ; TOP LEFT CORNER
00003652  3010                    2893              MOVE.W  (A0),D0
00003654  E188                    2894              LSL.L   #8,D0
00003656  E188                    2895              LSL.L   #8,D0
00003658  3028 0002               2896              MOVE.W  2(A0),D0
0000365C                          2897              
0000365C  3210                    2898              MOVE.W  (A0),D1
0000365E  0641 0010               2899              ADD.W   #PROJWIDTH,D1
00003662  E189                    2900              LSL.L   #8,D1
00003664  E189                    2901              LSL.L   #8,D1
00003666  3228 0002               2902              MOVE.W  2(A0),D1
0000366A  0641 0010               2903              ADD.W   #PROJHEIGHT,D1
0000366E                          2904  
0000366E  4EB8 14A6               2905              JSR BLKCOLL
00003672  4A80                    2906              TST.L   D0
00003674  6600 001A               2907              BNE.L   .PROJCOLL
00003678  4A81                    2908              TST.L   D1
0000367A  6600 0014               2909              BNE.L   .PROJCOLL
0000367E  4A82                    2910              TST.L   D2
00003680  6600 000E               2911              BNE.L   .PROJCOLL
00003684  4A83                    2912              TST.L   D3
00003686  6600 0008               2913              BNE.L   .PROJCOLL
0000368A                          2914  .PROJNOCOLL             
0000368A  4CDF 000F               2915              MOVEM.L  (A7)+,D0-D3
0000368E  4E75                    2916              RTS
00003690                          2917              
00003690  4EB8 10F4               2918  .PROJCOLL   JSR AGLKILL
00003694  5379 00003A74           2919              SUB.W   #1,(NPROJ)
0000369A  60EE                    2920              BRA     .PROJNOCOLL
0000369C                          2921  ; ------------------------------------------------------------------------------
0000369C                          2922  PROJPLOT 
0000369C                          2923  ; PLOTS THE PROJECTILE.
0000369C                          2924  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
0000369C                          2925  ; OUTPUT   : NONE
0000369C                          2926  ; MODIFIES : NONE
0000369C                          2927  ; ------------------------------------------------------------------------------
0000369C  1F00                    2928              MOVE.B  D0,-(A7)
0000369E  2F01                    2929              MOVE.L  D1,-(A7)
000036A0  48A7 3800               2930        MOVEM.W D2-D4, -(A7)
000036A4                          2931        
000036A4  223C 00C00FFE           2932        MOVE.L #$00C00FFE,D1 ;PEN COLOR
000036AA  103C 0050               2933        MOVE.B #80,D0
000036AE  4E4F                    2934        TRAP #15
000036B0  223C 00BFF006           2935        MOVE.L #$00BFF006,D1 ;FILL COLOR
000036B6  103C 0051               2936        MOVE.B #81,D0
000036BA  4E4F                    2937        TRAP #15
000036BC                          2938        ; SE DIBUJA EL CUADRADO
000036BC  3210                    2939        MOVE.W (A0),D1    
000036BE  3428 0002               2940        MOVE.W 2(A0),D2     
000036C2  3601                    2941        MOVE.W D1,D3
000036C4  0643 0010               2942              ADD.W  #PROJWIDTH,D3    
000036C8  3802                    2943        MOVE.W D2,D4
000036CA  0644 0010               2944              ADD.W  #PROJHEIGHT,D4
000036CE  103C 0057               2945        MOVE.B #87,D0
000036D2  4E4F                    2946        TRAP #15
000036D4                          2947        
000036D4  4C9F 001C               2948              MOVEM.W (A7)+,D2-D4
000036D8  221F                    2949              MOVE.L  (A7)+,D1      
000036DA  101F                    2950              MOVE.B  (A7)+,D0
000036DC  4E75                    2951              RTS
000036DE                          2952  
000036DE                          2953  
000036DE                          2954  
000036DE                          2955  
000036DE                          2956  -------------------- end include --------------------
000036DE                          2957              INCLUDE "AUDIO.X68"
000036DE                          2958     
000036DE                          2959  ; =============================================================================
000036DE                          2960  ; AUDIO MANAGEMENT
000036DE                          2961  ; =============================================================================
000036DE                          2962  
000036DE                          2963  
000036DE                          2964  ; -----------------------------------------------------------------------------
000036DE                          2965  AUDINIT
000036DE                          2966  ; CHANGES AUDIO TO PLAY
000036DE                          2967  ; INPUT    - NONE
000036DE                          2968  ; OUTPUT   - NONE
000036DE                          2969  ; MODIFIES - NONE
000036DE                          2970  ; -----------------------------------------------------------------------------
000036DE                          2971      
000036DE  48A7 E000               2972      MOVEM.W D0-D2, -(A7)
000036E2  48A7 00C0               2973      MOVEM.W A0-A1, -(A7)
000036E6                          2974  ;LOAD ELEVATOR MUSIC IN POS 0 
000036E6  103C 0047               2975      MOVE.B #71, D0
000036EA  43F8 100F               2976      LEA ELEVATOR_MUSIC, A1
000036EE  123C 0000               2977      MOVE.B #0, D1
000036F2  4E4F                    2978      TRAP #15
000036F4                          2979  ;LOAD HEAVEN MUSIC IN POS 1
000036F4  43F8 1000               2980      LEA HEAVENSOUND, A1
000036F8  123C 0001               2981      MOVE.B #1, D1
000036FC  4E4F                    2982      TRAP #15
000036FE                          2983  ;LOAD HELL MUSIC IN POS 2
000036FE  43F8 1026               2984      LEA HELLSOUND, A1
00003702  123C 0002               2985      MOVE.B #2, D1
00003706  4E4F                    2986      TRAP #15
00003708  4C9F 0300               2987      MOVEM.W (A7)+, A0-A1
0000370C  4C9F 0007               2988      MOVEM.W (A7)+, D0-D2
00003710                          2989  
00003710  4E75                    2990      RTS
00003712                          2991  
00003712                          2992  
00003712                          2993  ; -----------------------------------------------------------------------------
00003712                          2994  AUDPLAY
00003712                          2995  ; CHANGES AUDIO TO PLAY
00003712                          2996  ; INPUT    - NONE
00003712                          2997  ; OUTPUT   - NONE
00003712                          2998  ; MODIFIES - NONE
00003712                          2999  ; -----------------------------------------------------------------------------
00003712                          3000      
00003712  48E7 E000               3001      MOVEM.L D0-D2, -(A7)
00003716  48A7 00C0               3002      MOVEM.W A0-A1, -(A7)    
0000371A                          3003      
0000371A  3239 00003A7E           3004      MOVE.W LOADEDMAP, D1
00003720  C2FC 0006               3005             MULU #6, D1
00003724  3241                    3006             MOVEA.W D1, A1
00003726  4EE9 372A               3007             JMP MSCSEL(A1)
0000372A                          3008  MSCSEL:
0000372A  4EF9 00003760           3009             JMP ELEVATORMUSIC
00003730                          3010             
00003730  4EF9 0000377E           3011             JMP HEAVENMUSIC
00003736                          3012             
00003736  4EF9 0000377E           3013             JMP HEAVENMUSIC
0000373C                          3014             
0000373C  4EF9 0000377E           3015             JMP HEAVENMUSIC
00003742                          3016             
00003742  4EF9 0000377E           3017             JMP HEAVENMUSIC
00003748                          3018             
00003748  4EF9 000037A0           3019             JMP HELLMUSIC
0000374E                          3020             
0000374E  4EF9 000037A0           3021             JMP HELLMUSIC
00003754                          3022             
00003754  4EF9 000037A0           3023             JMP HELLMUSIC
0000375A                          3024             
0000375A  4EF9 000037A0           3025             JMP HELLMUSIC
00003760                          3026             
00003760                          3027  
00003760                          3028  ELEVATORMUSIC
00003760  103C 004C               3029      MOVE.B #76, D0
00003764  123C 0000               3030      MOVE.B #0, D1
00003768  7400                    3031      MOVE.L #0, D2
0000376A  4E4F                    3032      TRAP #15
0000376C  4C9F 0300               3033      MOVEM.W (A7)+, A0-A1
00003770  4CDF 0007               3034      MOVEM.L (A7)+, D0-D2
00003774  13FC 0001 00003A82      3035      MOVE.B #1, MUSICPLAYED
0000377C  4E75                    3036      RTS
0000377E                          3037  
0000377E                          3038  HEAVENMUSIC 
0000377E  103C 004C               3039      MOVE.B #76, D0
00003782  123C 0000               3040      MOVE.B #0, D1
00003786  7402                    3041      MOVE.L #2, D2
00003788  4E4F                    3042      TRAP #15
0000378A  103C 004C               3043      MOVE.B #76, D0
0000378E  123C 0001               3044      MOVE.B #1, D1
00003792  7400                    3045      MOVE.L #0, D2
00003794  4E4F                    3046      TRAP #15
00003796  4C9F 0300               3047      MOVEM.W (A7)+, A0-A1
0000379A  4CDF 0007               3048      MOVEM.L (A7)+, D0-D2
0000379E  4E75                    3049      RTS
000037A0                          3050  HELLMUSIC
000037A0  103C 004C               3051      MOVE.B #76, D0
000037A4  123C 0000               3052      MOVE.B #0, D1
000037A8  7402                    3053      MOVE.L #2, D2
000037AA  4E4F                    3054      TRAP #15
000037AC  103C 004C               3055      MOVE.B #76, D0
000037B0  123C 0002               3056      MOVE.B #2, D1
000037B4  7400                    3057      MOVE.L #0,  D2
000037B6  4E4F                    3058      TRAP #15
000037B8  4C9F 0300               3059      MOVEM.W (A7)+, A0-A1
000037BC  4CDF 0007               3060      MOVEM.L (A7)+, D0-D2
000037C0  4E75                    3061      RTS
000037C2                          3062  
000037C2                          3063  FIREDSOUND
000037C2  48A7 E000               3064      MOVEM.W D0-D2, -(A7)
000037C6  48A7 00C0               3065      MOVEM.W A0-A1, -(A7)
000037CA  103C 0049               3066      MOVE.B #73, D0
000037CE  43F8 1035               3067      LEA PROJ_SOUND, A1
000037D2  4E4F                    3068      TRAP #15
000037D4  4C9F 0300               3069      MOVEM.W (A7)+, A0-A1
000037D8  4C9F 0007               3070      MOVEM.W (A7)+, D0-D2
000037DC  4E75                    3071      RTS
000037DC  4E75                    3072  -------------------- end include --------------------
000037DE                          3073              INCLUDE "STATES.X68"
000037DE                          3074  ; =============================================================================
000037DE                          3075  ; GAME STATE MANAGEMENT
000037DE                          3076  ; =============================================================================
000037DE                          3077  
000037DE                          3078  ; -----------------------------------------------------------------------------
000037DE                          3079  STAINIT
000037DE                          3080  ; INITALIZES THE STATE MANAGER
000037DE                          3081  ; INPUT    - NONE
000037DE                          3082  ; OUTPUT   - NONE
000037DE                          3083  ; MODIFIES - NONE
000037DE                          3084  ; -----------------------------------------------------------------------------
000037DE  33FC FFFF 00003AA0      3085              MOVE.W  #STANONE,(STACUR)
000037E6  4279 00003AA2           3086              CLR.W   (STANEXT)
000037EC  4E75                    3087              RTS
000037EE                          3088  
000037EE                          3089  ; -----------------------------------------------------------------------------
000037EE                          3090  STAUPD
000037EE                          3091  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000037EE                          3092  ; INPUT    - NONE
000037EE                          3093  ; OUTPUT   - NONE
000037EE                          3094  ; MODIFIES - NONE
000037EE                          3095  ; -----------------------------------------------------------------------------
000037EE  48E7 8080               3096              MOVEM.L D0/A0,-(A7)
000037F2  4280                    3097              CLR.L   D0
000037F4  3039 00003AA2           3098              MOVE.W  (STANEXT),D0
000037FA  B079 00003AA0           3099              CMP.W   (STACUR),D0
00003800  6700 0012               3100              BEQ     .DOUPD
00003804  33C0 00003AA0           3101              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
0000380A  E588                    3102              LSL.L   #2,D0
0000380C  2040                    3103              MOVE.L  D0,A0
0000380E  2068 382C               3104              MOVE.L  .INITBL(A0),A0
00003812  4E90                    3105              JSR     (A0)
00003814  4280                    3106  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00003816  3039 00003AA0           3107              MOVE.W  (STACUR),D0
0000381C  E588                    3108              LSL.L   #2,D0
0000381E  2040                    3109              MOVE.L  D0,A0
00003820  2068 383C               3110              MOVE.L  .UPDTBL(A0),A0
00003824  4E90                    3111              JSR     (A0)
00003826  4CDF 0101               3112              MOVEM.L (A7)+,D0/A0
0000382A  4E75                    3113              RTS
0000382C= 00003878 00003878 ...   3114  .INITBL     DC.L    STAEMPTY,STAEMPTY,GAMINIT,ENDGINIT
0000383C= 000038EE 000029E4 ...   3115  .UPDTBL     DC.L    ISCUPD,ELEVATORUPDATE,GAMUPD,ENDGUPD
0000384C                          3116  
0000384C                          3117  ; -----------------------------------------------------------------------------
0000384C                          3118  STAPLOT
0000384C                          3119  ; PERFORMS STATE PLOT
0000384C                          3120  ; INPUT    - NONE
0000384C                          3121  ; OUTPUT   - NONE
0000384C                          3122  ; MODIFIES - NONE
0000384C                          3123  ; -----------------------------------------------------------------------------
0000384C  48E7 8080               3124              MOVEM.L D0/A0,-(A7)
00003850  4280                    3125              CLR.L   D0
00003852  3039 00003AA0           3126              MOVE.W  (STACUR),D0
00003858  E588                    3127              LSL.L   #2,D0
0000385A  2040                    3128              MOVE.L  D0,A0
0000385C  2068 3868               3129              MOVE.L  .PLTTBL(A0),A0
00003860  4E90                    3130              JSR     (A0)
00003862  4CDF 0101               3131              MOVEM.L (A7)+,D0/A0
00003866  4E75                    3132              RTS
00003868= 00003908 000027CC ...   3133  .PLTTBL     DC.L    ISCPLOT,ELEVATORPLOT,GAMPLOT,ENDGPLOT
00003878                          3134  
00003878                          3135  ; -----------------------------------------------------------------------------
00003878                          3136  STAEMPTY
00003878                          3137  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00003878                          3138  ; INPUT    - NONE
00003878                          3139  ; OUTPUT   - NONE
00003878                          3140  ; MODIFIES - NONE
00003878                          3141  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00003878                          3142  ; -----------------------------------------------------------------------------
00003878  4E75                    3143              RTS
0000387A                          3144  
0000387A                          3145  
0000387A                          3146  
0000387A                          3147  
0000387A                          3148  
0000387A                          3149  
0000387A                          3150  
0000387A                          3151  
0000387A                          3152  
0000387A                          3153  
0000387A                          3154  
0000387A                          3155  -------------------- end include --------------------
0000387A                          3156              INCLUDE "GAME.X68"
0000387A                          3157  ; ==============================================================================
0000387A                          3158  ; GAME MANAGEMENT
0000387A                          3159  ; ==============================================================================
0000387A                          3160  
0000387A                          3161  ; ------------------------------------------------------------------------------
0000387A                          3162  GAMINIT
0000387A                          3163  ; INITIALIZES GAME.
0000387A                          3164  ; INPUT    : NONE
0000387A                          3165  ; OUTPUT   : NONE
0000387A                          3166  ; MODIFIES : NONE
0000387A                          3167  ; ------------------------------------------------------------------------------
0000387A                          3168             * CLR.W LOADEDMAP
0000387A  4EB8 2A32               3169              JSR     PLAYERINIT
0000387E  6000 FE5E               3170              BRA     AUDINIT
00003882                          3171  
00003882                          3172  ; ------------------------------------------------------------------------------
00003882                          3173  GAMUPD
00003882                          3174  ; UPDATES THE GAME
00003882                          3175  ; INPUT    : NONE
00003882                          3176  ; OUTPUT   : NONE
00003882                          3177  ; MODIFIES : NONE
00003882                          3178  ; ------------------------------------------------------------------------------
00003882  48E7 8070               3179              MOVEM.L D0/A1-A3,-(A7)
00003886                          3180              
00003886                          3181              ; CHECK IF MUSIC IS ALREADY PLAYING 
00003886  1039 00003A82           3182              MOVE.B MUSICPLAYED, D0
0000388C  B07C 0001               3183              CMP #1, D0
00003890  6700 0006               3184              BEQ .NOMUSIC
00003894  4EB8 3712               3185              JSR AUDPLAY
00003898                          3186  ; GENERAL UPDATES
00003898  4EB8 2A34               3187  .NOMUSIC    JSR PLAYERUPD   
0000389C  4EB8 15A8               3188              JSR MAPUPD
000038A0                          3189  ; SHOTS LOGIC         
000038A0  1039 00003A69           3190              MOVE.B  (KBDEDGE),D0
000038A6  C03C 00F0               3191              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
000038AA  6718                    3192              BEQ.B .NOTFIRED
000038AC  4EB8 37C2               3193              JSR FIREDSOUND
000038B0  43F8 35DC               3194              LEA     PROJINIT,A1
000038B4  45F8 3640               3195              LEA     PROJUPD,A2
000038B8  47F8 369C               3196              LEA     PROJPLOT,A3
000038BC  303C 0001               3197              MOVE.W  #1,D0
000038C0  4EB8 12BC               3198              JSR     AGLADD
000038C4                          3199  .NOTFIRED
000038C4  4A79 00003A74           3200              TST.W   (NPROJ)
000038CA  6700 0006               3201              BEQ     .NOPROJ1
000038CE  4EB8 12D6               3202              JSR     AGLUPD
000038D2                          3203  .NOPROJ1
000038D2  4CDF 0E01               3204              MOVEM.L (A7)+,D0/A1-A3
000038D6  4E75                    3205              RTS
000038D8                          3206  
000038D8                          3207  ; ------------------------------------------------------------------------------
000038D8                          3208  GAMPLOT
000038D8                          3209  ; PLOTS THE GAME
000038D8                          3210  ; INPUT    : NONE
000038D8                          3211  ; OUTPUT   : NONE
000038D8                          3212  ; MODIFIES : NONE
000038D8                          3213  ; ------------------------------------------------------------------------------
000038D8  4EB8 1524               3214              JSR MAPPLOT     
000038DC  4A79 00003A74           3215              TST.W   (NPROJ)
000038E2  6700 0006               3216              BEQ     .NOPROJ2
000038E6  4EB8 12FA               3217              JSR     AGLPLOT
000038EA  6000 FCA8               3218  .NOPROJ2    BRA     PLAYERPLOT
000038EE                          3219  
000038EE                          3220  
000038EE                          3221  
000038EE                          3222  
000038EE                          3223  
000038EE                          3224  
000038EE                          3225  
000038EE                          3226  -------------------- end include --------------------
000038EE                          3227              INCLUDE "INTRO.X68"
000038EE                          3228  ; ==============================================================================
000038EE                          3229  ; INTRO SCREEN
000038EE                          3230  ; ==============================================================================
000038EE                          3231  
000038EE                          3232  ; ------------------------------------------------------------------------------
000038EE                          3233  ISCUPD
000038EE                          3234  ; INTRO SCREEN UPDATE
000038EE                          3235  ; INPUT    : NONE
000038EE                          3236  ; OUTPUT   : NONE
000038EE                          3237  ; MODIFIES : NONE
000038EE                          3238  ; ------------------------------------------------------------------------------
000038EE  103C 003D               3239              MOVE.B  #61,D0          ; READ MOUSE
000038F2  123C 0002               3240              MOVE.B  #2,D1           ; MOUSE DOWN STATE
000038F6  4E4F                    3241              TRAP    #15
000038F8  0200 000F               3242              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
000038FC  6708                    3243              BEQ.B   .DONE ; IF NO CLICK
000038FE  33FC 0001 00003AA2      3244              MOVE.W  #1,(STANEXT)
00003906                          3245  .DONE
00003906  4E75                    3246              RTS
00003908                          3247  ; ------------------------------------------------------------------------------
00003908                          3248  ISCPLOT
00003908                          3249  ; INTRO SCREEN PLOT
00003908                          3250  ; INPUT    : NONE
00003908                          3251  ; OUTPUT   : NONE
00003908                          3252  ; MODIFIES : NONE
00003908                          3253  ; ------------------------------------------------------------------------------
00003908  48E7 C080               3254              MOVEM.L D0-D1/A0,-(A7)
0000390C                          3255              
0000390C  4281                    3256              CLR.L   D1
0000390E  103C 0051               3257              MOVE.B  #81,D0
00003912  4E4F                    3258              TRAP    #15
00003914                          3259              
00003914  41F9 00003942           3260              LEA     .TITLE,A0
0000391A  103C 000A               3261              MOVE.B  #10,D0
0000391E  4EB8 1336               3262              JSR     UTLPRINT
00003922                          3263              
00003922  0839 0004 00003A6B      3264              BTST.B  #4,(SCRCYCCT)
0000392A  6700 0010               3265              BEQ     .DONE
0000392E                          3266              
0000392E  41F9 0000396E           3267              LEA     .HINT,A0
00003934  103C 0019               3268              MOVE.B  #25,D0
00003938  4EB8 1336               3269              JSR     UTLPRINT
0000393C                          3270              
0000393C  4CDF 0103               3271  .DONE       MOVEM.L (A7)+,D0-D1/A0
00003940                          3272  
00003940  4E75                    3273              RTS
00003942= 50 41 54 45 52 4E ...   3274  .TITLE      DC.B    'PATERNOSTER: Beyond the pillars of Hercules',0
0000396E= 43 4C 49 43 4B 20 ...   3275  .HINT       DC.B    'CLICK ANYWHERE TO START',0
00003986                          3276              DS.W    0
00003986                          3277  
00003986                          3278  
00003986                          3279  
00003986                          3280  
00003986                          3281  
00003986                          3282  
00003986                          3283  
00003986                          3284  
00003986                          3285  -------------------- end include --------------------
00003986                          3286              INCLUDE "ENDGAME.X68"
00003986                          3287  ; ==============================================================================
00003986                          3288  ; VICTORY SCREEN
00003986                          3289  ; ==============================================================================
00003986                          3290  
00003986                          3291  ; ------------------------------------------------------------------------------
00003986                          3292  ENDGINIT
00003986                          3293  ; END GAME SCREEN INIT
00003986                          3294  ; INPUT    : NONE
00003986                          3295  ; OUTPUT   : NONE
00003986                          3296  ; MODIFIES : NONE
00003986                          3297  ; ------------------------------------------------------------------------------
00003986                          3298  
00003986                          3299              ; GUARDAR SU RECORD EN UN FICHERO
00003986                          3300              ; LEER FICHERO QUE GUARDE LOS RECORDS Y GUARDAR EN MEMORIA
00003986  4E75                    3301              RTS
00003988                          3302  ; ------------------------------------------------------------------------------
00003988                          3303  ENDGUPD
00003988                          3304  ; END GAME SCREEN UPDATE
00003988                          3305  ; INPUT    : NONE
00003988                          3306  ; OUTPUT   : NONE
00003988                          3307  ; MODIFIES : NONE
00003988                          3308  ; ------------------------------------------------------------------------------
00003988  103C 003D               3309              MOVE.B  #61,D0          ; READ MOUSE
0000398C  123C 0002               3310              MOVE.B  #2,D1           ; MOUSE DOWN STATE
00003990  4E4F                    3311              TRAP    #15
00003992  0200 000F               3312              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00003996  6708                    3313              BEQ.B   .DONE           ; IF NO CLICK
00003998  33FC 0001 00003AA2      3314              MOVE.W  #1,(STANEXT)
000039A0                          3315  .DONE
000039A0  4E75                    3316              RTS
000039A2                          3317  
000039A2                          3318  ; ------------------------------------------------------------------------------
000039A2                          3319  ENDGPLOT
000039A2                          3320  ; END GAME SCREEN PLOT
000039A2                          3321  ; INPUT    : NONE
000039A2                          3322  ; OUTPUT   : NONE
000039A2                          3323  ; MODIFIES : NONE
000039A2                          3324  ; ------------------------------------------------------------------------------
000039A2  48E7 C080               3325              MOVEM.L D0-D1/A0,-(A7)
000039A6                          3326              
000039A6  4281                    3327              CLR.L   D1
000039A8  103C 0051               3328              MOVE.B  #81,D0
000039AC  4E4F                    3329              TRAP    #15
000039AE                          3330              
000039AE  41F9 000039EA           3331              LEA     .TXT1,A0
000039B4  103C 000A               3332              MOVE.B  #10,D0
000039B8  4EB8 1336               3333              JSR     UTLPRINT
000039BC                          3334              
000039BC  0839 0008 00003A6B      3335              BTST.B  #8,(SCRCYCCT)
000039C4  6700 0010               3336              BEQ     .NOTPRINT
000039C8                          3337              
000039C8  41F9 00003A04           3338              LEA     .TXT2,A0
000039CE  103C 0019               3339              MOVE.B  #25,D0
000039D2  4EB8 1336               3340              JSR     UTLPRINT
000039D6                          3341              
000039D6                          3342  .NOTPRINT
000039D6  41F9 00003A1C           3343              LEA     .TXT3,A0
000039DC  103C 0019               3344              MOVE.B  #25,D0
000039E0  4EB8 1336               3345              JSR     UTLPRINT
000039E4                          3346              
000039E4                          3347              ; MOSTRAR FICHERO QUE GUARDE LOS RECORDS
000039E4                          3348              
000039E4  4CDF 0103               3349              MOVEM.L (A7)+,D0-D1/A0
000039E8                          3350  
000039E8  4E75                    3351              RTS
000039EA= 59 4F 55 52 20 52 ...   3352  .TXT1       DC.B    'YOUR RECORD THIS TIME WAS',0
00003A04= 43 4C 49 43 4B 20 ...   3353  .TXT2       DC.B    'CLICK ANYWHERE TO START',0
00003A1C= 48 45 52 45 20 41 ...   3354  .TXT3       DC.B    'HERE ARE THE BEST RECORDS',0
00003A36                          3355              DS.W    0
00003A36                          3356  
00003A36                          3357  
00003A36                          3358  
00003A36                          3359  
00003A36                          3360  
00003A36                          3361  -------------------- end include --------------------
00003A36                          3362  START
00003A36                          3363  
00003A36                          3364  ; --- INITIALIZATION -----------------------------------------------------------
00003A36                          3365  
00003A36  007C 0700               3366              ORI.W   #$0700,SR
00003A3A  4EB8 110A               3367              JSR     SYSINIT
00003A3E                          3368              *JSR     UTLINIT
00003A3E  4EB8 37DE               3369              JSR     STAINIT
00003A42                          3370  
00003A42                          3371  .LOOP
00003A42                          3372  
00003A42                          3373  ; --- UPDATE -------------------------------------------------------------------
00003A42                          3374  
00003A42                          3375  ; READ INPUT DEVICES
00003A42                          3376  
00003A42  4E41                    3377              TRAP    #KBDUPTN
00003A44                          3378  
00003A44                          3379  ; UPDATE GAME LOGIC
00003A44                          3380  
00003A44  4EB8 37EE               3381              JSR     STAUPD
00003A48                          3382  
00003A48                          3383  ; --- SYNC ---------------------------------------------------------------------
00003A48                          3384  
00003A48  4A39 00003A6A           3385  .WINT       TST.B   (SCRINTCT)
00003A4E  67F8                    3386              BEQ     .WINT
00003A50  4239 00003A6A           3387              CLR.B   (SCRINTCT)
00003A56  5239 00003A6C           3388              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
00003A5C                          3389  
00003A5C                          3390  ; --- PLOT ---------------------------------------------------------------------
00003A5C                          3391              
00003A5C  4EB8 384C               3392              JSR     STAPLOT
00003A60                          3393              
00003A60  4E40                    3394              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
00003A62                          3395  
00003A62  60DE                    3396              BRA     .LOOP
00003A64                          3397              
00003A64  FFFF FFFF               3398              SIMHALT
00003A68                          3399              
00003A68                          3400              INCLUDE "VARS.X68"
00003A68                          3401  ; ==============================================================================
00003A68                          3402  ; VARIABLES
00003A68                          3403  ; ==============================================================================
00003A68                          3404              
00003A68                          3405  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00003A68                          3406              
00003A68                          3407  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
00003A69                          3408  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
00003A6A                          3409  
00003A6A                          3410  
00003A6A                          3411  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00003A6A                          3412  
00003A6A                          3413  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00003A6B                          3414  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00003A6C                          3415  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
00003A6E                          3416              DS.W    0
00003A6E                          3417  
00003A6E                          3418  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
00003A6E                          3419  
00003A6E= 0064                    3420  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
00003A70= 0140                    3421  PLAYERPOSX      DC.W    SCRWIDTH/2
00003A72= 00F0                    3422  PLAYERPOSY      DC.W    SCRHEIGH/2
00003A74                          3423  
00003A74                          3424  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
00003A74                          3425  
00003A74= 0000                    3426  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
00003A76                          3427  
00003A76                          3428  ; --- MAP RELATED VARIABLES ----------------------------------------------------
00003A76                          3429  
00003A76= 0000                    3430  BPOSX1  DC.W    0
00003A78= 0000                    3431  BPOSY1  DC.W    0
00003A7A= 0020                    3432  BPOSX2  DC.W    32
00003A7C= 0020                    3433  BPOSY2  DC.W    32
00003A7E= 0000                    3434  LOADEDMAP   DC.W    0                       ; CURRENT MAP
00003A80= 03 00                   3435  BLWHICHCOLL DC.B    3,0 ; BLOCKS WHICH PRODUCES COLLISIONS, ENDS WITH NULL
00003A82                          3436  
00003A82                          3437  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
00003A82                          3438  
00003A82= 00                      3439  MUSICPLAYED DC.B    0
00003A84                          3440              DS.W    0
00003A84                          3441  
00003A84                          3442  ; --- FPS RELATED VARIABLES ----------------------------------------------------
00003A84                          3443  
00003A84                          3444  REALFPS     DS.W    1
00003A86= 47 4F 41 4C 3A 20 00    3445  STRFPS1     DC.B    'GOAL: ',0   ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
00003A8D= 46 50 53 20 2D 20 ...   3446  STRFPS2     DC.B    'FPS - ACTUAL: ',0
00003A9C= 46 50 53 00             3447  STRFPS3     DC.B    'FPS',0
00003AA0                          3448  
00003AA0                          3449  ; --- STATE RELATED VARIABLES --------------------------------------------------
00003AA0                          3450  
00003AA0                          3451  STACUR      DS.W    1                       ; CURRENT STATE
00003AA2                          3452  STANEXT     DS.W    1                       ; NEXT STATE
00003AA4                          3453  
00003AA4                          3454  
00003AA4                          3455  
00003AA4                          3456  
00003AA4                          3457  
00003AA4                          3458  
00003AA4                          3459  
00003AA4                          3460  -------------------- end include --------------------
00003AA4                          3461              INCLUDE "LIB/UTLVARS.X68"
00003AA4                          3462  ; =============================================================================
00003AA4                          3463  ; UTILITY VARIABLES
00003AA4                          3464  ; =============================================================================
00003AA4                          3465  
00003AA4                          3466  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00003AA6                          3467              DS.W    0
00003AA6                          3468  -------------------- end include --------------------
00003AA6                          3469              INCLUDE "LIB/DMMVARS.X68"
00003AA6                          3470  ; =============================================================================
00003AA6                          3471  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
00003AA6                          3472  ; =============================================================================
00003AA6                          3473  
00003AC0                          3474              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00003AC0                          3475  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00004740                          3476              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00004740                          3477  -------------------- end include --------------------
00004740                          3478  
00004740                          3479              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12BC
AGLADD:END          12D2
AGLKILL             10F4
AGLPLOT             12FA
AGLPLOT:END         131A
AGLPLOT:LOOP        1302
AGLUPD              12D6
AGLUPD:END          12F4
AGLUPD:LOOP         12DE
AUDINIT             36DE
AUDPLAY             3712
BLKCOLL             14A6
BLOCKSCOL           F
BLOCKSIZE           20
BLOCKSROW           14
BLWHICHCOLL         3A80
BPOSX1              3A76
BPOSX2              3A7A
BPOSY1              3A78
BPOSY2              3A7C
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                1720
DBHV                1794
DDHL                164A
DDHV                166A
DF1HL               18BE
DF1HV               189E
DF2HL               1930
DF2HV               18DE
DGHE                168A
DGHL                1808
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             3AC0
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           1982
ELEVATORMUSIC       3760
ELEVATORPLOT        27CC
ELEVATORUPDATE      29E4
ELEVATORUPDATE:HLSEL  2A18
ELEVATORUPDATE:HVSEL  29FE
ELEVATOR_MUSIC      100F
ENDBLOCK            19DA
ENDGINIT            3986
ENDGPLOT            39A2
ENDGPLOT:NOTPRINT   39D6
ENDGPLOT:TXT1       39EA
ENDGPLOT:TXT2       3A04
ENDGPLOT:TXT3       3A1C
ENDGUPD             3988
ENDGUPD:DONE        39A0
ENDMAP              19EC
FIREDSOUND          37C2
FPSTEXTPOS          2D01
FRAMES_PER_SECOND   32
GAMINIT             387A
GAMPLOT             38D8
GAMPLOT:NOPROJ2     38EA
GAMUPD              3882
GAMUPD:NOMUSIC      3898
GAMUPD:NOPROJ1      38D2
GAMUPD:NOTFIRED     38C4
HEAVENMUSIC         377E
HEAVENSOUND         1000
HEAVEN_0            1DDC
HEAVEN_1            1F2C
HEAVEN_END          2067
HEAVEN_ROOM         21A2
HELLMUSIC           37A0
HELLSOUND           1026
HELL_0              22DD
HELL_1              2418
HELL_END            2553
HELL_ROOM           268E
ISBLWHICHCOLL       1486
ISBLWHICHCOLL:BCOLL  1498
ISBLWHICHCOLL:BEND  14A4
ISBLWHICHCOLL:BNEXTCHCK  148C
ISBLWHICHCOLL:BNOCOLL  14A2
ISCPLOT             3908
ISCPLOT:DONE        393C
ISCPLOT:HINT        396E
ISCPLOT:TITLE       3942
ISCUPD              38EE
ISCUPD:DONE         3906
JMPLIST             1602
KBDDOWN             53
KBDEDGE             3A69
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             1260
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              126E
KBDUPD:LOOP         12B2
KBDUPD:PACK         12AE
KBDUPTN             1
KBDVAL              3A68
LIMAPA1             2AA0
LIMAPA2             2B9E
LIMAPA3             2DAE
LIMAPA4             2EA6
LIMAPA5             2F9E
LIMAPA6             3146
LIMAPA7             32FA
LIMAPA8             33F2
LOADEDMAP           3A7E
MAP1NODOOR          1A58
MAP1NOLIMIT1        2ADE
MAP1NOLIMIT2        2B0A
MAP1NOLIMIT3        2B3C
MAP1NOLIMIT4        2B68
MAP1NOLIMITEND      2B94
MAP2NODOOR1         1AA6
MAP2NODOOR2         1ADC
MAP2NODOOR3         1B1A
MAP2NODOOR4         1B58
MAP2NOLIMIT1        2BE2
MAP2NOLIMIT10       2DA4
MAP2NOLIMIT2        2C14
MAP2NOLIMIT3        2C46
MAP2NOLIMIT4        2C78
MAP2NOLIMIT5        2CAA
MAP2NOLIMIT6        2CDC
MAP2NOLIMIT7        2D0E
MAP2NOLIMIT8        2D40
MAP2NOLIMIT9        2D72
MAP3NODOOR          1BA6
MAP3NOLIMIT1        2DEC
MAP3NOLIMIT2        2E18
MAP3NOLIMIT3        2E44
MAP3NOLIMIT4        2E70
MAP3NOLIMIT5        2E9C
MAP4NODOOR          1BEE
MAP4NOLIMIT1        2EE4
MAP4NOLIMIT2        2F10
MAP4NOLIMIT3        2F3C
MAP4NOLIMIT4        2F68
MAP4NOLIMIT5        2F94
MAP5NODOOR          1C36
MAP5NOLIMIT1        2FDC
MAP5NOLIMIT2        3008
MAP5NOLIMIT3        3034
MAP5NOLIMIT4        3060
MAP5NOLIMIT5        308C
MAP5NOLIMIT6        30B8
MAP5NOLIMIT7        30E4
MAP5NOLIMIT8        3110
MAP5NOLIMIT9        313C
MAP6NODOOR1         1C84
MAP6NODOOR2         1CBA
MAP6NODOOR3         1CF8
MAP6NODOOR4         1D36
MAP6NOLIMIT1        3184
MAP6NOLIMIT10       32F0
MAP6NOLIMIT2        31B0
MAP6NOLIMIT3        31DC
MAP6NOLIMIT5        3208
MAP6NOLIMIT6        3234
MAP6NOLIMIT7        3260
MAP6NOLIMIT8        3292
MAP6NOLIMIT9        32BE
MAP7NODOOR          1D86
MAP7NOLIMIT1        3338
MAP7NOLIMIT2        3364
MAP7NOLIMIT3        3390
MAP7NOLIMIT4        33BC
MAP7NOLIMIT5        33E8
MAP8NODOOR1         1DD6
MAP8NOLIMIT1        3430
MAP8NOLIMIT2        345C
MAP8NOLIMIT3        3488
MAP8NOLIMIT4        34B4
MAP8NOLIMIT5        34E0
MAPA1               1A16
MAPA2               1A5E
MAPA3               1B5E
MAPA4               1BAC
MAPA5               1BF4
MAPA6               1C3C
MAPA7               1D3C
MAPA8               1D8C
MAPPLOT             1524
MAPSEL              153C
MAPUPD              15A8
MOVEHOR             3548
MOVEHOR:NORIGHTEDGE  356C
MOVEHOR:NOTLEFTEDGE  3558
MOVEVER             356E
MOVEVER:NOLOWEREDGE  3592
MOVEVER:NOTUPPEREDGE  357E
MSCSEL              372A
MUSICPLAYED         3A82
NEWLINE             19B6
NEXT                15F4
NOLIMIT             34EA
NOLIMIT:DOWN        352E
NOLIMIT:NOTMOVED    3544
NOLIMIT:RIGHT       3518
NOLIMIT:UP          3502
NOLIMITMENU         2A88
NPROJ               3A74
PLAYERHEALTH        3A6E
PLAYERHEIGHT        20
PLAYERINIT          2A32
PLAYERPLOT          3594
PLAYERPOSX          3A70
PLAYERPOSY          3A72
PLAYERSPEED         4
PLAYERUPD           2A34
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            35DC
PROJINIT:FDOWN      3614
PROJINIT:FRIGHT     3602
PROJINIT:FUP        35F2
PROJINIT:NOTFDOWN   3622
PROJINIT:SHOOT      362C
PROJPLOT            369C
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             3640
PROJUPD:PROJCOLL    3690
PROJUPD:PROJNOCOLL  368A
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             3A84
SCRCYCCT            3A6B
SCRHEIGH            1E0
SCRINIT             1142
SCRINTCT            3A6A
SCRINTFPS           3A6C
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             1198
SCRTIM              1240
SCRTIM1S            124E
SCRUPTN             0
SCRWIDTH            280
STACUR              3AA0
STAEMPTY            3878
STAINIT             37DE
STANEXT             3AA2
STANONE             FFFFFFFF
STAPLOT             384C
STAPLOT:PLTTBL      3868
START               3A36
START:LOOP          3A42
START:WINT          3A48
STAUPD              37EE
STAUPD:DOUPD        3814
STAUPD:INITBL       382C
STAUPD:UPDTBL       383C
STRFPS1             3A86
STRFPS2             3A8D
STRFPS3             3A9C
SYSINIT             110A
TRIANGLE            298C
TRIANGLE:ISPOSITIVE  29DA
TRIANGLE:UPWARDS    29A8
UTLCHRWD            8
UTLINIT             1320
UTLPRINT            1336
UTLPRINT:ENDLOOP    1348
UTLPRINT:LOOP       133E
UTLRAND             1368
UTLRAND:RANDVEC     1386
UTLRNDIX            3AA4
