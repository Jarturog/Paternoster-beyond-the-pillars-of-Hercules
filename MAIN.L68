000025E4 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 16/01/2023 12:47:22

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002D01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/14)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000                            37  ;no lo usas SNDPLTN     EQU     3                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000                            45  
00001000  =00000004                 46  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 47  PLAYERWIDTH     EQU     32
00001000  =00000020                 48  PLAYERHEIGHT    EQU     32
00001000                            49  
00001000                            50  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            51  
00001000  =00000010                 52  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 53  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 54  PROJSPEEDX      EQU     8
00001000  =00000008                 55  PROJSPEEDY      EQU     8
00001000                            56  
00001000                            57  ; --- MUSIC RELATED CONSTANTS --------------------------------------------------
00001000                            58  
00001000= 53 4E 44 2F 4D 55 ...     59  HEAVENSOUND     DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     60  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     61  HELLSOUND       DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     62  PROJ_SOUND      DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            63  
00001048                            64  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001048                            65  
00001048  =FFFFFFFF                 66  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001048                            67  
00001048                            68  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001048                            69  
00001048  =00000014                 70  BLOCKSROW   EQU     20                      ; BLOCKS PER ROW
00001048  =0000000F                 71  BLOCKSCOL   EQU     15                      ; BLOCKS PER COLUMN
00001048  =00000020                 72  BLOCKSIZE   EQU     32                      ; BLOCK SIZE IN PIXELS
00001048                            73  
00001048                            74  ; --- ELEVATOR RELATED CONSTANTS -----------------------------------------------
00001048                            75  
00001048  =000000CC                 76  COLBUTHL    EQU     $000000CC
00001048  =00EEEEEE                 77  COLBUTHV    EQU     $00EEEEEE
00001048                            78  
00001048                            79  ; --- INTRO RELATED CONSTANTS --------------------------------------------------
00001048                            80  
00001048  =000000D5                 81  BTONPOSX    EQU     SCRWIDTH/3
00001048  =00000170                 82  BTONPOSY    EQU     SCRHEIGH-112
00001048  =000000DA                 83  BTONWIDTH   EQU     218
00001048  =00000020                 84  BTONHEIGHT  EQU     32
00001048                            85  
00001048                            86  
00001048                            87  
00001048                            88  
00001048                            89  
00001048                            90  
00001048                            91  
00001048                            92  
00001048                            93  
00001048                            94  
00001048                            95  
00001048                            96  -------------------- end include --------------------
00001048                            97              INCLUDE "LIB/DMMCONST.X68"
00001048                            98  ; =============================================================================
00001048                            99  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                           100  ; =============================================================================
00001048                           101  
00001048  =00000040                102  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                103  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                104  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                105  -------------------- end include --------------------
00001048                           106              INCLUDE "LIB/UTLCONST.X68"         
00001048                           107  ; ==============================================================================
00001048                           108  ; UTIL CONSTANTS
00001048                           109  ; ==============================================================================
00001048                           110  
00001048  =00000008                111  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001048  =00000008                112  -------------------- end include --------------------
00001048                           113              INCLUDE "LIB/DMMCODE.X68"
00001048                           114  ; =============================================================================
00001048                           115  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                           116  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                           117  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                           118  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                           119  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                           120  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                           121  ; =============================================================================
00001048                           122  
00001048                           123  ; -----------------------------------------------------------------------------
00001048                           124  DMMINIT
00001048                           125  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                           126  ; INPUT    - NONE
00001048                           127  ; OUTPUT   - NONE
00001048                           128  ; MODIFIES - NONE
00001048                           129  ; -----------------------------------------------------------------------------
00001048  48E7 8080                130              MOVEM.L D0/A0,-(A7)
0000104C  41F9 000026C0            131              LEA     DMMDATA,A0
00001052  303C 0031                132              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                133  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            134              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                135              DBRA.W  D0,.LOOP
00001064  4CDF 0101                136              MOVEM.L (A7)+,D0/A0
00001068  4E75                     137              RTS
0000106A                           138  
0000106A                           139  ; -----------------------------------------------------------------------------
0000106A                           140  DMMFIRST
0000106A                           141  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           142  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           143  ; INPUT    - NONE
0000106A                           144  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           145  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           146  ; -----------------------------------------------------------------------------
0000106A  41F9 000026C0            147              LEA     DMMDATA,A0
00001070  4A58                     148  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                149              BNE     DMMFRFND
00001076  D1FC 0000003E            150              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 0000333F            151  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     152              BLT     DMMFRLOP
00001084  207C 00000000            153              MOVE.L  #0,A0
0000108A  4E75                     154  DMMFRFND    RTS
0000108C                           155  
0000108C                           156  ; -----------------------------------------------------------------------------
0000108C                           157  DMMNEXT
0000108C                           158  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           159  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           160  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           161  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           162  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           163  ; -----------------------------------------------------------------------------
0000108C  2F00                     164              MOVE.L  D0,-(A7)
0000108E  2008                     165              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            166              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            167              ADD.L   #DMMBSIZE,D0
0000109C  2040                     168              MOVE.L  D0,A0
0000109E  201F                     169              MOVE.L  (A7)+,D0
000010A0  60DA                     170              BRA     DMMFRCOM
000010A2                           171  
000010A2                           172  ; -----------------------------------------------------------------------------
000010A2                           173  DMMFRSTO
000010A2                           174  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           175  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           176  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           177  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           178  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           179  ; -----------------------------------------------------------------------------
000010A2  41F9 000026C0            180              LEA     DMMDATA,A0
000010A8  B058                     181  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                182              BEQ     DMMFFND
000010AE  D1FC 0000003E            183              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 0000333F            184  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     185              BLT     DMMFLOOP
000010BC  207C 00000000            186              MOVE.L  #0,A0
000010C2  4E75                     187  DMMFFND     RTS
000010C4                           188  
000010C4                           189  ; -----------------------------------------------------------------------------
000010C4                           190  DMMNEXTO
000010C4                           191  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           192  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           193  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           194  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           195  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           196  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           197  ; -----------------------------------------------------------------------------
000010C4  2F00                     198              MOVE.L  D0,-(A7)
000010C6  2008                     199              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            200              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            201              ADD.L   #DMMBSIZE,D0
000010D4  2040                     202              MOVE.L  D0,A0
000010D6  201F                     203              MOVE.L  (A7)+,D0
000010D8  60DA                     204              BRA     DMMFCOM
000010DA                           205  
000010DA                           206  ; -----------------------------------------------------------------------------
000010DA                           207  DMMALLOC
000010DA                           208  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           209  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           210  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           211  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           212  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           213  ; -----------------------------------------------------------------------------
000010DA  3F00                     214              MOVE.W  D0,-(A7)
000010DC  4240                     215              CLR.W   D0
000010DE  4EB8 10A2                216              JSR     DMMFRSTO
000010E2  301F                     217              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            218              CMP.L   #0,A0
000010EA  6700 0006                219              BEQ     .END
000010EE  3140 FFFE                220              MOVE.W  D0,-2(A0)
000010F2  4E75                     221  .END        RTS
000010F4                           222  
000010F4                           223  ; -----------------------------------------------------------------------------
000010F4                           224  DMMFREE
000010F4                           225  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           226  ; SYSTEM (0)
000010F4                           227  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           228  ; OUTPUT   - NONE
000010F4                           229  ; MODIFIES - NONE
000010F4                           230  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                231              MOVEM.L D0/A0,-(A7)
000010F8  2008                     232              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            233              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     234              MOVE.L  D0,A0
00001102  4250                     235              CLR.W   (A0)
00001104  4CDF 0101                236              MOVEM.L (A7)+,D0/A0
00001108  4E75                     237              RTS
00001108  4E75                     238  -------------------- end include --------------------
0000110A                           239              INCLUDE "SYSTEM.X68"
0000110A                           240  ; ==============================================================================
0000110A                           241  ; SYSTEM
0000110A                           242  ; ==============================================================================
0000110A                           243              
0000110A                           244  ; ------------------------------------------------------------------------------
0000110A                           245  SYSINIT
0000110A                           246  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           247  ; INPUT    : NONE
0000110A                           248  ; OUTPUT   : NONE
0000110A                           249  ; MODIFIES : NONE
0000110A                           250  ; ------------------------------------------------------------------------------
0000110A                           251  
0000110A  21FC 00001198 0080       252              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000126E 0084       253              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 00001240 0064       254              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001122  21FC 0000124E 0068       255              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
0000112A                           256              
0000112A  4EB8 1048                257              JSR     DMMINIT
0000112E  4EB9 00001142            258              JSR     SCRINIT
00001134  4EB9 00001260            259              JSR     KBDINIT 
0000113A                           260              
0000113A  40E7                     261              MOVE.W  SR,-(A7)
0000113C  0257 D8FF                262              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
00001140  4E73                     263              RTE
00001142                           264              
00001142                           265  ; ------------------------------------------------------------------------------
00001142                           266  SCRINIT
00001142                           267  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001142                           268  ; ENABLE DOUBLE BUFFER.
00001142                           269  ; INPUT    : NONE
00001142                           270  ; OUTPUT   : NONE
00001142                           271  ; MODIFIES : NONE
00001142                           272  ; ------------------------------------------------------------------------------
00001142                           273  
00001142  48E7 F000                274              MOVEM.L D0-D3,-(A7)
00001146                           275  
00001146                           276              ; SET SCREEN RESOLUTION
00001146  103C 0021                277              MOVE.B  #33,D0
0000114A  223C 028001E0            278              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001150  4E4F                     279              TRAP    #15
00001152                           280              
00001152                           281              ; SET WINDOWED MODE
00001152  7201                     282              MOVE.L  #1,D1
00001154  4E4F                     283              TRAP    #15
00001156                           284              
00001156                           285              ; CLEAR SCREEN
00001156  103C 000B                286              MOVE.B  #11,D0
0000115A  323C FF00                287              MOVE.W  #$FF00,D1
0000115E  4E4F                     288              TRAP    #15
00001160                           289  
00001160                           290              ; ENABLE DOUBLE BUFFER
00001160  103C 005C                291              MOVE.B  #92,D0
00001164  123C 0011                292              MOVE.B  #17,D1
00001168  4E4F                     293              TRAP    #15
0000116A                           294              
0000116A                           295              ; ENABLE BOTH TIMED INTERRUPT
0000116A  103C 0020                296              MOVE.B  #32,D0
0000116E  123C 0006                297              MOVE.B  #6,D1
00001172  143C 0081                298              MOVE.B  #$80|SCRINTN,D2
00001176  7614                     299              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001178  4E4F                     300              TRAP    #15
0000117A  143C 0082                301              MOVE.B  #$80|SCRINTFPSN,D2
0000117E  263C 000003E8            302              MOVE.L  #1000,D3
00001184  4E4F                     303              TRAP    #15
00001186                           304              
00001186                           305              ; CLEAR INTERRUPT COUNTER
00001186  4279 00002618            306              CLR.W   (SCRINTCT)
0000118C  4239 0000261A            307              CLR.B   (SCRINTFPS) 
00001192                           308              
00001192  4CDF 000F                309              MOVEM.L (A7)+,D0-D3
00001196                           310              
00001196  4E75                     311              RTS
00001198                           312  
00001198                           313  ; ------------------------------------------------------------------------------
00001198                           314  SCRPLOT
00001198                           315  ; UPDATES DOUBLE BUFFER
00001198                           316  ; INPUT    : NONE
00001198                           317  ; OUTPUT   : NONE
00001198                           318  ; MODIFIES : NONE
00001198                           319  ; ------------------------------------------------------------------------------
00001198  48E7 E000                320              MOVEM.L D0-D2,-(A7)
0000119C  2F09                     321              MOVE.L  A1,-(A7)
0000119E                           322              
0000119E                           323              ; PLOT ACTUAL FPS AND GOAL FPS
0000119E                           324              
0000119E  103C 0051                325              MOVE.B  #81,D0
000011A2  7200                     326              MOVE.L  #$00000000,D1 ; FILL COLOR
000011A4  4E4F                     327              TRAP    #15
000011A6                           328              
000011A6  103C 0050                329              MOVE.B  #80,D0
000011AA  223C 00FFFFFF            330              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011B0  4E4F                     331              TRAP    #15
000011B2                           332              
000011B2  103C 000B                333              MOVE.B  #11,D0
000011B6  223C 00002D01            334              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011BC  4E4F                     335              TRAP    #15
000011BE                           336              
000011BE  43F9 0000267A            337              LEA.L   STRFPS1,A1 
000011C4  103C 000E                338              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011C8  4E4F                     339              TRAP    #15
000011CA                           340              
000011CA  103C 000B                341              MOVE.B  #11,D0
000011CE  323C 3601                342              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011D2  4E4F                     343              TRAP    #15
000011D4                           344              
000011D4  5E89                     345              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011D6  103C 000E                346              MOVE.B  #14,D0  
000011DA  4E4F                     347              TRAP    #15 
000011DC                           348              
000011DC  103C 000B                349              MOVE.B  #11,D0
000011E0  323C 4701                350              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E4  4E4F                     351              TRAP    #15
000011E6                           352              
000011E6  D3FC 0000000F            353              ADDA.L  #15,A1 ; PLOT 'FPS'
000011EC  103C 000E                354              MOVE.B  #14,D0 
000011F0  4E4F                     355              TRAP    #15
000011F2                           356              
000011F2  0643 0014                357              ADD.W   #20,D3
000011F6  103C 000B                358              MOVE.B  #11,D0
000011FA  323C 3301                359              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
000011FE  4E4F                     360              TRAP    #15
00001200                           361              
00001200  7232                     362              MOVE.L  #FRAMES_PER_SECOND,D1
00001202  740A                     363              MOVE.L  #10,D2
00001204  103C 000F                364              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001208  4E4F                     365              TRAP    #15
0000120A                           366              
0000120A  0643 0014                367              ADD.W   #20,D3
0000120E  103C 000B                368              MOVE.B  #11,D0
00001212  323C 4401                369              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001216  4E4F                     370              TRAP    #15
00001218                           371              
00001218  4281                     372              CLR.L   D1
0000121A  1239 00002678            373              MOVE.B  (REALFPS),D1
00001220  740A                     374              MOVE.L  #10,D2
00001222  103C 000F                375              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001226  4E4F                     376              TRAP    #15
00001228                           377              
00001228                           378              ; SWITCH BUFFERS
00001228  103C 005E                379              MOVE.B  #94,D0
0000122C  4E4F                     380              TRAP    #15
0000122E                           381              
0000122E                           382              ; CLEAR HIDDEN BUFFER
0000122E  103C 000B                383              MOVE.B  #11,D0
00001232  323C FF00                384              MOVE.W  #$FF00,D1
00001236  4E4F                     385              TRAP    #15
00001238                           386              
00001238  225F                     387              MOVE.L  (A7)+,A1
0000123A  4CDF 0007                388              MOVEM.L (A7)+,D0-D2
0000123E  4E73                     389              RTE
00001240                           390              
00001240                           391  ; ------------------------------------------------------------------------------
00001240                           392  SCRTIM
00001240                           393  ; TIMED INTERRUPT SERVICE ROUTINE
00001240                           394  ; INPUT    : NONE
00001240                           395  ; OUTPUT   : NONE
00001240                           396  ; MODIFIES : NONE
00001240                           397  ; ------------------------------------------------------------------------------
00001240  5239 00002618            398              ADDQ.B  #1,(SCRINTCT)
00001246  5239 00002619            399              ADDQ.B  #1,(SCRCYCCT)
0000124C  4E73                     400              RTE
0000124E                           401              
0000124E                           402  ; ------------------------------------------------------------------------------
0000124E                           403  SCRTIM1S
0000124E                           404  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000124E                           405  ; INPUT    : NONE
0000124E                           406  ; OUTPUT   : NONE
0000124E                           407  ; MODIFIES : NONE
0000124E                           408  ; ------------------------------------------------------------------------------
0000124E  13F9 0000261A 00002678   409              MOVE.B  (SCRINTFPS),REALFPS
00001258  4239 0000261A            410              CLR.B   SCRINTFPS
0000125E  4E73                     411              RTE
00001260                           412  
00001260                           413  ; ------------------------------------------------------------------------------
00001260                           414  KBDINIT
00001260                           415  ; INIT KEYBOARD
00001260                           416  ; INPUT    : NONE
00001260                           417  ; OUTPUT   : NONE
00001260                           418  ; MODIFIES : NONE
00001260                           419  ; ------------------------------------------------------------------------------
00001260  4239 00002616            420              CLR.B   (KBDVAL)
00001266  4239 00002617            421              CLR.B   (KBDEDGE)
0000126C  4E75                     422              RTS
0000126E                           423  
0000126E                           424  ; ------------------------------------------------------------------------------
0000126E                           425  KBDUPD
0000126E                           426  ; UPDATE KEYBOARD INFO.  
0000126E                           427  ; 7 -> FIRE DOWN
0000126E                           428  ; 6 -> FIRE RIGHT
0000126E                           429  ; 5 -> FIRE UP
0000126E                           430  ; 4 -> FIRE LEFT
0000126E                           431  ; 3 -> DOWN
0000126E                           432  ; 2 -> RIGHT
0000126E                           433  ; 1 -> UP
0000126E                           434  ; 0 -> LEFT
0000126E                           435  ; INPUT    : NONE
0000126E                           436  ; OUTPUT   : NONE
0000126E                           437  ; MODIFIES : NONE
0000126E                           438  ; ------------------------------------------------------------------------------
0000126E                           439  
0000126E  48E7 F000                440              MOVEM.L D0-D3,-(A7)
00001272                           441  
00001272                           442              ; READ FIRST PART
00001272  103C 0013                443              MOVE.B  #19,D0
00001276  223C 28272625            444              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000127C  4E4F                     445              TRAP    #15
0000127E                           446              
0000127E                           447              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000127E  4EB9 000012AE            448              JSR     .PACK
00001284                           449  
00001284                           450              ; READ SECOND PART
00001284  223C 53445741            451              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000128A  4E4F                     452              TRAP    #15
0000128C                           453  
0000128C                           454              ; CONVERT TO DESIRED FORMAT
0000128C  4EB9 000012AE            455              JSR     .PACK
00001292                           456              
00001292                           457              ; COMPUTE KBDEDGE
00001292  1039 00002616            458              MOVE.B  (KBDVAL),D0
00001298  4600                     459              NOT.B   D0
0000129A  C002                     460              AND.B   D2,D0
0000129C  13C0 00002617            461              MOVE.B  D0,(KBDEDGE)
000012A2                           462              
000012A2                           463              ; STORE KBDVAL
000012A2  13C2 00002616            464              MOVE.B  D2,(KBDVAL)
000012A8                           465              
000012A8  4CDF 000F                466              MOVEM.L (A7)+,D0-D3
000012AC                           467  
000012AC  4E73                     468              RTE
000012AE                           469              
000012AE  363C 0003                470  .PACK       MOVE.W  #3,D3
000012B2  E189                     471  .LOOP       LSL.L   #8,D1
000012B4  E312                     472              ROXL.B  #1,D2
000012B6  51CB FFFA                473              DBRA.W  D3,.LOOP
000012BA  4E75                     474              RTS
000012BC                           475  
000012BC                           476  
000012BC                           477  
000012BC                           478  -------------------- end include --------------------
000012BC                           479              INCLUDE "LIB/AGLCODE.X68"
000012BC                           480  ; =============================================================================
000012BC                           481  ; AGENT MANAGEMENT
000012BC                           482  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012BC                           483  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012BC                           484  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012BC                           485  ; +8:END    : DATA (AGENT SPECIFIC)
000012BC                           486  ; =============================================================================
000012BC                           487  
000012BC                           488  ; -----------------------------------------------------------------------------
000012BC                           489  AGLADD
000012BC                           490  ; CREATES A NEW AGENT
000012BC                           491  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012BC                           492  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012BC                           493  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012BC                           494  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012BC                           495  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012BC                           496  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012BC                           497  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012BC                           498  ; OUTPUT   - NONE
000012BC                           499  ; MODIFIES - NONE
000012BC                           500  ; -----------------------------------------------------------------------------
000012BC  2F08                     501              MOVE.L  A0,-(A7)
000012BE  4EB8 10DA                502              JSR     DMMALLOC
000012C2  B1FC 00000000            503              CMP.L   #0,A0
000012C8  6700 0008                504              BEQ     .END
000012CC  20CA                     505              MOVE.L  A2,(A0)+
000012CE  20CB                     506              MOVE.L  A3,(A0)+
000012D0  4E91                     507              JSR     (A1)
000012D2  205F                     508  .END        MOVE.L  (A7)+,A0
000012D4  4E75                     509              RTS
000012D6                           510  
000012D6                           511  ; -----------------------------------------------------------------------------
000012D6                           512  AGLUPD
000012D6                           513  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012D6                           514  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012D6                           515  ; INPUT    - NONE
000012D6                           516  ; OUTPUT   - NONE
000012D6                           517  ; MODIFIES - NONE
000012D6                           518  ; -----------------------------------------------------------------------------
000012D6  48E7 00C0                519              MOVEM.L A0-A1,-(A7)
000012DA  4EB8 106A                520              JSR     DMMFIRST
000012DE  B1FC 00000000            521  .LOOP       CMP.L   #0,A0
000012E4  6700 000E                522              BEQ     .END
000012E8  2250                     523              MOVE.L  (A0),A1
000012EA  5088                     524              ADD.L   #8,A0
000012EC  4E91                     525              JSR     (A1)
000012EE  4EB8 108C                526              JSR     DMMNEXT
000012F2  60EA                     527              BRA     .LOOP
000012F4  4CDF 0300                528  .END        MOVEM.L (A7)+,A0-A1
000012F8  4E75                     529              RTS
000012FA                           530  
000012FA                           531  ; -----------------------------------------------------------------------------
000012FA                           532  AGLPLOT
000012FA                           533  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012FA                           534  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012FA                           535  ; INPUT    - NONE
000012FA                           536  ; OUTPUT   - NONE
000012FA                           537  ; MODIFIES - NONE
000012FA                           538  ; -----------------------------------------------------------------------------
000012FA  48E7 00C0                539              MOVEM.L A0-A1,-(A7)
000012FE  4EB8 106A                540              JSR     DMMFIRST
00001302  B1FC 00000000            541  .LOOP       CMP.L   #0,A0
00001308  6700 0010                542              BEQ     .END
0000130C  2268 0004                543              MOVE.L  4(A0),A1
00001310  5088                     544              ADD.L   #8,A0
00001312  4E91                     545              JSR     (A1)
00001314  4EB8 108C                546              JSR     DMMNEXT
00001318  60E8                     547              BRA     .LOOP
0000131A  4CDF 0300                548  .END        MOVEM.L (A7)+,A0-A1
0000131E  4E75                     549              RTS
00001320                           550  
00001320                           551  ; -----------------------------------------------------------------------------
00001320  =000010F4                552  AGLKILL     EQU     DMMFREE
00001320                           553  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001320                           554  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001320                           555  ; OUTPUT   - NONE
00001320                           556  ; MODIFIES - NONE
00001320                           557  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001320                           558  ; -----------------------------------------------------------------------------
00001320                           559  -------------------- end include --------------------
00001320                           560              INCLUDE "LIB/UTLCODE.X68"
00001320                           561  ; =============================================================================
00001320                           562  ; UTILITY CODE
00001320                           563  ; =============================================================================
00001320                           564  
00001320                           565  ; -----------------------------------------------------------------------------
00001320                           566  UTLINIT
00001320                           567  ; INITIALIZES UTILITY CODE
00001320                           568  ; INPUT    - NONE
00001320                           569  ; OUTPUT   - NONE
00001320                           570  ; MODIFIES - NONE
00001320                           571  ; -----------------------------------------------------------------------------
00001320  48E7 C000                572              MOVEM.L D0-D1,-(A7)
00001324  103C 0008                573              MOVE.B  #8,D0
00001328  4E4F                     574              TRAP    #15
0000132A  13C1 00002698            575              MOVE.B  D1,(UTLRNDIX)
00001330  4CDF 0003                576              MOVEM.L (A7)+,D0-D1
00001334  4E75                     577              RTS
00001336                           578  
00001336                           579  ; -----------------------------------------------------------------------------
00001336                           580  UTLPRINT
00001336                           581  ; PRINT SCREEN CENTERED TEXT
00001336                           582  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001336                           583  ;            D0.B SCREEN ROW TO PRINT TEXT
00001336                           584  ; OUTPUT   : D0.B NEXT ROW
00001336                           585  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001336                           586  ; -----------------------------------------------------------------------------
00001336  48E7 C0C0                587              MOVEM.L D0-D1/A0-A1,-(A7)
0000133A  4201                     588              CLR.B   D1
0000133C  2248                     589              MOVE.L  A0,A1
0000133E  4A18                     590  .LOOP       TST.B   (A0)+
00001340  6700 0006                591              BEQ     .ENDLOOP
00001344  5201                     592              ADDQ.B  #1,D1
00001346  60F6                     593              BRA     .LOOP
00001348  E209                     594  .ENDLOOP    LSR.B   #1,D1
0000134A  0401 0028                595              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000134E  4401                     596              NEG.B   D1
00001350  E141                     597              ASL.W   #8,D1
00001352  8240                     598              OR.W    D0,D1
00001354  103C 000B                599              MOVE.B  #11,D0
00001358  4E4F                     600              TRAP    #15
0000135A  103C 000D                601              MOVE.B  #13,D0
0000135E  4E4F                     602              TRAP    #15
00001360  4CDF 0303                603              MOVEM.L (A7)+,D0-D1/A0-A1
00001364  5200                     604              ADDQ.B  #1,D0
00001366  4E75                     605              RTS
00001368                           606  
00001368                           607  ; -----------------------------------------------------------------------------
00001368                           608  UTLRAND
00001368                           609  ; PROVIDES A PSEUDO-RANDOM BYTE
00001368                           610  ; INPUT    - NONE
00001368                           611  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001368                           612  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001368                           613  ; -----------------------------------------------------------------------------
00001368  2F08                     614              MOVE.L  A0,-(A7)
0000136A  41F9 00001386            615              LEA     .RANDVEC,A0
00001370  4280                     616              CLR.L   D0
00001372  1039 00002698            617              MOVE.B  (UTLRNDIX),D0
00001378  1030 0800                618              MOVE.B  (A0,D0.L),D0
0000137C  5239 00002698            619              ADDQ.B  #1,(UTLRNDIX)
00001382  205F                     620              MOVE.L  (A7)+,A0
00001384  4E75                     621              RTS
00001386                           622  
00001386                           623  
00001386= A2 EE 9A 0C F5 24 ...    624  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000138E= 2A A3 51 26 E0 AC ...    625              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001396= 75 51 CA FD 33 EB ...    626              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000139E= 60 CC E7 B8 9A EB ...    627              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013A6= 1D 76 B5 95 B0 89 ...    628              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013AE= 39 15 48 C9 6E CA ...    629              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013B6= 43 E7 E2 7C 37 25 ...    630              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013BE= E9 94 CE E9 E4 52 ...    631              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013C6= 37 6D 9A 84 A2 28 ...    632              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013CE= 19 E2 C6 77 80 D4 ...    633              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013D6= 0A 5A 32 67 33 C2 ...    634              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013DE= 59 80 DC 0E 57 FC ...    635              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013E6= 8A AB BC F7 07 4D ...    636              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013EE= EF D5 77 6E 1E BB ...    637              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013F6= D6 E0 2A 8F BD 28 ...    638              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013FE= 13 4F 66 EC 0A 64 ...    639              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001406= 56 52 9A 16 9B 90 ...    640              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000140E= 06 8A A4 F7 01 DA ...    641              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001416= F2 E7 77 28 B1 76 ...    642              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000141E= A4 42 E3 81 B1 67 ...    643              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001426= BF CE FA 16 BF 38 ...    644              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000142E= D1 8B 50 0C 5F 49 ...    645              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001436= DE 4C 14 A2 40 DC ...    646              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000143E= B6 9B 0A 38 5D AB ...    647              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001446= E2 1B DD 75 15 82 ...    648              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000144E= 8A 26 51 30 9F 47 ...    649              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001456= 1E 8A BB 71 C6 6E ...    650              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000145E= 9F 47 E5 34 94 27 ...    651              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001466= 7D 06 D6 BA 30 0F ...    652              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000146E= EC 7F 7E 03 CF 2D ...    653              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001476= 94 5B 23 F2 8B CD ...    654              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000147E= 74 33 EC B9 0F D5 ...    655              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001486                           656  
00001486                           657  -------------------- end include --------------------
00001486                           658              INCLUDE "BLOCKS.X68"
00001486                           659  
00001486                           660  ; -----------------------------------------------------------------------------
00001486                           661  ISBLWHICHCOLL 
00001486                           662  ; CHECKS IF THE BLOCK IN D4 PRODUCES COLLISIONS
00001486                           663  ; INPUT    - D4.B
00001486                           664  ; OUTPUT   - ALL 1'S IF D4.L PRODUCES COLLISIONS, ALL 0'S IF NOT
00001486                           665  ; MODIFIES - D4.L, A0
00001486                           666  ; -----------------------------------------------------------------------------
00001486  41F9 0000262C            667              LEA.L   BLWHICHCOLL, A0
0000148C  4A10                     668  .BNEXTCHCK  TST.B   (A0)
0000148E  6712                     669              BEQ.B   .BNOCOLL
00001490  B810                     670              CMP.B   (A0),D4
00001492  6704                     671              BEQ.B   .BCOLL
00001494  5288                     672              ADDA.L  #1,A0
00001496  60F4                     673              BRA     .BNEXTCHCK
00001498  0084 FFFFFFFF            674  .BCOLL      ORI.L   #$FFFFFFFF, D4
0000149E  6000 0004                675              BRA     .BEND
000014A2  4284                     676  .BNOCOLL    CLR.L   D4
000014A4                           677  .BEND
000014A4  4E75                     678              RTS
000014A6                           679  
000014A6                           680  ; -----------------------------------------------------------------------------
000014A6                           681  BLKCOLL 
000014A6                           682  ; DETECTS BLOCK COLLISIONS
000014A6                           683  ; INPUT    - D0 TOP LEFT CORNER OF OBJECT, D1 BOTTOM RIGHT, WHERE UPPER WORD
000014A6                           684  ;            IS THE X COORDINATE AND LOWER WORD Y COORDINATE
000014A6                           685  ; OUTPUT   - ALL 1'S IN THE THE REGISTER THAT COLLIDES WITH A BLOCK
000014A6                           686  ;            THAT CANNOT BE TRAVERSED. THESE ARE D0 FOR LEFT UPPER BLOCK,
000014A6                           687  ;            D1 FOR RIGHT UPPER BLOCK, D2 FOR LEFT LOWER BLOCK AND D3 FOR 
000014A6                           688  ;            RIGHT LOWER BLOCK
000014A6                           689  ; MODIFIES - D0.L, D1.L, D2.L, D3.L
000014A6                           690  ; -----------------------------------------------------------------------------
000014A6  48E7 0E80                691              MOVEM.L D4-D6/A0,-(A7)
000014AA                           692              
000014AA  7810                     693              MOVE.L  #16,D4
000014AC  3400                     694              MOVE.W  D0,D2   ; D2 CONTAINS X LEFT
000014AE  E8A8                     695              LSR.L   D4,D0   ; D0 CONTAINS Y UPPER
000014B0  3601                     696              MOVE.W  D1,D3   ; D3 CONTAINS X RIGHT
000014B2  E8A9                     697              LSR.L   D4,D1   ; D1 CONTAINS Y LOWER
000014B4                           698              
000014B4  48C0                     699              EXT.L   D0
000014B6  48C1                     700              EXT.L   D1
000014B8  48C2                     701              EXT.L   D2
000014BA  48C3                     702              EXT.L   D3
000014BC                           703              
000014BC  80FC 0020                704              DIVU.W  #BLOCKSIZE,D0   ; LEFT BLOCK
000014C0  82FC 0020                705              DIVU.W  #BLOCKSIZE,D1   ; RIGHT BLOCK
000014C4  84FC 0020                706              DIVU.W  #BLOCKSIZE,D2   ; UPPER BLOCK
000014C8  86FC 0020                707              DIVU.W  #BLOCKSIZE,D3   ; LOWER BLOCK
000014CC                           708              
000014CC  48C0                     709              EXT.L   D0
000014CE  48C1                     710              EXT.L   D1
000014D0  48C2                     711              EXT.L   D2
000014D2  48C3                     712              EXT.L   D3
000014D4                           713              
000014D4  7815                     714              MOVE.L  #BLOCKSROW+1,D4 ; +1 BECAUSE OF NULL
000014D6  C8C2                     715              MULU.W  D2,D4           ; INDEX OF COLUMN OF UPPER LEFT AND RIGHT BLOCKS
000014D8  7A15                     716              MOVE.L  #BLOCKSROW+1,D5 ; +1 BECAUSE OF NULL
000014DA  CAC3                     717              MULU.W  D3,D5           ; INDEX OF COLUMN OF LOWER LEFT AND RIGHT BLOCKS
000014DC                           718              
000014DC  3C39 00002630            719              MOVE.W  (LOADEDMAP),D6
000014E2  48C6                     720              EXT.L   D6
000014E4  CCFC 0004                721              MULU    #4,D6
000014E8  41F9 00002652            722              LEA.L   MAPLIST,A0
000014EE  D1C6                     723              ADDA.L  D6,A0
000014F0  2050                     724              MOVEA.L (A0),A0         ; CURRENT MAP ADDRESS
000014F2                           725              
000014F2  2248                     726              MOVEA.L A0,A1
000014F4  D3C5                     727              ADDA.L  D5,A1   
000014F6  D3C1                     728              ADDA.L  D1,A1           ; RIGHT LOWER BLOCK
000014F8  1611                     729              MOVE.B  (A1),D3         ; STORING BOTTOM RIGHT BLOCK IN D3
000014FA                           730              
000014FA  2248                     731              MOVEA.L A0,A1
000014FC  D3C5                     732              ADDA.L  D5,A1   
000014FE  D3C0                     733              ADDA.L  D0,A1           ; LEFT LOWER BLOCK
00001500  1411                     734              MOVE.B  (A1),D2         ; STORING BOTTOM LEFT BLOCK IN D2
00001502                           735              
00001502  2248                     736              MOVEA.L A0,A1
00001504  D3C4                     737              ADDA.L  D4,A1   
00001506  D3C1                     738              ADDA.L  D1,A1           ; RIGHT UPPER BLOCK
00001508  1211                     739              MOVE.B  (A1),D1         ; STORING TOP RIGHT BLOCK IN D1
0000150A                           740              
0000150A  2248                     741              MOVEA.L A0,A1
0000150C  D3C4                     742              ADDA.L  D4,A1   
0000150E  D3C0                     743              ADDA.L  D0,A1           ; LEFT UPPER BLOCK
00001510  1011                     744              MOVE.B  (A1),D0         ; STORING TOP LEFT BLOCK IN D0
00001512                           745              
00001512  1800                     746              MOVE.B  D0,D4
00001514  4EB8 1486                747              JSR     ISBLWHICHCOLL
00001518  2004                     748              MOVE.L  D4,D0
0000151A                           749              
0000151A  1801                     750              MOVE.B  D1,D4
0000151C  4EB8 1486                751              JSR     ISBLWHICHCOLL
00001520  2204                     752              MOVE.L  D4,D1
00001522                           753              
00001522  1802                     754              MOVE.B  D2,D4
00001524  4EB8 1486                755              JSR     ISBLWHICHCOLL
00001528  2404                     756              MOVE.L  D4,D2
0000152A                           757              
0000152A  1803                     758              MOVE.B  D3,D4
0000152C  4EB8 1486                759              JSR     ISBLWHICHCOLL
00001530  2604                     760              MOVE.L  D4,D3
00001532                           761              
00001532  4CDF 0170                762              MOVEM.L (A7)+,D4-D6/A0
00001536                           763              
00001536  4E75                     764              RTS
00001538                           765  
00001538                           766  ; -----------------------------------------------------------------------------
00001538                           767  BLOCKSPLOT
00001538                           768  ; INPUT    - 
00001538                           769  ; OUTPUT   - 
00001538                           770  ; MODIFIES - 
00001538                           771  ; -----------------------------------------------------------------------------
00001538                           772  
00001538  48E7 FF00                773          MOVEM.L D0-D7, -(A7)
0000153C  48E7 00FE                774          MOVEM.L A0-A6, -(A7)
00001540  3239 00002630            775             MOVE.W LOADEDMAP, D1
00001546  C2FC 000C                776             MULU #12, D1
0000154A  3241                     777             MOVEA.W D1, A1
0000154C  4EE9 1550                778             JMP MAPSEL(A1)
00001550                           779  MAPSEL:
00001550  41F9 00003340            780             LEA HEAVEN_0, A0
00001556  4EF9 000015B0            781             JMP NEXT
0000155C  41F9 00003490            782             LEA HEAVEN_1, A0
00001562  4EF9 000015B0            783             JMP NEXT
00001568  41F9 000035CB            784             LEA HEAVEN_END, A0
0000156E  4EF9 000015B0            785             JMP NEXT
00001574  41F9 00003706            786             LEA HEAVEN_ROOM, A0
0000157A  4EF9 000015B0            787             JMP NEXT
00001580  41F9 00003841            788             LEA HELL_0, A0
00001586  4EF9 000015B0            789             JMP NEXT
0000158C  41F9 0000397C            790             LEA HELL_1, A0
00001592  4EF9 000015B0            791             JMP NEXT
00001598  41F9 00003AB7            792             LEA HELL_END, A0
0000159E  4EF9 000015B0            793             JMP NEXT
000015A4  41F9 00003BF2            794             LEA HELL_ROOM, A0
000015AA  4EF9 000015B0            795             JMP NEXT
000015B0                           796              
000015B0                           797  NEXT
000015B0  4281                     798             CLR.L D1
000015B2  1218                     799             MOVE.B (A0)+,D1
000015B4  C2FC 0006                800             MULU #6, D1
000015B8  2241                     801             MOVEA.L D1, A1
000015BA  4EE9 15BE                802             JMP JMPLIST(A1)
000015BE                           803             
000015BE                           804  JMPLIST: 
000015BE  4EF9 00001972            805              JMP NEWLINE ; 0 = END OF ROW
000015C4  4EF9 00001646            806              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
000015CA  4EF9 000016DC            807              JMP DBHL    ; 2 = DRAW BRICK HELL
000015D0  4EF9 00001750            808              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
000015D6  4EF9 000017C4            809              JMP DGHL    ; 4 = DRAW GRASS HELL
000015DC  4EF9 0000185A            810              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
000015E2  4EF9 0000187A            811              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
000015E8  4EF9 0000189A            812              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
000015EE  4EF9 00001606            813              JMP DDHL    ; 8 = DRAW DOOR HELL
000015F4  4EF9 00001626            814              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
000015FA  4EF9 000018EC            815              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
00001600  4EF9 000019A8            816              JMP ENDMAP  ; 11 = END OF THE MAP
00001606                           817              
00001606                           818  DDHL
00001606  2F3C 00111111            819      MOVE.L #$00111111, -(A7)
0000160C  2F3C 00111111            820      MOVE.L #$00111111, -(A7)
00001612  4EB9 0000193E            821      JSR DRAWBLOCK
00001618  2C1F                     822      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000161A  2C1F                     823      MOVE.L (A7)+, D6    
0000161C  4EB9 00001996            824      JSR ENDBLOCK
00001622  4EF8 15B0                825      JMP NEXT
00001626                           826  DDHV
00001626  2F3C 00FFFFFF            827      MOVE.L #$00FFFFFF, -(A7)
0000162C  2F3C 00FFFFFF            828      MOVE.L #$00FFFFFF, -(A7)
00001632  4EB9 0000193E            829      JSR DRAWBLOCK
00001638  2C1F                     830      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000163A  2C1F                     831      MOVE.L (A7)+, D6
0000163C  4EB9 00001996            832      JSR ENDBLOCK
00001642  4EF8 15B0                833      JMP NEXT
00001646                           834  DGHE ;DRAW-GRASS-HEAVEN vvvR
00001646  2F3C 0099FF99            835      MOVE.L #$0099FF99, -(A7)
0000164C  2F3C 0099FF99            836      MOVE.L #$0099FF99, -(A7)
00001652  4EB9 0000193E            837      JSR DRAWBLOCK
00001658  2C1F                     838      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000165A  2C1F                     839      MOVE.L (A7)+, D6
0000165C                           840      ; SET PEN COLOR 
0000165C  103C 0050                841      MOVE.B #80, D0
00001660  223C 0000CC00            842      MOVE.L #$0000CC00, D1
00001666  4E4F                     843      TRAP #15
00001668                           844      ;DRAW LINES   
00001668  103C 0054                845      MOVE.B #84, D0 
0000166C                           846      ;LINEA 11 
0000166C  3239 00002624            847      MOVE.W BPOSX1,D1
00001672  5C41                     848      ADD.W #6, D1
00001674  3439 00002626            849      MOVE.W BPOSY1, D2
0000167A  5A42                     850      ADD.W #5, D2
0000167C  3639 00002624            851      MOVE.W BPOSX1, D3
00001682  0643 0009                852      ADD.W #9, D3
00001686  3839 00002626            853      MOVE.W BPOSY1, D4
0000168C  0644 000A                854      ADD.W #10, D4
00001690  4E4F                     855      TRAP #15
00001692                           856      ;LINEA 12
00001692  5041                     857      ADD.W #8, D1    
00001694  5043                     858      ADD.W #8, D3
00001696  4E4F                     859      TRAP #15
00001698                           860      ;LINEA 13
00001698  5041                     861      ADD.W #8, D1    
0000169A  5043                     862      ADD.W #8, D3
0000169C  4E4F                     863      TRAP #15
0000169E                           864      ;LINEA 21
0000169E  3239 00002624            865      MOVE.W BPOSX1,D1
000016A4  5C41                     866      ADD.W #6, D1
000016A6  3439 00002626            867      MOVE.W BPOSY1, D2
000016AC  0642 0014                868      ADD.W #20, D2
000016B0  3639 00002624            869      MOVE.W BPOSX1, D3
000016B6  0643 0009                870      ADD.W #9, D3
000016BA  3839 00002626            871      MOVE.W BPOSY1, D4
000016C0  0644 0019                872      ADD.W #25, D4
000016C4  4E4F                     873      TRAP #15
000016C6                           874      ;LINEA 22
000016C6  5041                     875      ADD.W #8, D1    
000016C8  5043                     876      ADD.W #8, D3
000016CA  4E4F                     877      TRAP #15
000016CC                           878      ;LINEA 23
000016CC  5041                     879      ADD.W #8, D1    
000016CE  5043                     880      ADD.W #8, D3
000016D0  4E4F                     881      TRAP #15
000016D2  4EB9 00001996            882      JSR ENDBLOCK
000016D8  4EF8 15B0                883      JMP NEXT
000016DC                           884  DBHL ;DRAW BRICK-HELL vvvR
000016DC                           885      
000016DC  2F3C 00010101            886      MOVE.L #$00010101, -(A7)
000016E2  2F3C 00666666            887      MOVE.L #$00666666, -(A7)
000016E8  4EB9 0000193E            888      JSR DRAWBLOCK
000016EE  2C1F                     889      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000016F0  2C1F                     890      MOVE.L (A7)+, D6
000016F2                           891      ;DRAW HORIZONTAL LINE
000016F2  103C 0054                892      MOVE.B #84, D0 
000016F6  3239 00002624            893      MOVE.W BPOSX1, D1
000016FC  3439 00002626            894      MOVE.W BPOSY1, D2
00001702  0642 0010                895      ADD.W #16, D2
00001706  3639 00002624            896      MOVE.W BPOSX1, D3
0000170C  0643 0020                897      ADD.W #32, D3
00001710  3839 00002626            898      MOVE.W BPOSY1, D4
00001716  0644 0010                899      ADD.W #16, D4
0000171A  4E4F                     900      TRAP #15
0000171C                           901      ;DRAW VERTICAL LINE 
0000171C  3239 00002624            902      MOVE.W BPOSX1, D1
00001722  0641 0010                903      ADD.W #16, D1
00001726  3439 00002626            904      MOVE.W BPOSY1, D2
0000172C  0642 0010                905      ADD.W #16, D2
00001730  3639 00002624            906      MOVE.W BPOSX1, D3
00001736  0643 0010                907      ADD.W #16, D3
0000173A  3839 00002626            908      MOVE.W BPOSY1, D4
00001740  0644 0020                909      ADD.W #32, D4
00001744  4E4F                     910      TRAP #15
00001746  4EB9 00001996            911      JSR ENDBLOCK    
0000174C  4EF8 15B0                912      JMP NEXT
00001750                           913  DBHV ;DRAW BRICK-HEAVEN vvvR
00001750                           914      
00001750  2F3C 00CCCCCC            915      MOVE.L #$00CCCCCC, -(A7)
00001756  2F3C 00D7EBFA            916      MOVE.L #$00D7EBFA, -(A7)
0000175C  4EB9 0000193E            917      JSR DRAWBLOCK
00001762  2C1F                     918      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001764  2C1F                     919      MOVE.L (A7)+, D6
00001766                           920      ;DRAW HORIZONTAL LINE
00001766  103C 0054                921      MOVE.B #84, D0 
0000176A  3239 00002624            922      MOVE.W BPOSX1, D1
00001770  3439 00002626            923      MOVE.W BPOSY1, D2
00001776  0642 0010                924      ADD.W #16, D2
0000177A  3639 00002624            925      MOVE.W BPOSX1, D3
00001780  0643 0020                926      ADD.W #32, D3
00001784  3839 00002626            927      MOVE.W BPOSY1, D4
0000178A  0644 0010                928      ADD.W #16, D4
0000178E  4E4F                     929      TRAP #15
00001790                           930      ;DRAW VERTICAL LINE 
00001790  3239 00002624            931      MOVE.W BPOSX1, D1
00001796  0641 0010                932      ADD.W #16, D1
0000179A  3439 00002626            933      MOVE.W BPOSY1, D2
000017A0  0642 0010                934      ADD.W #16, D2
000017A4  3639 00002624            935      MOVE.W BPOSX1, D3
000017AA  0643 0010                936      ADD.W #16, D3
000017AE  3839 00002626            937      MOVE.W BPOSY1, D4
000017B4  0644 0020                938      ADD.W #32, D4
000017B8  4E4F                     939      TRAP #15 
000017BA  4EB9 00001996            940      JSR ENDBLOCK
000017C0  4EF8 15B0                941      JMP NEXT
000017C4                           942  DGHL ;DRAW GRASS HELL vvvR
000017C4                           943  
000017C4  2F3C 002255EE            944      MOVE.L #$002255EE, -(A7)
000017CA  2F3C 002255EE            945      MOVE.L #$002255EE, -(A7)
000017D0  4EB9 0000193E            946      JSR DRAWBLOCK
000017D6  2C1F                     947      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000017D8  2C1F                     948      MOVE.L (A7)+, D6
000017DA                           949      ; SET PEN COLOR 
000017DA  103C 0050                950      MOVE.B #80, D0
000017DE  223C 000000CC            951      MOVE.L #$000000CC, D1
000017E4  4E4F                     952      TRAP #15
000017E6                           953      ;DRAW LINES   
000017E6  103C 0054                954      MOVE.B #84, D0 
000017EA                           955      ;LINEA 11 
000017EA  3239 00002624            956      MOVE.W BPOSX1,D1
000017F0  5C41                     957      ADD.W #6, D1
000017F2  3439 00002626            958      MOVE.W BPOSY1, D2
000017F8  5A42                     959      ADD.W #5, D2
000017FA  3639 00002624            960      MOVE.W BPOSX1, D3
00001800  0643 0009                961      ADD.W #9, D3
00001804  3839 00002626            962      MOVE.W BPOSY1, D4
0000180A  0644 000A                963      ADD.W #10, D4
0000180E  4E4F                     964      TRAP #15
00001810                           965      ;LINEA 12
00001810  5041                     966      ADD.W #8, D1    
00001812  5043                     967      ADD.W #8, D3
00001814  4E4F                     968      TRAP #15
00001816                           969      ;LINEA 13
00001816  5041                     970      ADD.W #8, D1    
00001818  5043                     971      ADD.W #8, D3
0000181A  4E4F                     972      TRAP #15
0000181C                           973      ;LINEA 21
0000181C  3239 00002624            974      MOVE.W BPOSX1,D1
00001822  5C41                     975      ADD.W #6, D1
00001824  3439 00002626            976      MOVE.W BPOSY1, D2
0000182A  0642 0014                977      ADD.W #20, D2
0000182E  3639 00002624            978      MOVE.W BPOSX1, D3
00001834  0643 0009                979      ADD.W #9, D3
00001838  3839 00002626            980      MOVE.W BPOSY1, D4
0000183E  0644 0019                981      ADD.W #25, D4
00001842  4E4F                     982      TRAP #15
00001844                           983      ;LINEA 22
00001844  5041                     984      ADD.W #8, D1    
00001846  5043                     985      ADD.W #8, D3
00001848  4E4F                     986      TRAP #15
0000184A                           987      ;LINEA 23
0000184A  5041                     988      ADD.W #8, D1    
0000184C  5043                     989      ADD.W #8, D3
0000184E  4E4F                     990      TRAP #15
00001850  4EB9 00001996            991      JSR ENDBLOCK
00001856  4EF8 15B0                992      JMP NEXT
0000185A                           993  
0000185A                           994  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
0000185A  2F3C 00CCCCCC            995      MOVE.L #$00CCCCCC, -(A7)
00001860  2F3C 00C6DAE9            996      MOVE.L #$00C6DAE9, -(A7)
00001866  4EB9 0000193E            997      JSR DRAWBLOCK
0000186C  2C1F                     998      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000186E  2C1F                     999      MOVE.L (A7)+, D6
00001870  4EB9 00001996           1000      JSR ENDBLOCK
00001876  4EF8 15B0               1001      JMP NEXT
0000187A                          1002  DF1HL ; DRAW FLOOR_1 HELL vvvR 
0000187A  2F3C 00010101           1003      MOVE.L #$00010101, -(A7)
00001880  2F3C 00777777           1004      MOVE.L #$00777777, -(A7)
00001886  4EB9 0000193E           1005      JSR DRAWBLOCK
0000188C  2C1F                    1006      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000188E  2C1F                    1007      MOVE.L (A7)+, D6
00001890                          1008  
00001890  4EB9 00001996           1009      JSR ENDBLOCK
00001896  4EF8 15B0               1010      JMP NEXT
0000189A                          1011      
0000189A                          1012  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
0000189A  2F3C 00CCCCCC           1013      MOVE.L #$00CCCCCC, -(A7)
000018A0  2F3C 00C6DAE9           1014      MOVE.L #$00C6DAE9, -(A7)
000018A6  4EB9 0000193E           1015      JSR DRAWBLOCK
000018AC  2C1F                    1016      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018AE  2C1F                    1017      MOVE.L (A7)+, D6
000018B0                          1018      ;SET NEW FILL COLOR  
000018B0  103C 0051               1019      MOVE.B #81, D0
000018B4  223C 00D7EBFA           1020      MOVE.L #$00D7EBFA, D1
000018BA  4E4F                    1021      TRAP #15 
000018BC                          1022      ;DRAW INSIDE SQUARE 
000018BC  103C 0057               1023      MOVE.B #87, D0
000018C0  3239 00002624           1024      MOVE.W BPOSX1, D1
000018C6  5041                    1025      ADD.W #8, D1
000018C8  3439 00002626           1026      MOVE.W BPOSY1, D2
000018CE  5042                    1027      ADD.W #8, D2
000018D0  3639 00002628           1028      MOVE.W BPOSX2, D3
000018D6  5143                    1029      SUB.W #8, D3
000018D8  3839 0000262A           1030      MOVE.W BPOSY2, D4
000018DE  5144                    1031      SUB.W #8, D4
000018E0  4E4F                    1032      TRAP #15
000018E2  4EB9 00001996           1033      JSR ENDBLOCK
000018E8  4EF8 15B0               1034      JMP NEXT
000018EC                          1035  DF2HL ; DRAW FLOOR_2 HELL vvvR
000018EC  2F3C 00010101           1036      MOVE.L #$00010101, -(A7)
000018F2  2F3C 00777777           1037      MOVE.L #$00777777, -(A7)
000018F8  4EB9 0000193E           1038      JSR DRAWBLOCK
000018FE  2C1F                    1039      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001900  2C1F                    1040      MOVE.L (A7)+, D6
00001902                          1041      ;SET NEW FILL COLOR  
00001902  103C 0051               1042      MOVE.B #81, D0
00001906  223C 00666666           1043      MOVE.L #$00666666, D1
0000190C  4E4F                    1044      TRAP #15 
0000190E                          1045  ;DRAW INSIDE SQUARE 
0000190E  103C 0057               1046      MOVE.B #87, D0
00001912  3239 00002624           1047      MOVE.W BPOSX1, D1
00001918  5041                    1048      ADD.W #8, D1
0000191A  3439 00002626           1049      MOVE.W BPOSY1, D2
00001920  5042                    1050      ADD.W #8, D2
00001922  3639 00002628           1051      MOVE.W BPOSX2, D3
00001928  5143                    1052      SUB.W #8, D3
0000192A  3839 0000262A           1053      MOVE.W BPOSY2, D4
00001930  5144                    1054      SUB.W #8, D4
00001932  4E4F                    1055      TRAP #15
00001934  4EB9 00001996           1056      JSR ENDBLOCK
0000193A  4EF8 15B0               1057      JMP NEXT    
0000193E                          1058      
0000193E                          1059  DRAWBLOCK 
0000193E                          1060  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPU?S COMO LONGS. 
0000193E                          1061      
0000193E                          1062      ;SET FILL COLOR  
0000193E  103C 0051               1063      MOVE.B #81, D0
00001942  222F 0004               1064      MOVE.L 4(A7), D1
00001946  4E4F                    1065      TRAP #15 
00001948                          1066      
00001948                          1067      ; SET PEN COLOR 
00001948  103C 0050               1068      MOVE.B #80, D0
0000194C  222F 0008               1069      MOVE.L 8(A7), D1
00001950  4E4F                    1070      TRAP #15 
00001952                          1071  
00001952                          1072      ;DRAW BLOCK 
00001952  103C 0057               1073      MOVE.B #87, D0
00001956  3239 00002624           1074      MOVE.W BPOSX1, D1
0000195C  3439 00002626           1075      MOVE.W BPOSY1, D2
00001962  3639 00002628           1076      MOVE.W BPOSX2, D3
00001968  3839 0000262A           1077      MOVE.W BPOSY2, D4
0000196E  4E4F                    1078      TRAP #15
00001970  4E75                    1079      RTS
00001972                          1080  
00001972                          1081  NEWLINE
00001972                          1082      ;RESET X POSITION
00001972  33FC 0000 00002624      1083      MOVE.W #0, BPOSX1
0000197A  33FC 0020 00002628      1084      MOVE.W #32, BPOSX2
00001982                          1085      ;ADD 33 TO Y POSITION
00001982  0679 0020 00002626      1086      ADD.W #32, BPOSY1
0000198A  0679 0020 0000262A      1087      ADD.W #32, BPOSY2
00001992  4EF8 15B0               1088      JMP NEXT
00001996                          1089     
00001996                          1090  ENDBLOCK
00001996                          1091      ;SET NEW BLOCK POSITION
00001996  0679 0020 00002624      1092      ADD.W #32, BPOSX1
0000199E  0679 0020 00002628      1093      ADD.W #32, BPOSX2
000019A6  4E75                    1094      RTS
000019A8                          1095  ENDMAP
000019A8                          1096      ;SET DEFAULT BLOCK POSITION
000019A8  33FC 0000 00002624      1097      MOVE.W #0, BPOSX1
000019B0  33FC 0000 00002626      1098      MOVE.W #0, BPOSY1
000019B8  33FC 0020 00002628      1099      MOVE.W #32, BPOSX2
000019C0  33FC 0020 0000262A      1100      MOVE.W #32, BPOSY2
000019C8  4CDF 7F00               1101      MOVEM.L (A7)+, A0-A6
000019CC  4CDF 00FF               1102      MOVEM.L (A7)+, D0-D7
000019D0  4E75                    1103      RTS
000019D2                          1104      
000019D2                          1105  
000019D2                          1106  
000019D2                          1107  -------------------- end include --------------------
000019D2                          1108              INCLUDE "MAP.X68"
000019D2                          1109  
000019D2                          1110  ; -----------------------------------------------------------------------------
000019D2                          1111  MAPUPD
000019D2                          1112  ; INPUT    - 
000019D2                          1113  ; OUTPUT   - 
000019D2                          1114  ; MODIFIES - A0
000019D2                          1115  ; -----------------------------------------------------------------------------
000019D2  3F00                    1116              MOVE.W D0,-(A7)
000019D4                          1117              
000019D4  3039 00002630           1118              MOVE.W  LOADEDMAP, D0
000019DA                          1119              
000019DA  48C0                    1120              EXT.L   D0
000019DC  C0FC 0004               1121              MULU    #4,D0
000019E0  41F9 00002632           1122              LEA.L   MAPUPDLIST,A0
000019E6  D1C0                    1123              ADDA.L  D0,A0
000019E8  2050                    1124              MOVEA.L (A0),A0
000019EA  4ED0                    1125              JMP     (A0)
000019EC                          1126  
000019EC                          1127  
000019EC                          1128  MAPA1
000019EC  301F                    1129      MOVE.W (A7)+, D0
000019EE  48A7 F800               1130      MOVEM.W D0-D4, -(A7)
000019F2  3039 0000261E           1131      MOVE.W PLAYERPOSX, D0
000019F8  3239 00002620           1132      MOVE.W PLAYERPOSY, D1
000019FE                          1133      ;GO TO THE NEXT ROOM DOOR
000019FE                          1134      ;FIRST LETS CHECH POS X
000019FE  B07C 0160               1135      CMP #352, D0  ; BGT = 352 > D0
00001A02  6E00 002A               1136      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A06  B07C 0120               1137      CMP #288, D0
00001A0A  6D00 0022               1138      BLT MAP1NODOOR
00001A0E                          1139      ;NOW WE CHECK POS Y 
00001A0E  B27C 01E0               1140      CMP #480, D1  ; 
00001A12  6E00 001A               1141      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A16  B27C 01C0               1142      CMP #448, D1
00001A1A  6D00 0012               1143      BLT MAP1NODOOR
00001A1E  33FC 0020 00002620      1144      MOVE.W #32, PLAYERPOSY
00001A26  33FC 0001 00002630      1145      MOVE.W #1, LOADEDMAP
00001A2E                          1146  MAP1NODOOR
00001A2E  4C9F 001F               1147      MOVEM.W (A7)+, D0-D4
00001A32  4E75                    1148      RTS
00001A34                          1149      
00001A34                          1150  MAPA2
00001A34  301F                    1151      MOVE.W (A7)+, D0
00001A36  48A7 F800               1152      MOVEM.W D0-D4, -(A7)
00001A3A  3039 0000261E           1153      MOVE.W PLAYERPOSX, D0
00001A40  3239 00002620           1154      MOVE.W PLAYERPOSY, D1
00001A46                          1155      ;GO TO THE NEXT ROOM DOOR
00001A46                          1156      ;FIRST LETS CHECK POS X
00001A46  B07C 0160               1157      CMP #352, D0  ; BGT = 352 > D0
00001A4A  6E00 0030               1158      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A4E  B07C 0120               1159      CMP #288, D0
00001A52  6D00 0028               1160      BLT MAP2NODOOR1
00001A56                          1161      ;NOW WE CHECK POS Y 
00001A56  B27C 01E0               1162      CMP #480, D1  ; 
00001A5A  6E00 0020               1163      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A5E  B27C 01C0               1164      CMP #448, D1
00001A62  6D00 0018               1165      BLT MAP2NODOOR1
00001A66  33FC 0020 00002620      1166      MOVE.W #32, PLAYERPOSY
00001A6E  33FC 0002 00002630      1167      MOVE.W #2, LOADEDMAP
00001A76  4C9F 001F               1168      MOVEM.W (A7)+, D0-D4
00001A7A  4E75                    1169      RTS
00001A7C                          1170  MAP2NODOOR1
00001A7C                          1171      ;GO TO THE PREVIOUS ROOM DOOR
00001A7C                          1172      ;FIRST LETS CHECK POS X
00001A7C  B07C 0160               1173      CMP #352, D0  ; BGT = 352 > D0
00001A80  6E00 0030               1174      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A84  B07C 0120               1175      CMP #288, D0
00001A88  6D00 0028               1176      BLT MAP2NODOOR2
00001A8C                          1177      ;NOW WE CHECK POS Y 
00001A8C  B27C 0020               1178      CMP #32, D1  ; 
00001A90  6E00 0020               1179      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A94  B27C 0000               1180      CMP #0, D1
00001A98  6D00 0018               1181      BLT MAP2NODOOR2
00001A9C  33FC 01A0 00002620      1182      MOVE.W  #416, PLAYERPOSY
00001AA4  33FC 0000 00002630      1183      MOVE.W #0, LOADEDMAP
00001AAC  4C9F 001F               1184      MOVEM.W (A7)+, D0-D4
00001AB0  4E75                    1185      RTS
00001AB2                          1186  
00001AB2                          1187  MAP2NODOOR2
00001AB2                          1188      ;GO TO THE LEFT HEAVEN'S ROOM
00001AB2  B07C 00A0               1189      CMP #160, D0  ; BGT = 352 > D0
00001AB6  6E00 0038               1190      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ABA  B07C 0080               1191      CMP #128, D0
00001ABE  6D00 0030               1192      BLT MAP2NODOOR3
00001AC2                          1193      ;NOW WE CHECK POS Y 
00001AC2  B27C 00AA               1194      CMP #170, D1  ; 
00001AC6  6E00 0028               1195      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ACA  B27C 0078               1196      CMP #120, D1
00001ACE  6D00 0020               1197      BLT MAP2NODOOR3
00001AD2  33FC 0130 0000261E      1198      MOVE.W #$130, PLAYERPOSX
00001ADA  33FC 00B0 00002620      1199      MOVE.W #$0B0, PLAYERPOSY
00001AE2  33FC 0003 00002630      1200      MOVE.W #3, LOADEDMAP
00001AEA  4C9F 001F               1201      MOVEM.W (A7)+, D0-D4
00001AEE  4E75                    1202      RTS
00001AF0                          1203  MAP2NODOOR3
00001AF0                          1204      ;GO TO THE RIGHT HEAVEN'S ROOM
00001AF0  B07C 01E0               1205      CMP #480, D0  ; BGT = 352 > D0
00001AF4  6E00 0038               1206      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AF8  B07C 01C0               1207      CMP #448, D0
00001AFC  6D00 0030               1208      BLT MAP2NODOOR4
00001B00                          1209      ;NOW WE CHECK POS Y 
00001B00  B27C 00AA               1210      CMP #170, D1  ; 
00001B04  6E00 0028               1211      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B08  B27C 0078               1212      CMP #120, D1
00001B0C  6D00 0020               1213      BLT MAP2NODOOR4
00001B10  33FC 0130 0000261E      1214      MOVE.W #$130, PLAYERPOSX
00001B18  33FC 00B0 00002620      1215      MOVE.W #$0B0, PLAYERPOSY
00001B20  33FC 0003 00002630      1216      MOVE.W #3, LOADEDMAP
00001B28  4C9F 001F               1217      MOVEM.W (A7)+, D0-D4
00001B2C  4E75                    1218      RTS
00001B2E                          1219  MAP2NODOOR4
00001B2E  4C9F 001F               1220      MOVEM.W (A7)+, D0-D4
00001B32  4E75                    1221      RTS
00001B34                          1222  MAPA3 
00001B34  301F                    1223      MOVE.W (A7)+, D0
00001B36  48A7 F800               1224      MOVEM.W D0-D4, -(A7)
00001B3A  3039 0000261E           1225      MOVE.W PLAYERPOSX, D0
00001B40  3239 00002620           1226      MOVE.W PLAYERPOSY, D1
00001B46                          1227      ;GO TO THE PREVIOUS ROOM DOOR
00001B46                          1228      ;FIRST LETS CHECK POS X
00001B46  B07C 0160               1229      CMP #352, D0  ; BGT = 352 > D0
00001B4A  6E00 0030               1230      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B4E  B07C 0120               1231      CMP #288, D0
00001B52  6D00 0028               1232      BLT MAP3NODOOR
00001B56                          1233      ;NOW WE CHECK POS Y 
00001B56  B27C 0020               1234      CMP #32, D1  ; 
00001B5A  6E00 0020               1235      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B5E  B27C 0000               1236      CMP #0, D1
00001B62  6D00 0018               1237      BLT MAP3NODOOR
00001B66  33FC 01A0 00002620      1238      MOVE.W  #416, PLAYERPOSY
00001B6E  33FC 0001 00002630      1239      MOVE.W #1, LOADEDMAP
00001B76  4C9F 001F               1240      MOVEM.W (A7)+, D0-D4
00001B7A  4E75                    1241      RTS
00001B7C                          1242  MAP3NODOOR
00001B7C  4C9F 001F               1243      MOVEM.W (A7)+, D0-D4
00001B80  4E75                    1244      RTS
00001B82                          1245  MAPA4
00001B82  301F                    1246      MOVE.W (A7)+, D0
00001B84  48A7 F800               1247      MOVEM.W D0-D4, -(A7)
00001B88  3039 0000261E           1248      MOVE.W PLAYERPOSX, D0
00001B8E  3239 00002620           1249      MOVE.W PLAYERPOSY, D1
00001B94                          1250      ;GO BACK TO 2ND HEAVEN'S ROOM
00001B94  B07C 0180               1251      CMP #384, D0  ; BGT = 352 > D0
00001B98  6E00 002A               1252      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B9C  B07C 0104               1253      CMP #260, D0
00001BA0  6D00 0022               1254      BLT MAP4NODOOR
00001BA4                          1255      ;NOW WE CHECK POS Y 
00001BA4  B27C 0080               1256      CMP #128, D1  ; 
00001BA8  6E00 001A               1257      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BAC  B27C 0060               1258      CMP #96, D1
00001BB0  6D00 0012               1259      BLT MAP4NODOOR
00001BB4  33FC 00E0 0000261E      1260      MOVE.W  #224, PLAYERPOSX
00001BBC  33FC 0001 00002630      1261      MOVE.W #1, LOADEDMAP
00001BC4                          1262  MAP4NODOOR
00001BC4  4C9F 001F               1263      MOVEM.W (A7)+, D0-D4
00001BC8  4E75                    1264      RTS
00001BCA                          1265  ;;;;;;;;;;HELL
00001BCA                          1266  MAPA5
00001BCA  301F                    1267      MOVE.W (A7)+, D0
00001BCC  48A7 F800               1268      MOVEM.W D0-D4, -(A7)
00001BD0  3039 0000261E           1269      MOVE.W PLAYERPOSX, D0
00001BD6  3239 00002620           1270      MOVE.W PLAYERPOSY, D1
00001BDC                          1271      ;GO TO THE NEXT ROOM DOOR
00001BDC                          1272      ;FIRST LETS CHECH POS X
00001BDC  B07C 0160               1273      CMP #352, D0  ; BGT = 352 > D0
00001BE0  6E00 002A               1274      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BE4  B07C 0120               1275      CMP #288, D0
00001BE8  6D00 0022               1276      BLT MAP5NODOOR
00001BEC                          1277      ;NOW WE CHECK POS Y 
00001BEC  B27C 01E0               1278      CMP #480, D1  ; 
00001BF0  6E00 001A               1279      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BF4  B27C 01C0               1280      CMP #448, D1
00001BF8  6D00 0012               1281      BLT MAP5NODOOR
00001BFC  33FC 0020 00002620      1282      MOVE.W #32, PLAYERPOSY
00001C04  33FC 0005 00002630      1283      MOVE.W #5, LOADEDMAP
00001C0C                          1284  MAP5NODOOR
00001C0C  4C9F 001F               1285      MOVEM.W (A7)+, D0-D4
00001C10  4E75                    1286      RTS
00001C12                          1287      
00001C12                          1288  MAPA6
00001C12  301F                    1289      MOVE.W (A7)+, D0
00001C14  48A7 F800               1290      MOVEM.W D0-D4, -(A7)
00001C18  3039 0000261E           1291      MOVE.W PLAYERPOSX, D0
00001C1E  3239 00002620           1292      MOVE.W PLAYERPOSY, D1
00001C24                          1293      ;GO TO THE NEXT ROOM DOOR
00001C24                          1294      ;FIRST LETS CHECK POS X
00001C24  B07C 0160               1295      CMP #352, D0  ; BGT = 352 > D0
00001C28  6E00 0030               1296      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C2C  B07C 0120               1297      CMP #288, D0
00001C30  6D00 0028               1298      BLT MAP6NODOOR1
00001C34                          1299      ;NOW WE CHECK POS Y 
00001C34  B27C 01E0               1300      CMP #480, D1  ; 
00001C38  6E00 0020               1301      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C3C  B27C 01C0               1302      CMP #448, D1
00001C40  6D00 0018               1303      BLT MAP6NODOOR1
00001C44  33FC 0020 00002620      1304      MOVE.W #32, PLAYERPOSY
00001C4C  33FC 0006 00002630      1305      MOVE.W #6, LOADEDMAP
00001C54  4C9F 001F               1306      MOVEM.W (A7)+, D0-D4
00001C58  4E75                    1307      RTS
00001C5A                          1308  MAP6NODOOR1
00001C5A                          1309      ;GO TO THE PREVIOUS ROOM DOOR
00001C5A                          1310      ;FIRST LETS CHECK POS X
00001C5A  B07C 0160               1311      CMP #352, D0  ; BGT = 352 > D0
00001C5E  6E00 0030               1312      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C62  B07C 0120               1313      CMP #288, D0
00001C66  6D00 0028               1314      BLT MAP6NODOOR2
00001C6A                          1315      ;NOW WE CHECK POS Y 
00001C6A  B27C 0020               1316      CMP #32, D1  ; 
00001C6E  6E00 0020               1317      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C72  B27C 0000               1318      CMP #0, D1
00001C76  6D00 0018               1319      BLT MAP6NODOOR2
00001C7A  33FC 01A0 00002620      1320      MOVE.W  #416, PLAYERPOSY
00001C82  33FC 0004 00002630      1321      MOVE.W #4, LOADEDMAP
00001C8A  4C9F 001F               1322      MOVEM.W (A7)+, D0-D4
00001C8E  4E75                    1323      RTS
00001C90                          1324  MAP6NODOOR2
00001C90                          1325      ;CHECK FOR LEFT HELL ROOM
00001C90  B07C 0060               1326      CMP #96, D0  ; BGT = 352 > D0
00001C94  6E00 0038               1327      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C98  B07C 0040               1328      CMP #64, D0
00001C9C  6D00 0030               1329      BLT MAP6NODOOR3
00001CA0                          1330      ;NOW WE CHECK POS Y 
00001CA0  B27C 0180               1331      CMP #384, D1  ; 
00001CA4  6E00 0028               1332      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CA8  B27C 0140               1333      CMP #320, D1
00001CAC  6D00 0020               1334      BLT MAP6NODOOR3
00001CB0  33FC 0130 0000261E      1335      MOVE.W #$130, PLAYERPOSX
00001CB8  33FC 00B0 00002620      1336      MOVE.W #$0B0, PLAYERPOSY
00001CC0  33FC 0007 00002630      1337      MOVE.W #7, LOADEDMAP
00001CC8  4C9F 001F               1338      MOVEM.W (A7)+, D0-D4
00001CCC  4E75                    1339      RTS
00001CCE                          1340  MAP6NODOOR3
00001CCE                          1341      ;CHECK FOR THE RIGHT HELL ROOM
00001CCE  B07C 0240               1342      CMP #576, D0  ; BGT = 352 > D0
00001CD2  6E00 0038               1343      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CD6  B07C 021C               1344      CMP #540, D0
00001CDA  6D00 0030               1345      BLT MAP6NODOOR4
00001CDE                          1346      ;NOW WE CHECK POS Y 
00001CDE  B27C 0180               1347      CMP #384, D1  ; 
00001CE2  6E00 0028               1348      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CE6  B27C 0140               1349      CMP #320, D1
00001CEA  6D00 0020               1350      BLT MAP6NODOOR4
00001CEE  33FC 0130 0000261E      1351      MOVE.W #$130, PLAYERPOSX
00001CF6  33FC 00B0 00002620      1352      MOVE.W #$0B0, PLAYERPOSY
00001CFE  33FC 0007 00002630      1353      MOVE.W #7, LOADEDMAP
00001D06  4C9F 001F               1354      MOVEM.W (A7)+, D0-D4
00001D0A  4E75                    1355      RTS
00001D0C                          1356  MAP6NODOOR4
00001D0C  4C9F 001F               1357      MOVEM.W (A7)+, D0-D4
00001D10  4E75                    1358      RTS
00001D12                          1359  MAPA7 
00001D12  301F                    1360      MOVE.W (A7)+, D0
00001D14  48A7 F800               1361      MOVEM.W D0-D4, -(A7)
00001D18  3039 0000261E           1362      MOVE.W PLAYERPOSX, D0
00001D1E  3239 00002620           1363      MOVE.W PLAYERPOSY, D1
00001D24                          1364      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D24  B07C 0180               1365      CMP #384, D0  ; BGT = 352 > D0
00001D28  6E00 0032               1366      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D2C  B07C 0104               1367      CMP #260, D0
00001D30  6D00 002A               1368      BLT MAP7NODOOR
00001D34                          1369      ;NOW WE CHECK POS Y 
00001D34  B27C 0020               1370      CMP #32, D1  ; 
00001D38  6E00 0022               1371      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D3C  B27C 0000               1372      CMP #0, D1
00001D40  6D00 001A               1373      BLT MAP7NODOOR
00001D44  33FC 0140 0000261E      1374      MOVE.W  #320, PLAYERPOSX
00001D4C  33FC 01A0 00002620      1375      MOVE.W #416, PLAYERPOSY
00001D54  33FC 0005 00002630      1376      MOVE.W #5, LOADEDMAP
00001D5C                          1377  MAP7NODOOR
00001D5C  4C9F 001F               1378      MOVEM.W (A7)+, D0-D4
00001D60  4E75                    1379      RTS
00001D62                          1380  MAPA8
00001D62                          1381       ;HELLS ROOM
00001D62  301F                    1382      MOVE.W (A7)+, D0
00001D64  48A7 F800               1383      MOVEM.W D0-D4, -(A7)
00001D68  3039 0000261E           1384      MOVE.W PLAYERPOSX, D0
00001D6E  3239 00002620           1385      MOVE.W PLAYERPOSY, D1
00001D74                          1386      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D74  B07C 0180               1387      CMP #384, D0  ; BGT = 352 > D0
00001D78  6E00 0032               1388      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D7C  B07C 0104               1389      CMP #260, D0
00001D80  6D00 002A               1390      BLT MAP8NODOOR1
00001D84                          1391      ;NOW WE CHECK POS Y 
00001D84  B27C 0080               1392      CMP #128, D1  ; 
00001D88  6E00 0022               1393      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D8C  B27C 0060               1394      CMP #96, D1
00001D90  6D00 001A               1395      BLT MAP8NODOOR1
00001D94  33FC 0140 0000261E      1396      MOVE.W  #320, PLAYERPOSX
00001D9C  33FC 0080 00002620      1397      MOVE.W #128, PLAYERPOSY
00001DA4  33FC 0005 00002630      1398      MOVE.W #5, LOADEDMAP
00001DAC                          1399  MAP8NODOOR1
00001DAC  4C9F 001F               1400      MOVEM.W (A7)+, D0-D4
00001DB0  4E75                    1401      RTS
00001DB2                          1402  
00001DB2                          1403  
00001DB2                          1404  -------------------- end include --------------------
00001DB2                          1405              INCLUDE "ELEVATOR.X68"           
00001DB2                          1406  ELEVATORINIT
00001DB2  6000 048E               1407      BRA     AUDINIT
00001DB6                          1408  
00001DB6                          1409  ELEVATORPLOT
00001DB6                          1410      
00001DB6  48E7 FFFE               1411      MOVEM.L D0-D7/A0-A6,-(A7)
00001DBA                          1412  
00001DBA                          1413  
00001DBA                          1414  ;SET PEN COLOR  
00001DBA  103C 0050               1415      MOVE.B #80, D0
00001DBE  223C 00010101           1416      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
00001DC4  4E4F                    1417      TRAP #15
00001DC6                          1418      
00001DC6                          1419  ;END SET PEN COLOR 
00001DC6                          1420  
00001DC6                          1421      ;DRAW LINES
00001DC6                          1422  ;DRAW LINE 1 
00001DC6  103C 0054               1423      MOVE.B #84, D0
00001DCA  323C 0000               1424      MOVE.W #0, D1
00001DCE  343C 0000               1425      MOVE.W #0, D2
00001DD2  363C 00A0               1426      MOVE.W #160, D3
00001DD6  383C 0078               1427      MOVE.W #120, D4
00001DDA  4E4F                    1428      TRAP #15
00001DDC                          1429  
00001DDC                          1430  ;DRAW LINE 2
00001DDC  103C 0054               1431      MOVE.B #84, D0
00001DE0  323C 00A0               1432      MOVE.W #160, D1
00001DE4  343C 0078               1433      MOVE.W #120, D2
00001DE8  363C 00A0               1434      MOVE.W #160, D3
00001DEC  383C 01E0               1435      MOVE.W #480, D4
00001DF0  4E4F                    1436      TRAP #15
00001DF2                          1437      
00001DF2                          1438  ;DRAW LINE 3
00001DF2  103C 0054               1439      MOVE.B #84, D0
00001DF6  323C 00A0               1440      MOVE.W #160, D1
00001DFA  343C 0078               1441      MOVE.W #120, D2
00001DFE  363C 01E0               1442      MOVE.W #480, D3
00001E02  383C 0078               1443      MOVE.W #120, D4
00001E06  4E4F                    1444      TRAP #15
00001E08                          1445      
00001E08                          1446  ;DRAW LINE 4
00001E08  103C 0054               1447      MOVE.B #84, D0
00001E0C  323C 01E0               1448      MOVE.W #480, D1
00001E10  343C 0078               1449      MOVE.W #120, D2
00001E14  363C 0280               1450      MOVE.W #640, D3
00001E18  383C 0000               1451      MOVE.W #0, D4
00001E1C  4E4F                    1452      TRAP #15
00001E1E                          1453      
00001E1E                          1454  ;DRAW LINE 5
00001E1E  103C 0054               1455      MOVE.B #84, D0
00001E22  323C 01E0               1456      MOVE.W #480, D1
00001E26  343C 0078               1457      MOVE.W #120, D2
00001E2A  363C 01E0               1458      MOVE.W #480, D3
00001E2E  383C 01E0               1459      MOVE.W #480, D4
00001E32  4E4F                    1460      TRAP #15
00001E34                          1461  
00001E34                          1462  ;DRAW LINE 6 (TO GIVE SHADE) 
00001E34  103C 0054               1463      MOVE.B #84, D0
00001E38  323C 0119               1464      MOVE.W #281, D1
00001E3C  343C 015A               1465      MOVE.W #346, D2
00001E40  363C 0167               1466      MOVE.W #359, D3
00001E44  383C 015A               1467      MOVE.W #346, D4
00001E48  4E4F                    1468      TRAP #15
00001E4A                          1469      
00001E4A                          1470  ;DRAW LINE 7 (TO GIVE SHADE) 
00001E4A  103C 0054               1471      MOVE.B #84, D0
00001E4E  323C 011A               1472      MOVE.W #282, D1
00001E52  343C 015B               1473      MOVE.W #347, D2
00001E56  363C 0166               1474      MOVE.W #358, D3
00001E5A  383C 015B               1475      MOVE.W #347, D4
00001E5E  4E4F                    1476      TRAP #15
00001E60                          1477      
00001E60                          1478      ;END DRAW LINES
00001E60                          1479      
00001E60                          1480  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
00001E60  103C 0057               1481      MOVE.B #87, D0
00001E64  323C 0118               1482      MOVE.W #280, D1
00001E68  343C 00D2               1483      MOVE.W #210, D2
00001E6C  363C 0168               1484      MOVE.W #360, D3
00001E70  383C 0159               1485      MOVE.W #345, D4
00001E74  4E4F                    1486      TRAP #15
00001E76                          1487      
00001E76                          1488  ;DRAW ELLIPSE FOR THE LIGHT
00001E76  103C 005B               1489      MOVE.B #91, D0
00001E7A  323C 00FA               1490      MOVE.W #250, D1
00001E7E  343C 0028               1491      MOVE.W #40, D2
00001E82  363C 0186               1492      MOVE.W #390, D3
00001E86  383C 0050               1493      MOVE.W #80, D4
00001E8A  4E4F                    1494      TRAP #15
00001E8C                          1495      ;FILL SEGMENTS
00001E8C                          1496  ;FILL SEGMENT 1 LEFT WALL
00001E8C                          1497    ;SET FILL COLOR TO DARKER GREY, FOR W
00001E8C  103C 0051               1498      MOVE.B #81, D0
00001E90                          1499      ;MOVE.L #$00969696, D1
00001E90  223C 0020202F           1500      MOVE.L #$0020202F, D1
00001E96  4E4F                    1501      TRAP #15
00001E98                          1502      ;END SET FILL COLOR
00001E98  103C 0059               1503      MOVE.B #89, D0
00001E9C  323C 0064               1504      MOVE.W #100, D1
00001EA0  343C 0064               1505      MOVE.W #100, D2
00001EA4  4E4F                    1506      TRAP #15
00001EA6                          1507      
00001EA6                          1508  ;FILL SEGMENT 2 CEILING
00001EA6                          1509    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00001EA6  103C 0051               1510      MOVE.B #81, D0
00001EAA                          1511      ;MOVE.L #$00C0C0C0, D1
00001EAA  223C 00141424           1512      MOVE.L #$00141424,D1
00001EB0  4E4F                    1513      TRAP #15
00001EB2                          1514      ;END SET FILL COLOR
00001EB2  103C 0059               1515      MOVE.B #89, D0
00001EB6  323C 0064               1516      MOVE.W #100, D1
00001EBA  343C 0032               1517      MOVE.W #50, D2
00001EBE  4E4F                    1518      TRAP #15
00001EC0                          1519      
00001EC0                          1520  ;FILL SEGMENT 3 RIGHT WALL
00001EC0                          1521    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00001EC0  103C 0051               1522      MOVE.B #81, D0
00001EC4                          1523      ;MOVE.L #$00969696, D1
00001EC4  223C 0020202F           1524      MOVE.L #$0020202F,D1
00001ECA  4E4F                    1525      TRAP #15
00001ECC                          1526      ;END SET FILL COLOR
00001ECC  103C 0059               1527      MOVE.B #89, D0
00001ED0  323C 0276               1528      MOVE.W #630, D1
00001ED4  343C 01D6               1529      MOVE.W #470, D2
00001ED8  4E4F                    1530      TRAP #15
00001EDA                          1531      
00001EDA                          1532  ;FILL SEGMENT 4 BACKGROUND WALL
00001EDA                          1533    ;SET FILL COLOR TO 
00001EDA  103C 0051               1534      MOVE.B #81, D0
00001EDE                          1535      ;MOVE.L #$00ABABAB, D1
00001EDE  223C 001A1A2A           1536      MOVE.L #$001A1A2A, D1
00001EE4  4E4F                    1537      TRAP #15
00001EE6                          1538      ;END SET FILL COLOR
00001EE6  103C 0059               1539      MOVE.B #89, D0
00001EEA  323C 00F0               1540      MOVE.W #240, D1
00001EEE  343C 0140               1541      MOVE.W #320, D2
00001EF2  4E4F                    1542      TRAP #15
00001EF4                          1543      
00001EF4                          1544  ;FILL SEGMENT 5 PANEL 
00001EF4                          1545    ;SET FILL COLOR TO 
00001EF4  103C 0051               1546      MOVE.B #81, D0
00001EF8                          1547      ;MOVE.L #$00AFAFAF, D1
00001EF8  223C 001F1F2F           1548      MOVE.L #$001F1F2F, D1
00001EFE  4E4F                    1549      TRAP #15
00001F00                          1550      ;END SET FILL COLOR
00001F00  103C 0059               1551      MOVE.B #89, D0
00001F04  323C 011D               1552      MOVE.W #285, D1
00001F08  343C 00D7               1553      MOVE.W #215, D2
00001F0C  4E4F                    1554      TRAP #15
00001F0E                          1555      
00001F0E                          1556  ;FILL ELLIPSE LIGHT 
00001F0E                          1557    ;SET FILL COLOR TO 
00001F0E  103C 0051               1558      MOVE.B #81, D0
00001F12                          1559      ;MOVE.L #$00A1E9E9, D1
00001F12  223C 000000FF           1560      MOVE.L #$000000FF, D1
00001F18  4E4F                    1561      TRAP #15
00001F1A                          1562      ;END SET FILL COLOR
00001F1A  103C 0059               1563      MOVE.B #89, D0
00001F1E  323C 0140               1564      MOVE.W #320, D1
00001F22  343C 003C               1565      MOVE.W #60, D2
00001F26  4E4F                    1566      TRAP #15
00001F28                          1567  
00001F28                          1568  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
00001F28                          1569      ;SET FILL COLOR 
00001F28  103C 0051               1570      MOVE.B #81, D0
00001F2C  223C 000000CC           1571      MOVE.L #COLBUTHL, D1
00001F32  4E4F                    1572      TRAP #15
00001F34                          1573      ;END SET FILL COLOR
00001F34  3F3C 0135               1574      MOVE.W #309, -(A7) ;COORDENADA Y 
00001F38  3F3C 0136               1575      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00001F3C  3F3C 0016               1576      MOVE.W #22, -(A7)
00001F40  4EB9 00001F76           1577      JSR TRIANGLE
00001F46  3C1F                    1578      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
00001F48  3C1F                    1579      MOVE.W (A7)+, D6
00001F4A  3C1F                    1580      MOVE.W (A7)+, D6
00001F4C                          1581  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
00001F4C                          1582     ;SET FILL COLOR
00001F4C  103C 0051               1583     MOVE.B #81, D0
00001F50  223C 00EEEEEE           1584     MOVE.L #COLBUTHV, D1
00001F56  4E4F                    1585     TRAP #15
00001F58                          1586     
00001F58                          1587      ;END SET FILL COLOR
00001F58  3F3C 00F9               1588     MOVE.W #249, -(A7) ;COORDENADA Y 
00001F5C  3F3C 0136               1589     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00001F60  3F3C FFEA               1590     MOVE.W #-22, -(A7)
00001F64  4EB9 00001F76           1591     JSR TRIANGLE
00001F6A  3C1F                    1592     MOVE.W (A7)+, D6
00001F6C  3C1F                    1593     MOVE.W (A7)+, D6
00001F6E  3C1F                    1594     MOVE.W (A7)+, D6
00001F70  4CDF 7FFF               1595     MOVEM.L (A7)+, D0-D7/A0-A6
00001F74                          1596  
00001F74  4E75                    1597     RTS
00001F76                          1598  ; ------------------------------------------------------------------------------
00001F76                          1599  TRIANGLE
00001F76                          1600  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
00001F76                          1601  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
00001F76                          1602  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
00001F76                          1603  ;            SIDES LENGTH (WORD) IN THAT ORDER
00001F76                          1604  ; OUTPUT   : NONE
00001F76                          1605  ; MODIFIES : NONE
00001F76                          1606  ; ------------------------------------------------------------------------------
00001F76  48A7 F800               1607      MOVEM.W D0-D4, -(A7)
00001F7A                          1608      ; LINE FROM LEFT TO RIGHT
00001F7A  103C 0054               1609      MOVE.B  #84,D0      ; TASK NUMBER
00001F7E  322F 0010               1610      MOVE.W  16(A7),D1   ; X POSITION FROM
00001F82  342F 0012               1611      MOVE.W  18(A7),D2   ; Y POSITION FROM
00001F86  3802                    1612      MOVE.W  D2,D4       ; Y POSITION TO
00001F88  362F 000E               1613      MOVE.W  14(A7),D3   ; LENGTH
00001F8C                          1614      
00001F8C  6A00 0004               1615      BPL.W   .UPWARDS
00001F90  4443                    1616      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
00001F92                          1617  .UPWARDS
00001F92  D641                    1618      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
00001F94  4E4F                    1619      TRAP    #15         ; HORIZONTAL LINE DRAWN
00001F96                          1620      ; LINE FROM RIGHT TO UP/DOWN
00001F96  9641                    1621      SUB.W   D1,D3       ; I GET LENGTH IN D3
00001F98  3001                    1622      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
00001F9A  D243                    1623      ADD.W   D3,D1       ; X POSITION FROM
00001F9C  E24B                    1624      LSR.W   #1,D3       ; LENGTH/2
00001F9E  D640                    1625      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
00001FA0                          1626      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
00001FA0  D86F 000E               1627      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
00001FA4  103C 0054               1628      MOVE.B  #84,D0
00001FA8  4E4F                    1629      TRAP    #15
00001FAA                          1630      ; LINE FROM LEFT TO UP/DOWN
00001FAA  322F 0010               1631      MOVE.W  16(A7),D1   ; X POSITION FROM
00001FAE  4E4F                    1632      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
00001FB0                          1633      
00001FB0                          1634      ; FILLING TRIANGLE
00001FB0  103C 0059               1635      MOVE.B  #89,D0
00001FB4  5241                    1636      ADDQ.W  #1,D1
00001FB6  363C 0001               1637      MOVE.W  #1,D3
00001FBA  4A6F 000E               1638      TST.W   14(A7)
00001FBE  6A00 0004               1639      BPL.W   .ISPOSITIVE
00001FC2  4443                    1640      NEG.W   D3
00001FC4                          1641  .ISPOSITIVE
00001FC4  D443                    1642      ADD.W   D3,D2
00001FC6  4E4F                    1643      TRAP    #15
00001FC8                          1644      
00001FC8  4C9F 001F               1645      MOVEM.W (A7)+,D0-D4
00001FCC  4E75                    1646      RTS
00001FCE                          1647      
00001FCE                          1648  ; ------------------------------------------------------------------------------
00001FCE                          1649  ELEVATORUPDATE ; 1 = up 3 = down
00001FCE                          1650  ; INPUT    : 
00001FCE                          1651  ; OUTPUT   : 
00001FCE                          1652  ; MODIFIES : 
00001FCE                          1653  ; ------------------------------------------------------------------------------
00001FCE  4EB9 000022BE           1654      JSR  ELEVATORMUSIC  
00001FD4  0839 0005 00002616      1655      BTST #5, KBDVAL
00001FDC  6600 002A               1656      BNE .HLSEL
00001FE0  0839 0007 00002616      1657      BTST #7, KBDVAL
00001FE8  6600 0004               1658      BNE .HVSEL
00001FEC  4E75                    1659      RTS
00001FEE                          1660  .HVSEL  ;LOAD 1ST HEAVEN MAP
00001FEE  33FC 0002 00002696      1661      MOVE.W  #2,(STANEXT)
00001FF6  13FC 0000 00002676      1662      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
00001FFE  33FC 0000 00002630      1663      MOVE.W #0, LOADEDMAP    
00002006  4E75                    1664      RTS
00002008                          1665  .HLSEL  ;LOAD 1ST HELL MAP
00002008  33FC 0002 00002696      1666      MOVE.W  #2,(STANEXT)
00002010  13FC 0000 00002676      1667      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
00002018  33FC 0004 00002630      1668      MOVE.W #4, LOADEDMAP
00002020  4E75                    1669      RTS
00002022                          1670      
00002022                          1671          
00002022                          1672  
00002022                          1673  
00002022                          1674  
00002022                          1675  
00002022                          1676  
00002022                          1677  
00002022                          1678  
00002022                          1679  
00002022                          1680  
00002022                          1681  
00002022                          1682  
00002022                          1683  -------------------- end include --------------------
00002022                          1684              INCLUDE "PLAYER.X68"    
00002022                          1685  ; ==============================================================================
00002022                          1686  ; PLAYER MANAGEMENT
00002022                          1687  ; ==============================================================================
00002022                          1688              
00002022                          1689  ; ------------------------------------------------------------------------------
00002022                          1690  PLAYERUPD
00002022                          1691  ; UPDATES THE PLAYER.
00002022                          1692  ; INPUT    : NONE 
00002022                          1693  ; OUTPUT   : NONE
00002022                          1694  ; MODIFIES : NONE
00002022                          1695  ; ------------------------------------------------------------------------------
00002022  48E7 F000               1696              MOVEM.L D0-D3,-(A7)
00002026                          1697              ; CHECK COLLISIONS
00002026                          1698              ; TOP LEFT CORNER
00002026  3039 0000261E           1699              MOVE.W  (PLAYERPOSX),D0
0000202C  E188                    1700              LSL.L   #8,D0
0000202E  E188                    1701              LSL.L   #8,D0
00002030  3039 00002620           1702              MOVE.W  (PLAYERPOSY),D0
00002036                          1703              
00002036  3239 0000261E           1704              MOVE.W  (PLAYERPOSX),D1
0000203C  0641 0020               1705              ADD.W   #PLAYERWIDTH,D1
00002040  E189                    1706              LSL.L   #8,D1
00002042  E189                    1707              LSL.L   #8,D1
00002044  3239 00002620           1708              MOVE.W  (PLAYERPOSY),D1
0000204A  0641 0020               1709              ADD.W   #PLAYERHEIGHT,D1
0000204E                          1710              
0000204E  4EB8 14A6               1711              JSR BLKCOLL    
00002052                          1712                              
00002052  0839 0000 00002616      1713              BTST #0, KBDVAL         ; SI NO VA HACIA LA IZQUIERDA
0000205A  6700 001E               1714              BEQ .NOLEFT
0000205E  5979 0000261E           1715              SUB.W   #PLAYERSPEED,(PLAYERPOSX)
00002064  4A80                    1716              TST.L   D0              ; SI HAY COLISIONES CON D0
00002066  6600 000C               1717              BNE .LEFT             
0000206A  4A83                    1718              TST.L   D3              ; SI HAY COLISIONES CON D3
0000206C  6600 0006               1719              BNE .LEFT
00002070  6000 0008               1720              BRA  .NOLEFT
00002074  5879 0000261E           1721  .LEFT       ADD.W   #PLAYERSPEED,(PLAYERPOSX)
0000207A                          1722  .NOLEFT     
0000207A  0839 0001 00002616      1723              BTST #1, KBDVAL         ; SI NO VA ARRIBA
00002082  6700 001E               1724              BEQ .NOUP
00002086  5979 00002620           1725              SUB.W   #PLAYERSPEED,(PLAYERPOSY)
0000208C  4A80                    1726              TST.L   D0              ; SI HAY COLISIONES CON D0
0000208E  6600 000C               1727              BNE .UP             
00002092  4A81                    1728              TST.L   D1              ; SI HAY COLISIONES CON D1
00002094  6600 0006               1729              BNE .UP
00002098  6000 0008               1730              BRA .NOUP
0000209C  5879 00002620           1731  .UP         ADD.W   #PLAYERSPEED,(PLAYERPOSY)
000020A2                          1732  .NOUP       
000020A2  0839 0002 00002616      1733              BTST #2, KBDVAL         ; SI NO VA HACIA LA DERECHA
000020AA  6700 001E               1734              BEQ .NORIGHT
000020AE  5879 0000261E           1735              ADD.W   #PLAYERSPEED,(PLAYERPOSX)
000020B4  4A81                    1736              TST.L   D1              ; SI HAY COLISIONES CON D1
000020B6  6600 000C               1737              BNE .RIGHT             
000020BA  4A82                    1738              TST.L   D2              ; SI HAY COLISIONES CON D2
000020BC  6600 0006               1739              BNE .RIGHT
000020C0  6000 0008               1740              BRA .NORIGHT
000020C4  5979 0000261E           1741  .RIGHT      SUB.W   #PLAYERSPEED,(PLAYERPOSX)
000020CA                          1742  .NORIGHT    
000020CA  0839 0003 00002616      1743              BTST #3, KBDVAL         ; SI NO VA ABAJO
000020D2  6700 001E               1744              BEQ .NODOWN             
000020D6  5879 00002620           1745              ADD.W   #PLAYERSPEED,(PLAYERPOSY)
000020DC  4A82                    1746              TST.L   D2              ; SI HAY COLISIONES CON D2
000020DE  6600 000C               1747              BNE .DOWN             
000020E2  4A83                    1748              TST.L   D3              ; SI HAY COLISIONES CON D3
000020E4  6600 0006               1749              BNE .DOWN             
000020E8  6000 0008               1750              BRA .NODOWN             
000020EC  5979 00002620           1751  .DOWN       SUB.W   #PLAYERSPEED,(PLAYERPOSY)
000020F2                          1752  .NODOWN     
000020F2  4CDF 000F               1753              MOVEM.L (A7)+,D0-D3
000020F6  4E75                    1754              RTS
000020F8                          1755          
000020F8                          1756  ; ------------------------------------------------------------------------------
000020F8                          1757  PLAYERPLOT
000020F8                          1758  ; PLOT THE PLAYER.
000020F8                          1759  ; INPUT    : NONE 
000020F8                          1760  ; OUTPUT   : NONE
000020F8                          1761  ; MODIFIES : NONE
000020F8                          1762  ; ------------------------------------------------------------------------------
000020F8                          1763              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
000020F8  1F00                    1764              MOVE.B  D0,-(A7)
000020FA  2F01                    1765              MOVE.L  D1,-(A7)
000020FC  48A7 3800               1766        MOVEM.W D2-D4, -(A7)
00002100                          1767        
00002100  223C 00CC954E           1768        MOVE.L #$00CC954E,D1 ;PEN COLOR
00002106  103C 0050               1769        MOVE.B #80,D0
0000210A  4E4F                    1770        TRAP #15
0000210C  223C 00B53866           1771        MOVE.L #$00B53866,D1 ;FILL COLOR
00002112  103C 0051               1772        MOVE.B #81,D0
00002116  4E4F                    1773        TRAP #15
00002118                          1774        ; SE DIBUJA EL CUADRADO
00002118  3239 0000261E           1775        MOVE.W (PLAYERPOSX),D1    
0000211E  3439 00002620           1776        MOVE.W (PLAYERPOSY),D2      
00002124  3601                    1777        MOVE.W D1,D3
00002126  0643 0020               1778              ADD.W  #PLAYERWIDTH,D3  
0000212A  3802                    1779        MOVE.W D2,D4
0000212C  0644 0020               1780              ADD.W  #PLAYERHEIGHT,D4
00002130  103C 0057               1781        MOVE.B #87,D0
00002134  4E4F                    1782        TRAP #15
00002136                          1783        
00002136  4C9F 001C               1784              MOVEM.W (A7)+,D2-D4
0000213A  221F                    1785              MOVE.L  (A7)+,D1      
0000213C  101F                    1786              MOVE.B  (A7)+,D0
0000213E                          1787    
0000213E  4E75                    1788        RTS
00002140                          1789  
00002140                          1790  
00002140                          1791  
00002140                          1792  
00002140                          1793  
00002140                          1794  -------------------- end include --------------------
00002140                          1795              INCLUDE "PROJECTILE.X68"
00002140                          1796  ; ==============================================================================
00002140                          1797  ; PROJECTILE MANAGEMENT (AGENT)
00002140                          1798  ; PROJPOSX (W)  (A0)
00002140                          1799  ; PROJPOSY (W) 2(A0)
00002140                          1800  ; PROJVELX (W) 4(A0)
00002140                          1801  ; PROJVELY (W) 6(A0)
00002140                          1802  ; ==============================================================================
00002140                          1803  
00002140                          1804  ; ------------------------------------------------------------------------------
00002140                          1805  PROJINIT 
00002140                          1806  ; INITIALIZES THE PROJECTILE.
00002140                          1807  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00002140                          1808  ; OUTPUT   : NONE
00002140                          1809  ; MODIFIES : NONE
00002140                          1810  ; ------------------------------------------------------------------------------
00002140  2F00                    1811             MOVE.L  D0,-(A7)
00002142                          1812             
00002142  4280                    1813              CLR.L   D0
00002144  0839 0004 00002617      1814              BTST #4, (KBDEDGE)    
0000214C  6700 0008               1815              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
00002150  0680 FFF80000           1816              ADD.L   #-PROJSPEEDX<<16,D0
00002156  0839 0005 00002617      1817  .FUP        BTST #5, (KBDEDGE)      
0000215E  6700 0006               1818              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
00002162  0640 FFF8               1819              ADD.W   #-PROJSPEEDY,D0 
00002166  0839 0006 00002617      1820  .FRIGHT     BTST #6, (KBDEDGE)
0000216E  6700 0008               1821              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
00002172  0680 00080000           1822              ADD.L   #PROJSPEEDX<<16,D0
00002178  0839 0007 00002617      1823  .FDOWN      BTST #7, (KBDEDGE)
00002180  6700 0004               1824              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
00002184  5040                    1825              ADD.W   #PROJSPEEDY,D0
00002186  4A80                    1826  .NOTFDOWN   TST.L   D0
00002188  6600 0006               1827              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
0000218C  303C 0008               1828              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
00002190  20B9 0000261E           1829  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
00002196  2140 0004               1830              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
0000219A  5279 00002622           1831              ADD.W   #1,(NPROJ)
000021A0  201F                    1832              MOVE.L  (A7)+,D0
000021A2  4E75                    1833              RTS
000021A4                          1834    
000021A4                          1835  ; ------------------------------------------------------------------------------
000021A4                          1836  PROJUPD 
000021A4                          1837  ; UPDATES THE PROJECTILE.
000021A4                          1838  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
000021A4                          1839  ; OUTPUT   : NONE
000021A4                          1840  ; MODIFIES : NONE
000021A4                          1841  ; ------------------------------------------------------------------------------
000021A4  48E7 F000               1842              MOVEM.L  D0-D3,-(A7)
000021A8  2028 0004               1843              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
000021AC  D168 0002               1844              ADD.W   D0,2(A0)
000021B0  E088                    1845              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
000021B2  E088                    1846              LSR.L   #8,D0
000021B4  D150                    1847              ADD.W   D0,(A0) 
000021B6                          1848              
000021B6                          1849              ; CHECK COLLISIONS
000021B6                          1850              ; TOP LEFT CORNER
000021B6  3010                    1851              MOVE.W  (A0),D0
000021B8  E188                    1852              LSL.L   #8,D0
000021BA  E188                    1853              LSL.L   #8,D0
000021BC  3028 0002               1854              MOVE.W  2(A0),D0
000021C0                          1855              
000021C0  3210                    1856              MOVE.W  (A0),D1
000021C2  0641 0010               1857              ADD.W   #PROJWIDTH,D1
000021C6  E189                    1858              LSL.L   #8,D1
000021C8  E189                    1859              LSL.L   #8,D1
000021CA  3228 0002               1860              MOVE.W  2(A0),D1
000021CE  0641 0010               1861              ADD.W   #PROJHEIGHT,D1
000021D2                          1862  
000021D2  4EB8 14A6               1863              JSR BLKCOLL
000021D6  4A80                    1864              TST.L   D0
000021D8  6600 001A               1865              BNE.L   .PROJCOLL
000021DC  4A81                    1866              TST.L   D1
000021DE  6600 0014               1867              BNE.L   .PROJCOLL
000021E2  4A82                    1868              TST.L   D2
000021E4  6600 000E               1869              BNE.L   .PROJCOLL
000021E8  4A83                    1870              TST.L   D3
000021EA  6600 0008               1871              BNE.L   .PROJCOLL
000021EE                          1872  .PROJNOCOLL             
000021EE  4CDF 000F               1873              MOVEM.L  (A7)+,D0-D3
000021F2  4E75                    1874              RTS
000021F4                          1875              
000021F4  4EB8 10F4               1876  .PROJCOLL   JSR AGLKILL
000021F8  5379 00002622           1877              SUB.W   #1,(NPROJ)
000021FE  60EE                    1878              BRA     .PROJNOCOLL
00002200                          1879  ; ------------------------------------------------------------------------------
00002200                          1880  PROJPLOT 
00002200                          1881  ; PLOTS THE PROJECTILE.
00002200                          1882  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
00002200                          1883  ; OUTPUT   : NONE
00002200                          1884  ; MODIFIES : NONE
00002200                          1885  ; ------------------------------------------------------------------------------
00002200  1F00                    1886              MOVE.B  D0,-(A7)
00002202  2F01                    1887              MOVE.L  D1,-(A7)
00002204  48A7 3800               1888        MOVEM.W D2-D4, -(A7)
00002208                          1889        
00002208  223C 00C00FFE           1890        MOVE.L #$00C00FFE,D1 ;PEN COLOR
0000220E  103C 0050               1891        MOVE.B #80,D0
00002212  4E4F                    1892        TRAP #15
00002214  223C 00BFF006           1893        MOVE.L #$00BFF006,D1 ;FILL COLOR
0000221A  103C 0051               1894        MOVE.B #81,D0
0000221E  4E4F                    1895        TRAP #15
00002220                          1896        ; SE DIBUJA EL CUADRADO
00002220  3210                    1897        MOVE.W (A0),D1    
00002222  3428 0002               1898        MOVE.W 2(A0),D2     
00002226  3601                    1899        MOVE.W D1,D3
00002228  0643 0010               1900              ADD.W  #PROJWIDTH,D3    
0000222C  3802                    1901        MOVE.W D2,D4
0000222E  0644 0010               1902              ADD.W  #PROJHEIGHT,D4
00002232  103C 0057               1903        MOVE.B #87,D0
00002236  4E4F                    1904        TRAP #15
00002238                          1905        
00002238  4C9F 001C               1906              MOVEM.W (A7)+,D2-D4
0000223C  221F                    1907              MOVE.L  (A7)+,D1      
0000223E  101F                    1908              MOVE.B  (A7)+,D0
00002240  4E75                    1909              RTS
00002242                          1910  
00002242                          1911  
00002242                          1912  
00002242                          1913  
00002242                          1914  -------------------- end include --------------------
00002242                          1915              INCLUDE "AUDIO.X68"
00002242                          1916     
00002242                          1917  ; =============================================================================
00002242                          1918  ; AUDIO MANAGEMENT
00002242                          1919  ; =============================================================================
00002242                          1920  
00002242                          1921  
00002242                          1922  ; -----------------------------------------------------------------------------
00002242                          1923  AUDINIT
00002242                          1924  ; CHANGES AUDIO TO PLAY
00002242                          1925  ; INPUT    - NONE
00002242                          1926  ; OUTPUT   - NONE
00002242                          1927  ; MODIFIES - NONE
00002242                          1928  ; -----------------------------------------------------------------------------
00002242                          1929      
00002242  48A7 E000               1930      MOVEM.W D0-D2, -(A7)
00002246  48A7 00C0               1931      MOVEM.W A0-A1, -(A7)
0000224A                          1932  ;LOAD ELEVATOR MUSIC IN POS 0 
0000224A  103C 0047               1933      MOVE.B #71, D0
0000224E  43F8 100F               1934      LEA ELEVATOR_MUSIC, A1
00002252  123C 0000               1935      MOVE.B #0, D1
00002256  4E4F                    1936      TRAP #15
00002258                          1937  ;LOAD HEAVEN MUSIC IN POS 1
00002258  43F8 1000               1938      LEA HEAVENSOUND, A1
0000225C  123C 0001               1939      MOVE.B #1, D1
00002260  4E4F                    1940      TRAP #15
00002262                          1941  ;LOAD HELL MUSIC IN POS 2
00002262  43F8 1026               1942      LEA HELLSOUND, A1
00002266  123C 0002               1943      MOVE.B #2, D1
0000226A  4E4F                    1944      TRAP #15
0000226C  4C9F 0300               1945      MOVEM.W (A7)+, A0-A1
00002270  4C9F 0007               1946      MOVEM.W (A7)+, D0-D2
00002274                          1947  
00002274  4E75                    1948      RTS
00002276                          1949  
00002276                          1950  
00002276                          1951  ; -----------------------------------------------------------------------------
00002276                          1952  AUDPLAY
00002276                          1953  ; CHANGES AUDIO TO PLAY
00002276                          1954  ; INPUT    - NONE
00002276                          1955  ; OUTPUT   - NONE
00002276                          1956  ; MODIFIES - NONE
00002276                          1957  ; -----------------------------------------------------------------------------
00002276                          1958      
00002276  48E7 E000               1959      MOVEM.L D0-D2, -(A7)
0000227A  48A7 00C0               1960      MOVEM.W A0-A1, -(A7)    
0000227E                          1961      
0000227E  3239 00002630           1962      MOVE.W LOADEDMAP, D1
00002284  C2FC 0006               1963             MULU #6, D1
00002288  3241                    1964             MOVEA.W D1, A1
0000228A  4EE9 228E               1965             JMP MSCSEL(A1)
0000228E                          1966  MSCSEL:
0000228E                          1967             
0000228E  4EF9 000022DC           1968             JMP HEAVENMUSIC
00002294                          1969             
00002294  4EF9 000022DC           1970             JMP HEAVENMUSIC
0000229A                          1971             
0000229A  4EF9 000022DC           1972             JMP HEAVENMUSIC
000022A0                          1973             
000022A0  4EF9 000022DC           1974             JMP HEAVENMUSIC
000022A6                          1975             
000022A6  4EF9 000022FE           1976             JMP HELLMUSIC
000022AC                          1977             
000022AC  4EF9 000022FE           1978             JMP HELLMUSIC
000022B2                          1979             
000022B2  4EF9 000022FE           1980             JMP HELLMUSIC
000022B8                          1981             
000022B8  4EF9 000022FE           1982             JMP HELLMUSIC
000022BE                          1983             
000022BE                          1984  
000022BE                          1985  ELEVATORMUSIC
000022BE  48A7 E000               1986      MOVEM.W D0-D2 ,-(A7)
000022C2  103C 004C               1987      MOVE.B #76, D0
000022C6  123C 0000               1988      MOVE.B #0, D1
000022CA  7400                    1989      MOVE.L #0, D2
000022CC  4E4F                    1990      TRAP #15
000022CE  4C9F 0007               1991      MOVEM.W (A7)+, D0-D2 
000022D2  13FC 0001 00002676      1992      MOVE.B #1, MUSICPLAYED
000022DA  4E75                    1993      RTS
000022DC                          1994  
000022DC                          1995  HEAVENMUSIC 
000022DC  103C 004C               1996      MOVE.B #76, D0
000022E0  123C 0000               1997      MOVE.B #0, D1
000022E4  7402                    1998      MOVE.L #2, D2
000022E6  4E4F                    1999      TRAP #15
000022E8  103C 004C               2000      MOVE.B #76, D0
000022EC  123C 0001               2001      MOVE.B #1, D1
000022F0  7400                    2002      MOVE.L #0, D2
000022F2  4E4F                    2003      TRAP #15
000022F4  4C9F 0300               2004      MOVEM.W (A7)+, A0-A1
000022F8  4CDF 0007               2005      MOVEM.L (A7)+, D0-D2
000022FC  4E75                    2006      RTS
000022FE                          2007  HELLMUSIC
000022FE  103C 004C               2008      MOVE.B #76, D0
00002302  123C 0000               2009      MOVE.B #0, D1
00002306  7402                    2010      MOVE.L #2, D2
00002308  4E4F                    2011      TRAP #15
0000230A  103C 004C               2012      MOVE.B #76, D0
0000230E  123C 0002               2013      MOVE.B #2, D1
00002312  7400                    2014      MOVE.L #0,  D2
00002314  4E4F                    2015      TRAP #15
00002316  4C9F 0300               2016      MOVEM.W (A7)+, A0-A1
0000231A  4CDF 0007               2017      MOVEM.L (A7)+, D0-D2
0000231E  4E75                    2018      RTS
00002320                          2019  
00002320                          2020  FIREDSOUND
00002320  48A7 E000               2021      MOVEM.W D0-D2, -(A7)
00002324  48A7 00C0               2022      MOVEM.W A0-A1, -(A7)
00002328  103C 0049               2023      MOVE.B #73, D0
0000232C  43F8 1035               2024      LEA PROJ_SOUND, A1
00002330  4E4F                    2025      TRAP #15
00002332  4C9F 0300               2026      MOVEM.W (A7)+, A0-A1
00002336  4C9F 0007               2027      MOVEM.W (A7)+, D0-D2
0000233A  4E75                    2028      RTS
0000233C                          2029  
0000233C                          2030  -------------------- end include --------------------
0000233C                          2031              INCLUDE "STATES.X68"
0000233C                          2032  ; =============================================================================
0000233C                          2033  ; GAME STATE MANAGEMENT
0000233C                          2034  ; =============================================================================
0000233C                          2035  
0000233C                          2036  ; -----------------------------------------------------------------------------
0000233C                          2037  STAINIT
0000233C                          2038  ; INITALIZES THE STATE MANAGER
0000233C                          2039  ; INPUT    - NONE
0000233C                          2040  ; OUTPUT   - NONE
0000233C                          2041  ; MODIFIES - NONE
0000233C                          2042  ; -----------------------------------------------------------------------------
0000233C  33FC FFFF 00002694      2043              MOVE.W  #STANONE,(STACUR)
00002344  4279 00002696           2044              CLR.W   (STANEXT)
0000234A  4E75                    2045              RTS
0000234C                          2046  
0000234C                          2047  ; -----------------------------------------------------------------------------
0000234C                          2048  STAUPD
0000234C                          2049  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
0000234C                          2050  ; INPUT    - NONE
0000234C                          2051  ; OUTPUT   - NONE
0000234C                          2052  ; MODIFIES - NONE
0000234C                          2053  ; -----------------------------------------------------------------------------
0000234C  48E7 8080               2054              MOVEM.L D0/A0,-(A7)
00002350  4280                    2055              CLR.L   D0
00002352  3039 00002696           2056              MOVE.W  (STANEXT),D0
00002358  B079 00002694           2057              CMP.W   (STACUR),D0
0000235E  6700 0012               2058              BEQ     .DOUPD
00002362  33C0 00002694           2059              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002368  E588                    2060              LSL.L   #2,D0
0000236A  2040                    2061              MOVE.L  D0,A0
0000236C  2068 238A               2062              MOVE.L  .INITBL(A0),A0
00002370  4E90                    2063              JSR     (A0)
00002372  4280                    2064  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00002374  3039 00002694           2065              MOVE.W  (STACUR),D0
0000237A  E588                    2066              LSL.L   #2,D0
0000237C  2040                    2067              MOVE.L  D0,A0
0000237E  2068 239A               2068              MOVE.L  .UPDTBL(A0),A0
00002382  4E90                    2069              JSR     (A0)
00002384  4CDF 0101               2070              MOVEM.L (A7)+,D0/A0
00002388  4E75                    2071              RTS
0000238A= 000023D6 00001DB2 ...   2072  .INITBL     DC.L    STAEMPTY,ELEVATORINIT,STAEMPTY,ENDGINIT
0000239A= 00002444 00001FCE ...   2073  .UPDTBL     DC.L    ISCUPD,ELEVATORUPDATE,GAMUPD,ENDGUPD
000023AA                          2074  
000023AA                          2075  ; -----------------------------------------------------------------------------
000023AA                          2076  STAPLOT
000023AA                          2077  ; PERFORMS STATE PLOT
000023AA                          2078  ; INPUT    - NONE
000023AA                          2079  ; OUTPUT   - NONE
000023AA                          2080  ; MODIFIES - NONE
000023AA                          2081  ; -----------------------------------------------------------------------------
000023AA  48E7 8080               2082              MOVEM.L D0/A0,-(A7)
000023AE  4280                    2083              CLR.L   D0
000023B0  3039 00002694           2084              MOVE.W  (STACUR),D0
000023B6  E588                    2085              LSL.L   #2,D0
000023B8  2040                    2086              MOVE.L  D0,A0
000023BA  2068 23C6               2087              MOVE.L  .PLTTBL(A0),A0
000023BE  4E90                    2088              JSR     (A0)
000023C0  4CDF 0101               2089              MOVEM.L (A7)+,D0/A0
000023C4  4E75                    2090              RTS
000023C6= 00002498 00001DB6 ...   2091  .PLTTBL     DC.L    ISCPLOT,ELEVATORPLOT,GAMPLOT,ENDGPLOT
000023D6                          2092  
000023D6                          2093  ; -----------------------------------------------------------------------------
000023D6                          2094  STAEMPTY
000023D6                          2095  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000023D6                          2096  ; INPUT    - NONE
000023D6                          2097  ; OUTPUT   - NONE
000023D6                          2098  ; MODIFIES - NONE
000023D6                          2099  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000023D6                          2100  ; -----------------------------------------------------------------------------
000023D6  4E75                    2101              RTS
000023D8                          2102  
000023D8                          2103  
000023D8                          2104  
000023D8                          2105  
000023D8                          2106  
000023D8                          2107  
000023D8                          2108  
000023D8                          2109  
000023D8                          2110  
000023D8                          2111  
000023D8                          2112  
000023D8                          2113  
000023D8                          2114  -------------------- end include --------------------
000023D8                          2115              INCLUDE "GAME.X68"
000023D8                          2116  ; ==============================================================================
000023D8                          2117  ; GAME MANAGEMENT
000023D8                          2118  ; ==============================================================================
000023D8                          2119  
000023D8                          2120  ; ------------------------------------------------------------------------------
000023D8                          2121  GAMUPD
000023D8                          2122  ; UPDATES THE GAME
000023D8                          2123  ; INPUT    : NONE
000023D8                          2124  ; OUTPUT   : NONE
000023D8                          2125  ; MODIFIES : NONE
000023D8                          2126  ; ------------------------------------------------------------------------------
000023D8  48E7 8070               2127              MOVEM.L D0/A1-A3,-(A7)
000023DC                          2128              
000023DC                          2129              ; CHECK IF MUSIC IS ALREADY PLAYING 
000023DC  1039 00002676           2130              MOVE.B MUSICPLAYED, D0
000023E2  B07C 0001               2131              CMP #1, D0
000023E6  6700 0006               2132              BEQ .NOMUSIC
000023EA  4EB8 2276               2133              JSR AUDPLAY
000023EE                          2134  ; GENERAL UPDATES
000023EE  4EB8 2022               2135  .NOMUSIC    JSR PLAYERUPD   
000023F2  4EB8 19D2               2136              JSR MAPUPD
000023F6                          2137  ; SHOTS LOGIC         
000023F6  1039 00002617           2138              MOVE.B  (KBDEDGE),D0
000023FC  C03C 00F0               2139              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
00002400  6718                    2140              BEQ.B .NOTFIRED
00002402  4EB8 2320               2141              JSR FIREDSOUND
00002406  43F8 2140               2142              LEA     PROJINIT,A1
0000240A  45F8 21A4               2143              LEA     PROJUPD,A2
0000240E  47F8 2200               2144              LEA     PROJPLOT,A3
00002412  303C 0001               2145              MOVE.W  #1,D0
00002416  4EB8 12BC               2146              JSR     AGLADD
0000241A                          2147  .NOTFIRED
0000241A  4A79 00002622           2148              TST.W   (NPROJ)
00002420  6700 0006               2149              BEQ     .NOPROJ1
00002424  4EB8 12D6               2150              JSR     AGLUPD
00002428                          2151  .NOPROJ1
00002428  4CDF 0E01               2152              MOVEM.L (A7)+,D0/A1-A3
0000242C  4E75                    2153              RTS
0000242E                          2154  
0000242E                          2155  ; ------------------------------------------------------------------------------
0000242E                          2156  GAMPLOT
0000242E                          2157  ; PLOTS THE GAME
0000242E                          2158  ; INPUT    : NONE
0000242E                          2159  ; OUTPUT   : NONE
0000242E                          2160  ; MODIFIES : NONE
0000242E                          2161  ; ------------------------------------------------------------------------------
0000242E  4EB8 1538               2162              JSR BLOCKSPLOT     
00002432  4A79 00002622           2163              TST.W   (NPROJ)
00002438  6700 0006               2164              BEQ     .NOPROJ2
0000243C  4EB8 12FA               2165              JSR     AGLPLOT
00002440  6000 FCB6               2166  .NOPROJ2    BRA     PLAYERPLOT
00002444                          2167  
00002444                          2168  
00002444                          2169  
00002444                          2170  
00002444                          2171  
00002444                          2172  
00002444                          2173  
00002444                          2174  
00002444                          2175  
00002444                          2176  -------------------- end include --------------------
00002444                          2177              INCLUDE "INTRO.X68"
00002444                          2178  ; ==============================================================================
00002444                          2179  ; INTRO SCREEN
00002444                          2180  ; ==============================================================================
00002444                          2181  
00002444                          2182  ; ------------------------------------------------------------------------------
00002444                          2183  ISCUPD
00002444                          2184  ; INTRO SCREEN UPDATE
00002444                          2185  ; INPUT    : NONE
00002444                          2186  ; OUTPUT   : NONE
00002444                          2187  ; MODIFIES : NONE
00002444                          2188  ; ------------------------------------------------------------------------------
00002444  48E7 E000               2189              MOVEM.L D0-D2,-(A7)
00002448                          2190              
00002448  103C 000B               2191              MOVE.B  #11,D0          ; SET POINTER
0000244C  223C 00D50170           2192              MOVE.L  #BTONPOSX<<16|BTONPOSY,D1
00002452  4E4F                    2193              TRAP    #15
00002454                          2194              
00002454  103C 003D               2195              MOVE.B  #61,D0          ; READ MOUSE
00002458  123C 0002               2196              MOVE.B  #2,D1           ; MOUSE DOWN STATE
0000245C  4E4F                    2197              TRAP    #15
0000245E  0200 000F               2198              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002462  672E                    2199              BEQ.B   .DONE           ; IF NO CLICK
00002464                          2200              
00002464  4282                    2201              CLR.L       D2
00002466  3401                    2202              MOVE.W      D1,D2       ; D2 IS MOUSE X
00002468  0442 00D5               2203              SUB.W   #BTONPOSX,D2
0000246C  6D00 0024               2204              BLT     .DONE
00002470                          2205              
00002470  4841                    2206              SWAP        D1          ; D1 IS MOUSE Y
00002472  0441 0170               2207              SUB.W   #BTONPOSY,D1
00002476  6D00 001A               2208              BLT     .DONE
0000247A                          2209              
0000247A  0C42 00DA               2210              CMPI.W  #BTONWIDTH,D2
0000247E  6E00 0012               2211              BGT     .DONE
00002482  0C41 0020               2212              CMPI.W  #BTONHEIGHT,D1
00002486  6E00 000A               2213              BGT     .DONE           ; IF CLICKED OUTSIDE THE AREA
0000248A                          2214              
0000248A                          2215              
0000248A  33FC 0001 00002696      2216              MOVE.W  #1,(STANEXT)
00002492                          2217  .DONE
00002492  4CDF 0007               2218              MOVEM.L (A7)+,D0-D2
00002496  4E75                    2219              RTS
00002498                          2220  ; ------------------------------------------------------------------------------
00002498                          2221  ISCPLOT
00002498                          2222  ; INTRO SCREEN PLOT
00002498                          2223  ; INPUT    : NONE
00002498                          2224  ; OUTPUT   : NONE
00002498                          2225  ; MODIFIES : NONE
00002498                          2226  ; ------------------------------------------------------------------------------
00002498  48E7 F880               2227              MOVEM.L D0-D4/A0,-(A7)
0000249C                          2228              
0000249C  303C 0050               2229              MOVE.W  #80, D0
000024A0  223C 00FFFFFF           2230              MOVE.L  #$00FFFFFF, D1 ; PEN COLOR
000024A6  4E4F                    2231              TRAP    #15
000024A8                          2232              
000024A8  303C 0057               2233              MOVE.W  #87, D0
000024AC  323C 00D5               2234              MOVE.W  #BTONPOSX, D1 ; DRAW BUTTON
000024B0  343C 0170               2235              MOVE.W  #BTONPOSY, D2
000024B4  363C 01AF               2236              MOVE.W  #BTONPOSX+BTONWIDTH, D3
000024B8  383C 0190               2237              MOVE.W  #BTONPOSY+BTONHEIGHT, D4
000024BC  4E4F                    2238              TRAP    #15
000024BE                          2239              
000024BE  4281                    2240              CLR.L   D1
000024C0  103C 0051               2241              MOVE.B  #81,D0
000024C4  4E4F                    2242              TRAP    #15
000024C6                          2243              
000024C6  41F9 000024F4           2244              LEA     .TITLE,A0
000024CC  103C 000A               2245              MOVE.B  #10,D0
000024D0  4EB8 1336               2246              JSR     UTLPRINT
000024D4                          2247              
000024D4  0839 0004 00002619      2248              BTST.B  #4,(SCRCYCCT)
000024DC  6700 0010               2249              BEQ     .DONE
000024E0                          2250              
000024E0  41F9 00002520           2251              LEA     .HINT,A0
000024E6  103C 0019               2252              MOVE.B  #25,D0
000024EA  4EB8 1336               2253              JSR     UTLPRINT
000024EE                          2254              
000024EE  4CDF 011F               2255  .DONE       MOVEM.L (A7)+,D0-D4/A0
000024F2                          2256  
000024F2  4E75                    2257              RTS
000024F4= 50 41 54 45 52 4E ...   2258  .TITLE      DC.B    'PATERNOSTER: Beyond the pillars of Hercules',0
00002520= 43 4C 49 43 4B 20 ...   2259  .HINT       DC.B    'CLICK HERE TO START',0
00002534                          2260              DS.W    0
00002534                          2261  
00002534                          2262  
00002534                          2263  
00002534                          2264  
00002534                          2265  
00002534                          2266  
00002534                          2267  
00002534                          2268  
00002534                          2269  
00002534                          2270  
00002534                          2271  -------------------- end include --------------------
00002534                          2272              INCLUDE "ENDGAME.X68"
00002534                          2273  ; ==============================================================================
00002534                          2274  ; VICTORY SCREEN
00002534                          2275  ; ==============================================================================
00002534                          2276  
00002534                          2277  ; ------------------------------------------------------------------------------
00002534                          2278  ENDGINIT
00002534                          2279  ; END GAME SCREEN INIT
00002534                          2280  ; INPUT    : NONE
00002534                          2281  ; OUTPUT   : NONE
00002534                          2282  ; MODIFIES : NONE
00002534                          2283  ; ------------------------------------------------------------------------------
00002534                          2284  
00002534                          2285              ; GUARDAR SU RECORD EN UN FICHERO
00002534                          2286              ; LEER FICHERO QUE GUARDE LOS RECORDS Y GUARDAR EN MEMORIA
00002534  4E75                    2287              RTS
00002536                          2288  ; ------------------------------------------------------------------------------
00002536                          2289  ENDGUPD
00002536                          2290  ; END GAME SCREEN UPDATE
00002536                          2291  ; INPUT    : NONE
00002536                          2292  ; OUTPUT   : NONE
00002536                          2293  ; MODIFIES : NONE
00002536                          2294  ; ------------------------------------------------------------------------------
00002536  103C 003D               2295              MOVE.B  #61,D0          ; READ MOUSE
0000253A  123C 0002               2296              MOVE.B  #2,D1           ; MOUSE DOWN STATE
0000253E  4E4F                    2297              TRAP    #15
00002540  0200 000F               2298              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002544  6708                    2299              BEQ.B   .DONE           ; IF NO CLICK
00002546  33FC 0001 00002696      2300              MOVE.W  #1,(STANEXT)
0000254E                          2301  .DONE
0000254E  4E75                    2302              RTS
00002550                          2303  
00002550                          2304  ; ------------------------------------------------------------------------------
00002550                          2305  ENDGPLOT
00002550                          2306  ; END GAME SCREEN PLOT
00002550                          2307  ; INPUT    : NONE
00002550                          2308  ; OUTPUT   : NONE
00002550                          2309  ; MODIFIES : NONE
00002550                          2310  ; ------------------------------------------------------------------------------
00002550  48E7 C080               2311              MOVEM.L D0-D1/A0,-(A7)
00002554                          2312              
00002554  4281                    2313              CLR.L   D1
00002556  103C 0051               2314              MOVE.B  #81,D0
0000255A  4E4F                    2315              TRAP    #15
0000255C                          2316              
0000255C  41F9 00002598           2317              LEA     .TXT1,A0
00002562  103C 000A               2318              MOVE.B  #10,D0
00002566  4EB8 1336               2319              JSR     UTLPRINT
0000256A                          2320              
0000256A  0839 0008 00002619      2321              BTST.B  #8,(SCRCYCCT)
00002572  6700 0010               2322              BEQ     .NOTPRINT
00002576                          2323              
00002576  41F9 000025B2           2324              LEA     .TXT2,A0
0000257C  103C 0019               2325              MOVE.B  #25,D0
00002580  4EB8 1336               2326              JSR     UTLPRINT
00002584                          2327              
00002584                          2328  .NOTPRINT
00002584  41F9 000025CA           2329              LEA     .TXT3,A0
0000258A  103C 0019               2330              MOVE.B  #25,D0
0000258E  4EB8 1336               2331              JSR     UTLPRINT
00002592                          2332              
00002592                          2333              ; MOSTRAR FICHERO QUE GUARDE LOS RECORDS
00002592                          2334              
00002592  4CDF 0103               2335              MOVEM.L (A7)+,D0-D1/A0
00002596                          2336  
00002596  4E75                    2337              RTS
00002598= 59 4F 55 52 20 52 ...   2338  .TXT1       DC.B    'YOUR RECORD THIS TIME WAS',0
000025B2= 43 4C 49 43 4B 20 ...   2339  .TXT2       DC.B    'CLICK ANYWHERE TO START',0
000025CA= 48 45 52 45 20 41 ...   2340  .TXT3       DC.B    'HERE ARE THE BEST RECORDS',0
000025E4                          2341              DS.W    0
000025E4                          2342  
000025E4                          2343  
000025E4                          2344  
000025E4                          2345  
000025E4                          2346  
000025E4                          2347  -------------------- end include --------------------
000025E4                          2348  START
000025E4                          2349  
000025E4                          2350  ; --- INITIALIZATION -----------------------------------------------------------
000025E4                          2351  
000025E4  007C 0700               2352              ORI.W   #$0700,SR
000025E8  4EB8 110A               2353              JSR     SYSINIT
000025EC  4EB8 233C               2354              JSR     STAINIT
000025F0                          2355  
000025F0                          2356  .LOOP
000025F0                          2357  
000025F0                          2358  ; --- UPDATE -------------------------------------------------------------------
000025F0                          2359  
000025F0                          2360  ; READ INPUT DEVICES
000025F0                          2361  
000025F0  4E41                    2362              TRAP    #KBDUPTN
000025F2                          2363  
000025F2                          2364  ; UPDATE GAME LOGIC
000025F2                          2365  
000025F2  4EB8 234C               2366              JSR     STAUPD
000025F6                          2367  
000025F6                          2368  ; --- SYNC ---------------------------------------------------------------------
000025F6                          2369  
000025F6  4A39 00002618           2370  .WINT       TST.B   (SCRINTCT)
000025FC  67F8                    2371              BEQ     .WINT
000025FE  4239 00002618           2372              CLR.B   (SCRINTCT)
00002604  5239 0000261A           2373              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
0000260A                          2374  
0000260A                          2375  ; --- PLOT ---------------------------------------------------------------------
0000260A                          2376              
0000260A  4EB8 23AA               2377              JSR     STAPLOT
0000260E                          2378              
0000260E  4E40                    2379              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
00002610                          2380  
00002610  60DE                    2381              BRA     .LOOP
00002612                          2382              
00002612  FFFF FFFF               2383              SIMHALT
00002616                          2384              
00002616                          2385              INCLUDE "VARS.X68"
00002616                          2386  ; ==============================================================================
00002616                          2387  ; VARIABLES
00002616                          2388  ; ==============================================================================
00002616                          2389              
00002616                          2390  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00002616                          2391              
00002616                          2392  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
00002617                          2393  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
00002618                          2394  
00002618                          2395  
00002618                          2396  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00002618                          2397  
00002618                          2398  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00002619                          2399  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
0000261A                          2400  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
0000261C                          2401              DS.W    0
0000261C                          2402  
0000261C                          2403  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
0000261C                          2404  
0000261C= 0064                    2405  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
0000261E= 0140                    2406  PLAYERPOSX      DC.W    SCRWIDTH/2
00002620= 00F0                    2407  PLAYERPOSY      DC.W    SCRHEIGH/2
00002622                          2408  
00002622                          2409  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
00002622                          2410  
00002622= 0000                    2411  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
00002624                          2412  
00002624                          2413  ; --- BLOCKS RELATED VARIABLES -------------------------------------------------
00002624                          2414  
00002624= 0000                    2415  BPOSX1      DC.W    0
00002626= 0000                    2416  BPOSY1      DC.W    0
00002628= 0020                    2417  BPOSX2      DC.W    32
0000262A= 0020                    2418  BPOSY2      DC.W    32
0000262C= 02 03 00                2419  BLWHICHCOLL DC.B    2,3,0 ; BLOCKS WHICH PRODUCES COLLISIONS, ENDS WITH NULL
0000262F                          2420  
0000262F                          2421  ; --- MAP RELATED VARIABLES ----------------------------------------------------
0000262F                          2422  
00002630= 0000                    2423  LOADEDMAP   DC.W    0                       ; CURRENT MAP
00002632= 000019EC 00001A34 ...   2424  MAPUPDLIST  DC.L    MAPA1,MAPA2,MAPA3,MAPA4,MAPA5,MAPA6,MAPA7,MAPA8
00002652= 00003340 00003490 ...   2425  MAPLIST     DC.L    HEAVEN_0,HEAVEN_1,HEAVEN_END,HEAVEN_ROOM,HELL_0,HELL_1,HELL_END,HELL_ROOM,0 
00002676                          2426  
00002676                          2427  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
00002676                          2428  
00002676= 00                      2429  MUSICPLAYED DC.B    0
00002678                          2430              DS.W    0
00002678                          2431  
00002678                          2432  ; --- FPS RELATED VARIABLES ----------------------------------------------------
00002678                          2433  
00002678                          2434  REALFPS     DS.W    1
0000267A= 47 4F 41 4C 3A 20 00    2435  STRFPS1     DC.B    'GOAL: ',0   ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
00002681= 46 50 53 20 2D 20 ...   2436  STRFPS2     DC.B    'FPS - ACTUAL: ',0
00002690= 46 50 53 00             2437  STRFPS3     DC.B    'FPS',0
00002694                          2438  
00002694                          2439  ; --- STATE RELATED VARIABLES --------------------------------------------------
00002694                          2440  
00002694                          2441  STACUR      DS.W    1                       ; CURRENT STATE
00002696                          2442  STANEXT     DS.W    1                       ; NEXT STATE
00002698                          2443  
00002698                          2444  
00002698                          2445  
00002698                          2446  
00002698                          2447  
00002698                          2448  
00002698                          2449  
00002698                          2450  
00002698                          2451  
00002698                          2452  
00002698                          2453  
00002698                          2454  
00002698                          2455  
00002698                          2456  -------------------- end include --------------------
00002698                          2457              INCLUDE "LIB/UTLVARS.X68"
00002698                          2458  ; =============================================================================
00002698                          2459  ; UTILITY VARIABLES
00002698                          2460  ; =============================================================================
00002698                          2461  
00002698                          2462  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000269A                          2463              DS.W    0
0000269A                          2464  -------------------- end include --------------------
0000269A                          2465              INCLUDE "LIB/DMMVARS.X68"
0000269A                          2466  ; =============================================================================
0000269A                          2467  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
0000269A                          2468  ; =============================================================================
0000269A                          2469  
000026C0                          2470              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
000026C0                          2471  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00003340                          2472              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00003340                          2473  -------------------- end include --------------------
00003340                          2474              INCLUDE "DATA/MAPDATA.X68"
00003340                          2475  
00003340                          2476  HEAVEN_0    ;MAP 1
00003340= 03 03 03 03 03 03 ...   2477      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00003355= 03 01 01 01 01 01 ...   2478      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
0000336A= 03 01 03 03 03 03 ...   2479      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
0000337F= 03 01 03 05 05 05 ...   2480      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00003394= 03 01 03 05 05 05 ...   2481      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000033A9= 03 01 03 05 05 05 ...   2482      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000033BE= 03 01 03 05 05 05 ...   2483      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
000033D3= 03 01 03 05 05 05 ...   2484      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
000033E8= 03 01 03 05 05 05 ...   2485      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000033FD= 03 01 03 05 05 05 ...   2486      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00003412= 03 01 03 05 05 05 ...   2487      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00003427= 03 01 03 05 05 05 ...   2488      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
0000343C= 03 01 03 05 05 05 ...   2489      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00003451= 03 01 03 03 03 03 ...   2490      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00003466= 03 01 01 01 01 01 ...   2491      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
0000347B= 03 03 03 03 03 03 ...   2492      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00003490                          2493          
00003490                          2494  HEAVEN_1    ;MAP 2
00003490= 03 03 03 03 03 03 ...   2495      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
000034A5= 03 03 01 01 01 01 ...   2496      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
000034BA= 03 03 03 03 03 03 ...   2497      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
000034CF= 03 07 07 07 07 03 ...   2498      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
000034E4= 03 07 07 07 07 03 ...   2499      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
000034F9= 03 07 07 07 07 09 ...   2500      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
0000350E= 03 07 07 07 07 03 ...   2501      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00003523= 03 07 07 07 07 03 ...   2502      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00003538= 03 03 03 03 03 03 ...   2503      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
0000354D= 03 01 01 01 01 03 ...   2504      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00003562= 03 01 01 01 01 01 ...   2505      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00003577= 03 01 01 01 01 01 ...   2506      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
0000358C= 03 01 01 01 01 01 ...   2507      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
000035A1= 03 01 01 01 01 01 ...   2508      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
000035B6= 03 03 03 03 03 03 ...   2509      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
000035CB                          2510      
000035CB                          2511  HEAVEN_END  ;MAP 3
000035CB= 03 03 03 03 03 03 ...   2512      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
000035E0= 03 05 05 05 05 05 ...   2513      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
000035F5= 03 05 05 07 05 05 ...   2514      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000360A= 03 05 07 07 07 05 ...   2515      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
0000361F= 03 05 05 07 05 05 ...   2516      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00003634= 03 05 05 07 05 05 ...   2517      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00003649= 03 05 05 05 05 05 ...   2518      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
0000365E= 03 05 05 05 05 05 ...   2519      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00003673= 03 05 05 05 05 05 ...   2520      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00003688= 03 05 05 07 05 05 ...   2521      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000369D= 03 05 07 07 07 05 ...   2522      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
000036B2= 03 05 05 07 05 05 ...   2523      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000036C7= 03 05 05 07 05 05 ...   2524      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000036DC= 03 05 05 05 05 05 ...   2525      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
000036F1= 03 03 03 03 03 03 ...   2526      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
00003706                          2527      
00003706                          2528  HEAVEN_ROOM ;MAP 4
00003706= 09 09 09 09 09 09 ...   2529      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000371B= 09 09 09 09 09 09 ...   2530      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00003730= 09 09 09 09 09 09 ...   2531      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00003745= 09 09 09 09 09 09 ...   2532      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000375A= 09 09 09 09 09 03 ...   2533      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
0000376F= 09 09 09 09 09 03 ...   2534      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00003784= 09 09 09 09 09 03 ...   2535      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00003799= 09 09 09 09 09 03 ...   2536      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000037AE= 09 09 09 09 09 03 ...   2537      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000037C3= 09 09 09 09 09 03 ...   2538      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000037D8= 09 09 09 09 09 03 ...   2539      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
000037ED= 09 09 09 09 09 09 ...   2540      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00003802= 09 09 09 09 09 09 ...   2541      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00003817= 09 09 09 09 09 09 ...   2542      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000382C= 09 09 09 09 09 09 ...   2543      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
00003841                          2544      
00003841                          2545  HELL_0  ;MAP 5
00003841= 02 02 02 02 02 02 ...   2546      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
00003856= 02 06 06 06 06 06 ...   2547      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000386B= 02 06 06 04 06 06 ...   2548      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00003880= 02 06 06 04 06 06 ...   2549      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00003895= 02 06 04 04 04 06 ...   2550      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
000038AA= 02 06 06 04 06 06 ...   2551      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
000038BF= 02 06 06 06 06 06 ...   2552      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000038D4= 02 02 02 02 02 02 ...   2553      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
000038E9= 02 06 06 06 06 06 ...   2554      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000038FE= 02 06 06 06 06 06 ...   2555      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003913= 02 06 06 06 06 06 ...   2556      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003928= 02 06 06 06 06 06 ...   2557      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000393D= 02 06 06 06 06 06 ...   2558      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003952= 02 06 06 06 06 06 ...   2559      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003967= 02 02 02 02 02 02 ...   2560      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
0000397C                          2561          
0000397C                          2562  HELL_1      ;MAP 6
0000397C= 02 02 02 02 02 02 ...   2563      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00003991= 02 06 06 06 06 06 ...   2564      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000039A6= 02 06 06 06 06 06 ...   2565      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000039BB= 02 06 06 06 06 06 ...   2566      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000039D0= 02 06 06 06 06 06 ...   2567      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000039E5= 02 06 06 06 06 06 ...   2568      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
000039FA= 02 06 06 06 06 06 ...   2569      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00003A0F= 02 06 06 06 06 06 ...   2570      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00003A24= 02 06 06 06 06 06 ...   2571      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003A39= 02 06 06 06 06 06 ...   2572      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003A4E= 02 02 08 02 02 02 ...   2573      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
00003A63= 02 06 06 06 02 02 ...   2574      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00003A78= 02 06 06 06 02 02 ...   2575      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00003A8D= 02 06 06 06 02 02 ...   2576      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00003AA2= 02 02 02 02 02 02 ...   2577      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00003AB7                          2578          
00003AB7                          2579  HELL_END    ;MAP 7
00003AB7= 02 02 02 02 02 02 ...   2580      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00003ACC= 02 06 06 06 06 06 ...   2581      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003AE1= 02 06 06 06 06 06 ...   2582      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003AF6= 02 06 06 06 06 06 ...   2583      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003B0B= 02 06 06 06 06 06 ...   2584      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003B20= 02 06 06 06 06 06 ...   2585      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003B35= 02 06 06 06 06 06 ...   2586      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003B4A= 02 06 06 06 06 06 ...   2587      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003B5F= 02 06 06 06 06 06 ...   2588      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00003B74= 02 06 06 06 06 06 ...   2589      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00003B89= 02 06 06 06 06 06 ...   2590      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003B9E= 02 06 06 06 06 06 ...   2591      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003BB3= 02 06 06 06 06 06 ...   2592      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003BC8= 02 06 06 06 06 06 ...   2593      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003BDD= 02 02 02 02 02 02 ...   2594      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
00003BF2                          2595      
00003BF2                          2596  HELL_ROOM   ;MAP 8
00003BF2= 08 08 08 08 08 08 ...   2597      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003C07= 08 08 08 08 08 08 ...   2598      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003C1C= 08 08 08 08 08 08 ...   2599      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003C31= 08 08 08 08 08 08 ...   2600      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003C46= 08 08 08 08 08 02 ...   2601      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
00003C5B= 08 08 08 08 08 02 ...   2602      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003C70= 08 08 08 08 08 02 ...   2603      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003C85= 08 08 08 08 08 02 ...   2604      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003C9A= 08 08 08 08 08 02 ...   2605      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003CAF= 08 08 08 08 08 02 ...   2606      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003CC4= 08 08 08 08 08 02 ...   2607      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
00003CD9= 08 08 08 08 08 08 ...   2608      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003CEE= 08 08 08 08 08 08 ...   2609      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003D03= 08 08 08 08 08 08 ...   2610      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003D18= 08 08 08 08 08 08 ...   2611      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
00003D2D                          2612  
00003D2E= 0000                    2613      DC.W    0
00003D30                          2614  
00003D30                          2615  
00003D30                          2616  
00003D30                          2617  
00003D30                          2618  
00003D30                          2619  
00003D30                          2620  
00003D30                          2621  
00003D30                          2622  
00003D30                          2623  -------------------- end include --------------------
00003D30                          2624              INCLUDE "DATA/INTRODATA.X68"
00003D30                          2625  
00003D30                          2626  BITMAP
00003D30                          2627  
00003D30                          2628  -------------------- end include --------------------
00003D30                          2629  
00003D30                          2630              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12BC
AGLADD:END          12D2
AGLKILL             10F4
AGLPLOT             12FA
AGLPLOT:END         131A
AGLPLOT:LOOP        1302
AGLUPD              12D6
AGLUPD:END          12F4
AGLUPD:LOOP         12DE
AUDINIT             2242
AUDPLAY             2276
BITMAP              3D30
BLKCOLL             14A6
BLOCKSCOL           F
BLOCKSIZE           20
BLOCKSPLOT          1538
BLOCKSROW           14
BLWHICHCOLL         262C
BPOSX1              2624
BPOSX2              2628
BPOSY1              2626
BPOSY2              262A
BTONHEIGHT          20
BTONPOSX            D5
BTONPOSY            170
BTONWIDTH           DA
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                16DC
DBHV                1750
DDHL                1606
DDHV                1626
DF1HL               187A
DF1HV               185A
DF2HL               18EC
DF2HV               189A
DGHE                1646
DGHL                17C4
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             26C0
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           193E
ELEVATORINIT        1DB2
ELEVATORMUSIC       22BE
ELEVATORPLOT        1DB6
ELEVATORUPDATE      1FCE
ELEVATORUPDATE:HLSEL  2008
ELEVATORUPDATE:HVSEL  1FEE
ELEVATOR_MUSIC      100F
ENDBLOCK            1996
ENDGINIT            2534
ENDGPLOT            2550
ENDGPLOT:NOTPRINT   2584
ENDGPLOT:TXT1       2598
ENDGPLOT:TXT2       25B2
ENDGPLOT:TXT3       25CA
ENDGUPD             2536
ENDGUPD:DONE        254E
ENDMAP              19A8
FIREDSOUND          2320
FPSTEXTPOS          2D01
FRAMES_PER_SECOND   32
GAMPLOT             242E
GAMPLOT:NOPROJ2     2440
GAMUPD              23D8
GAMUPD:NOMUSIC      23EE
GAMUPD:NOPROJ1      2428
GAMUPD:NOTFIRED     241A
HEAVENMUSIC         22DC
HEAVENSOUND         1000
HEAVEN_0            3340
HEAVEN_1            3490
HEAVEN_END          35CB
HEAVEN_ROOM         3706
HELLMUSIC           22FE
HELLSOUND           1026
HELL_0              3841
HELL_1              397C
HELL_END            3AB7
HELL_ROOM           3BF2
ISBLWHICHCOLL       1486
ISBLWHICHCOLL:BCOLL  1498
ISBLWHICHCOLL:BEND  14A4
ISBLWHICHCOLL:BNEXTCHCK  148C
ISBLWHICHCOLL:BNOCOLL  14A2
ISCPLOT             2498
ISCPLOT:DONE        24EE
ISCPLOT:HINT        2520
ISCPLOT:TITLE       24F4
ISCUPD              2444
ISCUPD:DONE         2492
JMPLIST             15BE
KBDDOWN             53
KBDEDGE             2617
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             1260
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              126E
KBDUPD:LOOP         12B2
KBDUPD:PACK         12AE
KBDUPTN             1
KBDVAL              2616
LOADEDMAP           2630
MAP1NODOOR          1A2E
MAP2NODOOR1         1A7C
MAP2NODOOR2         1AB2
MAP2NODOOR3         1AF0
MAP2NODOOR4         1B2E
MAP3NODOOR          1B7C
MAP4NODOOR          1BC4
MAP5NODOOR          1C0C
MAP6NODOOR1         1C5A
MAP6NODOOR2         1C90
MAP6NODOOR3         1CCE
MAP6NODOOR4         1D0C
MAP7NODOOR          1D5C
MAP8NODOOR1         1DAC
MAPA1               19EC
MAPA2               1A34
MAPA3               1B34
MAPA4               1B82
MAPA5               1BCA
MAPA6               1C12
MAPA7               1D12
MAPA8               1D62
MAPLIST             2652
MAPSEL              1550
MAPUPD              19D2
MAPUPDLIST          2632
MSCSEL              228E
MUSICPLAYED         2676
NEWLINE             1972
NEXT                15B0
NPROJ               2622
PLAYERHEALTH        261C
PLAYERHEIGHT        20
PLAYERPLOT          20F8
PLAYERPOSX          261E
PLAYERPOSY          2620
PLAYERSPEED         4
PLAYERUPD           2022
PLAYERUPD:DOWN      20EC
PLAYERUPD:LEFT      2074
PLAYERUPD:NODOWN    20F2
PLAYERUPD:NOLEFT    207A
PLAYERUPD:NORIGHT   20CA
PLAYERUPD:NOUP      20A2
PLAYERUPD:RIGHT     20C4
PLAYERUPD:UP        209C
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            2140
PROJINIT:FDOWN      2178
PROJINIT:FRIGHT     2166
PROJINIT:FUP        2156
PROJINIT:NOTFDOWN   2186
PROJINIT:SHOOT      2190
PROJPLOT            2200
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             21A4
PROJUPD:PROJCOLL    21F4
PROJUPD:PROJNOCOLL  21EE
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             2678
SCRCYCCT            2619
SCRHEIGH            1E0
SCRINIT             1142
SCRINTCT            2618
SCRINTFPS           261A
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             1198
SCRTIM              1240
SCRTIM1S            124E
SCRUPTN             0
SCRWIDTH            280
STACUR              2694
STAEMPTY            23D6
STAINIT             233C
STANEXT             2696
STANONE             FFFFFFFF
STAPLOT             23AA
STAPLOT:PLTTBL      23C6
START               25E4
START:LOOP          25F0
START:WINT          25F6
STAUPD              234C
STAUPD:DOUPD        2372
STAUPD:INITBL       238A
STAUPD:UPDTBL       239A
STRFPS1             267A
STRFPS2             2681
STRFPS3             2690
SYSINIT             110A
TRIANGLE            1F76
TRIANGLE:ISPOSITIVE  1FC4
TRIANGLE:UPWARDS    1F92
UTLCHRWD            8
UTLINIT             1320
UTLPRINT            1336
UTLPRINT:ENDLOOP    1348
UTLPRINT:LOOP       133E
UTLRAND             1368
UTLRAND:RANDVEC     1386
UTLRNDIX            2698
