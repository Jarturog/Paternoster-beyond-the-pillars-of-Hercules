00002F7C Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 15/01/2023 22:55:52

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002D01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/14)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000                            37  ;no lo usas SNDPLTN     EQU     3                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000                            45  
00001000  =00000004                 46  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 47  PLAYERWIDTH     EQU     32
00001000  =00000020                 48  PLAYERHEIGHT    EQU     32
00001000                            49  
00001000                            50  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            51  
00001000  =00000010                 52  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 53  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 54  PROJSPEEDX      EQU     8
00001000  =00000008                 55  PROJSPEEDY      EQU     8
00001000                            56  
00001000                            57  ; --- MUSIC RELATED CONSTANTS --------------------------------------------------
00001000                            58  
00001000= 53 4E 44 2F 4D 55 ...     59  HEAVENSOUND     DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     60  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     61  HELLSOUND       DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     62  PROJ_SOUND      DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            63  
00001048                            64  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001048                            65  
00001048  =FFFFFFFF                 66  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001048                            67  
00001048                            68  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001048                            69  
00001048  =00000014                 70  BLOCKSROW   EQU     20                      ; BLOCKS PER ROW
00001048  =0000000F                 71  BLOCKSCOL   EQU     15                      ; BLOCKS PER COLUMN
00001048  =00000020                 72  BLOCKSIZE   EQU     32                      ; BLOCK SIZE IN PIXELS
00001048                            73  
00001048                            74  ; --- ELEVATOR RELATED CONSTANTS -----------------------------------------------
00001048                            75  
00001048  =000000CC                 76  COLBUTHL    EQU     $000000CC
00001048  =00EEEEEE                 77  COLBUTHV    EQU     $00EEEEEE
00001048                            78  
00001048                            79  
00001048                            80  
00001048                            81  
00001048                            82  
00001048                            83  
00001048                            84  
00001048                            85  
00001048                            86  
00001048                            87  
00001048                            88  
00001048                            89  
00001048                            90  -------------------- end include --------------------
00001048                            91              INCLUDE "LIB/DMMCONST.X68"
00001048                            92  ; =============================================================================
00001048                            93  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                            94  ; =============================================================================
00001048                            95  
00001048  =00000040                 96  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                 97  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                 98  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                 99  -------------------- end include --------------------
00001048                           100              INCLUDE "LIB/UTLCONST.X68"         
00001048                           101  ; ==============================================================================
00001048                           102  ; UTIL CONSTANTS
00001048                           103  ; ==============================================================================
00001048                           104  
00001048  =00000008                105  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001048  =00000008                106  -------------------- end include --------------------
00001048                           107              INCLUDE "LIB/DMMCODE.X68"
00001048                           108  ; =============================================================================
00001048                           109  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                           110  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                           111  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                           112  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                           113  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                           114  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                           115  ; =============================================================================
00001048                           116  
00001048                           117  ; -----------------------------------------------------------------------------
00001048                           118  DMMINIT
00001048                           119  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                           120  ; INPUT    - NONE
00001048                           121  ; OUTPUT   - NONE
00001048                           122  ; MODIFIES - NONE
00001048                           123  ; -----------------------------------------------------------------------------
00001048  48E7 8080                124              MOVEM.L D0/A0,-(A7)
0000104C  41F9 00003040            125              LEA     DMMDATA,A0
00001052  303C 0031                126              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                127  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            128              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                129              DBRA.W  D0,.LOOP
00001064  4CDF 0101                130              MOVEM.L (A7)+,D0/A0
00001068  4E75                     131              RTS
0000106A                           132  
0000106A                           133  ; -----------------------------------------------------------------------------
0000106A                           134  DMMFIRST
0000106A                           135  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           136  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           137  ; INPUT    - NONE
0000106A                           138  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           139  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           140  ; -----------------------------------------------------------------------------
0000106A  41F9 00003040            141              LEA     DMMDATA,A0
00001070  4A58                     142  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                143              BNE     DMMFRFND
00001076  D1FC 0000003E            144              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 00003CBF            145  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     146              BLT     DMMFRLOP
00001084  207C 00000000            147              MOVE.L  #0,A0
0000108A  4E75                     148  DMMFRFND    RTS
0000108C                           149  
0000108C                           150  ; -----------------------------------------------------------------------------
0000108C                           151  DMMNEXT
0000108C                           152  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           153  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           154  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           155  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           156  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           157  ; -----------------------------------------------------------------------------
0000108C  2F00                     158              MOVE.L  D0,-(A7)
0000108E  2008                     159              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            160              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            161              ADD.L   #DMMBSIZE,D0
0000109C  2040                     162              MOVE.L  D0,A0
0000109E  201F                     163              MOVE.L  (A7)+,D0
000010A0  60DA                     164              BRA     DMMFRCOM
000010A2                           165  
000010A2                           166  ; -----------------------------------------------------------------------------
000010A2                           167  DMMFRSTO
000010A2                           168  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           169  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           170  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           171  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           172  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           173  ; -----------------------------------------------------------------------------
000010A2  41F9 00003040            174              LEA     DMMDATA,A0
000010A8  B058                     175  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                176              BEQ     DMMFFND
000010AE  D1FC 0000003E            177              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 00003CBF            178  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     179              BLT     DMMFLOOP
000010BC  207C 00000000            180              MOVE.L  #0,A0
000010C2  4E75                     181  DMMFFND     RTS
000010C4                           182  
000010C4                           183  ; -----------------------------------------------------------------------------
000010C4                           184  DMMNEXTO
000010C4                           185  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           186  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           187  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           188  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           189  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           190  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           191  ; -----------------------------------------------------------------------------
000010C4  2F00                     192              MOVE.L  D0,-(A7)
000010C6  2008                     193              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            194              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            195              ADD.L   #DMMBSIZE,D0
000010D4  2040                     196              MOVE.L  D0,A0
000010D6  201F                     197              MOVE.L  (A7)+,D0
000010D8  60DA                     198              BRA     DMMFCOM
000010DA                           199  
000010DA                           200  ; -----------------------------------------------------------------------------
000010DA                           201  DMMALLOC
000010DA                           202  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           203  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           204  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           205  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           206  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           207  ; -----------------------------------------------------------------------------
000010DA  3F00                     208              MOVE.W  D0,-(A7)
000010DC  4240                     209              CLR.W   D0
000010DE  4EB8 10A2                210              JSR     DMMFRSTO
000010E2  301F                     211              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            212              CMP.L   #0,A0
000010EA  6700 0006                213              BEQ     .END
000010EE  3140 FFFE                214              MOVE.W  D0,-2(A0)
000010F2  4E75                     215  .END        RTS
000010F4                           216  
000010F4                           217  ; -----------------------------------------------------------------------------
000010F4                           218  DMMFREE
000010F4                           219  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           220  ; SYSTEM (0)
000010F4                           221  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           222  ; OUTPUT   - NONE
000010F4                           223  ; MODIFIES - NONE
000010F4                           224  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                225              MOVEM.L D0/A0,-(A7)
000010F8  2008                     226              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            227              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     228              MOVE.L  D0,A0
00001102  4250                     229              CLR.W   (A0)
00001104  4CDF 0101                230              MOVEM.L (A7)+,D0/A0
00001108  4E75                     231              RTS
00001108  4E75                     232  -------------------- end include --------------------
0000110A                           233              INCLUDE "SYSTEM.X68"
0000110A                           234  ; ==============================================================================
0000110A                           235  ; SYSTEM
0000110A                           236  ; ==============================================================================
0000110A                           237              
0000110A                           238  ; ------------------------------------------------------------------------------
0000110A                           239  SYSINIT
0000110A                           240  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           241  ; INPUT    : NONE
0000110A                           242  ; OUTPUT   : NONE
0000110A                           243  ; MODIFIES : NONE
0000110A                           244  ; ------------------------------------------------------------------------------
0000110A                           245  
0000110A  21FC 00001198 0080       246              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000126E 0084       247              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 00001240 0064       248              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001122  21FC 0000124E 0068       249              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
0000112A                           250              
0000112A  4EB8 1048                251              JSR     DMMINIT
0000112E  4EB9 00001142            252              JSR     SCRINIT
00001134  4EB9 00001260            253              JSR     KBDINIT 
0000113A                           254              
0000113A  40E7                     255              MOVE.W  SR,-(A7)
0000113C  0257 D8FF                256              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
00001140  4E73                     257              RTE
00001142                           258              
00001142                           259  ; ------------------------------------------------------------------------------
00001142                           260  SCRINIT
00001142                           261  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001142                           262  ; ENABLE DOUBLE BUFFER.
00001142                           263  ; INPUT    : NONE
00001142                           264  ; OUTPUT   : NONE
00001142                           265  ; MODIFIES : NONE
00001142                           266  ; ------------------------------------------------------------------------------
00001142                           267  
00001142  48E7 F000                268              MOVEM.L D0-D3,-(A7)
00001146                           269  
00001146                           270              ; SET SCREEN RESOLUTION
00001146  103C 0021                271              MOVE.B  #33,D0
0000114A  223C 028001E0            272              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001150  4E4F                     273              TRAP    #15
00001152                           274              
00001152                           275              ; SET WINDOWED MODE
00001152  7201                     276              MOVE.L  #1,D1
00001154  4E4F                     277              TRAP    #15
00001156                           278              
00001156                           279              ; CLEAR SCREEN
00001156  103C 000B                280              MOVE.B  #11,D0
0000115A  323C FF00                281              MOVE.W  #$FF00,D1
0000115E  4E4F                     282              TRAP    #15
00001160                           283  
00001160                           284              ; ENABLE DOUBLE BUFFER
00001160  103C 005C                285              MOVE.B  #92,D0
00001164  123C 0011                286              MOVE.B  #17,D1
00001168  4E4F                     287              TRAP    #15
0000116A                           288              
0000116A                           289              ; ENABLE BOTH TIMED INTERRUPT
0000116A  103C 0020                290              MOVE.B  #32,D0
0000116E  123C 0006                291              MOVE.B  #6,D1
00001172  143C 0081                292              MOVE.B  #$80|SCRINTN,D2
00001176  7614                     293              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001178  4E4F                     294              TRAP    #15
0000117A  143C 0082                295              MOVE.B  #$80|SCRINTFPSN,D2
0000117E  263C 000003E8            296              MOVE.L  #1000,D3
00001184  4E4F                     297              TRAP    #15
00001186                           298              
00001186                           299              ; CLEAR INTERRUPT COUNTER
00001186  4279 00002FB0            300              CLR.W   (SCRINTCT)
0000118C  4239 00002FB2            301              CLR.B   (SCRINTFPS) 
00001192                           302              
00001192  4CDF 000F                303              MOVEM.L (A7)+,D0-D3
00001196                           304              
00001196  4E75                     305              RTS
00001198                           306  
00001198                           307  ; ------------------------------------------------------------------------------
00001198                           308  SCRPLOT
00001198                           309  ; UPDATES DOUBLE BUFFER
00001198                           310  ; INPUT    : NONE
00001198                           311  ; OUTPUT   : NONE
00001198                           312  ; MODIFIES : NONE
00001198                           313  ; ------------------------------------------------------------------------------
00001198  48E7 E000                314              MOVEM.L D0-D2,-(A7)
0000119C  2F09                     315              MOVE.L  A1,-(A7)
0000119E                           316              
0000119E                           317              ; PLOT ACTUAL FPS AND GOAL FPS
0000119E                           318              
0000119E  103C 0051                319              MOVE.B  #81,D0
000011A2  7200                     320              MOVE.L  #$00000000,D1 ; FILL COLOR
000011A4  4E4F                     321              TRAP    #15
000011A6                           322              
000011A6  103C 0050                323              MOVE.B  #80,D0
000011AA  223C 00FFFFFF            324              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011B0  4E4F                     325              TRAP    #15
000011B2                           326              
000011B2  103C 000B                327              MOVE.B  #11,D0
000011B6  223C 00002D01            328              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011BC  4E4F                     329              TRAP    #15
000011BE                           330              
000011BE  43F9 00003012            331              LEA.L   STRFPS1,A1 
000011C4  103C 000E                332              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011C8  4E4F                     333              TRAP    #15
000011CA                           334              
000011CA  103C 000B                335              MOVE.B  #11,D0
000011CE  323C 3601                336              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011D2  4E4F                     337              TRAP    #15
000011D4                           338              
000011D4  5E89                     339              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011D6  103C 000E                340              MOVE.B  #14,D0  
000011DA  4E4F                     341              TRAP    #15 
000011DC                           342              
000011DC  103C 000B                343              MOVE.B  #11,D0
000011E0  323C 4701                344              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E4  4E4F                     345              TRAP    #15
000011E6                           346              
000011E6  D3FC 0000000F            347              ADDA.L  #15,A1 ; PLOT 'FPS'
000011EC  103C 000E                348              MOVE.B  #14,D0 
000011F0  4E4F                     349              TRAP    #15
000011F2                           350              
000011F2  0643 0014                351              ADD.W   #20,D3
000011F6  103C 000B                352              MOVE.B  #11,D0
000011FA  323C 3301                353              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
000011FE  4E4F                     354              TRAP    #15
00001200                           355              
00001200  7232                     356              MOVE.L  #FRAMES_PER_SECOND,D1
00001202  740A                     357              MOVE.L  #10,D2
00001204  103C 000F                358              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001208  4E4F                     359              TRAP    #15
0000120A                           360              
0000120A  0643 0014                361              ADD.W   #20,D3
0000120E  103C 000B                362              MOVE.B  #11,D0
00001212  323C 4401                363              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001216  4E4F                     364              TRAP    #15
00001218                           365              
00001218  4281                     366              CLR.L   D1
0000121A  1239 00003010            367              MOVE.B  (REALFPS),D1
00001220  740A                     368              MOVE.L  #10,D2
00001222  103C 000F                369              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001226  4E4F                     370              TRAP    #15
00001228                           371              
00001228                           372              ; SWITCH BUFFERS
00001228  103C 005E                373              MOVE.B  #94,D0
0000122C  4E4F                     374              TRAP    #15
0000122E                           375              
0000122E                           376              ; CLEAR HIDDEN BUFFER
0000122E  103C 000B                377              MOVE.B  #11,D0
00001232  323C FF00                378              MOVE.W  #$FF00,D1
00001236  4E4F                     379              TRAP    #15
00001238                           380              
00001238  225F                     381              MOVE.L  (A7)+,A1
0000123A  4CDF 0007                382              MOVEM.L (A7)+,D0-D2
0000123E  4E73                     383              RTE
00001240                           384              
00001240                           385  ; ------------------------------------------------------------------------------
00001240                           386  SCRTIM
00001240                           387  ; TIMED INTERRUPT SERVICE ROUTINE
00001240                           388  ; INPUT    : NONE
00001240                           389  ; OUTPUT   : NONE
00001240                           390  ; MODIFIES : NONE
00001240                           391  ; ------------------------------------------------------------------------------
00001240  5239 00002FB0            392              ADDQ.B  #1,(SCRINTCT)
00001246  5239 00002FB1            393              ADDQ.B  #1,(SCRCYCCT)
0000124C  4E73                     394              RTE
0000124E                           395              
0000124E                           396  ; ------------------------------------------------------------------------------
0000124E                           397  SCRTIM1S
0000124E                           398  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000124E                           399  ; INPUT    : NONE
0000124E                           400  ; OUTPUT   : NONE
0000124E                           401  ; MODIFIES : NONE
0000124E                           402  ; ------------------------------------------------------------------------------
0000124E  13F9 00002FB2 00003010   403              MOVE.B  (SCRINTFPS),REALFPS
00001258  4239 00002FB2            404              CLR.B   SCRINTFPS
0000125E  4E73                     405              RTE
00001260                           406  
00001260                           407  ; ------------------------------------------------------------------------------
00001260                           408  KBDINIT
00001260                           409  ; INIT KEYBOARD
00001260                           410  ; INPUT    : NONE
00001260                           411  ; OUTPUT   : NONE
00001260                           412  ; MODIFIES : NONE
00001260                           413  ; ------------------------------------------------------------------------------
00001260  4239 00002FAE            414              CLR.B   (KBDVAL)
00001266  4239 00002FAF            415              CLR.B   (KBDEDGE)
0000126C  4E75                     416              RTS
0000126E                           417  
0000126E                           418  ; ------------------------------------------------------------------------------
0000126E                           419  KBDUPD
0000126E                           420  ; UPDATE KEYBOARD INFO.  
0000126E                           421  ; 7 -> FIRE DOWN
0000126E                           422  ; 6 -> FIRE RIGHT
0000126E                           423  ; 5 -> FIRE UP
0000126E                           424  ; 4 -> FIRE LEFT
0000126E                           425  ; 3 -> DOWN
0000126E                           426  ; 2 -> RIGHT
0000126E                           427  ; 1 -> UP
0000126E                           428  ; 0 -> LEFT
0000126E                           429  ; INPUT    : NONE
0000126E                           430  ; OUTPUT   : NONE
0000126E                           431  ; MODIFIES : NONE
0000126E                           432  ; ------------------------------------------------------------------------------
0000126E                           433  
0000126E  48E7 F000                434              MOVEM.L D0-D3,-(A7)
00001272                           435  
00001272                           436              ; READ FIRST PART
00001272  103C 0013                437              MOVE.B  #19,D0
00001276  223C 28272625            438              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000127C  4E4F                     439              TRAP    #15
0000127E                           440              
0000127E                           441              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000127E  4EB9 000012AE            442              JSR     .PACK
00001284                           443  
00001284                           444              ; READ SECOND PART
00001284  223C 53445741            445              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000128A  4E4F                     446              TRAP    #15
0000128C                           447  
0000128C                           448              ; CONVERT TO DESIRED FORMAT
0000128C  4EB9 000012AE            449              JSR     .PACK
00001292                           450              
00001292                           451              ; COMPUTE KBDEDGE
00001292  1039 00002FAE            452              MOVE.B  (KBDVAL),D0
00001298  4600                     453              NOT.B   D0
0000129A  C002                     454              AND.B   D2,D0
0000129C  13C0 00002FAF            455              MOVE.B  D0,(KBDEDGE)
000012A2                           456              
000012A2                           457              ; STORE KBDVAL
000012A2  13C2 00002FAE            458              MOVE.B  D2,(KBDVAL)
000012A8                           459              
000012A8  4CDF 000F                460              MOVEM.L (A7)+,D0-D3
000012AC                           461  
000012AC  4E73                     462              RTE
000012AE                           463              
000012AE  363C 0003                464  .PACK       MOVE.W  #3,D3
000012B2  E189                     465  .LOOP       LSL.L   #8,D1
000012B4  E312                     466              ROXL.B  #1,D2
000012B6  51CB FFFA                467              DBRA.W  D3,.LOOP
000012BA  4E75                     468              RTS
000012BC                           469  
000012BC                           470  
000012BC                           471  
000012BC                           472  -------------------- end include --------------------
000012BC                           473              INCLUDE "LIB/AGLCODE.X68"
000012BC                           474  ; =============================================================================
000012BC                           475  ; AGENT MANAGEMENT
000012BC                           476  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012BC                           477  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012BC                           478  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012BC                           479  ; +8:END    : DATA (AGENT SPECIFIC)
000012BC                           480  ; =============================================================================
000012BC                           481  
000012BC                           482  ; -----------------------------------------------------------------------------
000012BC                           483  AGLADD
000012BC                           484  ; CREATES A NEW AGENT
000012BC                           485  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012BC                           486  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012BC                           487  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012BC                           488  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012BC                           489  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012BC                           490  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012BC                           491  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012BC                           492  ; OUTPUT   - NONE
000012BC                           493  ; MODIFIES - NONE
000012BC                           494  ; -----------------------------------------------------------------------------
000012BC  2F08                     495              MOVE.L  A0,-(A7)
000012BE  4EB8 10DA                496              JSR     DMMALLOC
000012C2  B1FC 00000000            497              CMP.L   #0,A0
000012C8  6700 0008                498              BEQ     .END
000012CC  20CA                     499              MOVE.L  A2,(A0)+
000012CE  20CB                     500              MOVE.L  A3,(A0)+
000012D0  4E91                     501              JSR     (A1)
000012D2  205F                     502  .END        MOVE.L  (A7)+,A0
000012D4  4E75                     503              RTS
000012D6                           504  
000012D6                           505  ; -----------------------------------------------------------------------------
000012D6                           506  AGLUPD
000012D6                           507  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012D6                           508  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012D6                           509  ; INPUT    - NONE
000012D6                           510  ; OUTPUT   - NONE
000012D6                           511  ; MODIFIES - NONE
000012D6                           512  ; -----------------------------------------------------------------------------
000012D6  48E7 00C0                513              MOVEM.L A0-A1,-(A7)
000012DA  4EB8 106A                514              JSR     DMMFIRST
000012DE  B1FC 00000000            515  .LOOP       CMP.L   #0,A0
000012E4  6700 000E                516              BEQ     .END
000012E8  2250                     517              MOVE.L  (A0),A1
000012EA  5088                     518              ADD.L   #8,A0
000012EC  4E91                     519              JSR     (A1)
000012EE  4EB8 108C                520              JSR     DMMNEXT
000012F2  60EA                     521              BRA     .LOOP
000012F4  4CDF 0300                522  .END        MOVEM.L (A7)+,A0-A1
000012F8  4E75                     523              RTS
000012FA                           524  
000012FA                           525  ; -----------------------------------------------------------------------------
000012FA                           526  AGLPLOT
000012FA                           527  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012FA                           528  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012FA                           529  ; INPUT    - NONE
000012FA                           530  ; OUTPUT   - NONE
000012FA                           531  ; MODIFIES - NONE
000012FA                           532  ; -----------------------------------------------------------------------------
000012FA  48E7 00C0                533              MOVEM.L A0-A1,-(A7)
000012FE  4EB8 106A                534              JSR     DMMFIRST
00001302  B1FC 00000000            535  .LOOP       CMP.L   #0,A0
00001308  6700 0010                536              BEQ     .END
0000130C  2268 0004                537              MOVE.L  4(A0),A1
00001310  5088                     538              ADD.L   #8,A0
00001312  4E91                     539              JSR     (A1)
00001314  4EB8 108C                540              JSR     DMMNEXT
00001318  60E8                     541              BRA     .LOOP
0000131A  4CDF 0300                542  .END        MOVEM.L (A7)+,A0-A1
0000131E  4E75                     543              RTS
00001320                           544  
00001320                           545  ; -----------------------------------------------------------------------------
00001320  =000010F4                546  AGLKILL     EQU     DMMFREE
00001320                           547  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001320                           548  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001320                           549  ; OUTPUT   - NONE
00001320                           550  ; MODIFIES - NONE
00001320                           551  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001320                           552  ; -----------------------------------------------------------------------------
00001320                           553  -------------------- end include --------------------
00001320                           554              INCLUDE "LIB/UTLCODE.X68"
00001320                           555  ; =============================================================================
00001320                           556  ; UTILITY CODE
00001320                           557  ; =============================================================================
00001320                           558  
00001320                           559  ; -----------------------------------------------------------------------------
00001320                           560  UTLINIT
00001320                           561  ; INITIALIZES UTILITY CODE
00001320                           562  ; INPUT    - NONE
00001320                           563  ; OUTPUT   - NONE
00001320                           564  ; MODIFIES - NONE
00001320                           565  ; -----------------------------------------------------------------------------
00001320  48E7 C000                566              MOVEM.L D0-D1,-(A7)
00001324  103C 0008                567              MOVE.B  #8,D0
00001328  4E4F                     568              TRAP    #15
0000132A  13C1 00003030            569              MOVE.B  D1,(UTLRNDIX)
00001330  4CDF 0003                570              MOVEM.L (A7)+,D0-D1
00001334  4E75                     571              RTS
00001336                           572  
00001336                           573  ; -----------------------------------------------------------------------------
00001336                           574  UTLPRINT
00001336                           575  ; PRINT SCREEN CENTERED TEXT
00001336                           576  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001336                           577  ;            D0.B SCREEN ROW TO PRINT TEXT
00001336                           578  ; OUTPUT   : D0.B NEXT ROW
00001336                           579  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001336                           580  ; -----------------------------------------------------------------------------
00001336  48E7 C0C0                581              MOVEM.L D0-D1/A0-A1,-(A7)
0000133A  4201                     582              CLR.B   D1
0000133C  2248                     583              MOVE.L  A0,A1
0000133E  4A18                     584  .LOOP       TST.B   (A0)+
00001340  6700 0006                585              BEQ     .ENDLOOP
00001344  5201                     586              ADDQ.B  #1,D1
00001346  60F6                     587              BRA     .LOOP
00001348  E209                     588  .ENDLOOP    LSR.B   #1,D1
0000134A  0401 0028                589              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000134E  4401                     590              NEG.B   D1
00001350  E141                     591              ASL.W   #8,D1
00001352  8240                     592              OR.W    D0,D1
00001354  103C 000B                593              MOVE.B  #11,D0
00001358  4E4F                     594              TRAP    #15
0000135A  103C 000D                595              MOVE.B  #13,D0
0000135E  4E4F                     596              TRAP    #15
00001360  4CDF 0303                597              MOVEM.L (A7)+,D0-D1/A0-A1
00001364  5200                     598              ADDQ.B  #1,D0
00001366  4E75                     599              RTS
00001368                           600  
00001368                           601  ; -----------------------------------------------------------------------------
00001368                           602  UTLRAND
00001368                           603  ; PROVIDES A PSEUDO-RANDOM BYTE
00001368                           604  ; INPUT    - NONE
00001368                           605  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001368                           606  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001368                           607  ; -----------------------------------------------------------------------------
00001368  2F08                     608              MOVE.L  A0,-(A7)
0000136A  41F9 00001386            609              LEA     .RANDVEC,A0
00001370  4280                     610              CLR.L   D0
00001372  1039 00003030            611              MOVE.B  (UTLRNDIX),D0
00001378  1030 0800                612              MOVE.B  (A0,D0.L),D0
0000137C  5239 00003030            613              ADDQ.B  #1,(UTLRNDIX)
00001382  205F                     614              MOVE.L  (A7)+,A0
00001384  4E75                     615              RTS
00001386                           616  
00001386                           617  
00001386= A2 EE 9A 0C F5 24 ...    618  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000138E= 2A A3 51 26 E0 AC ...    619              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001396= 75 51 CA FD 33 EB ...    620              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000139E= 60 CC E7 B8 9A EB ...    621              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013A6= 1D 76 B5 95 B0 89 ...    622              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013AE= 39 15 48 C9 6E CA ...    623              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013B6= 43 E7 E2 7C 37 25 ...    624              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013BE= E9 94 CE E9 E4 52 ...    625              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013C6= 37 6D 9A 84 A2 28 ...    626              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013CE= 19 E2 C6 77 80 D4 ...    627              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013D6= 0A 5A 32 67 33 C2 ...    628              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013DE= 59 80 DC 0E 57 FC ...    629              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013E6= 8A AB BC F7 07 4D ...    630              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013EE= EF D5 77 6E 1E BB ...    631              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013F6= D6 E0 2A 8F BD 28 ...    632              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013FE= 13 4F 66 EC 0A 64 ...    633              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001406= 56 52 9A 16 9B 90 ...    634              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000140E= 06 8A A4 F7 01 DA ...    635              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001416= F2 E7 77 28 B1 76 ...    636              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000141E= A4 42 E3 81 B1 67 ...    637              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001426= BF CE FA 16 BF 38 ...    638              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000142E= D1 8B 50 0C 5F 49 ...    639              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001436= DE 4C 14 A2 40 DC ...    640              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000143E= B6 9B 0A 38 5D AB ...    641              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001446= E2 1B DD 75 15 82 ...    642              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000144E= 8A 26 51 30 9F 47 ...    643              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001456= 1E 8A BB 71 C6 6E ...    644              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000145E= 9F 47 E5 34 94 27 ...    645              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001466= 7D 06 D6 BA 30 0F ...    646              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000146E= EC 7F 7E 03 CF 2D ...    647              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001476= 94 5B 23 F2 8B CD ...    648              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000147E= 74 33 EC B9 0F D5 ...    649              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001486                           650  
00001486                           651  -------------------- end include --------------------
00001486                           652              INCLUDE "BLOCKS.X68"
00001486                           653  
00001486                           654  ; -----------------------------------------------------------------------------
00001486                           655  ISBLWHICHCOLL 
00001486                           656  ; CHECKS IF THE BLOCK IN D4 PRODUCES COLLISIONS
00001486                           657  ; INPUT    - D4.B
00001486                           658  ; OUTPUT   - ALL 1'S IF D4.L PRODUCES COLLISIONS, ALL 0'S IF NOT
00001486                           659  ; MODIFIES - D4.L, A0
00001486                           660  ; -----------------------------------------------------------------------------
00001486  41F9 00002FC4            661              LEA.L   BLWHICHCOLL, A0
0000148C  4A10                     662  .BNEXTCHCK  TST.B   (A0)
0000148E  6712                     663              BEQ.B   .BNOCOLL
00001490  B810                     664              CMP.B   (A0),D4
00001492  6704                     665              BEQ.B   .BCOLL
00001494  5288                     666              ADDA.L  #1,A0
00001496  60F4                     667              BRA     .BNEXTCHCK
00001498  0084 FFFFFFFF            668  .BCOLL      ORI.L   #$FFFFFFFF, D4
0000149E  6000 0004                669              BRA     .BEND
000014A2  4284                     670  .BNOCOLL    CLR.L   D4
000014A4                           671  .BEND
000014A4  4E75                     672              RTS
000014A6                           673  
000014A6                           674  ; -----------------------------------------------------------------------------
000014A6                           675  BLKCOLL 
000014A6                           676  ; DETECTS BLOCK COLLISIONS
000014A6                           677  ; INPUT    - D0 TOP LEFT CORNER OF OBJECT, D1 BOTTOM RIGHT, WHERE UPPER WORD
000014A6                           678  ;            IS THE X COORDINATE AND LOWER WORD Y COORDINATE
000014A6                           679  ; OUTPUT   - ALL 1'S IN THE THE REGISTER THAT COLLIDES WITH A BLOCK
000014A6                           680  ;            THAT CANNOT BE TRAVERSED. THESE ARE D0 FOR LEFT UPPER BLOCK,
000014A6                           681  ;            D1 FOR RIGHT UPPER BLOCK, D2 FOR LEFT LOWER BLOCK AND D3 FOR 
000014A6                           682  ;            RIGHT LOWER BLOCK
000014A6                           683  ; MODIFIES - D0.L, D1.L, D2.L, D3.L
000014A6                           684  ; -----------------------------------------------------------------------------
000014A6  48E7 0E80                685              MOVEM.L D4-D6/A0,-(A7)
000014AA                           686              
000014AA  7810                     687              MOVE.L  #16,D4
000014AC  3400                     688              MOVE.W  D0,D2   ; D2 CONTAINS X LEFT
000014AE  E8A8                     689              LSR.L   D4,D0   ; D0 CONTAINS Y UPPER
000014B0  3601                     690              MOVE.W  D1,D3   ; D3 CONTAINS X RIGHT
000014B2  E8A9                     691              LSR.L   D4,D1   ; D1 CONTAINS Y LOWER
000014B4                           692              
000014B4  48C0                     693              EXT.L   D0
000014B6  48C1                     694              EXT.L   D1
000014B8  48C2                     695              EXT.L   D2
000014BA  48C3                     696              EXT.L   D3
000014BC                           697              
000014BC  80FC 0020                698              DIVU.W  #BLOCKSIZE,D0   ; LEFT BLOCK
000014C0  82FC 0020                699              DIVU.W  #BLOCKSIZE,D1   ; RIGHT BLOCK
000014C4  84FC 0020                700              DIVU.W  #BLOCKSIZE,D2   ; UPPER BLOCK
000014C8  86FC 0020                701              DIVU.W  #BLOCKSIZE,D3   ; LOWER BLOCK
000014CC                           702              
000014CC  48C0                     703              EXT.L   D0
000014CE  48C1                     704              EXT.L   D1
000014D0  48C2                     705              EXT.L   D2
000014D2  48C3                     706              EXT.L   D3
000014D4                           707              
000014D4  7815                     708              MOVE.L  #BLOCKSROW+1,D4 ; +1 BECAUSE OF NULL
000014D6  C8C2                     709              MULU.W  D2,D4           ; INDEX OF COLUMN OF UPPER LEFT AND RIGHT BLOCKS
000014D8  7A15                     710              MOVE.L  #BLOCKSROW+1,D5 ; +1 BECAUSE OF NULL
000014DA  CAC3                     711              MULU.W  D3,D5           ; INDEX OF COLUMN OF LOWER LEFT AND RIGHT BLOCKS
000014DC                           712              
000014DC  3C39 00002FC8            713              MOVE.W  (LOADEDMAP),D6
000014E2  48C6                     714              EXT.L   D6
000014E4  CCFC 0004                715              MULU    #4,D6
000014E8  41F9 00002FEA            716              LEA.L   MAPLIST,A0
000014EE  D1C6                     717              ADDA.L  D6,A0
000014F0  2050                     718              MOVEA.L (A0),A0         ; CURRENT MAP ADDRESS
000014F2                           719              
000014F2  2248                     720              MOVEA.L A0,A1
000014F4  D3C5                     721              ADDA.L  D5,A1   
000014F6  D3C1                     722              ADDA.L  D1,A1           ; RIGHT LOWER BLOCK
000014F8  1611                     723              MOVE.B  (A1),D3         ; STORING BOTTOM RIGHT BLOCK IN D3
000014FA                           724              
000014FA  2248                     725              MOVEA.L A0,A1
000014FC  D3C5                     726              ADDA.L  D5,A1   
000014FE  D3C0                     727              ADDA.L  D0,A1           ; LEFT LOWER BLOCK
00001500  1411                     728              MOVE.B  (A1),D2         ; STORING BOTTOM LEFT BLOCK IN D2
00001502                           729              
00001502  2248                     730              MOVEA.L A0,A1
00001504  D3C4                     731              ADDA.L  D4,A1   
00001506  D3C1                     732              ADDA.L  D1,A1           ; RIGHT UPPER BLOCK
00001508  1211                     733              MOVE.B  (A1),D1         ; STORING TOP RIGHT BLOCK IN D1
0000150A                           734              
0000150A  2248                     735              MOVEA.L A0,A1
0000150C  D3C4                     736              ADDA.L  D4,A1   
0000150E  D3C0                     737              ADDA.L  D0,A1           ; LEFT UPPER BLOCK
00001510  1011                     738              MOVE.B  (A1),D0         ; STORING TOP LEFT BLOCK IN D0
00001512                           739              
00001512  1800                     740              MOVE.B  D0,D4
00001514  4EB8 1486                741              JSR     ISBLWHICHCOLL
00001518  2004                     742              MOVE.L  D4,D0
0000151A                           743              
0000151A  1801                     744              MOVE.B  D1,D4
0000151C  4EB8 1486                745              JSR     ISBLWHICHCOLL
00001520  2204                     746              MOVE.L  D4,D1
00001522                           747              
00001522  1802                     748              MOVE.B  D2,D4
00001524  4EB8 1486                749              JSR     ISBLWHICHCOLL
00001528  2404                     750              MOVE.L  D4,D2
0000152A                           751              
0000152A  1803                     752              MOVE.B  D3,D4
0000152C  4EB8 1486                753              JSR     ISBLWHICHCOLL
00001530  2604                     754              MOVE.L  D4,D3
00001532                           755              
00001532  4CDF 0170                756              MOVEM.L (A7)+,D4-D6/A0
00001536                           757              
00001536  4E75                     758              RTS
00001538                           759  
00001538                           760  ; -----------------------------------------------------------------------------
00001538                           761  MAPPLOT
00001538                           762  ; INPUT    - 
00001538                           763  ; OUTPUT   - 
00001538                           764  ; MODIFIES - 
00001538                           765  ; -----------------------------------------------------------------------------
00001538                           766  
00001538  48E7 FF00                767          MOVEM.L D0-D7, -(A7)
0000153C  48E7 00FE                768          MOVEM.L A0-A6, -(A7)
00001540  3239 00002FC8            769             MOVE.W LOADEDMAP, D1
00001546  C2FC 000C                770             MULU #12, D1
0000154A  3241                     771             MOVEA.W D1, A1
0000154C  4EE9 1550                772             JMP MAPSEL(A1)
00001550                           773  MAPSEL:
00001550  41F9 00001DB2            774             LEA HEAVEN_0, A0
00001556  4EF9 000015CA            775             JMP NEXT
0000155C  41F9 00001F02            776             LEA HEAVEN_1, A0
00001562  4EF9 000015CA            777             JMP NEXT
00001568  41F9 0000203D            778             LEA HEAVEN_END, A0
0000156E  4EF9 000015CA            779             JMP NEXT
00001574  41F9 00002178            780             LEA HEAVEN_ROOM, A0
0000157A  4EF9 000015CA            781             JMP NEXT
00001580  41F9 000022B3            782             LEA HELL_0, A0
00001586  4EF9 000015CA            783             JMP NEXT
0000158C  41F9 000023EE            784             LEA HELL_1, A0
00001592  4EF9 000015CA            785             JMP NEXT
00001598  41F9 00002529            786             LEA HELL_END, A0
0000159E  4EF9 000015CA            787             JMP NEXT
000015A4  41F9 00002664            788             LEA HELL_ROOM, A0
000015AA  4EF9 000015CA            789             JMP NEXT
000015B0                           790  ; -----------------------------------------------------------------------------
000015B0                           791  MAPUPD
000015B0                           792  ; INPUT    - 
000015B0                           793  ; OUTPUT   - 
000015B0                           794  ; MODIFIES - A0
000015B0                           795  ; -----------------------------------------------------------------------------
000015B0  3F00                     796              MOVE.W D0,-(A7)
000015B2                           797              
000015B2  3039 00002FC8            798              MOVE.W  LOADEDMAP, D0
000015B8                           799              
000015B8  48C0                     800              EXT.L   D0
000015BA  C0FC 0004                801              MULU    #4,D0
000015BE  41F9 00002FCA            802              LEA.L   MAPUPDLIST,A0
000015C4  D1C0                     803              ADDA.L  D0,A0
000015C6  2050                     804              MOVEA.L (A0),A0
000015C8  4ED0                     805              JMP     (A0)
000015CA                           806  
000015CA                           807              
000015CA                           808  NEXT
000015CA  4281                     809             CLR.L D1
000015CC  1218                     810             MOVE.B (A0)+,D1
000015CE  C2FC 0006                811             MULU #6, D1
000015D2  2241                     812             MOVEA.L D1, A1
000015D4  4EE9 15D8                813             JMP JMPLIST(A1)
000015D8                           814             
000015D8                           815  JMPLIST: 
000015D8  4EF9 0000198C            816              JMP NEWLINE ; 0 = END OF ROW
000015DE  4EF9 00001660            817              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
000015E4  4EF9 000016F6            818              JMP DBHL    ; 2 = DRAW BRICK HELL
000015EA  4EF9 0000176A            819              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
000015F0  4EF9 000017DE            820              JMP DGHL    ; 4 = DRAW GRASS HELL
000015F6  4EF9 00001874            821              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
000015FC  4EF9 00001894            822              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
00001602  4EF9 000018B4            823              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
00001608  4EF9 00001620            824              JMP DDHL    ; 8 = DRAW DOOR HELL
0000160E  4EF9 00001640            825              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
00001614  4EF9 00001906            826              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
0000161A  4EF9 000019C2            827              JMP ENDMAP  ; 11 = END OF THE MAP
00001620                           828              
00001620                           829  DDHL
00001620  2F3C 00111111            830      MOVE.L #$00111111, -(A7)
00001626  2F3C 00111111            831      MOVE.L #$00111111, -(A7)
0000162C  4EB9 00001958            832      JSR DRAWBLOCK
00001632  2C1F                     833      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001634  2C1F                     834      MOVE.L (A7)+, D6    
00001636  4EB9 000019B0            835      JSR ENDBLOCK
0000163C  4EF8 15CA                836      JMP NEXT
00001640                           837  DDHV
00001640  2F3C 00FFFFFF            838      MOVE.L #$00FFFFFF, -(A7)
00001646  2F3C 00FFFFFF            839      MOVE.L #$00FFFFFF, -(A7)
0000164C  4EB9 00001958            840      JSR DRAWBLOCK
00001652  2C1F                     841      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001654  2C1F                     842      MOVE.L (A7)+, D6
00001656  4EB9 000019B0            843      JSR ENDBLOCK
0000165C  4EF8 15CA                844      JMP NEXT
00001660                           845  DGHE ;DRAW-GRASS-HEAVEN vvvR
00001660  2F3C 0099FF99            846      MOVE.L #$0099FF99, -(A7)
00001666  2F3C 0099FF99            847      MOVE.L #$0099FF99, -(A7)
0000166C  4EB9 00001958            848      JSR DRAWBLOCK
00001672  2C1F                     849      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001674  2C1F                     850      MOVE.L (A7)+, D6
00001676                           851      ; SET PEN COLOR 
00001676  103C 0050                852      MOVE.B #80, D0
0000167A  223C 0000CC00            853      MOVE.L #$0000CC00, D1
00001680  4E4F                     854      TRAP #15
00001682                           855      ;DRAW LINES   
00001682  103C 0054                856      MOVE.B #84, D0 
00001686                           857      ;LINEA 11 
00001686  3239 00002FBC            858      MOVE.W BPOSX1,D1
0000168C  5C41                     859      ADD.W #6, D1
0000168E  3439 00002FBE            860      MOVE.W BPOSY1, D2
00001694  5A42                     861      ADD.W #5, D2
00001696  3639 00002FBC            862      MOVE.W BPOSX1, D3
0000169C  0643 0009                863      ADD.W #9, D3
000016A0  3839 00002FBE            864      MOVE.W BPOSY1, D4
000016A6  0644 000A                865      ADD.W #10, D4
000016AA  4E4F                     866      TRAP #15
000016AC                           867      ;LINEA 12
000016AC  5041                     868      ADD.W #8, D1    
000016AE  5043                     869      ADD.W #8, D3
000016B0  4E4F                     870      TRAP #15
000016B2                           871      ;LINEA 13
000016B2  5041                     872      ADD.W #8, D1    
000016B4  5043                     873      ADD.W #8, D3
000016B6  4E4F                     874      TRAP #15
000016B8                           875      ;LINEA 21
000016B8  3239 00002FBC            876      MOVE.W BPOSX1,D1
000016BE  5C41                     877      ADD.W #6, D1
000016C0  3439 00002FBE            878      MOVE.W BPOSY1, D2
000016C6  0642 0014                879      ADD.W #20, D2
000016CA  3639 00002FBC            880      MOVE.W BPOSX1, D3
000016D0  0643 0009                881      ADD.W #9, D3
000016D4  3839 00002FBE            882      MOVE.W BPOSY1, D4
000016DA  0644 0019                883      ADD.W #25, D4
000016DE  4E4F                     884      TRAP #15
000016E0                           885      ;LINEA 22
000016E0  5041                     886      ADD.W #8, D1    
000016E2  5043                     887      ADD.W #8, D3
000016E4  4E4F                     888      TRAP #15
000016E6                           889      ;LINEA 23
000016E6  5041                     890      ADD.W #8, D1    
000016E8  5043                     891      ADD.W #8, D3
000016EA  4E4F                     892      TRAP #15
000016EC  4EB9 000019B0            893      JSR ENDBLOCK
000016F2  4EF8 15CA                894      JMP NEXT
000016F6                           895  DBHL ;DRAW BRICK-HELL vvvR
000016F6                           896      
000016F6  2F3C 00010101            897      MOVE.L #$00010101, -(A7)
000016FC  2F3C 00666666            898      MOVE.L #$00666666, -(A7)
00001702  4EB9 00001958            899      JSR DRAWBLOCK
00001708  2C1F                     900      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000170A  2C1F                     901      MOVE.L (A7)+, D6
0000170C                           902      ;DRAW HORIZONTAL LINE
0000170C  103C 0054                903      MOVE.B #84, D0 
00001710  3239 00002FBC            904      MOVE.W BPOSX1, D1
00001716  3439 00002FBE            905      MOVE.W BPOSY1, D2
0000171C  0642 0010                906      ADD.W #16, D2
00001720  3639 00002FBC            907      MOVE.W BPOSX1, D3
00001726  0643 0020                908      ADD.W #32, D3
0000172A  3839 00002FBE            909      MOVE.W BPOSY1, D4
00001730  0644 0010                910      ADD.W #16, D4
00001734  4E4F                     911      TRAP #15
00001736                           912      ;DRAW VERTICAL LINE 
00001736  3239 00002FBC            913      MOVE.W BPOSX1, D1
0000173C  0641 0010                914      ADD.W #16, D1
00001740  3439 00002FBE            915      MOVE.W BPOSY1, D2
00001746  0642 0010                916      ADD.W #16, D2
0000174A  3639 00002FBC            917      MOVE.W BPOSX1, D3
00001750  0643 0010                918      ADD.W #16, D3
00001754  3839 00002FBE            919      MOVE.W BPOSY1, D4
0000175A  0644 0020                920      ADD.W #32, D4
0000175E  4E4F                     921      TRAP #15
00001760  4EB9 000019B0            922      JSR ENDBLOCK    
00001766  4EF8 15CA                923      JMP NEXT
0000176A                           924  DBHV ;DRAW BRICK-HEAVEN vvvR
0000176A                           925      
0000176A  2F3C 00CCCCCC            926      MOVE.L #$00CCCCCC, -(A7)
00001770  2F3C 00D7EBFA            927      MOVE.L #$00D7EBFA, -(A7)
00001776  4EB9 00001958            928      JSR DRAWBLOCK
0000177C  2C1F                     929      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000177E  2C1F                     930      MOVE.L (A7)+, D6
00001780                           931      ;DRAW HORIZONTAL LINE
00001780  103C 0054                932      MOVE.B #84, D0 
00001784  3239 00002FBC            933      MOVE.W BPOSX1, D1
0000178A  3439 00002FBE            934      MOVE.W BPOSY1, D2
00001790  0642 0010                935      ADD.W #16, D2
00001794  3639 00002FBC            936      MOVE.W BPOSX1, D3
0000179A  0643 0020                937      ADD.W #32, D3
0000179E  3839 00002FBE            938      MOVE.W BPOSY1, D4
000017A4  0644 0010                939      ADD.W #16, D4
000017A8  4E4F                     940      TRAP #15
000017AA                           941      ;DRAW VERTICAL LINE 
000017AA  3239 00002FBC            942      MOVE.W BPOSX1, D1
000017B0  0641 0010                943      ADD.W #16, D1
000017B4  3439 00002FBE            944      MOVE.W BPOSY1, D2
000017BA  0642 0010                945      ADD.W #16, D2
000017BE  3639 00002FBC            946      MOVE.W BPOSX1, D3
000017C4  0643 0010                947      ADD.W #16, D3
000017C8  3839 00002FBE            948      MOVE.W BPOSY1, D4
000017CE  0644 0020                949      ADD.W #32, D4
000017D2  4E4F                     950      TRAP #15 
000017D4  4EB9 000019B0            951      JSR ENDBLOCK
000017DA  4EF8 15CA                952      JMP NEXT
000017DE                           953  DGHL ;DRAW GRASS HELL vvvR
000017DE                           954  
000017DE  2F3C 002255EE            955      MOVE.L #$002255EE, -(A7)
000017E4  2F3C 002255EE            956      MOVE.L #$002255EE, -(A7)
000017EA  4EB9 00001958            957      JSR DRAWBLOCK
000017F0  2C1F                     958      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000017F2  2C1F                     959      MOVE.L (A7)+, D6
000017F4                           960      ; SET PEN COLOR 
000017F4  103C 0050                961      MOVE.B #80, D0
000017F8  223C 000000CC            962      MOVE.L #$000000CC, D1
000017FE  4E4F                     963      TRAP #15
00001800                           964      ;DRAW LINES   
00001800  103C 0054                965      MOVE.B #84, D0 
00001804                           966      ;LINEA 11 
00001804  3239 00002FBC            967      MOVE.W BPOSX1,D1
0000180A  5C41                     968      ADD.W #6, D1
0000180C  3439 00002FBE            969      MOVE.W BPOSY1, D2
00001812  5A42                     970      ADD.W #5, D2
00001814  3639 00002FBC            971      MOVE.W BPOSX1, D3
0000181A  0643 0009                972      ADD.W #9, D3
0000181E  3839 00002FBE            973      MOVE.W BPOSY1, D4
00001824  0644 000A                974      ADD.W #10, D4
00001828  4E4F                     975      TRAP #15
0000182A                           976      ;LINEA 12
0000182A  5041                     977      ADD.W #8, D1    
0000182C  5043                     978      ADD.W #8, D3
0000182E  4E4F                     979      TRAP #15
00001830                           980      ;LINEA 13
00001830  5041                     981      ADD.W #8, D1    
00001832  5043                     982      ADD.W #8, D3
00001834  4E4F                     983      TRAP #15
00001836                           984      ;LINEA 21
00001836  3239 00002FBC            985      MOVE.W BPOSX1,D1
0000183C  5C41                     986      ADD.W #6, D1
0000183E  3439 00002FBE            987      MOVE.W BPOSY1, D2
00001844  0642 0014                988      ADD.W #20, D2
00001848  3639 00002FBC            989      MOVE.W BPOSX1, D3
0000184E  0643 0009                990      ADD.W #9, D3
00001852  3839 00002FBE            991      MOVE.W BPOSY1, D4
00001858  0644 0019                992      ADD.W #25, D4
0000185C  4E4F                     993      TRAP #15
0000185E                           994      ;LINEA 22
0000185E  5041                     995      ADD.W #8, D1    
00001860  5043                     996      ADD.W #8, D3
00001862  4E4F                     997      TRAP #15
00001864                           998      ;LINEA 23
00001864  5041                     999      ADD.W #8, D1    
00001866  5043                    1000      ADD.W #8, D3
00001868  4E4F                    1001      TRAP #15
0000186A  4EB9 000019B0           1002      JSR ENDBLOCK
00001870  4EF8 15CA               1003      JMP NEXT
00001874                          1004  
00001874                          1005  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
00001874  2F3C 00CCCCCC           1006      MOVE.L #$00CCCCCC, -(A7)
0000187A  2F3C 00C6DAE9           1007      MOVE.L #$00C6DAE9, -(A7)
00001880  4EB9 00001958           1008      JSR DRAWBLOCK
00001886  2C1F                    1009      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001888  2C1F                    1010      MOVE.L (A7)+, D6
0000188A  4EB9 000019B0           1011      JSR ENDBLOCK
00001890  4EF8 15CA               1012      JMP NEXT
00001894                          1013  DF1HL ; DRAW FLOOR_1 HELL vvvR 
00001894  2F3C 00010101           1014      MOVE.L #$00010101, -(A7)
0000189A  2F3C 00777777           1015      MOVE.L #$00777777, -(A7)
000018A0  4EB9 00001958           1016      JSR DRAWBLOCK
000018A6  2C1F                    1017      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018A8  2C1F                    1018      MOVE.L (A7)+, D6
000018AA                          1019  
000018AA  4EB9 000019B0           1020      JSR ENDBLOCK
000018B0  4EF8 15CA               1021      JMP NEXT
000018B4                          1022      
000018B4                          1023  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
000018B4  2F3C 00CCCCCC           1024      MOVE.L #$00CCCCCC, -(A7)
000018BA  2F3C 00C6DAE9           1025      MOVE.L #$00C6DAE9, -(A7)
000018C0  4EB9 00001958           1026      JSR DRAWBLOCK
000018C6  2C1F                    1027      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018C8  2C1F                    1028      MOVE.L (A7)+, D6
000018CA                          1029      ;SET NEW FILL COLOR  
000018CA  103C 0051               1030      MOVE.B #81, D0
000018CE  223C 00D7EBFA           1031      MOVE.L #$00D7EBFA, D1
000018D4  4E4F                    1032      TRAP #15 
000018D6                          1033      ;DRAW INSIDE SQUARE 
000018D6  103C 0057               1034      MOVE.B #87, D0
000018DA  3239 00002FBC           1035      MOVE.W BPOSX1, D1
000018E0  5041                    1036      ADD.W #8, D1
000018E2  3439 00002FBE           1037      MOVE.W BPOSY1, D2
000018E8  5042                    1038      ADD.W #8, D2
000018EA  3639 00002FC0           1039      MOVE.W BPOSX2, D3
000018F0  5143                    1040      SUB.W #8, D3
000018F2  3839 00002FC2           1041      MOVE.W BPOSY2, D4
000018F8  5144                    1042      SUB.W #8, D4
000018FA  4E4F                    1043      TRAP #15
000018FC  4EB9 000019B0           1044      JSR ENDBLOCK
00001902  4EF8 15CA               1045      JMP NEXT
00001906                          1046  DF2HL ; DRAW FLOOR_2 HELL vvvR
00001906  2F3C 00010101           1047      MOVE.L #$00010101, -(A7)
0000190C  2F3C 00777777           1048      MOVE.L #$00777777, -(A7)
00001912  4EB9 00001958           1049      JSR DRAWBLOCK
00001918  2C1F                    1050      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000191A  2C1F                    1051      MOVE.L (A7)+, D6
0000191C                          1052      ;SET NEW FILL COLOR  
0000191C  103C 0051               1053      MOVE.B #81, D0
00001920  223C 00666666           1054      MOVE.L #$00666666, D1
00001926  4E4F                    1055      TRAP #15 
00001928                          1056  ;DRAW INSIDE SQUARE 
00001928  103C 0057               1057      MOVE.B #87, D0
0000192C  3239 00002FBC           1058      MOVE.W BPOSX1, D1
00001932  5041                    1059      ADD.W #8, D1
00001934  3439 00002FBE           1060      MOVE.W BPOSY1, D2
0000193A  5042                    1061      ADD.W #8, D2
0000193C  3639 00002FC0           1062      MOVE.W BPOSX2, D3
00001942  5143                    1063      SUB.W #8, D3
00001944  3839 00002FC2           1064      MOVE.W BPOSY2, D4
0000194A  5144                    1065      SUB.W #8, D4
0000194C  4E4F                    1066      TRAP #15
0000194E  4EB9 000019B0           1067      JSR ENDBLOCK
00001954  4EF8 15CA               1068      JMP NEXT    
00001958                          1069      
00001958                          1070  DRAWBLOCK 
00001958                          1071  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPUS COMO LONGS. 
00001958                          1072      
00001958                          1073      ;SET FILL COLOR  
00001958  103C 0051               1074      MOVE.B #81, D0
0000195C  222F 0004               1075      MOVE.L 4(A7), D1
00001960  4E4F                    1076      TRAP #15 
00001962                          1077      
00001962                          1078      ; SET PEN COLOR 
00001962  103C 0050               1079      MOVE.B #80, D0
00001966  222F 0008               1080      MOVE.L 8(A7), D1
0000196A  4E4F                    1081      TRAP #15 
0000196C                          1082  
0000196C                          1083      ;DRAW BLOCK 
0000196C  103C 0057               1084      MOVE.B #87, D0
00001970  3239 00002FBC           1085      MOVE.W BPOSX1, D1
00001976  3439 00002FBE           1086      MOVE.W BPOSY1, D2
0000197C  3639 00002FC0           1087      MOVE.W BPOSX2, D3
00001982  3839 00002FC2           1088      MOVE.W BPOSY2, D4
00001988  4E4F                    1089      TRAP #15
0000198A  4E75                    1090      RTS
0000198C                          1091  
0000198C                          1092  NEWLINE
0000198C                          1093      ;RESET X POSITION
0000198C  33FC 0000 00002FBC      1094      MOVE.W #0, BPOSX1
00001994  33FC 0020 00002FC0      1095      MOVE.W #32, BPOSX2
0000199C                          1096      ;ADD 33 TO Y POSITION
0000199C  0679 0020 00002FBE      1097      ADD.W #32, BPOSY1
000019A4  0679 0020 00002FC2      1098      ADD.W #32, BPOSY2
000019AC  4EF8 15CA               1099      JMP NEXT
000019B0                          1100     
000019B0                          1101  ENDBLOCK
000019B0                          1102      ;SET NEW BLOCK POSITION
000019B0  0679 0020 00002FBC      1103      ADD.W #32, BPOSX1
000019B8  0679 0020 00002FC0      1104      ADD.W #32, BPOSX2
000019C0  4E75                    1105      RTS
000019C2                          1106  ENDMAP
000019C2                          1107      ;SET DEFAULT BLOCK POSITION
000019C2  33FC 0000 00002FBC      1108      MOVE.W #0, BPOSX1
000019CA  33FC 0000 00002FBE      1109      MOVE.W #0, BPOSY1
000019D2  33FC 0020 00002FC0      1110      MOVE.W #32, BPOSX2
000019DA  33FC 0020 00002FC2      1111      MOVE.W #32, BPOSY2
000019E2  4CDF 7F00               1112      MOVEM.L (A7)+, A0-A6
000019E6  4CDF 00FF               1113      MOVEM.L (A7)+, D0-D7
000019EA  4E75                    1114      RTS
000019EC                          1115      
000019EC                          1116  
000019EC                          1117  
000019EC                          1118  MAPA1
000019EC  301F                    1119      MOVE.W (A7)+, D0
000019EE  48A7 F800               1120      MOVEM.W D0-D4, -(A7)
000019F2  3039 00002FB6           1121      MOVE.W PLAYERPOSX, D0
000019F8  3239 00002FB8           1122      MOVE.W PLAYERPOSY, D1
000019FE                          1123      ;GO TO THE NEXT ROOM DOOR
000019FE                          1124      ;FIRST LETS CHECH POS X
000019FE  B07C 0160               1125      CMP #352, D0  ; BGT = 352 > D0
00001A02  6E00 002A               1126      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A06  B07C 0120               1127      CMP #288, D0
00001A0A  6D00 0022               1128      BLT MAP1NODOOR
00001A0E                          1129      ;NOW WE CHECK POS Y 
00001A0E  B27C 01E0               1130      CMP #480, D1  ; 
00001A12  6E00 001A               1131      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A16  B27C 01C0               1132      CMP #448, D1
00001A1A  6D00 0012               1133      BLT MAP1NODOOR
00001A1E  33FC 0020 00002FB8      1134      MOVE.W #32, PLAYERPOSY
00001A26  33FC 0001 00002FC8      1135      MOVE.W #1, LOADEDMAP
00001A2E                          1136  MAP1NODOOR
00001A2E  4C9F 001F               1137      MOVEM.W (A7)+, D0-D4
00001A32  4E75                    1138      RTS
00001A34                          1139      
00001A34                          1140  MAPA2
00001A34  301F                    1141      MOVE.W (A7)+, D0
00001A36  48A7 F800               1142      MOVEM.W D0-D4, -(A7)
00001A3A  3039 00002FB6           1143      MOVE.W PLAYERPOSX, D0
00001A40  3239 00002FB8           1144      MOVE.W PLAYERPOSY, D1
00001A46                          1145      ;GO TO THE NEXT ROOM DOOR
00001A46                          1146      ;FIRST LETS CHECK POS X
00001A46  B07C 0160               1147      CMP #352, D0  ; BGT = 352 > D0
00001A4A  6E00 0030               1148      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A4E  B07C 0120               1149      CMP #288, D0
00001A52  6D00 0028               1150      BLT MAP2NODOOR1
00001A56                          1151      ;NOW WE CHECK POS Y 
00001A56  B27C 01E0               1152      CMP #480, D1  ; 
00001A5A  6E00 0020               1153      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A5E  B27C 01C0               1154      CMP #448, D1
00001A62  6D00 0018               1155      BLT MAP2NODOOR1
00001A66  33FC 0020 00002FB8      1156      MOVE.W #32, PLAYERPOSY
00001A6E  33FC 0002 00002FC8      1157      MOVE.W #2, LOADEDMAP
00001A76  4C9F 001F               1158      MOVEM.W (A7)+, D0-D4
00001A7A  4E75                    1159      RTS
00001A7C                          1160  MAP2NODOOR1
00001A7C                          1161      ;GO TO THE PREVIOUS ROOM DOOR
00001A7C                          1162      ;FIRST LETS CHECK POS X
00001A7C  B07C 0160               1163      CMP #352, D0  ; BGT = 352 > D0
00001A80  6E00 0030               1164      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A84  B07C 0120               1165      CMP #288, D0
00001A88  6D00 0028               1166      BLT MAP2NODOOR2
00001A8C                          1167      ;NOW WE CHECK POS Y 
00001A8C  B27C 0020               1168      CMP #32, D1  ; 
00001A90  6E00 0020               1169      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A94  B27C 0000               1170      CMP #0, D1
00001A98  6D00 0018               1171      BLT MAP2NODOOR2
00001A9C  33FC 01A0 00002FB8      1172      MOVE.W  #416, PLAYERPOSY
00001AA4  33FC 0000 00002FC8      1173      MOVE.W #0, LOADEDMAP
00001AAC  4C9F 001F               1174      MOVEM.W (A7)+, D0-D4
00001AB0  4E75                    1175      RTS
00001AB2                          1176  
00001AB2                          1177  MAP2NODOOR2
00001AB2                          1178      ;GO TO THE LEFT HEAVEN'S ROOM
00001AB2  B07C 00A0               1179      CMP #160, D0  ; BGT = 352 > D0
00001AB6  6E00 0038               1180      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ABA  B07C 0080               1181      CMP #128, D0
00001ABE  6D00 0030               1182      BLT MAP2NODOOR3
00001AC2                          1183      ;NOW WE CHECK POS Y 
00001AC2  B27C 00AA               1184      CMP #170, D1  ; 
00001AC6  6E00 0028               1185      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ACA  B27C 0078               1186      CMP #120, D1
00001ACE  6D00 0020               1187      BLT MAP2NODOOR3
00001AD2  33FC 0130 00002FB6      1188      MOVE.W #$130, PLAYERPOSX
00001ADA  33FC 00B0 00002FB8      1189      MOVE.W #$0B0, PLAYERPOSY
00001AE2  33FC 0003 00002FC8      1190      MOVE.W #3, LOADEDMAP
00001AEA  4C9F 001F               1191      MOVEM.W (A7)+, D0-D4
00001AEE  4E75                    1192      RTS
00001AF0                          1193  MAP2NODOOR3
00001AF0                          1194      ;GO TO THE RIGHT HEAVEN'S ROOM
00001AF0  B07C 01E0               1195      CMP #480, D0  ; BGT = 352 > D0
00001AF4  6E00 0038               1196      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AF8  B07C 01C0               1197      CMP #448, D0
00001AFC  6D00 0030               1198      BLT MAP2NODOOR4
00001B00                          1199      ;NOW WE CHECK POS Y 
00001B00  B27C 00AA               1200      CMP #170, D1  ; 
00001B04  6E00 0028               1201      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B08  B27C 0078               1202      CMP #120, D1
00001B0C  6D00 0020               1203      BLT MAP2NODOOR4
00001B10  33FC 0130 00002FB6      1204      MOVE.W #$130, PLAYERPOSX
00001B18  33FC 00B0 00002FB8      1205      MOVE.W #$0B0, PLAYERPOSY
00001B20  33FC 0003 00002FC8      1206      MOVE.W #3, LOADEDMAP
00001B28  4C9F 001F               1207      MOVEM.W (A7)+, D0-D4
00001B2C  4E75                    1208      RTS
00001B2E                          1209  MAP2NODOOR4
00001B2E  4C9F 001F               1210      MOVEM.W (A7)+, D0-D4
00001B32  4E75                    1211      RTS
00001B34                          1212  MAPA3 
00001B34  301F                    1213      MOVE.W (A7)+, D0
00001B36  48A7 F800               1214      MOVEM.W D0-D4, -(A7)
00001B3A  3039 00002FB6           1215      MOVE.W PLAYERPOSX, D0
00001B40  3239 00002FB8           1216      MOVE.W PLAYERPOSY, D1
00001B46                          1217      ;GO TO THE PREVIOUS ROOM DOOR
00001B46                          1218      ;FIRST LETS CHECK POS X
00001B46  B07C 0160               1219      CMP #352, D0  ; BGT = 352 > D0
00001B4A  6E00 0030               1220      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B4E  B07C 0120               1221      CMP #288, D0
00001B52  6D00 0028               1222      BLT MAP3NODOOR
00001B56                          1223      ;NOW WE CHECK POS Y 
00001B56  B27C 0020               1224      CMP #32, D1  ; 
00001B5A  6E00 0020               1225      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B5E  B27C 0000               1226      CMP #0, D1
00001B62  6D00 0018               1227      BLT MAP3NODOOR
00001B66  33FC 01A0 00002FB8      1228      MOVE.W  #416, PLAYERPOSY
00001B6E  33FC 0001 00002FC8      1229      MOVE.W #1, LOADEDMAP
00001B76  4C9F 001F               1230      MOVEM.W (A7)+, D0-D4
00001B7A  4E75                    1231      RTS
00001B7C                          1232  MAP3NODOOR
00001B7C  4C9F 001F               1233      MOVEM.W (A7)+, D0-D4
00001B80  4E75                    1234      RTS
00001B82                          1235  MAPA4
00001B82  301F                    1236      MOVE.W (A7)+, D0
00001B84  48A7 F800               1237      MOVEM.W D0-D4, -(A7)
00001B88  3039 00002FB6           1238      MOVE.W PLAYERPOSX, D0
00001B8E  3239 00002FB8           1239      MOVE.W PLAYERPOSY, D1
00001B94                          1240      ;GO BACK TO 2ND HEAVEN'S ROOM
00001B94  B07C 0180               1241      CMP #384, D0  ; BGT = 352 > D0
00001B98  6E00 002A               1242      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B9C  B07C 0104               1243      CMP #260, D0
00001BA0  6D00 0022               1244      BLT MAP4NODOOR
00001BA4                          1245      ;NOW WE CHECK POS Y 
00001BA4  B27C 0080               1246      CMP #128, D1  ; 
00001BA8  6E00 001A               1247      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BAC  B27C 0060               1248      CMP #96, D1
00001BB0  6D00 0012               1249      BLT MAP4NODOOR
00001BB4  33FC 00E0 00002FB6      1250      MOVE.W  #224, PLAYERPOSX
00001BBC  33FC 0001 00002FC8      1251      MOVE.W #1, LOADEDMAP
00001BC4                          1252  MAP4NODOOR
00001BC4  4C9F 001F               1253      MOVEM.W (A7)+, D0-D4
00001BC8  4E75                    1254      RTS
00001BCA                          1255  ;;;;;;;;;;HELL
00001BCA                          1256  MAPA5
00001BCA  301F                    1257      MOVE.W (A7)+, D0
00001BCC  48A7 F800               1258      MOVEM.W D0-D4, -(A7)
00001BD0  3039 00002FB6           1259      MOVE.W PLAYERPOSX, D0
00001BD6  3239 00002FB8           1260      MOVE.W PLAYERPOSY, D1
00001BDC                          1261      ;GO TO THE NEXT ROOM DOOR
00001BDC                          1262      ;FIRST LETS CHECH POS X
00001BDC  B07C 0160               1263      CMP #352, D0  ; BGT = 352 > D0
00001BE0  6E00 002A               1264      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BE4  B07C 0120               1265      CMP #288, D0
00001BE8  6D00 0022               1266      BLT MAP5NODOOR
00001BEC                          1267      ;NOW WE CHECK POS Y 
00001BEC  B27C 01E0               1268      CMP #480, D1  ; 
00001BF0  6E00 001A               1269      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BF4  B27C 01C0               1270      CMP #448, D1
00001BF8  6D00 0012               1271      BLT MAP5NODOOR
00001BFC  33FC 0020 00002FB8      1272      MOVE.W #32, PLAYERPOSY
00001C04  33FC 0005 00002FC8      1273      MOVE.W #5, LOADEDMAP
00001C0C                          1274  MAP5NODOOR
00001C0C  4C9F 001F               1275      MOVEM.W (A7)+, D0-D4
00001C10  4E75                    1276      RTS
00001C12                          1277      
00001C12                          1278  MAPA6
00001C12  301F                    1279      MOVE.W (A7)+, D0
00001C14  48A7 F800               1280      MOVEM.W D0-D4, -(A7)
00001C18  3039 00002FB6           1281      MOVE.W PLAYERPOSX, D0
00001C1E  3239 00002FB8           1282      MOVE.W PLAYERPOSY, D1
00001C24                          1283      ;GO TO THE NEXT ROOM DOOR
00001C24                          1284      ;FIRST LETS CHECK POS X
00001C24  B07C 0160               1285      CMP #352, D0  ; BGT = 352 > D0
00001C28  6E00 0030               1286      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C2C  B07C 0120               1287      CMP #288, D0
00001C30  6D00 0028               1288      BLT MAP6NODOOR1
00001C34                          1289      ;NOW WE CHECK POS Y 
00001C34  B27C 01E0               1290      CMP #480, D1  ; 
00001C38  6E00 0020               1291      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C3C  B27C 01C0               1292      CMP #448, D1
00001C40  6D00 0018               1293      BLT MAP6NODOOR1
00001C44  33FC 0020 00002FB8      1294      MOVE.W #32, PLAYERPOSY
00001C4C  33FC 0006 00002FC8      1295      MOVE.W #6, LOADEDMAP
00001C54  4C9F 001F               1296      MOVEM.W (A7)+, D0-D4
00001C58  4E75                    1297      RTS
00001C5A                          1298  MAP6NODOOR1
00001C5A                          1299      ;GO TO THE PREVIOUS ROOM DOOR
00001C5A                          1300      ;FIRST LETS CHECK POS X
00001C5A  B07C 0160               1301      CMP #352, D0  ; BGT = 352 > D0
00001C5E  6E00 0030               1302      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C62  B07C 0120               1303      CMP #288, D0
00001C66  6D00 0028               1304      BLT MAP6NODOOR2
00001C6A                          1305      ;NOW WE CHECK POS Y 
00001C6A  B27C 0020               1306      CMP #32, D1  ; 
00001C6E  6E00 0020               1307      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C72  B27C 0000               1308      CMP #0, D1
00001C76  6D00 0018               1309      BLT MAP6NODOOR2
00001C7A  33FC 01A0 00002FB8      1310      MOVE.W  #416, PLAYERPOSY
00001C82  33FC 0004 00002FC8      1311      MOVE.W #4, LOADEDMAP
00001C8A  4C9F 001F               1312      MOVEM.W (A7)+, D0-D4
00001C8E  4E75                    1313      RTS
00001C90                          1314  MAP6NODOOR2
00001C90                          1315      ;CHECK FOR LEFT HELL ROOM
00001C90  B07C 0060               1316      CMP #96, D0  ; BGT = 352 > D0
00001C94  6E00 0038               1317      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C98  B07C 0040               1318      CMP #64, D0
00001C9C  6D00 0030               1319      BLT MAP6NODOOR3
00001CA0                          1320      ;NOW WE CHECK POS Y 
00001CA0  B27C 0180               1321      CMP #384, D1  ; 
00001CA4  6E00 0028               1322      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CA8  B27C 0140               1323      CMP #320, D1
00001CAC  6D00 0020               1324      BLT MAP6NODOOR3
00001CB0  33FC 0130 00002FB6      1325      MOVE.W #$130, PLAYERPOSX
00001CB8  33FC 00B0 00002FB8      1326      MOVE.W #$0B0, PLAYERPOSY
00001CC0  33FC 0007 00002FC8      1327      MOVE.W #7, LOADEDMAP
00001CC8  4C9F 001F               1328      MOVEM.W (A7)+, D0-D4
00001CCC  4E75                    1329      RTS
00001CCE                          1330  MAP6NODOOR3
00001CCE                          1331      ;CHECK FOR THE RIGHT HELL ROOM
00001CCE  B07C 0240               1332      CMP #576, D0  ; BGT = 352 > D0
00001CD2  6E00 0038               1333      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CD6  B07C 021C               1334      CMP #540, D0
00001CDA  6D00 0030               1335      BLT MAP6NODOOR4
00001CDE                          1336      ;NOW WE CHECK POS Y 
00001CDE  B27C 0180               1337      CMP #384, D1  ; 
00001CE2  6E00 0028               1338      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CE6  B27C 0140               1339      CMP #320, D1
00001CEA  6D00 0020               1340      BLT MAP6NODOOR4
00001CEE  33FC 0130 00002FB6      1341      MOVE.W #$130, PLAYERPOSX
00001CF6  33FC 00B0 00002FB8      1342      MOVE.W #$0B0, PLAYERPOSY
00001CFE  33FC 0007 00002FC8      1343      MOVE.W #7, LOADEDMAP
00001D06  4C9F 001F               1344      MOVEM.W (A7)+, D0-D4
00001D0A  4E75                    1345      RTS
00001D0C                          1346  MAP6NODOOR4
00001D0C  4C9F 001F               1347      MOVEM.W (A7)+, D0-D4
00001D10  4E75                    1348      RTS
00001D12                          1349  MAPA7 
00001D12  301F                    1350      MOVE.W (A7)+, D0
00001D14  48A7 F800               1351      MOVEM.W D0-D4, -(A7)
00001D18  3039 00002FB6           1352      MOVE.W PLAYERPOSX, D0
00001D1E  3239 00002FB8           1353      MOVE.W PLAYERPOSY, D1
00001D24                          1354      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D24  B07C 0180               1355      CMP #384, D0  ; BGT = 352 > D0
00001D28  6E00 0032               1356      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D2C  B07C 0104               1357      CMP #260, D0
00001D30  6D00 002A               1358      BLT MAP7NODOOR
00001D34                          1359      ;NOW WE CHECK POS Y 
00001D34  B27C 0020               1360      CMP #32, D1  ; 
00001D38  6E00 0022               1361      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D3C  B27C 0000               1362      CMP #0, D1
00001D40  6D00 001A               1363      BLT MAP7NODOOR
00001D44  33FC 0140 00002FB6      1364      MOVE.W  #320, PLAYERPOSX
00001D4C  33FC 01A0 00002FB8      1365      MOVE.W #416, PLAYERPOSY
00001D54  33FC 0005 00002FC8      1366      MOVE.W #5, LOADEDMAP
00001D5C                          1367  MAP7NODOOR
00001D5C  4C9F 001F               1368      MOVEM.W (A7)+, D0-D4
00001D60  4E75                    1369      RTS
00001D62                          1370  MAPA8
00001D62                          1371       ;HELLS ROOM
00001D62  301F                    1372      MOVE.W (A7)+, D0
00001D64  48A7 F800               1373      MOVEM.W D0-D4, -(A7)
00001D68  3039 00002FB6           1374      MOVE.W PLAYERPOSX, D0
00001D6E  3239 00002FB8           1375      MOVE.W PLAYERPOSY, D1
00001D74                          1376      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D74  B07C 0180               1377      CMP #384, D0  ; BGT = 352 > D0
00001D78  6E00 0032               1378      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D7C  B07C 0104               1379      CMP #260, D0
00001D80  6D00 002A               1380      BLT MAP8NODOOR1
00001D84                          1381      ;NOW WE CHECK POS Y 
00001D84  B27C 0080               1382      CMP #128, D1  ; 
00001D88  6E00 0022               1383      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D8C  B27C 0060               1384      CMP #96, D1
00001D90  6D00 001A               1385      BLT MAP8NODOOR1
00001D94  33FC 0140 00002FB6      1386      MOVE.W  #320, PLAYERPOSX
00001D9C  33FC 0080 00002FB8      1387      MOVE.W #128, PLAYERPOSY
00001DA4  33FC 0005 00002FC8      1388      MOVE.W #5, LOADEDMAP
00001DAC                          1389  MAP8NODOOR1
00001DAC  4C9F 001F               1390      MOVEM.W (A7)+, D0-D4
00001DB0  4E75                    1391      RTS
00001DB2                          1392  
00001DB2                          1393  
00001DB2                          1394  
00001DB2                          1395  
00001DB2                          1396  
00001DB2                          1397  
00001DB2                          1398  
00001DB2                          1399  
00001DB2                          1400  
00001DB2                          1401  
00001DB2                          1402  
00001DB2                          1403  
00001DB2                          1404  
00001DB2                          1405  
00001DB2                          1406  
00001DB2                          1407  
00001DB2                          1408  
00001DB2                          1409  
00001DB2                          1410  
00001DB2                          1411  
00001DB2                          1412  -------------------- end include --------------------
00001DB2                          1413              INCLUDE "MAPS.X68"
00001DB2                          1414  
00001DB2                          1415  HEAVEN_0    ;MAP 1
00001DB2= 03 03 03 03 03 03 ...   1416      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00001DC7= 03 01 01 01 01 01 ...   1417      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
00001DDC= 03 01 03 03 03 03 ...   1418      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
00001DF1= 03 01 03 05 05 05 ...   1419      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00001E06= 03 01 03 05 05 05 ...   1420      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E1B= 03 01 03 05 05 05 ...   1421      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E30= 03 01 03 05 05 05 ...   1422      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001E45= 03 01 03 05 05 05 ...   1423      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001E5A= 03 01 03 05 05 05 ...   1424      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E6F= 03 01 03 05 05 05 ...   1425      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E84= 03 01 03 05 05 05 ...   1426      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E99= 03 01 03 05 05 05 ...   1427      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001EAE= 03 01 03 05 05 05 ...   1428      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001EC3= 03 01 03 03 03 03 ...   1429      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00001ED8= 03 01 01 01 01 01 ...   1430      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001EED= 03 03 03 03 03 03 ...   1431      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001F02                          1432          
00001F02                          1433  HEAVEN_1    ;MAP 2
00001F02= 03 03 03 03 03 03 ...   1434      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001F17= 03 03 01 01 01 01 ...   1435      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
00001F2C= 03 03 03 03 03 03 ...   1436      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
00001F41= 03 07 07 07 07 03 ...   1437      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F56= 03 07 07 07 07 03 ...   1438      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F6B= 03 07 07 07 07 09 ...   1439      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
00001F80= 03 07 07 07 07 03 ...   1440      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00001F95= 03 07 07 07 07 03 ...   1441      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001FAA= 03 03 03 03 03 03 ...   1442      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
00001FBF= 03 01 01 01 01 03 ...   1443      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00001FD4= 03 01 01 01 01 01 ...   1444      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00001FE9= 03 01 01 01 01 01 ...   1445      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001FFE= 03 01 01 01 01 01 ...   1446      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00002013= 03 01 01 01 01 01 ...   1447      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00002028= 03 03 03 03 03 03 ...   1448      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
0000203D                          1449      
0000203D                          1450  HEAVEN_END  ;MAP 3
0000203D= 03 03 03 03 03 03 ...   1451      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00002052= 03 05 05 05 05 05 ...   1452      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00002067= 03 05 05 07 05 05 ...   1453      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000207C= 03 05 07 07 07 05 ...   1454      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00002091= 03 05 05 07 05 05 ...   1455      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
000020A6= 03 05 05 07 05 05 ...   1456      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
000020BB= 03 05 05 05 05 05 ...   1457      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020D0= 03 05 05 05 05 05 ...   1458      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020E5= 03 05 05 05 05 05 ...   1459      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020FA= 03 05 05 07 05 05 ...   1460      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000210F= 03 05 07 07 07 05 ...   1461      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00002124= 03 05 05 07 05 05 ...   1462      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002139= 03 05 05 07 05 05 ...   1463      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000214E= 03 05 05 05 05 05 ...   1464      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00002163= 03 03 03 03 03 03 ...   1465      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
00002178                          1466      
00002178                          1467  HEAVEN_ROOM ;MAP 4
00002178= 09 09 09 09 09 09 ...   1468      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000218D= 09 09 09 09 09 09 ...   1469      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021A2= 09 09 09 09 09 09 ...   1470      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021B7= 09 09 09 09 09 09 ...   1471      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021CC= 09 09 09 09 09 03 ...   1472      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
000021E1= 09 09 09 09 09 03 ...   1473      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021F6= 09 09 09 09 09 03 ...   1474      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000220B= 09 09 09 09 09 03 ...   1475      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002220= 09 09 09 09 09 03 ...   1476      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002235= 09 09 09 09 09 03 ...   1477      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000224A= 09 09 09 09 09 03 ...   1478      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
0000225F= 09 09 09 09 09 09 ...   1479      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002274= 09 09 09 09 09 09 ...   1480      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002289= 09 09 09 09 09 09 ...   1481      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000229E= 09 09 09 09 09 09 ...   1482      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
000022B3                          1483      
000022B3                          1484  HELL_0  ;MAP 5
000022B3= 02 02 02 02 02 02 ...   1485      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
000022C8= 02 06 06 06 06 06 ...   1486      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022DD= 02 06 06 04 06 06 ...   1487      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
000022F2= 02 06 06 04 06 06 ...   1488      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00002307= 02 06 04 04 04 06 ...   1489      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
0000231C= 02 06 06 04 06 06 ...   1490      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00002331= 02 06 06 06 06 06 ...   1491      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002346= 02 02 02 02 02 02 ...   1492      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
0000235B= 02 06 06 06 06 06 ...   1493      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002370= 02 06 06 06 06 06 ...   1494      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002385= 02 06 06 06 06 06 ...   1495      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000239A= 02 06 06 06 06 06 ...   1496      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023AF= 02 06 06 06 06 06 ...   1497      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023C4= 02 06 06 06 06 06 ...   1498      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023D9= 02 02 02 02 02 02 ...   1499      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
000023EE                          1500          
000023EE                          1501  HELL_1      ;MAP 6
000023EE= 02 02 02 02 02 02 ...   1502      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00002403= 02 06 06 06 06 06 ...   1503      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002418= 02 06 06 06 06 06 ...   1504      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000242D= 02 06 06 06 06 06 ...   1505      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002442= 02 06 06 06 06 06 ...   1506      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002457= 02 06 06 06 06 06 ...   1507      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
0000246C= 02 06 06 06 06 06 ...   1508      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002481= 02 06 06 06 06 06 ...   1509      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00002496= 02 06 06 06 06 06 ...   1510      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000024AB= 02 06 06 06 06 06 ...   1511      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024C0= 02 02 08 02 02 02 ...   1512      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
000024D5= 02 06 06 06 02 02 ...   1513      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
000024EA= 02 06 06 06 02 02 ...   1514      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
000024FF= 02 06 06 06 02 02 ...   1515      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002514= 02 02 02 02 02 02 ...   1516      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002529                          1517          
00002529                          1518  HELL_END    ;MAP 7
00002529= 02 02 02 02 02 02 ...   1519      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
0000253E= 02 06 06 06 06 06 ...   1520      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002553= 02 06 06 06 06 06 ...   1521      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002568= 02 06 06 06 06 06 ...   1522      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000257D= 02 06 06 06 06 06 ...   1523      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002592= 02 06 06 06 06 06 ...   1524      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025A7= 02 06 06 06 06 06 ...   1525      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025BC= 02 06 06 06 06 06 ...   1526      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025D1= 02 06 06 06 06 06 ...   1527      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
000025E6= 02 06 06 06 06 06 ...   1528      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
000025FB= 02 06 06 06 06 06 ...   1529      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002610= 02 06 06 06 06 06 ...   1530      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002625= 02 06 06 06 06 06 ...   1531      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000263A= 02 06 06 06 06 06 ...   1532      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000264F= 02 02 02 02 02 02 ...   1533      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
00002664                          1534      
00002664                          1535  HELL_ROOM   ;MAP 8
00002664= 08 08 08 08 08 08 ...   1536      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002679= 08 08 08 08 08 08 ...   1537      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000268E= 08 08 08 08 08 08 ...   1538      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026A3= 08 08 08 08 08 08 ...   1539      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026B8= 08 08 08 08 08 02 ...   1540      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
000026CD= 08 08 08 08 08 02 ...   1541      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026E2= 08 08 08 08 08 02 ...   1542      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026F7= 08 08 08 08 08 02 ...   1543      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000270C= 08 08 08 08 08 02 ...   1544      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002721= 08 08 08 08 08 02 ...   1545      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002736= 08 08 08 08 08 02 ...   1546      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
0000274B= 08 08 08 08 08 08 ...   1547      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002760= 08 08 08 08 08 08 ...   1548      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002775= 08 08 08 08 08 08 ...   1549      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000278A= 08 08 08 08 08 08 ...   1550      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
0000279F                          1551  
000027A0= 0000                    1552      DC.W    0
000027A2                          1553  
000027A2                          1554  
000027A2                          1555  
000027A2                          1556  
000027A2                          1557  
000027A2                          1558  
000027A2                          1559  
000027A2                          1560  
000027A2                          1561  
000027A2                          1562  -------------------- end include --------------------
000027A2                          1563              INCLUDE "ELEVATOR.X68"           
000027A2                          1564  ELEVATORINIT
000027A2  6000 048E               1565      BRA     AUDINIT
000027A6                          1566  
000027A6                          1567  ELEVATORPLOT
000027A6                          1568      
000027A6  48E7 FFFE               1569      MOVEM.L D0-D7/A0-A6,-(A7)
000027AA                          1570  
000027AA                          1571  
000027AA                          1572  ;SET PEN COLOR  
000027AA  103C 0050               1573      MOVE.B #80, D0
000027AE  223C 00010101           1574      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
000027B4  4E4F                    1575      TRAP #15
000027B6                          1576      
000027B6                          1577  ;END SET PEN COLOR 
000027B6                          1578  
000027B6                          1579      ;DRAW LINES
000027B6                          1580  ;DRAW LINE 1 
000027B6  103C 0054               1581      MOVE.B #84, D0
000027BA  323C 0000               1582      MOVE.W #0, D1
000027BE  343C 0000               1583      MOVE.W #0, D2
000027C2  363C 00A0               1584      MOVE.W #160, D3
000027C6  383C 0078               1585      MOVE.W #120, D4
000027CA  4E4F                    1586      TRAP #15
000027CC                          1587  
000027CC                          1588  ;DRAW LINE 2
000027CC  103C 0054               1589      MOVE.B #84, D0
000027D0  323C 00A0               1590      MOVE.W #160, D1
000027D4  343C 0078               1591      MOVE.W #120, D2
000027D8  363C 00A0               1592      MOVE.W #160, D3
000027DC  383C 01E0               1593      MOVE.W #480, D4
000027E0  4E4F                    1594      TRAP #15
000027E2                          1595      
000027E2                          1596  ;DRAW LINE 3
000027E2  103C 0054               1597      MOVE.B #84, D0
000027E6  323C 00A0               1598      MOVE.W #160, D1
000027EA  343C 0078               1599      MOVE.W #120, D2
000027EE  363C 01E0               1600      MOVE.W #480, D3
000027F2  383C 0078               1601      MOVE.W #120, D4
000027F6  4E4F                    1602      TRAP #15
000027F8                          1603      
000027F8                          1604  ;DRAW LINE 4
000027F8  103C 0054               1605      MOVE.B #84, D0
000027FC  323C 01E0               1606      MOVE.W #480, D1
00002800  343C 0078               1607      MOVE.W #120, D2
00002804  363C 0280               1608      MOVE.W #640, D3
00002808  383C 0000               1609      MOVE.W #0, D4
0000280C  4E4F                    1610      TRAP #15
0000280E                          1611      
0000280E                          1612  ;DRAW LINE 5
0000280E  103C 0054               1613      MOVE.B #84, D0
00002812  323C 01E0               1614      MOVE.W #480, D1
00002816  343C 0078               1615      MOVE.W #120, D2
0000281A  363C 01E0               1616      MOVE.W #480, D3
0000281E  383C 01E0               1617      MOVE.W #480, D4
00002822  4E4F                    1618      TRAP #15
00002824                          1619  
00002824                          1620  ;DRAW LINE 6 (TO GIVE SHADE) 
00002824  103C 0054               1621      MOVE.B #84, D0
00002828  323C 0119               1622      MOVE.W #281, D1
0000282C  343C 015A               1623      MOVE.W #346, D2
00002830  363C 0167               1624      MOVE.W #359, D3
00002834  383C 015A               1625      MOVE.W #346, D4
00002838  4E4F                    1626      TRAP #15
0000283A                          1627      
0000283A                          1628  ;DRAW LINE 7 (TO GIVE SHADE) 
0000283A  103C 0054               1629      MOVE.B #84, D0
0000283E  323C 011A               1630      MOVE.W #282, D1
00002842  343C 015B               1631      MOVE.W #347, D2
00002846  363C 0166               1632      MOVE.W #358, D3
0000284A  383C 015B               1633      MOVE.W #347, D4
0000284E  4E4F                    1634      TRAP #15
00002850                          1635      
00002850                          1636      ;END DRAW LINES
00002850                          1637      
00002850                          1638  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
00002850  103C 0057               1639      MOVE.B #87, D0
00002854  323C 0118               1640      MOVE.W #280, D1
00002858  343C 00D2               1641      MOVE.W #210, D2
0000285C  363C 0168               1642      MOVE.W #360, D3
00002860  383C 0159               1643      MOVE.W #345, D4
00002864  4E4F                    1644      TRAP #15
00002866                          1645      
00002866                          1646  ;DRAW ELLIPSE FOR THE LIGHT
00002866  103C 005B               1647      MOVE.B #91, D0
0000286A  323C 00FA               1648      MOVE.W #250, D1
0000286E  343C 0028               1649      MOVE.W #40, D2
00002872  363C 0186               1650      MOVE.W #390, D3
00002876  383C 0050               1651      MOVE.W #80, D4
0000287A  4E4F                    1652      TRAP #15
0000287C                          1653      ;FILL SEGMENTS
0000287C                          1654  ;FILL SEGMENT 1 LEFT WALL
0000287C                          1655    ;SET FILL COLOR TO DARKER GREY, FOR W
0000287C  103C 0051               1656      MOVE.B #81, D0
00002880                          1657      ;MOVE.L #$00969696, D1
00002880  223C 0020202F           1658      MOVE.L #$0020202F, D1
00002886  4E4F                    1659      TRAP #15
00002888                          1660      ;END SET FILL COLOR
00002888  103C 0059               1661      MOVE.B #89, D0
0000288C  323C 0064               1662      MOVE.W #100, D1
00002890  343C 0064               1663      MOVE.W #100, D2
00002894  4E4F                    1664      TRAP #15
00002896                          1665      
00002896                          1666  ;FILL SEGMENT 2 CEILING
00002896                          1667    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00002896  103C 0051               1668      MOVE.B #81, D0
0000289A                          1669      ;MOVE.L #$00C0C0C0, D1
0000289A  223C 00141424           1670      MOVE.L #$00141424,D1
000028A0  4E4F                    1671      TRAP #15
000028A2                          1672      ;END SET FILL COLOR
000028A2  103C 0059               1673      MOVE.B #89, D0
000028A6  323C 0064               1674      MOVE.W #100, D1
000028AA  343C 0032               1675      MOVE.W #50, D2
000028AE  4E4F                    1676      TRAP #15
000028B0                          1677      
000028B0                          1678  ;FILL SEGMENT 3 RIGHT WALL
000028B0                          1679    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
000028B0  103C 0051               1680      MOVE.B #81, D0
000028B4                          1681      ;MOVE.L #$00969696, D1
000028B4  223C 0020202F           1682      MOVE.L #$0020202F,D1
000028BA  4E4F                    1683      TRAP #15
000028BC                          1684      ;END SET FILL COLOR
000028BC  103C 0059               1685      MOVE.B #89, D0
000028C0  323C 0276               1686      MOVE.W #630, D1
000028C4  343C 01D6               1687      MOVE.W #470, D2
000028C8  4E4F                    1688      TRAP #15
000028CA                          1689      
000028CA                          1690  ;FILL SEGMENT 4 BACKGROUND WALL
000028CA                          1691    ;SET FILL COLOR TO 
000028CA  103C 0051               1692      MOVE.B #81, D0
000028CE                          1693      ;MOVE.L #$00ABABAB, D1
000028CE  223C 001A1A2A           1694      MOVE.L #$001A1A2A, D1
000028D4  4E4F                    1695      TRAP #15
000028D6                          1696      ;END SET FILL COLOR
000028D6  103C 0059               1697      MOVE.B #89, D0
000028DA  323C 00F0               1698      MOVE.W #240, D1
000028DE  343C 0140               1699      MOVE.W #320, D2
000028E2  4E4F                    1700      TRAP #15
000028E4                          1701      
000028E4                          1702  ;FILL SEGMENT 5 PANEL 
000028E4                          1703    ;SET FILL COLOR TO 
000028E4  103C 0051               1704      MOVE.B #81, D0
000028E8                          1705      ;MOVE.L #$00AFAFAF, D1
000028E8  223C 001F1F2F           1706      MOVE.L #$001F1F2F, D1
000028EE  4E4F                    1707      TRAP #15
000028F0                          1708      ;END SET FILL COLOR
000028F0  103C 0059               1709      MOVE.B #89, D0
000028F4  323C 011D               1710      MOVE.W #285, D1
000028F8  343C 00D7               1711      MOVE.W #215, D2
000028FC  4E4F                    1712      TRAP #15
000028FE                          1713      
000028FE                          1714  ;FILL ELLIPSE LIGHT 
000028FE                          1715    ;SET FILL COLOR TO 
000028FE  103C 0051               1716      MOVE.B #81, D0
00002902                          1717      ;MOVE.L #$00A1E9E9, D1
00002902  223C 000000FF           1718      MOVE.L #$000000FF, D1
00002908  4E4F                    1719      TRAP #15
0000290A                          1720      ;END SET FILL COLOR
0000290A  103C 0059               1721      MOVE.B #89, D0
0000290E  323C 0140               1722      MOVE.W #320, D1
00002912  343C 003C               1723      MOVE.W #60, D2
00002916  4E4F                    1724      TRAP #15
00002918                          1725  
00002918                          1726  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
00002918                          1727      ;SET FILL COLOR 
00002918  103C 0051               1728      MOVE.B #81, D0
0000291C  223C 000000CC           1729      MOVE.L #COLBUTHL, D1
00002922  4E4F                    1730      TRAP #15
00002924                          1731      ;END SET FILL COLOR
00002924  3F3C 0135               1732      MOVE.W #309, -(A7) ;COORDENADA Y 
00002928  3F3C 0136               1733      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
0000292C  3F3C 0016               1734      MOVE.W #22, -(A7)
00002930  4EB9 00002966           1735      JSR TRIANGLE
00002936  3C1F                    1736      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
00002938  3C1F                    1737      MOVE.W (A7)+, D6
0000293A  3C1F                    1738      MOVE.W (A7)+, D6
0000293C                          1739  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
0000293C                          1740     ;SET FILL COLOR
0000293C  103C 0051               1741     MOVE.B #81, D0
00002940  223C 00EEEEEE           1742     MOVE.L #COLBUTHV, D1
00002946  4E4F                    1743     TRAP #15
00002948                          1744     
00002948                          1745      ;END SET FILL COLOR
00002948  3F3C 00F9               1746     MOVE.W #249, -(A7) ;COORDENADA Y 
0000294C  3F3C 0136               1747     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00002950  3F3C FFEA               1748     MOVE.W #-22, -(A7)
00002954  4EB9 00002966           1749     JSR TRIANGLE
0000295A  3C1F                    1750     MOVE.W (A7)+, D6
0000295C  3C1F                    1751     MOVE.W (A7)+, D6
0000295E  3C1F                    1752     MOVE.W (A7)+, D6
00002960  4CDF 7FFF               1753     MOVEM.L (A7)+, D0-D7/A0-A6
00002964                          1754  
00002964  4E75                    1755     RTS
00002966                          1756  ; ------------------------------------------------------------------------------
00002966                          1757  TRIANGLE
00002966                          1758  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
00002966                          1759  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
00002966                          1760  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
00002966                          1761  ;            SIDES LENGTH (WORD) IN THAT ORDER
00002966                          1762  ; OUTPUT   : NONE
00002966                          1763  ; MODIFIES : NONE
00002966                          1764  ; ------------------------------------------------------------------------------
00002966  48A7 F800               1765      MOVEM.W D0-D4, -(A7)
0000296A                          1766      ; LINE FROM LEFT TO RIGHT
0000296A  103C 0054               1767      MOVE.B  #84,D0      ; TASK NUMBER
0000296E  322F 0010               1768      MOVE.W  16(A7),D1   ; X POSITION FROM
00002972  342F 0012               1769      MOVE.W  18(A7),D2   ; Y POSITION FROM
00002976  3802                    1770      MOVE.W  D2,D4       ; Y POSITION TO
00002978  362F 000E               1771      MOVE.W  14(A7),D3   ; LENGTH
0000297C                          1772      
0000297C  6A00 0004               1773      BPL.W   .UPWARDS
00002980  4443                    1774      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
00002982                          1775  .UPWARDS
00002982  D641                    1776      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
00002984  4E4F                    1777      TRAP    #15         ; HORIZONTAL LINE DRAWN
00002986                          1778      ; LINE FROM RIGHT TO UP/DOWN
00002986  9641                    1779      SUB.W   D1,D3       ; I GET LENGTH IN D3
00002988  3001                    1780      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
0000298A  D243                    1781      ADD.W   D3,D1       ; X POSITION FROM
0000298C  E24B                    1782      LSR.W   #1,D3       ; LENGTH/2
0000298E  D640                    1783      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
00002990                          1784      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
00002990  D86F 000E               1785      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
00002994  103C 0054               1786      MOVE.B  #84,D0
00002998  4E4F                    1787      TRAP    #15
0000299A                          1788      ; LINE FROM LEFT TO UP/DOWN
0000299A  322F 0010               1789      MOVE.W  16(A7),D1   ; X POSITION FROM
0000299E  4E4F                    1790      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
000029A0                          1791      
000029A0                          1792      ; FILLING TRIANGLE
000029A0  103C 0059               1793      MOVE.B  #89,D0
000029A4  5241                    1794      ADDQ.W  #1,D1
000029A6  363C 0001               1795      MOVE.W  #1,D3
000029AA  4A6F 000E               1796      TST.W   14(A7)
000029AE  6A00 0004               1797      BPL.W   .ISPOSITIVE
000029B2  4443                    1798      NEG.W   D3
000029B4                          1799  .ISPOSITIVE
000029B4  D443                    1800      ADD.W   D3,D2
000029B6  4E4F                    1801      TRAP    #15
000029B8                          1802      
000029B8  4C9F 001F               1803      MOVEM.W (A7)+,D0-D4
000029BC  4E75                    1804      RTS
000029BE                          1805      
000029BE                          1806  ; ------------------------------------------------------------------------------
000029BE                          1807  ELEVATORUPDATE ; 1 = up 3 = down
000029BE                          1808  ; INPUT    : 
000029BE                          1809  ; OUTPUT   : 
000029BE                          1810  ; MODIFIES : 
000029BE                          1811  ; ------------------------------------------------------------------------------
000029BE  4EB9 00002CAE           1812      JSR  ELEVATORMUSIC  
000029C4  0839 0005 00002FAE      1813      BTST #5, KBDVAL
000029CC  6600 002A               1814      BNE .HLSEL
000029D0  0839 0007 00002FAE      1815      BTST #7, KBDVAL
000029D8  6600 0004               1816      BNE .HVSEL
000029DC  4E75                    1817      RTS
000029DE                          1818  .HVSEL  ;LOAD 1ST HEAVEN MAP
000029DE  33FC 0002 0000302E      1819      MOVE.W  #2,(STANEXT)
000029E6  13FC 0000 0000300E      1820      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
000029EE  33FC 0000 00002FC8      1821      MOVE.W #0, LOADEDMAP    
000029F6  4E75                    1822      RTS
000029F8                          1823  .HLSEL  ;LOAD 1ST HELL MAP
000029F8  33FC 0002 0000302E      1824      MOVE.W  #2,(STANEXT)
00002A00  13FC 0000 0000300E      1825      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
00002A08  33FC 0004 00002FC8      1826      MOVE.W #4, LOADEDMAP
00002A10  4E75                    1827      RTS
00002A12                          1828      
00002A12                          1829          
00002A12                          1830  
00002A12                          1831  
00002A12                          1832  
00002A12                          1833  
00002A12                          1834  
00002A12                          1835  
00002A12                          1836  
00002A12                          1837  
00002A12                          1838  
00002A12                          1839  
00002A12                          1840  
00002A12                          1841  -------------------- end include --------------------
00002A12                          1842              INCLUDE "PLAYER.X68"    
00002A12                          1843  ; ==============================================================================
00002A12                          1844  ; PLAYER MANAGEMENT
00002A12                          1845  ; ==============================================================================
00002A12                          1846              
00002A12                          1847  ; ------------------------------------------------------------------------------
00002A12                          1848  PLAYERUPD
00002A12                          1849  ; UPDATES THE PLAYER.
00002A12                          1850  ; INPUT    : NONE 
00002A12                          1851  ; OUTPUT   : NONE
00002A12                          1852  ; MODIFIES : NONE
00002A12                          1853  ; ------------------------------------------------------------------------------
00002A12  48E7 F000               1854              MOVEM.L D0-D3,-(A7)
00002A16                          1855              ; CHECK COLLISIONS
00002A16                          1856              ; TOP LEFT CORNER
00002A16  3039 00002FB6           1857              MOVE.W  (PLAYERPOSX),D0
00002A1C  E188                    1858              LSL.L   #8,D0
00002A1E  E188                    1859              LSL.L   #8,D0
00002A20  3039 00002FB8           1860              MOVE.W  (PLAYERPOSY),D0
00002A26                          1861              
00002A26  3239 00002FB6           1862              MOVE.W  (PLAYERPOSX),D1
00002A2C  0641 0020               1863              ADD.W   #PLAYERWIDTH,D1
00002A30  E189                    1864              LSL.L   #8,D1
00002A32  E189                    1865              LSL.L   #8,D1
00002A34  3239 00002FB8           1866              MOVE.W  (PLAYERPOSY),D1
00002A3A  0641 0020               1867              ADD.W   #PLAYERHEIGHT,D1
00002A3E                          1868              
00002A3E  4EB8 14A6               1869              JSR BLKCOLL    
00002A42                          1870                              
00002A42  0839 0000 00002FAE      1871              BTST #0, KBDVAL         ; SI NO VA HACIA LA IZQUIERDA
00002A4A  6700 001E               1872              BEQ .NOLEFT
00002A4E  5979 00002FB6           1873              SUB.W   #PLAYERSPEED,(PLAYERPOSX)
00002A54  4A80                    1874              TST.L   D0              ; SI HAY COLISIONES CON D0
00002A56  6600 000C               1875              BNE .LEFT             
00002A5A  4A83                    1876              TST.L   D3              ; SI HAY COLISIONES CON D3
00002A5C  6600 0006               1877              BNE .LEFT
00002A60  6000 0008               1878              BRA  .NOLEFT
00002A64  5879 00002FB6           1879  .LEFT       ADD.W   #PLAYERSPEED,(PLAYERPOSX)
00002A6A                          1880  .NOLEFT     
00002A6A  0839 0001 00002FAE      1881              BTST #1, KBDVAL         ; SI NO VA ARRIBA
00002A72  6700 001E               1882              BEQ .NOUP
00002A76  5979 00002FB8           1883              SUB.W   #PLAYERSPEED,(PLAYERPOSY)
00002A7C  4A80                    1884              TST.L   D0              ; SI HAY COLISIONES CON D0
00002A7E  6600 000C               1885              BNE .UP             
00002A82  4A81                    1886              TST.L   D1              ; SI HAY COLISIONES CON D1
00002A84  6600 0006               1887              BNE .UP
00002A88  6000 0008               1888              BRA .NOUP
00002A8C  5879 00002FB8           1889  .UP         ADD.W   #PLAYERSPEED,(PLAYERPOSY)
00002A92                          1890  .NOUP       
00002A92  0839 0002 00002FAE      1891              BTST #2, KBDVAL         ; SI NO VA HACIA LA DERECHA
00002A9A  6700 001E               1892              BEQ .NORIGHT
00002A9E  5879 00002FB6           1893              ADD.W   #PLAYERSPEED,(PLAYERPOSX)
00002AA4  4A81                    1894              TST.L   D1              ; SI HAY COLISIONES CON D1
00002AA6  6600 000C               1895              BNE .RIGHT             
00002AAA  4A82                    1896              TST.L   D2              ; SI HAY COLISIONES CON D2
00002AAC  6600 0006               1897              BNE .RIGHT
00002AB0  6000 0008               1898              BRA .NORIGHT
00002AB4  5979 00002FB6           1899  .RIGHT      SUB.W   #PLAYERSPEED,(PLAYERPOSX)
00002ABA                          1900  .NORIGHT    
00002ABA  0839 0003 00002FAE      1901              BTST #3, KBDVAL         ; SI NO VA ABAJO
00002AC2  6700 001E               1902              BEQ .NODOWN             
00002AC6  5879 00002FB8           1903              ADD.W   #PLAYERSPEED,(PLAYERPOSY)
00002ACC  4A82                    1904              TST.L   D2              ; SI HAY COLISIONES CON D2
00002ACE  6600 000C               1905              BNE .DOWN             
00002AD2  4A83                    1906              TST.L   D3              ; SI HAY COLISIONES CON D3
00002AD4  6600 0006               1907              BNE .DOWN             
00002AD8  6000 0008               1908              BRA .NODOWN             
00002ADC  5979 00002FB8           1909  .DOWN       SUB.W   #PLAYERSPEED,(PLAYERPOSY)
00002AE2                          1910  .NODOWN     
00002AE2  4CDF 000F               1911              MOVEM.L (A7)+,D0-D3
00002AE6  4E75                    1912              RTS
00002AE8                          1913          
00002AE8                          1914  ; ------------------------------------------------------------------------------
00002AE8                          1915  PLAYERPLOT
00002AE8                          1916  ; PLOT THE PLAYER.
00002AE8                          1917  ; INPUT    : NONE 
00002AE8                          1918  ; OUTPUT   : NONE
00002AE8                          1919  ; MODIFIES : NONE
00002AE8                          1920  ; ------------------------------------------------------------------------------
00002AE8                          1921              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
00002AE8  1F00                    1922              MOVE.B  D0,-(A7)
00002AEA  2F01                    1923              MOVE.L  D1,-(A7)
00002AEC  48A7 3800               1924        MOVEM.W D2-D4, -(A7)
00002AF0                          1925        
00002AF0  223C 00CC954E           1926        MOVE.L #$00CC954E,D1 ;PEN COLOR
00002AF6  103C 0050               1927        MOVE.B #80,D0
00002AFA  4E4F                    1928        TRAP #15
00002AFC  223C 00B53866           1929        MOVE.L #$00B53866,D1 ;FILL COLOR
00002B02  103C 0051               1930        MOVE.B #81,D0
00002B06  4E4F                    1931        TRAP #15
00002B08                          1932        ; SE DIBUJA EL CUADRADO
00002B08  3239 00002FB6           1933        MOVE.W (PLAYERPOSX),D1    
00002B0E  3439 00002FB8           1934        MOVE.W (PLAYERPOSY),D2      
00002B14  3601                    1935        MOVE.W D1,D3
00002B16  0643 0020               1936              ADD.W  #PLAYERWIDTH,D3  
00002B1A  3802                    1937        MOVE.W D2,D4
00002B1C  0644 0020               1938              ADD.W  #PLAYERHEIGHT,D4
00002B20  103C 0057               1939        MOVE.B #87,D0
00002B24  4E4F                    1940        TRAP #15
00002B26                          1941        
00002B26  4C9F 001C               1942              MOVEM.W (A7)+,D2-D4
00002B2A  221F                    1943              MOVE.L  (A7)+,D1      
00002B2C  101F                    1944              MOVE.B  (A7)+,D0
00002B2E                          1945    
00002B2E  4E75                    1946        RTS
00002B30                          1947  
00002B30                          1948  
00002B30                          1949  
00002B30                          1950  
00002B30                          1951  
00002B30                          1952  -------------------- end include --------------------
00002B30                          1953              INCLUDE "PROJECTILE.X68"
00002B30                          1954  ; ==============================================================================
00002B30                          1955  ; PROJECTILE MANAGEMENT (AGENT)
00002B30                          1956  ; PROJPOSX (W)  (A0)
00002B30                          1957  ; PROJPOSY (W) 2(A0)
00002B30                          1958  ; PROJVELX (W) 4(A0)
00002B30                          1959  ; PROJVELY (W) 6(A0)
00002B30                          1960  ; ==============================================================================
00002B30                          1961  
00002B30                          1962  ; ------------------------------------------------------------------------------
00002B30                          1963  PROJINIT 
00002B30                          1964  ; INITIALIZES THE PROJECTILE.
00002B30                          1965  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00002B30                          1966  ; OUTPUT   : NONE
00002B30                          1967  ; MODIFIES : NONE
00002B30                          1968  ; ------------------------------------------------------------------------------
00002B30  2F00                    1969             MOVE.L  D0,-(A7)
00002B32                          1970             
00002B32  4280                    1971              CLR.L   D0
00002B34  0839 0004 00002FAF      1972              BTST #4, (KBDEDGE)    
00002B3C  6700 0008               1973              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
00002B40  0680 FFF80000           1974              ADD.L   #-PROJSPEEDX<<16,D0
00002B46  0839 0005 00002FAF      1975  .FUP        BTST #5, (KBDEDGE)      
00002B4E  6700 0006               1976              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
00002B52  0640 FFF8               1977              ADD.W   #-PROJSPEEDY,D0 
00002B56  0839 0006 00002FAF      1978  .FRIGHT     BTST #6, (KBDEDGE)
00002B5E  6700 0008               1979              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
00002B62  0680 00080000           1980              ADD.L   #PROJSPEEDX<<16,D0
00002B68  0839 0007 00002FAF      1981  .FDOWN      BTST #7, (KBDEDGE)
00002B70  6700 0004               1982              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
00002B74  5040                    1983              ADD.W   #PROJSPEEDY,D0
00002B76  4A80                    1984  .NOTFDOWN   TST.L   D0
00002B78  6600 0006               1985              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
00002B7C  303C 0008               1986              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
00002B80  20B9 00002FB6           1987  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
00002B86  2140 0004               1988              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
00002B8A  5279 00002FBA           1989              ADD.W   #1,(NPROJ)
00002B90  201F                    1990              MOVE.L  (A7)+,D0
00002B92  4E75                    1991              RTS
00002B94                          1992    
00002B94                          1993  ; ------------------------------------------------------------------------------
00002B94                          1994  PROJUPD 
00002B94                          1995  ; UPDATES THE PROJECTILE.
00002B94                          1996  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00002B94                          1997  ; OUTPUT   : NONE
00002B94                          1998  ; MODIFIES : NONE
00002B94                          1999  ; ------------------------------------------------------------------------------
00002B94  48E7 F000               2000              MOVEM.L  D0-D3,-(A7)
00002B98  2028 0004               2001              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
00002B9C  D168 0002               2002              ADD.W   D0,2(A0)
00002BA0  E088                    2003              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
00002BA2  E088                    2004              LSR.L   #8,D0
00002BA4  D150                    2005              ADD.W   D0,(A0) 
00002BA6                          2006              
00002BA6                          2007              ; CHECK COLLISIONS
00002BA6                          2008              ; TOP LEFT CORNER
00002BA6  3010                    2009              MOVE.W  (A0),D0
00002BA8  E188                    2010              LSL.L   #8,D0
00002BAA  E188                    2011              LSL.L   #8,D0
00002BAC  3028 0002               2012              MOVE.W  2(A0),D0
00002BB0                          2013              
00002BB0  3210                    2014              MOVE.W  (A0),D1
00002BB2  0641 0010               2015              ADD.W   #PROJWIDTH,D1
00002BB6  E189                    2016              LSL.L   #8,D1
00002BB8  E189                    2017              LSL.L   #8,D1
00002BBA  3228 0002               2018              MOVE.W  2(A0),D1
00002BBE  0641 0010               2019              ADD.W   #PROJHEIGHT,D1
00002BC2                          2020  
00002BC2  4EB8 14A6               2021              JSR BLKCOLL
00002BC6  4A80                    2022              TST.L   D0
00002BC8  6600 001A               2023              BNE.L   .PROJCOLL
00002BCC  4A81                    2024              TST.L   D1
00002BCE  6600 0014               2025              BNE.L   .PROJCOLL
00002BD2  4A82                    2026              TST.L   D2
00002BD4  6600 000E               2027              BNE.L   .PROJCOLL
00002BD8  4A83                    2028              TST.L   D3
00002BDA  6600 0008               2029              BNE.L   .PROJCOLL
00002BDE                          2030  .PROJNOCOLL             
00002BDE  4CDF 000F               2031              MOVEM.L  (A7)+,D0-D3
00002BE2  4E75                    2032              RTS
00002BE4                          2033              
00002BE4  4EB8 10F4               2034  .PROJCOLL   JSR AGLKILL
00002BE8  5379 00002FBA           2035              SUB.W   #1,(NPROJ)
00002BEE  60EE                    2036              BRA     .PROJNOCOLL
00002BF0                          2037  ; ------------------------------------------------------------------------------
00002BF0                          2038  PROJPLOT 
00002BF0                          2039  ; PLOTS THE PROJECTILE.
00002BF0                          2040  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
00002BF0                          2041  ; OUTPUT   : NONE
00002BF0                          2042  ; MODIFIES : NONE
00002BF0                          2043  ; ------------------------------------------------------------------------------
00002BF0  1F00                    2044              MOVE.B  D0,-(A7)
00002BF2  2F01                    2045              MOVE.L  D1,-(A7)
00002BF4  48A7 3800               2046        MOVEM.W D2-D4, -(A7)
00002BF8                          2047        
00002BF8  223C 00C00FFE           2048        MOVE.L #$00C00FFE,D1 ;PEN COLOR
00002BFE  103C 0050               2049        MOVE.B #80,D0
00002C02  4E4F                    2050        TRAP #15
00002C04  223C 00BFF006           2051        MOVE.L #$00BFF006,D1 ;FILL COLOR
00002C0A  103C 0051               2052        MOVE.B #81,D0
00002C0E  4E4F                    2053        TRAP #15
00002C10                          2054        ; SE DIBUJA EL CUADRADO
00002C10  3210                    2055        MOVE.W (A0),D1    
00002C12  3428 0002               2056        MOVE.W 2(A0),D2     
00002C16  3601                    2057        MOVE.W D1,D3
00002C18  0643 0010               2058              ADD.W  #PROJWIDTH,D3    
00002C1C  3802                    2059        MOVE.W D2,D4
00002C1E  0644 0010               2060              ADD.W  #PROJHEIGHT,D4
00002C22  103C 0057               2061        MOVE.B #87,D0
00002C26  4E4F                    2062        TRAP #15
00002C28                          2063        
00002C28  4C9F 001C               2064              MOVEM.W (A7)+,D2-D4
00002C2C  221F                    2065              MOVE.L  (A7)+,D1      
00002C2E  101F                    2066              MOVE.B  (A7)+,D0
00002C30  4E75                    2067              RTS
00002C32                          2068  
00002C32                          2069  
00002C32                          2070  
00002C32                          2071  
00002C32                          2072  -------------------- end include --------------------
00002C32                          2073              INCLUDE "AUDIO.X68"
00002C32                          2074     
00002C32                          2075  ; =============================================================================
00002C32                          2076  ; AUDIO MANAGEMENT
00002C32                          2077  ; =============================================================================
00002C32                          2078  
00002C32                          2079  
00002C32                          2080  ; -----------------------------------------------------------------------------
00002C32                          2081  AUDINIT
00002C32                          2082  ; CHANGES AUDIO TO PLAY
00002C32                          2083  ; INPUT    - NONE
00002C32                          2084  ; OUTPUT   - NONE
00002C32                          2085  ; MODIFIES - NONE
00002C32                          2086  ; -----------------------------------------------------------------------------
00002C32                          2087      
00002C32  48A7 E000               2088      MOVEM.W D0-D2, -(A7)
00002C36  48A7 00C0               2089      MOVEM.W A0-A1, -(A7)
00002C3A                          2090  ;LOAD ELEVATOR MUSIC IN POS 0 
00002C3A  103C 0047               2091      MOVE.B #71, D0
00002C3E  43F8 100F               2092      LEA ELEVATOR_MUSIC, A1
00002C42  123C 0000               2093      MOVE.B #0, D1
00002C46  4E4F                    2094      TRAP #15
00002C48                          2095  ;LOAD HEAVEN MUSIC IN POS 1
00002C48  43F8 1000               2096      LEA HEAVENSOUND, A1
00002C4C  123C 0001               2097      MOVE.B #1, D1
00002C50  4E4F                    2098      TRAP #15
00002C52                          2099  ;LOAD HELL MUSIC IN POS 2
00002C52  43F8 1026               2100      LEA HELLSOUND, A1
00002C56  123C 0002               2101      MOVE.B #2, D1
00002C5A  4E4F                    2102      TRAP #15
00002C5C  4C9F 0300               2103      MOVEM.W (A7)+, A0-A1
00002C60  4C9F 0007               2104      MOVEM.W (A7)+, D0-D2
00002C64                          2105  
00002C64  4E75                    2106      RTS
00002C66                          2107  
00002C66                          2108  
00002C66                          2109  ; -----------------------------------------------------------------------------
00002C66                          2110  AUDPLAY
00002C66                          2111  ; CHANGES AUDIO TO PLAY
00002C66                          2112  ; INPUT    - NONE
00002C66                          2113  ; OUTPUT   - NONE
00002C66                          2114  ; MODIFIES - NONE
00002C66                          2115  ; -----------------------------------------------------------------------------
00002C66                          2116      
00002C66  48E7 E000               2117      MOVEM.L D0-D2, -(A7)
00002C6A  48A7 00C0               2118      MOVEM.W A0-A1, -(A7)    
00002C6E                          2119      
00002C6E  3239 00002FC8           2120      MOVE.W LOADEDMAP, D1
00002C74  C2FC 0006               2121             MULU #6, D1
00002C78  3241                    2122             MOVEA.W D1, A1
00002C7A  4EE9 2C7E               2123             JMP MSCSEL(A1)
00002C7E                          2124  MSCSEL:
00002C7E                          2125             
00002C7E  4EF9 00002CCC           2126             JMP HEAVENMUSIC
00002C84                          2127             
00002C84  4EF9 00002CCC           2128             JMP HEAVENMUSIC
00002C8A                          2129             
00002C8A  4EF9 00002CCC           2130             JMP HEAVENMUSIC
00002C90                          2131             
00002C90  4EF9 00002CCC           2132             JMP HEAVENMUSIC
00002C96                          2133             
00002C96  4EF9 00002CEE           2134             JMP HELLMUSIC
00002C9C                          2135             
00002C9C  4EF9 00002CEE           2136             JMP HELLMUSIC
00002CA2                          2137             
00002CA2  4EF9 00002CEE           2138             JMP HELLMUSIC
00002CA8                          2139             
00002CA8  4EF9 00002CEE           2140             JMP HELLMUSIC
00002CAE                          2141             
00002CAE                          2142  
00002CAE                          2143  ELEVATORMUSIC
00002CAE  48A7 E000               2144      MOVEM.W D0-D2 ,-(A7)
00002CB2  103C 004C               2145      MOVE.B #76, D0
00002CB6  123C 0000               2146      MOVE.B #0, D1
00002CBA  7400                    2147      MOVE.L #0, D2
00002CBC  4E4F                    2148      TRAP #15
00002CBE  4C9F 0007               2149      MOVEM.W (A7)+, D0-D2 
00002CC2  13FC 0001 0000300E      2150      MOVE.B #1, MUSICPLAYED
00002CCA  4E75                    2151      RTS
00002CCC                          2152  
00002CCC                          2153  HEAVENMUSIC 
00002CCC  103C 004C               2154      MOVE.B #76, D0
00002CD0  123C 0000               2155      MOVE.B #0, D1
00002CD4  7402                    2156      MOVE.L #2, D2
00002CD6  4E4F                    2157      TRAP #15
00002CD8  103C 004C               2158      MOVE.B #76, D0
00002CDC  123C 0001               2159      MOVE.B #1, D1
00002CE0  7400                    2160      MOVE.L #0, D2
00002CE2  4E4F                    2161      TRAP #15
00002CE4  4C9F 0300               2162      MOVEM.W (A7)+, A0-A1
00002CE8  4CDF 0007               2163      MOVEM.L (A7)+, D0-D2
00002CEC  4E75                    2164      RTS
00002CEE                          2165  HELLMUSIC
00002CEE  103C 004C               2166      MOVE.B #76, D0
00002CF2  123C 0000               2167      MOVE.B #0, D1
00002CF6  7402                    2168      MOVE.L #2, D2
00002CF8  4E4F                    2169      TRAP #15
00002CFA  103C 004C               2170      MOVE.B #76, D0
00002CFE  123C 0002               2171      MOVE.B #2, D1
00002D02  7400                    2172      MOVE.L #0,  D2
00002D04  4E4F                    2173      TRAP #15
00002D06  4C9F 0300               2174      MOVEM.W (A7)+, A0-A1
00002D0A  4CDF 0007               2175      MOVEM.L (A7)+, D0-D2
00002D0E  4E75                    2176      RTS
00002D10                          2177  
00002D10                          2178  FIREDSOUND
00002D10  48A7 E000               2179      MOVEM.W D0-D2, -(A7)
00002D14  48A7 00C0               2180      MOVEM.W A0-A1, -(A7)
00002D18  103C 0049               2181      MOVE.B #73, D0
00002D1C  43F8 1035               2182      LEA PROJ_SOUND, A1
00002D20  4E4F                    2183      TRAP #15
00002D22  4C9F 0300               2184      MOVEM.W (A7)+, A0-A1
00002D26  4C9F 0007               2185      MOVEM.W (A7)+, D0-D2
00002D2A  4E75                    2186      RTS
00002D2C                          2187  
00002D2C                          2188  -------------------- end include --------------------
00002D2C                          2189              INCLUDE "STATES.X68"
00002D2C                          2190  ; =============================================================================
00002D2C                          2191  ; GAME STATE MANAGEMENT
00002D2C                          2192  ; =============================================================================
00002D2C                          2193  
00002D2C                          2194  ; -----------------------------------------------------------------------------
00002D2C                          2195  STAINIT
00002D2C                          2196  ; INITALIZES THE STATE MANAGER
00002D2C                          2197  ; INPUT    - NONE
00002D2C                          2198  ; OUTPUT   - NONE
00002D2C                          2199  ; MODIFIES - NONE
00002D2C                          2200  ; -----------------------------------------------------------------------------
00002D2C  33FC FFFF 0000302C      2201              MOVE.W  #STANONE,(STACUR)
00002D34  4279 0000302E           2202              CLR.W   (STANEXT)
00002D3A  4E75                    2203              RTS
00002D3C                          2204  
00002D3C                          2205  ; -----------------------------------------------------------------------------
00002D3C                          2206  STAUPD
00002D3C                          2207  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00002D3C                          2208  ; INPUT    - NONE
00002D3C                          2209  ; OUTPUT   - NONE
00002D3C                          2210  ; MODIFIES - NONE
00002D3C                          2211  ; -----------------------------------------------------------------------------
00002D3C  48E7 8080               2212              MOVEM.L D0/A0,-(A7)
00002D40  4280                    2213              CLR.L   D0
00002D42  3039 0000302E           2214              MOVE.W  (STANEXT),D0
00002D48  B079 0000302C           2215              CMP.W   (STACUR),D0
00002D4E  6700 0012               2216              BEQ     .DOUPD
00002D52  33C0 0000302C           2217              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002D58  E588                    2218              LSL.L   #2,D0
00002D5A  2040                    2219              MOVE.L  D0,A0
00002D5C  2068 2D7A               2220              MOVE.L  .INITBL(A0),A0
00002D60  4E90                    2221              JSR     (A0)
00002D62  4280                    2222  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00002D64  3039 0000302C           2223              MOVE.W  (STACUR),D0
00002D6A  E588                    2224              LSL.L   #2,D0
00002D6C  2040                    2225              MOVE.L  D0,A0
00002D6E  2068 2D8A               2226              MOVE.L  .UPDTBL(A0),A0
00002D72  4E90                    2227              JSR     (A0)
00002D74  4CDF 0101               2228              MOVEM.L (A7)+,D0/A0
00002D78  4E75                    2229              RTS
00002D7A= 00002DC6 000027A2 ...   2230  .INITBL     DC.L    STAEMPTY,ELEVATORINIT,STAEMPTY,ENDGINIT
00002D8A= 00002E34 000029BE ...   2231  .UPDTBL     DC.L    ISCUPD,ELEVATORUPDATE,GAMUPD,ENDGUPD
00002D9A                          2232  
00002D9A                          2233  ; -----------------------------------------------------------------------------
00002D9A                          2234  STAPLOT
00002D9A                          2235  ; PERFORMS STATE PLOT
00002D9A                          2236  ; INPUT    - NONE
00002D9A                          2237  ; OUTPUT   - NONE
00002D9A                          2238  ; MODIFIES - NONE
00002D9A                          2239  ; -----------------------------------------------------------------------------
00002D9A  48E7 8080               2240              MOVEM.L D0/A0,-(A7)
00002D9E  4280                    2241              CLR.L   D0
00002DA0  3039 0000302C           2242              MOVE.W  (STACUR),D0
00002DA6  E588                    2243              LSL.L   #2,D0
00002DA8  2040                    2244              MOVE.L  D0,A0
00002DAA  2068 2DB6               2245              MOVE.L  .PLTTBL(A0),A0
00002DAE  4E90                    2246              JSR     (A0)
00002DB0  4CDF 0101               2247              MOVEM.L (A7)+,D0/A0
00002DB4  4E75                    2248              RTS
00002DB6= 00002E4E 000027A6 ...   2249  .PLTTBL     DC.L    ISCPLOT,ELEVATORPLOT,GAMPLOT,ENDGPLOT
00002DC6                          2250  
00002DC6                          2251  ; -----------------------------------------------------------------------------
00002DC6                          2252  STAEMPTY
00002DC6                          2253  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00002DC6                          2254  ; INPUT    - NONE
00002DC6                          2255  ; OUTPUT   - NONE
00002DC6                          2256  ; MODIFIES - NONE
00002DC6                          2257  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00002DC6                          2258  ; -----------------------------------------------------------------------------
00002DC6  4E75                    2259              RTS
00002DC8                          2260  
00002DC8                          2261  
00002DC8                          2262  
00002DC8                          2263  
00002DC8                          2264  
00002DC8                          2265  
00002DC8                          2266  
00002DC8                          2267  
00002DC8                          2268  
00002DC8                          2269  
00002DC8                          2270  
00002DC8                          2271  
00002DC8                          2272  -------------------- end include --------------------
00002DC8                          2273              INCLUDE "GAME.X68"
00002DC8                          2274  ; ==============================================================================
00002DC8                          2275  ; GAME MANAGEMENT
00002DC8                          2276  ; ==============================================================================
00002DC8                          2277  
00002DC8                          2278  ; ------------------------------------------------------------------------------
00002DC8                          2279  GAMUPD
00002DC8                          2280  ; UPDATES THE GAME
00002DC8                          2281  ; INPUT    : NONE
00002DC8                          2282  ; OUTPUT   : NONE
00002DC8                          2283  ; MODIFIES : NONE
00002DC8                          2284  ; ------------------------------------------------------------------------------
00002DC8  48E7 8070               2285              MOVEM.L D0/A1-A3,-(A7)
00002DCC                          2286              
00002DCC                          2287              ; CHECK IF MUSIC IS ALREADY PLAYING 
00002DCC  1039 0000300E           2288              MOVE.B MUSICPLAYED, D0
00002DD2  B07C 0001               2289              CMP #1, D0
00002DD6  6700 0006               2290              BEQ .NOMUSIC
00002DDA  4EB8 2C66               2291              JSR AUDPLAY
00002DDE                          2292  ; GENERAL UPDATES
00002DDE  4EB8 2A12               2293  .NOMUSIC    JSR PLAYERUPD   
00002DE2  4EB8 15B0               2294              JSR MAPUPD
00002DE6                          2295  ; SHOTS LOGIC         
00002DE6  1039 00002FAF           2296              MOVE.B  (KBDEDGE),D0
00002DEC  C03C 00F0               2297              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
00002DF0  6718                    2298              BEQ.B .NOTFIRED
00002DF2  4EB8 2D10               2299              JSR FIREDSOUND
00002DF6  43F8 2B30               2300              LEA     PROJINIT,A1
00002DFA  45F8 2B94               2301              LEA     PROJUPD,A2
00002DFE  47F8 2BF0               2302              LEA     PROJPLOT,A3
00002E02  303C 0001               2303              MOVE.W  #1,D0
00002E06  4EB8 12BC               2304              JSR     AGLADD
00002E0A                          2305  .NOTFIRED
00002E0A  4A79 00002FBA           2306              TST.W   (NPROJ)
00002E10  6700 0006               2307              BEQ     .NOPROJ1
00002E14  4EB8 12D6               2308              JSR     AGLUPD
00002E18                          2309  .NOPROJ1
00002E18  4CDF 0E01               2310              MOVEM.L (A7)+,D0/A1-A3
00002E1C  4E75                    2311              RTS
00002E1E                          2312  
00002E1E                          2313  ; ------------------------------------------------------------------------------
00002E1E                          2314  GAMPLOT
00002E1E                          2315  ; PLOTS THE GAME
00002E1E                          2316  ; INPUT    : NONE
00002E1E                          2317  ; OUTPUT   : NONE
00002E1E                          2318  ; MODIFIES : NONE
00002E1E                          2319  ; ------------------------------------------------------------------------------
00002E1E  4EB8 1538               2320              JSR MAPPLOT     
00002E22  4A79 00002FBA           2321              TST.W   (NPROJ)
00002E28  6700 0006               2322              BEQ     .NOPROJ2
00002E2C  4EB8 12FA               2323              JSR     AGLPLOT
00002E30  6000 FCB6               2324  .NOPROJ2    BRA     PLAYERPLOT
00002E34                          2325  
00002E34                          2326  
00002E34                          2327  
00002E34                          2328  
00002E34                          2329  
00002E34                          2330  
00002E34                          2331  
00002E34                          2332  
00002E34                          2333  -------------------- end include --------------------
00002E34                          2334              INCLUDE "INTRO.X68"
00002E34                          2335  ; ==============================================================================
00002E34                          2336  ; INTRO SCREEN
00002E34                          2337  ; ==============================================================================
00002E34                          2338  
00002E34                          2339  ; ------------------------------------------------------------------------------
00002E34                          2340  ISCUPD
00002E34                          2341  ; INTRO SCREEN UPDATE
00002E34                          2342  ; INPUT    : NONE
00002E34                          2343  ; OUTPUT   : NONE
00002E34                          2344  ; MODIFIES : NONE
00002E34                          2345  ; ------------------------------------------------------------------------------
00002E34  103C 003D               2346              MOVE.B  #61,D0          ; READ MOUSE
00002E38  123C 0002               2347              MOVE.B  #2,D1           ; MOUSE DOWN STATE
00002E3C  4E4F                    2348              TRAP    #15
00002E3E  0200 000F               2349              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002E42  6708                    2350              BEQ.B   .DONE ; IF NO CLICK
00002E44  33FC 0001 0000302E      2351              MOVE.W  #1,(STANEXT)
00002E4C                          2352  .DONE
00002E4C  4E75                    2353              RTS
00002E4E                          2354  ; ------------------------------------------------------------------------------
00002E4E                          2355  ISCPLOT
00002E4E                          2356  ; INTRO SCREEN PLOT
00002E4E                          2357  ; INPUT    : NONE
00002E4E                          2358  ; OUTPUT   : NONE
00002E4E                          2359  ; MODIFIES : NONE
00002E4E                          2360  ; ------------------------------------------------------------------------------
00002E4E  48E7 C080               2361              MOVEM.L D0-D1/A0,-(A7)
00002E52                          2362              
00002E52  4281                    2363              CLR.L   D1
00002E54  103C 0051               2364              MOVE.B  #81,D0
00002E58  4E4F                    2365              TRAP    #15
00002E5A                          2366              
00002E5A  41F9 00002E88           2367              LEA     .TITLE,A0
00002E60  103C 000A               2368              MOVE.B  #10,D0
00002E64  4EB8 1336               2369              JSR     UTLPRINT
00002E68                          2370              
00002E68  0839 0004 00002FB1      2371              BTST.B  #4,(SCRCYCCT)
00002E70  6700 0010               2372              BEQ     .DONE
00002E74                          2373              
00002E74  41F9 00002EB4           2374              LEA     .HINT,A0
00002E7A  103C 0019               2375              MOVE.B  #25,D0
00002E7E  4EB8 1336               2376              JSR     UTLPRINT
00002E82                          2377              
00002E82  4CDF 0103               2378  .DONE       MOVEM.L (A7)+,D0-D1/A0
00002E86                          2379  
00002E86  4E75                    2380              RTS
00002E88= 50 41 54 45 52 4E ...   2381  .TITLE      DC.B    'PATERNOSTER: Beyond the pillars of Hercules',0
00002EB4= 43 4C 49 43 4B 20 ...   2382  .HINT       DC.B    'CLICK ANYWHERE TO START',0
00002ECC                          2383              DS.W    0
00002ECC                          2384  
00002ECC                          2385  
00002ECC                          2386  
00002ECC                          2387  
00002ECC                          2388  
00002ECC                          2389  
00002ECC                          2390  
00002ECC                          2391  
00002ECC                          2392  -------------------- end include --------------------
00002ECC                          2393              INCLUDE "ENDGAME.X68"
00002ECC                          2394  ; ==============================================================================
00002ECC                          2395  ; VICTORY SCREEN
00002ECC                          2396  ; ==============================================================================
00002ECC                          2397  
00002ECC                          2398  ; ------------------------------------------------------------------------------
00002ECC                          2399  ENDGINIT
00002ECC                          2400  ; END GAME SCREEN INIT
00002ECC                          2401  ; INPUT    : NONE
00002ECC                          2402  ; OUTPUT   : NONE
00002ECC                          2403  ; MODIFIES : NONE
00002ECC                          2404  ; ------------------------------------------------------------------------------
00002ECC                          2405  
00002ECC                          2406              ; GUARDAR SU RECORD EN UN FICHERO
00002ECC                          2407              ; LEER FICHERO QUE GUARDE LOS RECORDS Y GUARDAR EN MEMORIA
00002ECC  4E75                    2408              RTS
00002ECE                          2409  ; ------------------------------------------------------------------------------
00002ECE                          2410  ENDGUPD
00002ECE                          2411  ; END GAME SCREEN UPDATE
00002ECE                          2412  ; INPUT    : NONE
00002ECE                          2413  ; OUTPUT   : NONE
00002ECE                          2414  ; MODIFIES : NONE
00002ECE                          2415  ; ------------------------------------------------------------------------------
00002ECE  103C 003D               2416              MOVE.B  #61,D0          ; READ MOUSE
00002ED2  123C 0002               2417              MOVE.B  #2,D1           ; MOUSE DOWN STATE
00002ED6  4E4F                    2418              TRAP    #15
00002ED8  0200 000F               2419              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002EDC  6708                    2420              BEQ.B   .DONE           ; IF NO CLICK
00002EDE  33FC 0001 0000302E      2421              MOVE.W  #1,(STANEXT)
00002EE6                          2422  .DONE
00002EE6  4E75                    2423              RTS
00002EE8                          2424  
00002EE8                          2425  ; ------------------------------------------------------------------------------
00002EE8                          2426  ENDGPLOT
00002EE8                          2427  ; END GAME SCREEN PLOT
00002EE8                          2428  ; INPUT    : NONE
00002EE8                          2429  ; OUTPUT   : NONE
00002EE8                          2430  ; MODIFIES : NONE
00002EE8                          2431  ; ------------------------------------------------------------------------------
00002EE8  48E7 C080               2432              MOVEM.L D0-D1/A0,-(A7)
00002EEC                          2433              
00002EEC  4281                    2434              CLR.L   D1
00002EEE  103C 0051               2435              MOVE.B  #81,D0
00002EF2  4E4F                    2436              TRAP    #15
00002EF4                          2437              
00002EF4  41F9 00002F30           2438              LEA     .TXT1,A0
00002EFA  103C 000A               2439              MOVE.B  #10,D0
00002EFE  4EB8 1336               2440              JSR     UTLPRINT
00002F02                          2441              
00002F02  0839 0008 00002FB1      2442              BTST.B  #8,(SCRCYCCT)
00002F0A  6700 0010               2443              BEQ     .NOTPRINT
00002F0E                          2444              
00002F0E  41F9 00002F4A           2445              LEA     .TXT2,A0
00002F14  103C 0019               2446              MOVE.B  #25,D0
00002F18  4EB8 1336               2447              JSR     UTLPRINT
00002F1C                          2448              
00002F1C                          2449  .NOTPRINT
00002F1C  41F9 00002F62           2450              LEA     .TXT3,A0
00002F22  103C 0019               2451              MOVE.B  #25,D0
00002F26  4EB8 1336               2452              JSR     UTLPRINT
00002F2A                          2453              
00002F2A                          2454              ; MOSTRAR FICHERO QUE GUARDE LOS RECORDS
00002F2A                          2455              
00002F2A  4CDF 0103               2456              MOVEM.L (A7)+,D0-D1/A0
00002F2E                          2457  
00002F2E  4E75                    2458              RTS
00002F30= 59 4F 55 52 20 52 ...   2459  .TXT1       DC.B    'YOUR RECORD THIS TIME WAS',0
00002F4A= 43 4C 49 43 4B 20 ...   2460  .TXT2       DC.B    'CLICK ANYWHERE TO START',0
00002F62= 48 45 52 45 20 41 ...   2461  .TXT3       DC.B    'HERE ARE THE BEST RECORDS',0
00002F7C                          2462              DS.W    0
00002F7C                          2463  
00002F7C                          2464  
00002F7C                          2465  
00002F7C                          2466  
00002F7C                          2467  
00002F7C                          2468  -------------------- end include --------------------
00002F7C                          2469  START
00002F7C                          2470  
00002F7C                          2471  ; --- INITIALIZATION -----------------------------------------------------------
00002F7C                          2472  
00002F7C  007C 0700               2473              ORI.W   #$0700,SR
00002F80  4EB8 110A               2474              JSR     SYSINIT
00002F84  4EB8 2D2C               2475              JSR     STAINIT
00002F88                          2476  
00002F88                          2477  .LOOP
00002F88                          2478  
00002F88                          2479  ; --- UPDATE -------------------------------------------------------------------
00002F88                          2480  
00002F88                          2481  ; READ INPUT DEVICES
00002F88                          2482  
00002F88  4E41                    2483              TRAP    #KBDUPTN
00002F8A                          2484  
00002F8A                          2485  ; UPDATE GAME LOGIC
00002F8A                          2486  
00002F8A  4EB8 2D3C               2487              JSR     STAUPD
00002F8E                          2488  
00002F8E                          2489  ; --- SYNC ---------------------------------------------------------------------
00002F8E                          2490  
00002F8E  4A39 00002FB0           2491  .WINT       TST.B   (SCRINTCT)
00002F94  67F8                    2492              BEQ     .WINT
00002F96  4239 00002FB0           2493              CLR.B   (SCRINTCT)
00002F9C  5239 00002FB2           2494              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
00002FA2                          2495  
00002FA2                          2496  ; --- PLOT ---------------------------------------------------------------------
00002FA2                          2497              
00002FA2  4EB8 2D9A               2498              JSR     STAPLOT
00002FA6                          2499              
00002FA6  4E40                    2500              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
00002FA8                          2501  
00002FA8  60DE                    2502              BRA     .LOOP
00002FAA                          2503              
00002FAA  FFFF FFFF               2504              SIMHALT
00002FAE                          2505              
00002FAE                          2506              INCLUDE "VARS.X68"
00002FAE                          2507  ; ==============================================================================
00002FAE                          2508  ; VARIABLES
00002FAE                          2509  ; ==============================================================================
00002FAE                          2510              
00002FAE                          2511  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00002FAE                          2512              
00002FAE                          2513  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
00002FAF                          2514  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
00002FB0                          2515  
00002FB0                          2516  
00002FB0                          2517  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00002FB0                          2518  
00002FB0                          2519  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00002FB1                          2520  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00002FB2                          2521  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
00002FB4                          2522              DS.W    0
00002FB4                          2523  
00002FB4                          2524  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
00002FB4                          2525  
00002FB4= 0064                    2526  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
00002FB6= 0140                    2527  PLAYERPOSX      DC.W    SCRWIDTH/2
00002FB8= 00F0                    2528  PLAYERPOSY      DC.W    SCRHEIGH/2
00002FBA                          2529  
00002FBA                          2530  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
00002FBA                          2531  
00002FBA= 0000                    2532  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
00002FBC                          2533  
00002FBC                          2534  ; --- BLOCKS RELATED VARIABLES -------------------------------------------------
00002FBC                          2535  
00002FBC= 0000                    2536  BPOSX1      DC.W    0
00002FBE= 0000                    2537  BPOSY1      DC.W    0
00002FC0= 0020                    2538  BPOSX2      DC.W    32
00002FC2= 0020                    2539  BPOSY2      DC.W    32
00002FC4= 02 03 00                2540  BLWHICHCOLL DC.B    2,3,0 ; BLOCKS WHICH PRODUCES COLLISIONS, ENDS WITH NULL
00002FC7                          2541  
00002FC7                          2542  ; --- MAP RELATED VARIABLES ----------------------------------------------------
00002FC7                          2543  
00002FC8= 0000                    2544  LOADEDMAP   DC.W    0                       ; CURRENT MAP
00002FCA= 000019EC 00001A34 ...   2545  MAPUPDLIST  DC.L    MAPA1,MAPA2,MAPA3,MAPA4,MAPA5,MAPA6,MAPA7,MAPA8
00002FEA= 00001DB2 00001F02 ...   2546  MAPLIST     DC.L    HEAVEN_0,HEAVEN_1,HEAVEN_END,HEAVEN_ROOM,HELL_0,HELL_1,HELL_END,HELL_ROOM,0 
0000300E                          2547  
0000300E                          2548  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
0000300E                          2549  
0000300E= 00                      2550  MUSICPLAYED DC.B    0
00003010                          2551              DS.W    0
00003010                          2552  
00003010                          2553  ; --- FPS RELATED VARIABLES ----------------------------------------------------
00003010                          2554  
00003010                          2555  REALFPS     DS.W    1
00003012= 47 4F 41 4C 3A 20 00    2556  STRFPS1     DC.B    'GOAL: ',0   ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
00003019= 46 50 53 20 2D 20 ...   2557  STRFPS2     DC.B    'FPS - ACTUAL: ',0
00003028= 46 50 53 00             2558  STRFPS3     DC.B    'FPS',0
0000302C                          2559  
0000302C                          2560  ; --- STATE RELATED VARIABLES --------------------------------------------------
0000302C                          2561  
0000302C                          2562  STACUR      DS.W    1                       ; CURRENT STATE
0000302E                          2563  STANEXT     DS.W    1                       ; NEXT STATE
00003030                          2564  
00003030                          2565  
00003030                          2566  
00003030                          2567  
00003030                          2568  
00003030                          2569  
00003030                          2570  
00003030                          2571  
00003030                          2572  
00003030                          2573  
00003030                          2574  
00003030                          2575  
00003030                          2576  -------------------- end include --------------------
00003030                          2577              INCLUDE "LIB/UTLVARS.X68"
00003030                          2578  ; =============================================================================
00003030                          2579  ; UTILITY VARIABLES
00003030                          2580  ; =============================================================================
00003030                          2581  
00003030                          2582  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00003032                          2583              DS.W    0
00003032                          2584  -------------------- end include --------------------
00003032                          2585              INCLUDE "LIB/DMMVARS.X68"
00003032                          2586  ; =============================================================================
00003032                          2587  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
00003032                          2588  ; =============================================================================
00003032                          2589  
00003040                          2590              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00003040                          2591  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00003CC0                          2592              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00003CC0                          2593  -------------------- end include --------------------
00003CC0                          2594  
00003CC0                          2595              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12BC
AGLADD:END          12D2
AGLKILL             10F4
AGLPLOT             12FA
AGLPLOT:END         131A
AGLPLOT:LOOP        1302
AGLUPD              12D6
AGLUPD:END          12F4
AGLUPD:LOOP         12DE
AUDINIT             2C32
AUDPLAY             2C66
BLKCOLL             14A6
BLOCKSCOL           F
BLOCKSIZE           20
BLOCKSROW           14
BLWHICHCOLL         2FC4
BPOSX1              2FBC
BPOSX2              2FC0
BPOSY1              2FBE
BPOSY2              2FC2
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                16F6
DBHV                176A
DDHL                1620
DDHV                1640
DF1HL               1894
DF1HV               1874
DF2HL               1906
DF2HV               18B4
DGHE                1660
DGHL                17DE
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             3040
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           1958
ELEVATORINIT        27A2
ELEVATORMUSIC       2CAE
ELEVATORPLOT        27A6
ELEVATORUPDATE      29BE
ELEVATORUPDATE:HLSEL  29F8
ELEVATORUPDATE:HVSEL  29DE
ELEVATOR_MUSIC      100F
ENDBLOCK            19B0
ENDGINIT            2ECC
ENDGPLOT            2EE8
ENDGPLOT:NOTPRINT   2F1C
ENDGPLOT:TXT1       2F30
ENDGPLOT:TXT2       2F4A
ENDGPLOT:TXT3       2F62
ENDGUPD             2ECE
ENDGUPD:DONE        2EE6
ENDMAP              19C2
FIREDSOUND          2D10
FPSTEXTPOS          2D01
FRAMES_PER_SECOND   32
GAMPLOT             2E1E
GAMPLOT:NOPROJ2     2E30
GAMUPD              2DC8
GAMUPD:NOMUSIC      2DDE
GAMUPD:NOPROJ1      2E18
GAMUPD:NOTFIRED     2E0A
HEAVENMUSIC         2CCC
HEAVENSOUND         1000
HEAVEN_0            1DB2
HEAVEN_1            1F02
HEAVEN_END          203D
HEAVEN_ROOM         2178
HELLMUSIC           2CEE
HELLSOUND           1026
HELL_0              22B3
HELL_1              23EE
HELL_END            2529
HELL_ROOM           2664
ISBLWHICHCOLL       1486
ISBLWHICHCOLL:BCOLL  1498
ISBLWHICHCOLL:BEND  14A4
ISBLWHICHCOLL:BNEXTCHCK  148C
ISBLWHICHCOLL:BNOCOLL  14A2
ISCPLOT             2E4E
ISCPLOT:DONE        2E82
ISCPLOT:HINT        2EB4
ISCPLOT:TITLE       2E88
ISCUPD              2E34
ISCUPD:DONE         2E4C
JMPLIST             15D8
KBDDOWN             53
KBDEDGE             2FAF
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             1260
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              126E
KBDUPD:LOOP         12B2
KBDUPD:PACK         12AE
KBDUPTN             1
KBDVAL              2FAE
LOADEDMAP           2FC8
MAP1NODOOR          1A2E
MAP2NODOOR1         1A7C
MAP2NODOOR2         1AB2
MAP2NODOOR3         1AF0
MAP2NODOOR4         1B2E
MAP3NODOOR          1B7C
MAP4NODOOR          1BC4
MAP5NODOOR          1C0C
MAP6NODOOR1         1C5A
MAP6NODOOR2         1C90
MAP6NODOOR3         1CCE
MAP6NODOOR4         1D0C
MAP7NODOOR          1D5C
MAP8NODOOR1         1DAC
MAPA1               19EC
MAPA2               1A34
MAPA3               1B34
MAPA4               1B82
MAPA5               1BCA
MAPA6               1C12
MAPA7               1D12
MAPA8               1D62
MAPLIST             2FEA
MAPPLOT             1538
MAPSEL              1550
MAPUPD              15B0
MAPUPDLIST          2FCA
MSCSEL              2C7E
MUSICPLAYED         300E
NEWLINE             198C
NEXT                15CA
NPROJ               2FBA
PLAYERHEALTH        2FB4
PLAYERHEIGHT        20
PLAYERPLOT          2AE8
PLAYERPOSX          2FB6
PLAYERPOSY          2FB8
PLAYERSPEED         4
PLAYERUPD           2A12
PLAYERUPD:DOWN      2ADC
PLAYERUPD:LEFT      2A64
PLAYERUPD:NODOWN    2AE2
PLAYERUPD:NOLEFT    2A6A
PLAYERUPD:NORIGHT   2ABA
PLAYERUPD:NOUP      2A92
PLAYERUPD:RIGHT     2AB4
PLAYERUPD:UP        2A8C
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            2B30
PROJINIT:FDOWN      2B68
PROJINIT:FRIGHT     2B56
PROJINIT:FUP        2B46
PROJINIT:NOTFDOWN   2B76
PROJINIT:SHOOT      2B80
PROJPLOT            2BF0
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             2B94
PROJUPD:PROJCOLL    2BE4
PROJUPD:PROJNOCOLL  2BDE
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             3010
SCRCYCCT            2FB1
SCRHEIGH            1E0
SCRINIT             1142
SCRINTCT            2FB0
SCRINTFPS           2FB2
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             1198
SCRTIM              1240
SCRTIM1S            124E
SCRUPTN             0
SCRWIDTH            280
STACUR              302C
STAEMPTY            2DC6
STAINIT             2D2C
STANEXT             302E
STANONE             FFFFFFFF
STAPLOT             2D9A
STAPLOT:PLTTBL      2DB6
START               2F7C
START:LOOP          2F88
START:WINT          2F8E
STAUPD              2D3C
STAUPD:DOUPD        2D62
STAUPD:INITBL       2D7A
STAUPD:UPDTBL       2D8A
STRFPS1             3012
STRFPS2             3019
STRFPS3             3028
SYSINIT             110A
TRIANGLE            2966
TRIANGLE:ISPOSITIVE  29B4
TRIANGLE:UPWARDS    2982
UTLCHRWD            8
UTLINIT             1320
UTLPRINT            1336
UTLPRINT:ENDLOOP    1348
UTLPRINT:LOOP       133E
UTLRAND             1368
UTLRAND:RANDVEC     1386
UTLRNDIX            3030
