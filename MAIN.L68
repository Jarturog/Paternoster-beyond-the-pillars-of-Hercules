00003750 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 14/01/2023 19:37:48

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002A01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/15)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000  =00000002                 37  SNDPLTN     EQU     2                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000  =00000004                 45  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 46  PLAYERWIDTH     EQU     32
00001000  =00000020                 47  PLAYERHEIGHT    EQU     32
00001000                            48  
00001000                            49  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            50  
00001000  =00000010                 51  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 52  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 53  PROJSPEEDX      EQU     8
00001000  =00000008                 54  PROJSPEEDY      EQU     8
00001000                            55  
00001000                            56  ; --- MUSIC RELATED CONSTANTS ---------------------------------------------------
00001000= 53 4E 44 2F 4D 55 ...     57  HEAVENSOUND DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     58  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     59  HELLSOUND   DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     60  PROJ_SOUND  DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            61  
00001048                            62  
00001048                            63  
00001048                            64  
00001048                            65  
00001048                            66  
00001048                            67  
00001048                            68  
00001048                            69  -------------------- end include --------------------
00001048                            70              INCLUDE "LIB/DMMCONST.X68"           
00001048                            71  ; =============================================================================
00001048                            72  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                            73  ; =============================================================================
00001048                            74  
00001048  =00000040                 75  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                 76  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                 77  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                 78  -------------------- end include --------------------
00001048                            79              INCLUDE "LIB/DMMCODE.X68"
00001048                            80  ; =============================================================================
00001048                            81  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                            82  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                            83  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                            84  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                            85  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                            86  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                            87  ; =============================================================================
00001048                            88  
00001048                            89  ; -----------------------------------------------------------------------------
00001048                            90  DMMINIT
00001048                            91  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                            92  ; INPUT    - NONE
00001048                            93  ; OUTPUT   - NONE
00001048                            94  ; MODIFIES - NONE
00001048                            95  ; -----------------------------------------------------------------------------
00001048  48E7 8080                 96              MOVEM.L D0/A0,-(A7)
0000104C  41F9 000037C0             97              LEA     DMMDATA,A0
00001052  303C 0031                 98              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                 99  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            100              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                101              DBRA.W  D0,.LOOP
00001064  4CDF 0101                102              MOVEM.L (A7)+,D0/A0
00001068  4E75                     103              RTS
0000106A                           104  
0000106A                           105  ; -----------------------------------------------------------------------------
0000106A                           106  DMMFIRST
0000106A                           107  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           108  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           109  ; INPUT    - NONE
0000106A                           110  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           111  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           112  ; -----------------------------------------------------------------------------
0000106A  41F9 000037C0            113              LEA     DMMDATA,A0
00001070  4A58                     114  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                115              BNE     DMMFRFND
00001076  D1FC 0000003E            116              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 0000443F            117  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     118              BLT     DMMFRLOP
00001084  207C 00000000            119              MOVE.L  #0,A0
0000108A  4E75                     120  DMMFRFND    RTS
0000108C                           121  
0000108C                           122  ; -----------------------------------------------------------------------------
0000108C                           123  DMMNEXT
0000108C                           124  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           125  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           126  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           127  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           128  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           129  ; -----------------------------------------------------------------------------
0000108C  2F00                     130              MOVE.L  D0,-(A7)
0000108E  2008                     131              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            132              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            133              ADD.L   #DMMBSIZE,D0
0000109C  2040                     134              MOVE.L  D0,A0
0000109E  201F                     135              MOVE.L  (A7)+,D0
000010A0  60DA                     136              BRA     DMMFRCOM
000010A2                           137  
000010A2                           138  ; -----------------------------------------------------------------------------
000010A2                           139  DMMFRSTO
000010A2                           140  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           141  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           142  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           143  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           144  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           145  ; -----------------------------------------------------------------------------
000010A2  41F9 000037C0            146              LEA     DMMDATA,A0
000010A8  B058                     147  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                148              BEQ     DMMFFND
000010AE  D1FC 0000003E            149              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 0000443F            150  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     151              BLT     DMMFLOOP
000010BC  207C 00000000            152              MOVE.L  #0,A0
000010C2  4E75                     153  DMMFFND     RTS
000010C4                           154  
000010C4                           155  ; -----------------------------------------------------------------------------
000010C4                           156  DMMNEXTO
000010C4                           157  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           158  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           159  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           160  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           161  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           162  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           163  ; -----------------------------------------------------------------------------
000010C4  2F00                     164              MOVE.L  D0,-(A7)
000010C6  2008                     165              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            166              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            167              ADD.L   #DMMBSIZE,D0
000010D4  2040                     168              MOVE.L  D0,A0
000010D6  201F                     169              MOVE.L  (A7)+,D0
000010D8  60DA                     170              BRA     DMMFCOM
000010DA                           171  
000010DA                           172  ; -----------------------------------------------------------------------------
000010DA                           173  DMMALLOC
000010DA                           174  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           175  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           176  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           177  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           178  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           179  ; -----------------------------------------------------------------------------
000010DA  3F00                     180              MOVE.W  D0,-(A7)
000010DC  4240                     181              CLR.W   D0
000010DE  4EB8 10A2                182              JSR     DMMFRSTO
000010E2  301F                     183              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            184              CMP.L   #0,A0
000010EA  6700 0006                185              BEQ     .END
000010EE  3140 FFFE                186              MOVE.W  D0,-2(A0)
000010F2  4E75                     187  .END        RTS
000010F4                           188  
000010F4                           189  ; -----------------------------------------------------------------------------
000010F4                           190  DMMFREE
000010F4                           191  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           192  ; SYSTEM (0)
000010F4                           193  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           194  ; OUTPUT   - NONE
000010F4                           195  ; MODIFIES - NONE
000010F4                           196  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                197              MOVEM.L D0/A0,-(A7)
000010F8  2008                     198              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            199              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     200              MOVE.L  D0,A0
00001102  4250                     201              CLR.W   (A0)
00001104  4CDF 0101                202              MOVEM.L (A7)+,D0/A0
00001108  4E75                     203              RTS
00001108  4E75                     204  -------------------- end include --------------------
0000110A                           205              INCLUDE "SYSTEM.X68"
0000110A                           206  ; ==============================================================================
0000110A                           207  ; SYSTEM
0000110A                           208  ; ==============================================================================
0000110A                           209              
0000110A                           210  ; ------------------------------------------------------------------------------
0000110A                           211  SYSINIT
0000110A                           212  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           213  ; INPUT    : NONE
0000110A                           214  ; OUTPUT   : NONE
0000110A                           215  ; MODIFIES : NONE
0000110A                           216  ; ------------------------------------------------------------------------------
0000110A                           217  
0000110A  21FC 00001198 0080       218              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000126E 0084       219              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 00001240 0064       220              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001122  21FC 0000124E 0068       221              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
0000112A                           222              
0000112A  4EB8 1048                223              JSR     DMMINIT
0000112E  4EB9 00001142            224              JSR     SCRINIT
00001134  4EB9 00001260            225              JSR     KBDINIT
0000113A                           226              
0000113A  40E7                     227              MOVE.W  SR,-(A7)
0000113C  0257 D8FF                228              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
00001140  4E73                     229              RTE
00001142                           230              
00001142                           231  ; ------------------------------------------------------------------------------
00001142                           232  SCRINIT
00001142                           233  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001142                           234  ; ENABLE DOUBLE BUFFER.
00001142                           235  ; INPUT    : NONE
00001142                           236  ; OUTPUT   : NONE
00001142                           237  ; MODIFIES : NONE
00001142                           238  ; ------------------------------------------------------------------------------
00001142                           239  
00001142  48E7 F000                240              MOVEM.L D0-D3,-(A7)
00001146                           241  
00001146                           242              ; SET SCREEN RESOLUTION
00001146  103C 0021                243              MOVE.B  #33,D0
0000114A  223C 028001E0            244              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001150  4E4F                     245              TRAP    #15
00001152                           246              
00001152                           247              ; SET WINDOWED MODE
00001152  7201                     248              MOVE.L  #1,D1
00001154  4E4F                     249              TRAP    #15
00001156                           250              
00001156                           251              ; CLEAR SCREEN
00001156  103C 000B                252              MOVE.B  #11,D0
0000115A  323C FF00                253              MOVE.W  #$FF00,D1
0000115E  4E4F                     254              TRAP    #15
00001160                           255  
00001160                           256              ; ENABLE DOUBLE BUFFER
00001160  103C 005C                257              MOVE.B  #92,D0
00001164  123C 0011                258              MOVE.B  #17,D1
00001168  4E4F                     259              TRAP    #15
0000116A                           260              
0000116A                           261              ; ENABLE BOTH TIMED INTERRUPT
0000116A  103C 0020                262              MOVE.B  #32,D0
0000116E  123C 0006                263              MOVE.B  #6,D1
00001172  143C 0081                264              MOVE.B  #$80|SCRINTN,D2
00001176  7614                     265              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001178  4E4F                     266              TRAP    #15
0000117A  143C 0082                267              MOVE.B  #$80|SCRINTFPSN,D2
0000117E  263C 000003E8            268              MOVE.L  #1000,D3
00001184  4E4F                     269              TRAP    #15
00001186                           270              
00001186                           271              ; CLEAR INTERRUPT COUNTER
00001186  4279 00003784            272              CLR.W   (SCRINTCT)
0000118C  4239 00003786            273              CLR.B   (SCRINTFPS) 
00001192                           274              
00001192  4CDF 000F                275              MOVEM.L (A7)+,D0-D3
00001196                           276              
00001196  4E75                     277              RTS
00001198                           278  
00001198                           279  ; ------------------------------------------------------------------------------
00001198                           280  SCRPLOT
00001198                           281  ; UPDATES DOUBLE BUFFER
00001198                           282  ; INPUT    : NONE
00001198                           283  ; OUTPUT   : NONE
00001198                           284  ; MODIFIES : NONE
00001198                           285  ; ------------------------------------------------------------------------------
00001198  48E7 E000                286              MOVEM.L D0-D2,-(A7)
0000119C  2F09                     287              MOVE.L  A1,-(A7)
0000119E                           288              
0000119E                           289              ; PLOT ACTUAL FPS AND GOAL FPS
0000119E                           290              
0000119E  103C 0051                291              MOVE.B  #81,D0
000011A2  7200                     292              MOVE.L  #$00000000,D1 ; FILL COLOR
000011A4  4E4F                     293              TRAP    #15
000011A6                           294              
000011A6  103C 0050                295              MOVE.B  #80,D0
000011AA  223C 00FFFFFF            296              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011B0  4E4F                     297              TRAP    #15
000011B2                           298              
000011B2  103C 000B                299              MOVE.B  #11,D0
000011B6  223C 00002A01            300              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011BC  4E4F                     301              TRAP    #15
000011BE                           302              
000011BE  43F9 0000379E            303              LEA.L   STRFPS1,A1 
000011C4  103C 000E                304              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011C8  4E4F                     305              TRAP    #15
000011CA                           306              
000011CA  103C 000B                307              MOVE.B  #11,D0
000011CE  323C 3301                308              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011D2  4E4F                     309              TRAP    #15
000011D4                           310              
000011D4  5E89                     311              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011D6  103C 000E                312              MOVE.B  #14,D0  
000011DA  4E4F                     313              TRAP    #15 
000011DC                           314              
000011DC  103C 000B                315              MOVE.B  #11,D0
000011E0  323C 4401                316              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E4  4E4F                     317              TRAP    #15
000011E6                           318              
000011E6  D3FC 0000000F            319              ADDA.L  #15,A1 ; PLOT 'FPS'
000011EC  103C 000E                320              MOVE.B  #14,D0 
000011F0  4E4F                     321              TRAP    #15
000011F2                           322              
000011F2  0643 0014                323              ADD.W   #20,D3
000011F6  103C 000B                324              MOVE.B  #11,D0
000011FA  323C 3001                325              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
000011FE  4E4F                     326              TRAP    #15
00001200                           327              
00001200  7232                     328              MOVE.L  #FRAMES_PER_SECOND,D1
00001202  740A                     329              MOVE.L  #10,D2
00001204  103C 000F                330              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001208  4E4F                     331              TRAP    #15
0000120A                           332              
0000120A  0643 0014                333              ADD.W   #20,D3
0000120E  103C 000B                334              MOVE.B  #11,D0
00001212  323C 4101                335              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001216  4E4F                     336              TRAP    #15
00001218                           337              
00001218  4281                     338              CLR.L   D1
0000121A  1239 0000379C            339              MOVE.B  (REALFPS),D1
00001220  740A                     340              MOVE.L  #10,D2
00001222  103C 000F                341              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001226  4E4F                     342              TRAP    #15
00001228                           343              
00001228                           344              ; SWITCH BUFFERS
00001228  103C 005E                345              MOVE.B  #94,D0
0000122C  4E4F                     346              TRAP    #15
0000122E                           347              
0000122E                           348              ; CLEAR HIDDEN BUFFER
0000122E  103C 000B                349              MOVE.B  #11,D0
00001232  323C FF00                350              MOVE.W  #$FF00,D1
00001236  4E4F                     351              TRAP    #15
00001238                           352              
00001238  225F                     353              MOVE.L  (A7)+,A1
0000123A  4CDF 0007                354              MOVEM.L (A7)+,D0-D2
0000123E  4E73                     355              RTE
00001240                           356              
00001240                           357  ; ------------------------------------------------------------------------------
00001240                           358  SCRTIM
00001240                           359  ; TIMED INTERRUPT SERVICE ROUTINE
00001240                           360  ; INPUT    : NONE
00001240                           361  ; OUTPUT   : NONE
00001240                           362  ; MODIFIES : NONE
00001240                           363  ; ------------------------------------------------------------------------------
00001240  5239 00003784            364              ADDQ.B  #1,(SCRINTCT)
00001246  5239 00003785            365              ADDQ.B  #1,(SCRCYCCT)
0000124C  4E73                     366              RTE
0000124E                           367              
0000124E                           368  ; ------------------------------------------------------------------------------
0000124E                           369  SCRTIM1S
0000124E                           370  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000124E                           371  ; INPUT    : NONE
0000124E                           372  ; OUTPUT   : NONE
0000124E                           373  ; MODIFIES : NONE
0000124E                           374  ; ------------------------------------------------------------------------------
0000124E  13F9 00003786 0000379C   375              MOVE.B  (SCRINTFPS),REALFPS
00001258  4239 00003786            376              CLR.B   SCRINTFPS
0000125E  4E73                     377              RTE
00001260                           378  
00001260                           379  ; ------------------------------------------------------------------------------
00001260                           380  KBDINIT
00001260                           381  ; INIT KEYBOARD
00001260                           382  ; INPUT    : NONE
00001260                           383  ; OUTPUT   : NONE
00001260                           384  ; MODIFIES : NONE
00001260                           385  ; ------------------------------------------------------------------------------
00001260  4239 00003782            386              CLR.B   (KBDVAL)
00001266  4239 00003783            387              CLR.B   (KBDEDGE)
0000126C  4E75                     388              RTS
0000126E                           389  
0000126E                           390  ; ------------------------------------------------------------------------------
0000126E                           391  KBDUPD
0000126E                           392  ; UPDATE KEYBOARD INFO.  
0000126E                           393  ; 7 -> FIRE DOWN
0000126E                           394  ; 6 -> FIRE RIGHT
0000126E                           395  ; 5 -> FIRE UP
0000126E                           396  ; 4 -> FIRE LEFT
0000126E                           397  ; 3 -> DOWN
0000126E                           398  ; 2 -> RIGHT
0000126E                           399  ; 1 -> UP
0000126E                           400  ; 0 -> LEFT
0000126E                           401  ; INPUT    : NONE
0000126E                           402  ; OUTPUT   : NONE
0000126E                           403  ; MODIFIES : NONE
0000126E                           404  ; ------------------------------------------------------------------------------
0000126E                           405  
0000126E  48E7 F000                406              MOVEM.L D0-D3,-(A7)
00001272                           407  
00001272                           408              ; READ FIRST PART
00001272  103C 0013                409              MOVE.B  #19,D0
00001276  223C 28272625            410              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000127C  4E4F                     411              TRAP    #15
0000127E                           412              
0000127E                           413              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000127E  4EB9 000012AE            414              JSR     .PACK
00001284                           415  
00001284                           416              ; READ SECOND PART
00001284  223C 53445741            417              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000128A  4E4F                     418              TRAP    #15
0000128C                           419  
0000128C                           420              ; CONVERT TO DESIRED FORMAT
0000128C  4EB9 000012AE            421              JSR     .PACK
00001292                           422              
00001292                           423              ; COMPUTE KBDEDGE
00001292  1039 00003782            424              MOVE.B  (KBDVAL),D0
00001298  4600                     425              NOT.B   D0
0000129A  C002                     426              AND.B   D2,D0
0000129C  13C0 00003783            427              MOVE.B  D0,(KBDEDGE)
000012A2                           428              
000012A2                           429              ; STORE KBDVAL
000012A2  13C2 00003782            430              MOVE.B  D2,(KBDVAL)
000012A8                           431              
000012A8  4CDF 000F                432              MOVEM.L (A7)+,D0-D3
000012AC                           433  
000012AC  4E73                     434              RTE
000012AE                           435              
000012AE  363C 0003                436  .PACK       MOVE.W  #3,D3
000012B2  E189                     437  .LOOP       LSL.L   #8,D1
000012B4  E312                     438              ROXL.B  #1,D2
000012B6  51CB FFFA                439              DBRA.W  D3,.LOOP
000012BA  4E75                     440              RTS
000012BC                           441  
000012BC                           442  
000012BC                           443  
000012BC                           444  -------------------- end include --------------------
000012BC                           445              INCLUDE "LIB/AGLCODE.X68"
000012BC                           446  ; =============================================================================
000012BC                           447  ; AGENT MANAGEMENT
000012BC                           448  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012BC                           449  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012BC                           450  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012BC                           451  ; +8:END    : DATA (AGENT SPECIFIC)
000012BC                           452  ; =============================================================================
000012BC                           453  
000012BC                           454  ; -----------------------------------------------------------------------------
000012BC                           455  AGLADD
000012BC                           456  ; CREATES A NEW AGENT
000012BC                           457  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012BC                           458  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012BC                           459  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012BC                           460  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012BC                           461  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012BC                           462  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012BC                           463  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012BC                           464  ; OUTPUT   - NONE
000012BC                           465  ; MODIFIES - NONE
000012BC                           466  ; -----------------------------------------------------------------------------
000012BC  2F08                     467              MOVE.L  A0,-(A7)
000012BE  4EB8 10DA                468              JSR     DMMALLOC
000012C2  B1FC 00000000            469              CMP.L   #0,A0
000012C8  6700 0008                470              BEQ     .END
000012CC  20CA                     471              MOVE.L  A2,(A0)+
000012CE  20CB                     472              MOVE.L  A3,(A0)+
000012D0  4E91                     473              JSR     (A1)
000012D2  205F                     474  .END        MOVE.L  (A7)+,A0
000012D4  4E75                     475              RTS
000012D6                           476  
000012D6                           477  ; -----------------------------------------------------------------------------
000012D6                           478  AGLUPD
000012D6                           479  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012D6                           480  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012D6                           481  ; INPUT    - NONE
000012D6                           482  ; OUTPUT   - NONE
000012D6                           483  ; MODIFIES - NONE
000012D6                           484  ; -----------------------------------------------------------------------------
000012D6  48E7 00C0                485              MOVEM.L A0-A1,-(A7)
000012DA  4EB8 106A                486              JSR     DMMFIRST
000012DE  B1FC 00000000            487  .LOOP       CMP.L   #0,A0
000012E4  6700 000E                488              BEQ     .END
000012E8  2250                     489              MOVE.L  (A0),A1
000012EA  5088                     490              ADD.L   #8,A0
000012EC  4E91                     491              JSR     (A1)
000012EE  4EB8 108C                492              JSR     DMMNEXT
000012F2  60EA                     493              BRA     .LOOP
000012F4  4CDF 0300                494  .END        MOVEM.L (A7)+,A0-A1
000012F8  4E75                     495              RTS
000012FA                           496  
000012FA                           497  ; -----------------------------------------------------------------------------
000012FA                           498  AGLPLOT
000012FA                           499  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012FA                           500  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012FA                           501  ; INPUT    - NONE
000012FA                           502  ; OUTPUT   - NONE
000012FA                           503  ; MODIFIES - NONE
000012FA                           504  ; -----------------------------------------------------------------------------
000012FA  48E7 00C0                505              MOVEM.L A0-A1,-(A7)
000012FE  4EB8 106A                506              JSR     DMMFIRST
00001302  B1FC 00000000            507  .LOOP       CMP.L   #0,A0
00001308  6700 0010                508              BEQ     .END
0000130C  2268 0004                509              MOVE.L  4(A0),A1
00001310  5088                     510              ADD.L   #8,A0
00001312  4E91                     511              JSR     (A1)
00001314  4EB8 108C                512              JSR     DMMNEXT
00001318  60E8                     513              BRA     .LOOP
0000131A  4CDF 0300                514  .END        MOVEM.L (A7)+,A0-A1
0000131E  4E75                     515              RTS
00001320                           516  
00001320                           517  ; -----------------------------------------------------------------------------
00001320  =000010F4                518  AGLKILL     EQU     DMMFREE
00001320                           519  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001320                           520  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001320                           521  ; OUTPUT   - NONE
00001320                           522  ; MODIFIES - NONE
00001320                           523  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001320                           524  ; -----------------------------------------------------------------------------
00001320                           525  -------------------- end include --------------------
00001320                           526              INCLUDE "LIB/UTLCODE.X68"
00001320                           527  ; =============================================================================
00001320                           528  ; UTILITY CODE
00001320                           529  ; =============================================================================
00001320                           530  
00001320                           531  ; -----------------------------------------------------------------------------
00001320                           532  UTLINIT
00001320                           533  ; INITIALIZES UTILITY CODE
00001320                           534  ; INPUT    - NONE
00001320                           535  ; OUTPUT   - NONE
00001320                           536  ; MODIFIES - NONE
00001320                           537  ; -----------------------------------------------------------------------------
00001320  48E7 C000                538              MOVEM.L D0-D1,-(A7)
00001324  103C 0008                539              MOVE.B  #8,D0
00001328  4E4F                     540              TRAP    #15
0000132A  13C1 000037B8            541              MOVE.B  D1,(UTLRNDIX)
00001330  4CDF 0003                542              MOVEM.L (A7)+,D0-D1
00001334  4E75                     543              RTS
00001336                           544  
00001336                           545  ; -----------------------------------------------------------------------------
00001336                           546  UTLRAND
00001336                           547  ; PROVIDES A PSEUDO-RANDOM BYTE
00001336                           548  ; INPUT    - NONE
00001336                           549  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001336                           550  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001336                           551  ; -----------------------------------------------------------------------------
00001336  2F08                     552              MOVE.L  A0,-(A7)
00001338  41F9 00001354            553              LEA     .RANDVEC,A0
0000133E  4280                     554              CLR.L   D0
00001340  1039 000037B8            555              MOVE.B  (UTLRNDIX),D0
00001346  1030 0800                556              MOVE.B  (A0,D0.L),D0
0000134A  5239 000037B8            557              ADDQ.B  #1,(UTLRNDIX)
00001350  205F                     558              MOVE.L  (A7)+,A0
00001352  4E75                     559              RTS
00001354                           560  
00001354                           561  
00001354= A2 EE 9A 0C F5 24 ...    562  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000135C= 2A A3 51 26 E0 AC ...    563              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001364= 75 51 CA FD 33 EB ...    564              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000136C= 60 CC E7 B8 9A EB ...    565              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001374= 1D 76 B5 95 B0 89 ...    566              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
0000137C= 39 15 48 C9 6E CA ...    567              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001384= 43 E7 E2 7C 37 25 ...    568              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000138C= E9 94 CE E9 E4 52 ...    569              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001394= 37 6D 9A 84 A2 28 ...    570              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000139C= 19 E2 C6 77 80 D4 ...    571              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013A4= 0A 5A 32 67 33 C2 ...    572              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013AC= 59 80 DC 0E 57 FC ...    573              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013B4= 8A AB BC F7 07 4D ...    574              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013BC= EF D5 77 6E 1E BB ...    575              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013C4= D6 E0 2A 8F BD 28 ...    576              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013CC= 13 4F 66 EC 0A 64 ...    577              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000013D4= 56 52 9A 16 9B 90 ...    578              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000013DC= 06 8A A4 F7 01 DA ...    579              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000013E4= F2 E7 77 28 B1 76 ...    580              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000013EC= A4 42 E3 81 B1 67 ...    581              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000013F4= BF CE FA 16 BF 38 ...    582              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000013FC= D1 8B 50 0C 5F 49 ...    583              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001404= DE 4C 14 A2 40 DC ...    584              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000140C= B6 9B 0A 38 5D AB ...    585              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001414= E2 1B DD 75 15 82 ...    586              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000141C= 8A 26 51 30 9F 47 ...    587              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001424= 1E 8A BB 71 C6 6E ...    588              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000142C= 9F 47 E5 34 94 27 ...    589              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001434= 7D 06 D6 BA 30 0F ...    590              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000143C= EC 7F 7E 03 CF 2D ...    591              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001444= 94 5B 23 F2 8B CD ...    592              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000144C= 74 33 EC B9 0F D5 ...    593              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
0000144C= 74 33 EC B9 0F D5 ...    594  -------------------- end include --------------------
00001454                           595              INCLUDE "BLOCKS.X68"
00001454                           596      
00001454                           597  MAPPLOT
00001454  48E7 FF00                598          MOVEM.L D0-D7, -(A7)
00001458  48E7 00FE                599          MOVEM.L A0-A6, -(A7)
0000145C  3239 00003798            600             MOVE.W LOADEDMAP, D1
00001462  C2FC 000C                601             MULU #12, D1
00001466  3241                     602             MOVEA.W D1, A1
00001468  4EE9 146C                603             JMP MAPSEL(A1)
0000146C                           604  MAPSEL:
0000146C  4EF9 000026FA            605             JMP ELEVATORPLOT
00001472  4EF9 00001524            606             JMP NEXT
00001478  41F9 00001D0C            607             LEA HEAVEN_0, A0
0000147E  4EF9 00001524            608             JMP NEXT
00001484  41F9 00001E5C            609             LEA HEAVEN_1, A0
0000148A  4EF9 00001524            610             JMP NEXT
00001490  41F9 00001F97            611             LEA HEAVEN_END, A0
00001496  4EF9 00001524            612             JMP NEXT
0000149C  41F9 000020D2            613             LEA HEAVEN_ROOM, A0
000014A2  4EF9 00001524            614             JMP NEXT
000014A8  41F9 0000220D            615             LEA HELL_0, A0
000014AE  4EF9 00001524            616             JMP NEXT
000014B4  41F9 00002348            617             LEA HELL_1, A0
000014BA  4EF9 00001524            618             JMP NEXT
000014C0  41F9 00002483            619             LEA HELL_END, A0
000014C6  4EF9 00001524            620             JMP NEXT
000014CC  41F9 000025BE            621             LEA HELL_ROOM, A0
000014D2  4EF9 00001524            622             JMP NEXT
000014D8                           623  MAPUPD
000014D8                           624              
000014D8  3F00                     625              MOVE.W D0, -(A7)
000014DA  3039 00003798            626              MOVE.W LOADEDMAP, D0
000014E0  B07C 0001                627              CMP #1, D0
000014E4  6700 0460                628              BEQ MAPA1
000014E8  B07C 0002                629              CMP #2, D0
000014EC  6700 04A0                630              BEQ MAPA2
000014F0  B07C 0003                631              CMP #3, D0
000014F4  6700 0598                632              BEQ MAPA3
000014F8  B07C 0004                633              CMP #4, D0
000014FC  6700 05DE                634              BEQ MAPA4
00001500  B07C 0005                635              CMP #5, D0
00001504  6700 061E                636              BEQ MAPA5
00001508  B07C 0006                637              CMP #6, D0
0000150C  6700 065E                638              BEQ MAPA6
00001510  B07C 0007                639              CMP #7, D0
00001514  6700 0756                640              BEQ MAPA7
00001518  B07C 0008                641              CMP #8, D0
0000151C  6700 079E                642              BEQ MAPA8
00001520  301F                     643              MOVE.W (A7)+, D0
00001522  4E75                     644              RTS
00001524                           645  
00001524                           646      
00001524                           647              
00001524                           648  NEXT
00001524  4281                     649             CLR.L D1
00001526  1218                     650             MOVE.B (A0)+,D1
00001528  C2FC 0006                651             MULU #6, D1
0000152C  2241                     652             MOVEA.L D1, A1
0000152E  4EE9 1532                653             JMP JMPLIST(A1)
00001532                           654             
00001532                           655  JMPLIST: 
00001532  4EF9 000018E6            656              JMP NEWLINE ; 0 = END OF ROW
00001538  4EF9 000015BA            657              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
0000153E  4EF9 00001650            658              JMP DBHL    ; 2 = DRAW BRICK HELL
00001544  4EF9 000016C4            659              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
0000154A  4EF9 00001738            660              JMP DGHL    ; 4 = DRAW GRASS HELL
00001550  4EF9 000017CE            661              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
00001556  4EF9 000017EE            662              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
0000155C  4EF9 0000180E            663              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
00001562  4EF9 0000157A            664              JMP DDHL    ; 8 = DRAW DOOR HELL
00001568  4EF9 0000159A            665              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
0000156E  4EF9 00001860            666              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
00001574  4EF9 0000191C            667              JMP ENDMAP  ; 11 = END OF THE MAP
0000157A                           668              
0000157A                           669  DDHL
0000157A  2F3C 00111111            670      MOVE.L #$00111111, -(A7)
00001580  2F3C 00111111            671      MOVE.L #$00111111, -(A7)
00001586  4EB9 000018B2            672      JSR DRAWBLOCK
0000158C  2C1F                     673      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000158E  2C1F                     674      MOVE.L (A7)+, D6    
00001590  4EB9 0000190A            675      JSR ENDBLOCK
00001596  4EF8 1524                676      JMP NEXT
0000159A                           677  DDHV
0000159A  2F3C 00FFFFFF            678      MOVE.L #$00FFFFFF, -(A7)
000015A0  2F3C 00FFFFFF            679      MOVE.L #$00FFFFFF, -(A7)
000015A6  4EB9 000018B2            680      JSR DRAWBLOCK
000015AC  2C1F                     681      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000015AE  2C1F                     682      MOVE.L (A7)+, D6
000015B0  4EB9 0000190A            683      JSR ENDBLOCK
000015B6  4EF8 1524                684      JMP NEXT
000015BA                           685  DGHE ;DRAW-GRASS-HEAVEN vvvR
000015BA  2F3C 0099FF99            686      MOVE.L #$0099FF99, -(A7)
000015C0  2F3C 0099FF99            687      MOVE.L #$0099FF99, -(A7)
000015C6  4EB9 000018B2            688      JSR DRAWBLOCK
000015CC  2C1F                     689      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000015CE  2C1F                     690      MOVE.L (A7)+, D6
000015D0                           691      ; SET PEN COLOR 
000015D0  103C 0050                692      MOVE.B #80, D0
000015D4  223C 0000CC00            693      MOVE.L #$0000CC00, D1
000015DA  4E4F                     694      TRAP #15
000015DC                           695      ;DRAW LINES   
000015DC  103C 0054                696      MOVE.B #84, D0 
000015E0                           697      ;LINEA 11 
000015E0  3239 00003790            698      MOVE.W BPOSX1,D1
000015E6  5C41                     699      ADD.W #6, D1
000015E8  3439 00003792            700      MOVE.W BPOSY1, D2
000015EE  5A42                     701      ADD.W #5, D2
000015F0  3639 00003790            702      MOVE.W BPOSX1, D3
000015F6  0643 0009                703      ADD.W #9, D3
000015FA  3839 00003792            704      MOVE.W BPOSY1, D4
00001600  0644 000A                705      ADD.W #10, D4
00001604  4E4F                     706      TRAP #15
00001606                           707      ;LINEA 12
00001606  5041                     708      ADD.W #8, D1    
00001608  5043                     709      ADD.W #8, D3
0000160A  4E4F                     710      TRAP #15
0000160C                           711      ;LINEA 13
0000160C  5041                     712      ADD.W #8, D1    
0000160E  5043                     713      ADD.W #8, D3
00001610  4E4F                     714      TRAP #15
00001612                           715      ;LINEA 21
00001612  3239 00003790            716      MOVE.W BPOSX1,D1
00001618  5C41                     717      ADD.W #6, D1
0000161A  3439 00003792            718      MOVE.W BPOSY1, D2
00001620  0642 0014                719      ADD.W #20, D2
00001624  3639 00003790            720      MOVE.W BPOSX1, D3
0000162A  0643 0009                721      ADD.W #9, D3
0000162E  3839 00003792            722      MOVE.W BPOSY1, D4
00001634  0644 0019                723      ADD.W #25, D4
00001638  4E4F                     724      TRAP #15
0000163A                           725      ;LINEA 22
0000163A  5041                     726      ADD.W #8, D1    
0000163C  5043                     727      ADD.W #8, D3
0000163E  4E4F                     728      TRAP #15
00001640                           729      ;LINEA 23
00001640  5041                     730      ADD.W #8, D1    
00001642  5043                     731      ADD.W #8, D3
00001644  4E4F                     732      TRAP #15
00001646  4EB9 0000190A            733      JSR ENDBLOCK
0000164C  4EF8 1524                734      JMP NEXT
00001650                           735  DBHL ;DRAW BRICK-HELL vvvR
00001650                           736      
00001650  2F3C 00010101            737      MOVE.L #$00010101, -(A7)
00001656  2F3C 00666666            738      MOVE.L #$00666666, -(A7)
0000165C  4EB9 000018B2            739      JSR DRAWBLOCK
00001662  2C1F                     740      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001664  2C1F                     741      MOVE.L (A7)+, D6
00001666                           742      ;DRAW HORIZONTAL LINE
00001666  103C 0054                743      MOVE.B #84, D0 
0000166A  3239 00003790            744      MOVE.W BPOSX1, D1
00001670  3439 00003792            745      MOVE.W BPOSY1, D2
00001676  0642 0010                746      ADD.W #16, D2
0000167A  3639 00003790            747      MOVE.W BPOSX1, D3
00001680  0643 0020                748      ADD.W #32, D3
00001684  3839 00003792            749      MOVE.W BPOSY1, D4
0000168A  0644 0010                750      ADD.W #16, D4
0000168E  4E4F                     751      TRAP #15
00001690                           752      ;DRAW VERTICAL LINE 
00001690  3239 00003790            753      MOVE.W BPOSX1, D1
00001696  0641 0010                754      ADD.W #16, D1
0000169A  3439 00003792            755      MOVE.W BPOSY1, D2
000016A0  0642 0010                756      ADD.W #16, D2
000016A4  3639 00003790            757      MOVE.W BPOSX1, D3
000016AA  0643 0010                758      ADD.W #16, D3
000016AE  3839 00003792            759      MOVE.W BPOSY1, D4
000016B4  0644 0020                760      ADD.W #32, D4
000016B8  4E4F                     761      TRAP #15
000016BA  4EB9 0000190A            762      JSR ENDBLOCK    
000016C0  4EF8 1524                763      JMP NEXT
000016C4                           764  DBHV ;DRAW BRICK-HEAVEN vvvR
000016C4                           765      
000016C4  2F3C 00CCCCCC            766      MOVE.L #$00CCCCCC, -(A7)
000016CA  2F3C 00D7EBFA            767      MOVE.L #$00D7EBFA, -(A7)
000016D0  4EB9 000018B2            768      JSR DRAWBLOCK
000016D6  2C1F                     769      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000016D8  2C1F                     770      MOVE.L (A7)+, D6
000016DA                           771      ;DRAW HORIZONTAL LINE
000016DA  103C 0054                772      MOVE.B #84, D0 
000016DE  3239 00003790            773      MOVE.W BPOSX1, D1
000016E4  3439 00003792            774      MOVE.W BPOSY1, D2
000016EA  0642 0010                775      ADD.W #16, D2
000016EE  3639 00003790            776      MOVE.W BPOSX1, D3
000016F4  0643 0020                777      ADD.W #32, D3
000016F8  3839 00003792            778      MOVE.W BPOSY1, D4
000016FE  0644 0010                779      ADD.W #16, D4
00001702  4E4F                     780      TRAP #15
00001704                           781      ;DRAW VERTICAL LINE 
00001704  3239 00003790            782      MOVE.W BPOSX1, D1
0000170A  0641 0010                783      ADD.W #16, D1
0000170E  3439 00003792            784      MOVE.W BPOSY1, D2
00001714  0642 0010                785      ADD.W #16, D2
00001718  3639 00003790            786      MOVE.W BPOSX1, D3
0000171E  0643 0010                787      ADD.W #16, D3
00001722  3839 00003792            788      MOVE.W BPOSY1, D4
00001728  0644 0020                789      ADD.W #32, D4
0000172C  4E4F                     790      TRAP #15 
0000172E  4EB9 0000190A            791      JSR ENDBLOCK
00001734  4EF8 1524                792      JMP NEXT
00001738                           793  DGHL ;DRAW GRASS HELL vvvR
00001738                           794  
00001738  2F3C 002255EE            795      MOVE.L #$002255EE, -(A7)
0000173E  2F3C 002255EE            796      MOVE.L #$002255EE, -(A7)
00001744  4EB9 000018B2            797      JSR DRAWBLOCK
0000174A  2C1F                     798      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000174C  2C1F                     799      MOVE.L (A7)+, D6
0000174E                           800      ; SET PEN COLOR 
0000174E  103C 0050                801      MOVE.B #80, D0
00001752  223C 000000CC            802      MOVE.L #$000000CC, D1
00001758  4E4F                     803      TRAP #15
0000175A                           804      ;DRAW LINES   
0000175A  103C 0054                805      MOVE.B #84, D0 
0000175E                           806      ;LINEA 11 
0000175E  3239 00003790            807      MOVE.W BPOSX1,D1
00001764  5C41                     808      ADD.W #6, D1
00001766  3439 00003792            809      MOVE.W BPOSY1, D2
0000176C  5A42                     810      ADD.W #5, D2
0000176E  3639 00003790            811      MOVE.W BPOSX1, D3
00001774  0643 0009                812      ADD.W #9, D3
00001778  3839 00003792            813      MOVE.W BPOSY1, D4
0000177E  0644 000A                814      ADD.W #10, D4
00001782  4E4F                     815      TRAP #15
00001784                           816      ;LINEA 12
00001784  5041                     817      ADD.W #8, D1    
00001786  5043                     818      ADD.W #8, D3
00001788  4E4F                     819      TRAP #15
0000178A                           820      ;LINEA 13
0000178A  5041                     821      ADD.W #8, D1    
0000178C  5043                     822      ADD.W #8, D3
0000178E  4E4F                     823      TRAP #15
00001790                           824      ;LINEA 21
00001790  3239 00003790            825      MOVE.W BPOSX1,D1
00001796  5C41                     826      ADD.W #6, D1
00001798  3439 00003792            827      MOVE.W BPOSY1, D2
0000179E  0642 0014                828      ADD.W #20, D2
000017A2  3639 00003790            829      MOVE.W BPOSX1, D3
000017A8  0643 0009                830      ADD.W #9, D3
000017AC  3839 00003792            831      MOVE.W BPOSY1, D4
000017B2  0644 0019                832      ADD.W #25, D4
000017B6  4E4F                     833      TRAP #15
000017B8                           834      ;LINEA 22
000017B8  5041                     835      ADD.W #8, D1    
000017BA  5043                     836      ADD.W #8, D3
000017BC  4E4F                     837      TRAP #15
000017BE                           838      ;LINEA 23
000017BE  5041                     839      ADD.W #8, D1    
000017C0  5043                     840      ADD.W #8, D3
000017C2  4E4F                     841      TRAP #15
000017C4  4EB9 0000190A            842      JSR ENDBLOCK
000017CA  4EF8 1524                843      JMP NEXT
000017CE                           844  
000017CE                           845  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
000017CE  2F3C 00CCCCCC            846      MOVE.L #$00CCCCCC, -(A7)
000017D4  2F3C 00C6DAE9            847      MOVE.L #$00C6DAE9, -(A7)
000017DA  4EB9 000018B2            848      JSR DRAWBLOCK
000017E0  2C1F                     849      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000017E2  2C1F                     850      MOVE.L (A7)+, D6
000017E4  4EB9 0000190A            851      JSR ENDBLOCK
000017EA  4EF8 1524                852      JMP NEXT
000017EE                           853  DF1HL ; DRAW FLOOR_1 HELL vvvR 
000017EE  2F3C 00010101            854      MOVE.L #$00010101, -(A7)
000017F4  2F3C 00777777            855      MOVE.L #$00777777, -(A7)
000017FA  4EB9 000018B2            856      JSR DRAWBLOCK
00001800  2C1F                     857      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001802  2C1F                     858      MOVE.L (A7)+, D6
00001804                           859  
00001804  4EB9 0000190A            860      JSR ENDBLOCK
0000180A  4EF8 1524                861      JMP NEXT
0000180E                           862      
0000180E                           863  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
0000180E  2F3C 00CCCCCC            864      MOVE.L #$00CCCCCC, -(A7)
00001814  2F3C 00C6DAE9            865      MOVE.L #$00C6DAE9, -(A7)
0000181A  4EB9 000018B2            866      JSR DRAWBLOCK
00001820  2C1F                     867      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001822  2C1F                     868      MOVE.L (A7)+, D6
00001824                           869      ;SET NEW FILL COLOR  
00001824  103C 0051                870      MOVE.B #81, D0
00001828  223C 00D7EBFA            871      MOVE.L #$00D7EBFA, D1
0000182E  4E4F                     872      TRAP #15 
00001830                           873      ;DRAW INSIDE SQUARE 
00001830  103C 0057                874      MOVE.B #87, D0
00001834  3239 00003790            875      MOVE.W BPOSX1, D1
0000183A  5041                     876      ADD.W #8, D1
0000183C  3439 00003792            877      MOVE.W BPOSY1, D2
00001842  5042                     878      ADD.W #8, D2
00001844  3639 00003794            879      MOVE.W BPOSX2, D3
0000184A  5143                     880      SUB.W #8, D3
0000184C  3839 00003796            881      MOVE.W BPOSY2, D4
00001852  5144                     882      SUB.W #8, D4
00001854  4E4F                     883      TRAP #15
00001856  4EB9 0000190A            884      JSR ENDBLOCK
0000185C  4EF8 1524                885      JMP NEXT
00001860                           886  DF2HL ; DRAW FLOOR_2 HELL vvvR
00001860  2F3C 00010101            887      MOVE.L #$00010101, -(A7)
00001866  2F3C 00777777            888      MOVE.L #$00777777, -(A7)
0000186C  4EB9 000018B2            889      JSR DRAWBLOCK
00001872  2C1F                     890      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001874  2C1F                     891      MOVE.L (A7)+, D6
00001876                           892      ;SET NEW FILL COLOR  
00001876  103C 0051                893      MOVE.B #81, D0
0000187A  223C 00666666            894      MOVE.L #$00666666, D1
00001880  4E4F                     895      TRAP #15 
00001882                           896  ;DRAW INSIDE SQUARE 
00001882  103C 0057                897      MOVE.B #87, D0
00001886  3239 00003790            898      MOVE.W BPOSX1, D1
0000188C  5041                     899      ADD.W #8, D1
0000188E  3439 00003792            900      MOVE.W BPOSY1, D2
00001894  5042                     901      ADD.W #8, D2
00001896  3639 00003794            902      MOVE.W BPOSX2, D3
0000189C  5143                     903      SUB.W #8, D3
0000189E  3839 00003796            904      MOVE.W BPOSY2, D4
000018A4  5144                     905      SUB.W #8, D4
000018A6  4E4F                     906      TRAP #15
000018A8  4EB9 0000190A            907      JSR ENDBLOCK
000018AE  4EF8 1524                908      JMP NEXT    
000018B2                           909      
000018B2                           910  DRAWBLOCK 
000018B2                           911  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPUS COMO LONGS. 
000018B2                           912      
000018B2                           913      ;SET FILL COLOR  
000018B2  103C 0051                914      MOVE.B #81, D0
000018B6  222F 0004                915      MOVE.L 4(A7), D1
000018BA  4E4F                     916      TRAP #15 
000018BC                           917      
000018BC                           918      ; SET PEN COLOR 
000018BC  103C 0050                919      MOVE.B #80, D0
000018C0  222F 0008                920      MOVE.L 8(A7), D1
000018C4  4E4F                     921      TRAP #15 
000018C6                           922  
000018C6                           923      ;DRAW BLOCK 
000018C6  103C 0057                924      MOVE.B #87, D0
000018CA  3239 00003790            925      MOVE.W BPOSX1, D1
000018D0  3439 00003792            926      MOVE.W BPOSY1, D2
000018D6  3639 00003794            927      MOVE.W BPOSX2, D3
000018DC  3839 00003796            928      MOVE.W BPOSY2, D4
000018E2  4E4F                     929      TRAP #15
000018E4  4E75                     930      RTS
000018E6                           931  
000018E6                           932  NEWLINE
000018E6                           933      ;RESET X POSITION
000018E6  33FC 0000 00003790       934      MOVE.W #0, BPOSX1
000018EE  33FC 0020 00003794       935      MOVE.W #32, BPOSX2
000018F6                           936      ;ADD 33 TO Y POSITION
000018F6  0679 0020 00003792       937      ADD.W #32, BPOSY1
000018FE  0679 0020 00003796       938      ADD.W #32, BPOSY2
00001906  4EF8 1524                939      JMP NEXT
0000190A                           940     
0000190A                           941  ENDBLOCK
0000190A                           942      ;SET NEW BLOCK POSITION
0000190A  0679 0020 00003790       943      ADD.W #32, BPOSX1
00001912  0679 0020 00003794       944      ADD.W #32, BPOSX2
0000191A  4E75                     945      RTS
0000191C                           946  ENDMAP
0000191C                           947      ;SET DEFAULT BLOCK POSITION
0000191C  33FC 0000 00003790       948      MOVE.W #0, BPOSX1
00001924  33FC 0000 00003792       949      MOVE.W #0, BPOSY1
0000192C  33FC 0020 00003794       950      MOVE.W #32, BPOSX2
00001934  33FC 0020 00003796       951      MOVE.W #32, BPOSY2
0000193C  4CDF 7F00                952      MOVEM.L (A7)+, A0-A6
00001940  4CDF 00FF                953      MOVEM.L (A7)+, D0-D7
00001944  4E75                     954      RTS
00001946                           955      
00001946                           956  
00001946                           957  
00001946                           958  MAPA1
00001946  301F                     959      MOVE.W (A7)+, D0
00001948  48A7 F800                960      MOVEM.W D0-D4, -(A7)
0000194C  3039 0000378A            961      MOVE.W PLAYERPOSX, D0
00001952  3239 0000378C            962      MOVE.W PLAYERPOSY, D1
00001958                           963      ;GO TO THE NEXT ROOM DOOR
00001958                           964      ;FIRST LETS CHECH POS X
00001958  B07C 0160                965      CMP #352, D0  ; BGT = 352 > D0
0000195C  6E00 002A                966      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001960  B07C 0120                967      CMP #288, D0
00001964  6D00 0022                968      BLT MAP1NODOOR
00001968                           969      ;NOW WE CHECK POS Y 
00001968  B27C 01E0                970      CMP #480, D1  ; 
0000196C  6E00 001A                971      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001970  B27C 01C0                972      CMP #448, D1
00001974  6D00 0012                973      BLT MAP1NODOOR
00001978  33FC 0020 0000378C       974      MOVE.W #32, PLAYERPOSY
00001980  33FC 0002 00003798       975      MOVE.W #2, LOADEDMAP
00001988                           976  MAP1NODOOR
00001988  4C9F 001F                977      MOVEM.W (A7)+, D0-D4
0000198C  4E75                     978      RTS
0000198E                           979      
0000198E                           980  MAPA2
0000198E  301F                     981      MOVE.W (A7)+, D0
00001990  48A7 F800                982      MOVEM.W D0-D4, -(A7)
00001994  3039 0000378A            983      MOVE.W PLAYERPOSX, D0
0000199A  3239 0000378C            984      MOVE.W PLAYERPOSY, D1
000019A0                           985      ;GO TO THE NEXT ROOM DOOR
000019A0                           986      ;FIRST LETS CHECK POS X
000019A0  B07C 0160                987      CMP #352, D0  ; BGT = 352 > D0
000019A4  6E00 0030                988      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019A8  B07C 0120                989      CMP #288, D0
000019AC  6D00 0028                990      BLT MAP2NODOOR1
000019B0                           991      ;NOW WE CHECK POS Y 
000019B0  B27C 01E0                992      CMP #480, D1  ; 
000019B4  6E00 0020                993      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019B8  B27C 01C0                994      CMP #448, D1
000019BC  6D00 0018                995      BLT MAP2NODOOR1
000019C0  33FC 0020 0000378C       996      MOVE.W #32, PLAYERPOSY
000019C8  33FC 0003 00003798       997      MOVE.W #3, LOADEDMAP
000019D0  4C9F 001F                998      MOVEM.W (A7)+, D0-D4
000019D4  4E75                     999      RTS
000019D6                          1000  MAP2NODOOR1
000019D6                          1001      ;GO TO THE PREVIOUS ROOM DOOR
000019D6                          1002      ;FIRST LETS CHECK POS X
000019D6  B07C 0160               1003      CMP #352, D0  ; BGT = 352 > D0
000019DA  6E00 0030               1004      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019DE  B07C 0120               1005      CMP #288, D0
000019E2  6D00 0028               1006      BLT MAP2NODOOR2
000019E6                          1007      ;NOW WE CHECK POS Y 
000019E6  B27C 0020               1008      CMP #32, D1  ; 
000019EA  6E00 0020               1009      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019EE  B27C 0000               1010      CMP #0, D1
000019F2  6D00 0018               1011      BLT MAP2NODOOR2
000019F6  33FC 01A0 0000378C      1012      MOVE.W  #416, PLAYERPOSY
000019FE  33FC 0001 00003798      1013      MOVE.W #1, LOADEDMAP
00001A06  4C9F 001F               1014      MOVEM.W (A7)+, D0-D4
00001A0A  4E75                    1015      RTS
00001A0C                          1016  
00001A0C                          1017  MAP2NODOOR2
00001A0C                          1018      ;GO TO THE LEFT HEAVEN'S ROOM
00001A0C  B07C 00A0               1019      CMP #160, D0  ; BGT = 352 > D0
00001A10  6E00 0038               1020      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A14  B07C 0080               1021      CMP #128, D0
00001A18  6D00 0030               1022      BLT MAP2NODOOR3
00001A1C                          1023      ;NOW WE CHECK POS Y 
00001A1C  B27C 00AA               1024      CMP #170, D1  ; 
00001A20  6E00 0028               1025      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A24  B27C 0078               1026      CMP #120, D1
00001A28  6D00 0020               1027      BLT MAP2NODOOR3
00001A2C  33FC 0130 0000378A      1028      MOVE.W #$130, PLAYERPOSX
00001A34  33FC 00B0 0000378C      1029      MOVE.W #$0B0, PLAYERPOSY
00001A3C  33FC 0004 00003798      1030      MOVE.W #4, LOADEDMAP
00001A44  4C9F 001F               1031      MOVEM.W (A7)+, D0-D4
00001A48  4E75                    1032      RTS
00001A4A                          1033  MAP2NODOOR3
00001A4A                          1034      ;GO TO THE RIGHT HEAVEN'S ROOM
00001A4A  B07C 01E0               1035      CMP #480, D0  ; BGT = 352 > D0
00001A4E  6E00 0038               1036      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A52  B07C 01C0               1037      CMP #448, D0
00001A56  6D00 0030               1038      BLT MAP2NODOOR4
00001A5A                          1039      ;NOW WE CHECK POS Y 
00001A5A  B27C 00AA               1040      CMP #170, D1  ; 
00001A5E  6E00 0028               1041      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A62  B27C 0078               1042      CMP #120, D1
00001A66  6D00 0020               1043      BLT MAP2NODOOR4
00001A6A  33FC 0130 0000378A      1044      MOVE.W #$130, PLAYERPOSX
00001A72  33FC 00B0 0000378C      1045      MOVE.W #$0B0, PLAYERPOSY
00001A7A  33FC 0004 00003798      1046      MOVE.W #4, LOADEDMAP
00001A82  4C9F 001F               1047      MOVEM.W (A7)+, D0-D4
00001A86  4E75                    1048      RTS
00001A88                          1049  MAP2NODOOR4
00001A88  4C9F 001F               1050      MOVEM.W (A7)+, D0-D4
00001A8C  4E75                    1051      RTS
00001A8E                          1052  MAPA3 
00001A8E  301F                    1053      MOVE.W (A7)+, D0
00001A90  48A7 F800               1054      MOVEM.W D0-D4, -(A7)
00001A94  3039 0000378A           1055      MOVE.W PLAYERPOSX, D0
00001A9A  3239 0000378C           1056      MOVE.W PLAYERPOSY, D1
00001AA0                          1057      ;GO TO THE PREVIOUS ROOM DOOR
00001AA0                          1058      ;FIRST LETS CHECK POS X
00001AA0  B07C 0160               1059      CMP #352, D0  ; BGT = 352 > D0
00001AA4  6E00 0030               1060      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AA8  B07C 0120               1061      CMP #288, D0
00001AAC  6D00 0028               1062      BLT MAP3NODOOR
00001AB0                          1063      ;NOW WE CHECK POS Y 
00001AB0  B27C 0020               1064      CMP #32, D1  ; 
00001AB4  6E00 0020               1065      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AB8  B27C 0000               1066      CMP #0, D1
00001ABC  6D00 0018               1067      BLT MAP3NODOOR
00001AC0  33FC 01A0 0000378C      1068      MOVE.W  #416, PLAYERPOSY
00001AC8  33FC 0002 00003798      1069      MOVE.W #2, LOADEDMAP
00001AD0  4C9F 001F               1070      MOVEM.W (A7)+, D0-D4
00001AD4  4E75                    1071      RTS
00001AD6                          1072  MAP3NODOOR
00001AD6  4C9F 001F               1073      MOVEM.W (A7)+, D0-D4
00001ADA  4E75                    1074      RTS
00001ADC                          1075  MAPA4
00001ADC  301F                    1076      MOVE.W (A7)+, D0
00001ADE  48A7 F800               1077      MOVEM.W D0-D4, -(A7)
00001AE2  3039 0000378A           1078      MOVE.W PLAYERPOSX, D0
00001AE8  3239 0000378C           1079      MOVE.W PLAYERPOSY, D1
00001AEE                          1080      ;GO BACK TO 2ND HEAVEN'S ROOM
00001AEE  B07C 0180               1081      CMP #384, D0  ; BGT = 352 > D0
00001AF2  6E00 002A               1082      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AF6  B07C 0104               1083      CMP #260, D0
00001AFA  6D00 0022               1084      BLT MAP4NODOOR
00001AFE                          1085      ;NOW WE CHECK POS Y 
00001AFE  B27C 0080               1086      CMP #128, D1  ; 
00001B02  6E00 001A               1087      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B06  B27C 0060               1088      CMP #96, D1
00001B0A  6D00 0012               1089      BLT MAP4NODOOR
00001B0E  33FC 00E0 0000378A      1090      MOVE.W  #224, PLAYERPOSX
00001B16  33FC 0002 00003798      1091      MOVE.W #2, LOADEDMAP
00001B1E                          1092  MAP4NODOOR
00001B1E  4C9F 001F               1093      MOVEM.W (A7)+, D0-D4
00001B22  4E75                    1094      RTS
00001B24                          1095  ;;;;;;;;;;HELL
00001B24                          1096  MAPA5
00001B24  301F                    1097      MOVE.W (A7)+, D0
00001B26  48A7 F800               1098      MOVEM.W D0-D4, -(A7)
00001B2A  3039 0000378A           1099      MOVE.W PLAYERPOSX, D0
00001B30  3239 0000378C           1100      MOVE.W PLAYERPOSY, D1
00001B36                          1101      ;GO TO THE NEXT ROOM DOOR
00001B36                          1102      ;FIRST LETS CHECH POS X
00001B36  B07C 0160               1103      CMP #352, D0  ; BGT = 352 > D0
00001B3A  6E00 002A               1104      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B3E  B07C 0120               1105      CMP #288, D0
00001B42  6D00 0022               1106      BLT MAP5NODOOR
00001B46                          1107      ;NOW WE CHECK POS Y 
00001B46  B27C 01E0               1108      CMP #480, D1  ; 
00001B4A  6E00 001A               1109      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B4E  B27C 01C0               1110      CMP #448, D1
00001B52  6D00 0012               1111      BLT MAP5NODOOR
00001B56  33FC 0020 0000378C      1112      MOVE.W #32, PLAYERPOSY
00001B5E  33FC 0006 00003798      1113      MOVE.W #6, LOADEDMAP
00001B66                          1114  MAP5NODOOR
00001B66  4C9F 001F               1115      MOVEM.W (A7)+, D0-D4
00001B6A  4E75                    1116      RTS
00001B6C                          1117      
00001B6C                          1118  MAPA6
00001B6C  301F                    1119      MOVE.W (A7)+, D0
00001B6E  48A7 F800               1120      MOVEM.W D0-D4, -(A7)
00001B72  3039 0000378A           1121      MOVE.W PLAYERPOSX, D0
00001B78  3239 0000378C           1122      MOVE.W PLAYERPOSY, D1
00001B7E                          1123      ;GO TO THE NEXT ROOM DOOR
00001B7E                          1124      ;FIRST LETS CHECK POS X
00001B7E  B07C 0160               1125      CMP #352, D0  ; BGT = 352 > D0
00001B82  6E00 0030               1126      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B86  B07C 0120               1127      CMP #288, D0
00001B8A  6D00 0028               1128      BLT MAP6NODOOR1
00001B8E                          1129      ;NOW WE CHECK POS Y 
00001B8E  B27C 01E0               1130      CMP #480, D1  ; 
00001B92  6E00 0020               1131      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B96  B27C 01C0               1132      CMP #448, D1
00001B9A  6D00 0018               1133      BLT MAP6NODOOR1
00001B9E  33FC 0020 0000378C      1134      MOVE.W #32, PLAYERPOSY
00001BA6  33FC 0007 00003798      1135      MOVE.W #7, LOADEDMAP
00001BAE  4C9F 001F               1136      MOVEM.W (A7)+, D0-D4
00001BB2  4E75                    1137      RTS
00001BB4                          1138  MAP6NODOOR1
00001BB4                          1139      ;GO TO THE PREVIOUS ROOM DOOR
00001BB4                          1140      ;FIRST LETS CHECK POS X
00001BB4  B07C 0160               1141      CMP #352, D0  ; BGT = 352 > D0
00001BB8  6E00 0030               1142      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BBC  B07C 0120               1143      CMP #288, D0
00001BC0  6D00 0028               1144      BLT MAP6NODOOR2
00001BC4                          1145      ;NOW WE CHECK POS Y 
00001BC4  B27C 0020               1146      CMP #32, D1  ; 
00001BC8  6E00 0020               1147      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BCC  B27C 0000               1148      CMP #0, D1
00001BD0  6D00 0018               1149      BLT MAP6NODOOR2
00001BD4  33FC 01A0 0000378C      1150      MOVE.W  #416, PLAYERPOSY
00001BDC  33FC 0005 00003798      1151      MOVE.W #5, LOADEDMAP
00001BE4  4C9F 001F               1152      MOVEM.W (A7)+, D0-D4
00001BE8  4E75                    1153      RTS
00001BEA                          1154  MAP6NODOOR2
00001BEA                          1155      ;CHECK FOR LEFT HELL ROOM
00001BEA  B07C 0060               1156      CMP #96, D0  ; BGT = 352 > D0
00001BEE  6E00 0038               1157      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BF2  B07C 0040               1158      CMP #64, D0
00001BF6  6D00 0030               1159      BLT MAP6NODOOR3
00001BFA                          1160      ;NOW WE CHECK POS Y 
00001BFA  B27C 0180               1161      CMP #384, D1  ; 
00001BFE  6E00 0028               1162      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C02  B27C 0140               1163      CMP #320, D1
00001C06  6D00 0020               1164      BLT MAP6NODOOR3
00001C0A  33FC 0130 0000378A      1165      MOVE.W #$130, PLAYERPOSX
00001C12  33FC 00B0 0000378C      1166      MOVE.W #$0B0, PLAYERPOSY
00001C1A  33FC 0008 00003798      1167      MOVE.W #8, LOADEDMAP
00001C22  4C9F 001F               1168      MOVEM.W (A7)+, D0-D4
00001C26  4E75                    1169      RTS
00001C28                          1170  MAP6NODOOR3
00001C28                          1171      ;CHECK FOR THE RIGHT HELL ROOM
00001C28  B07C 0240               1172      CMP #576, D0  ; BGT = 352 > D0
00001C2C  6E00 0038               1173      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C30  B07C 021C               1174      CMP #540, D0
00001C34  6D00 0030               1175      BLT MAP6NODOOR4
00001C38                          1176      ;NOW WE CHECK POS Y 
00001C38  B27C 0180               1177      CMP #384, D1  ; 
00001C3C  6E00 0028               1178      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C40  B27C 0140               1179      CMP #320, D1
00001C44  6D00 0020               1180      BLT MAP6NODOOR4
00001C48  33FC 0130 0000378A      1181      MOVE.W #$130, PLAYERPOSX
00001C50  33FC 00B0 0000378C      1182      MOVE.W #$0B0, PLAYERPOSY
00001C58  33FC 0008 00003798      1183      MOVE.W #8, LOADEDMAP
00001C60  4C9F 001F               1184      MOVEM.W (A7)+, D0-D4
00001C64  4E75                    1185      RTS
00001C66                          1186  MAP6NODOOR4
00001C66  4C9F 001F               1187      MOVEM.W (A7)+, D0-D4
00001C6A  4E75                    1188      RTS
00001C6C                          1189  MAPA7 
00001C6C  301F                    1190      MOVE.W (A7)+, D0
00001C6E  48A7 F800               1191      MOVEM.W D0-D4, -(A7)
00001C72  3039 0000378A           1192      MOVE.W PLAYERPOSX, D0
00001C78  3239 0000378C           1193      MOVE.W PLAYERPOSY, D1
00001C7E                          1194      ;GO BACK TO PREVIOUS HELL'S ROOM
00001C7E  B07C 0180               1195      CMP #384, D0  ; BGT = 352 > D0
00001C82  6E00 0032               1196      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C86  B07C 0104               1197      CMP #260, D0
00001C8A  6D00 002A               1198      BLT MAP7NODOOR
00001C8E                          1199      ;NOW WE CHECK POS Y 
00001C8E  B27C 0020               1200      CMP #32, D1  ; 
00001C92  6E00 0022               1201      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C96  B27C 0000               1202      CMP #0, D1
00001C9A  6D00 001A               1203      BLT MAP7NODOOR
00001C9E  33FC 0140 0000378A      1204      MOVE.W  #320, PLAYERPOSX
00001CA6  33FC 01A0 0000378C      1205      MOVE.W #416, PLAYERPOSY
00001CAE  33FC 0006 00003798      1206      MOVE.W #6, LOADEDMAP
00001CB6                          1207  MAP7NODOOR
00001CB6  4C9F 001F               1208      MOVEM.W (A7)+, D0-D4
00001CBA  4E75                    1209      RTS
00001CBC                          1210  MAPA8
00001CBC                          1211       ;HELLS ROOM
00001CBC  301F                    1212      MOVE.W (A7)+, D0
00001CBE  48A7 F800               1213      MOVEM.W D0-D4, -(A7)
00001CC2  3039 0000378A           1214      MOVE.W PLAYERPOSX, D0
00001CC8  3239 0000378C           1215      MOVE.W PLAYERPOSY, D1
00001CCE                          1216      ;GO BACK TO PREVIOUS HELL'S ROOM
00001CCE  B07C 0180               1217      CMP #384, D0  ; BGT = 352 > D0
00001CD2  6E00 0032               1218      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CD6  B07C 0104               1219      CMP #260, D0
00001CDA  6D00 002A               1220      BLT MAP8NODOOR1
00001CDE                          1221      ;NOW WE CHECK POS Y 
00001CDE  B27C 0080               1222      CMP #128, D1  ; 
00001CE2  6E00 0022               1223      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CE6  B27C 0060               1224      CMP #96, D1
00001CEA  6D00 001A               1225      BLT MAP8NODOOR1
00001CEE  33FC 0140 0000378A      1226      MOVE.W  #320, PLAYERPOSX
00001CF6  33FC 0080 0000378C      1227      MOVE.W #128, PLAYERPOSY
00001CFE  33FC 0006 00003798      1228      MOVE.W #6, LOADEDMAP
00001D06                          1229  MAP8NODOOR1
00001D06  4C9F 001F               1230      MOVEM.W (A7)+, D0-D4
00001D0A  4E75                    1231      RTS
00001D0C                          1232  
00001D0C                          1233  
00001D0C                          1234  
00001D0C                          1235  
00001D0C                          1236  
00001D0C                          1237  
00001D0C                          1238  
00001D0C                          1239  
00001D0C                          1240  
00001D0C                          1241  
00001D0C                          1242  
00001D0C                          1243  
00001D0C                          1244  
00001D0C                          1245  -------------------- end include --------------------
00001D0C                          1246              INCLUDE "MAP.X68"
00001D0C                          1247  
00001D0C                          1248  ;MAP 0 INDICATES THAT WE ARE IN THE ELEVATOR MENU. 
00001D0C                          1249  
00001D0C                          1250  HEAVEN_0    ;MAP 1
00001D0C= 03 03 03 03 03 03 ...   1251      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00001D21= 03 01 01 01 01 01 ...   1252      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
00001D36= 03 01 03 03 03 03 ...   1253      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
00001D4B= 03 01 03 05 05 05 ...   1254      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00001D60= 03 01 03 05 05 05 ...   1255      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001D75= 03 01 03 05 05 05 ...   1256      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001D8A= 03 01 03 05 05 05 ...   1257      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001D9F= 03 01 03 05 05 05 ...   1258      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001DB4= 03 01 03 05 05 05 ...   1259      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DC9= 03 01 03 05 05 05 ...   1260      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DDE= 03 01 03 05 05 05 ...   1261      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DF3= 03 01 03 05 05 05 ...   1262      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E08= 03 01 03 05 05 05 ...   1263      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E1D= 03 01 03 03 03 03 ...   1264      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00001E32= 03 01 01 01 01 01 ...   1265      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001E47= 03 03 03 03 03 03 ...   1266      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001E5C                          1267          
00001E5C                          1268  HEAVEN_1    ;MAP 2
00001E5C= 03 03 03 03 03 03 ...   1269      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001E71= 03 03 01 01 01 01 ...   1270      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
00001E86= 03 03 03 03 03 03 ...   1271      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
00001E9B= 03 07 07 07 07 03 ...   1272      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001EB0= 03 07 07 07 07 03 ...   1273      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001EC5= 03 07 07 07 07 09 ...   1274      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
00001EDA= 03 07 07 07 07 03 ...   1275      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00001EEF= 03 07 07 07 07 03 ...   1276      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F04= 03 03 03 03 03 03 ...   1277      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
00001F19= 03 01 01 01 01 03 ...   1278      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00001F2E= 03 01 01 01 01 01 ...   1279      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00001F43= 03 01 01 01 01 01 ...   1280      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001F58= 03 01 01 01 01 01 ...   1281      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001F6D= 03 01 01 01 01 01 ...   1282      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001F82= 03 03 03 03 03 03 ...   1283      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001F97                          1284      
00001F97                          1285  HEAVEN_END  ;MAP 3
00001F97= 03 03 03 03 03 03 ...   1286      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001FAC= 03 05 05 05 05 05 ...   1287      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00001FC1= 03 05 05 07 05 05 ...   1288      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00001FD6= 03 05 07 07 07 05 ...   1289      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00001FEB= 03 05 05 07 05 05 ...   1290      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00002000= 03 05 05 07 05 05 ...   1291      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00002015= 03 05 05 05 05 05 ...   1292      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
0000202A= 03 05 05 05 05 05 ...   1293      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
0000203F= 03 05 05 05 05 05 ...   1294      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00002054= 03 05 05 07 05 05 ...   1295      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002069= 03 05 07 07 07 05 ...   1296      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
0000207E= 03 05 05 07 05 05 ...   1297      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002093= 03 05 05 07 05 05 ...   1298      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000020A8= 03 05 05 05 05 05 ...   1299      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
000020BD= 03 03 03 03 03 03 ...   1300      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
000020D2                          1301      
000020D2                          1302  HEAVEN_ROOM ;MAP 4
000020D2= 09 09 09 09 09 09 ...   1303      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000020E7= 09 09 09 09 09 09 ...   1304      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000020FC= 09 09 09 09 09 09 ...   1305      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002111= 09 09 09 09 09 09 ...   1306      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002126= 09 09 09 09 09 03 ...   1307      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
0000213B= 09 09 09 09 09 03 ...   1308      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002150= 09 09 09 09 09 03 ...   1309      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002165= 09 09 09 09 09 03 ...   1310      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000217A= 09 09 09 09 09 03 ...   1311      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000218F= 09 09 09 09 09 03 ...   1312      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021A4= 09 09 09 09 09 03 ...   1313      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
000021B9= 09 09 09 09 09 09 ...   1314      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021CE= 09 09 09 09 09 09 ...   1315      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021E3= 09 09 09 09 09 09 ...   1316      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021F8= 09 09 09 09 09 09 ...   1317      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
0000220D                          1318      
0000220D                          1319  HELL_0  ;MAP 5
0000220D= 02 02 02 02 02 02 ...   1320      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
00002222= 02 06 06 06 06 06 ...   1321      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002237= 02 06 06 04 06 06 ...   1322      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
0000224C= 02 06 06 04 06 06 ...   1323      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00002261= 02 06 04 04 04 06 ...   1324      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
00002276= 02 06 06 04 06 06 ...   1325      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
0000228B= 02 06 06 06 06 06 ...   1326      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022A0= 02 02 02 02 02 02 ...   1327      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
000022B5= 02 06 06 06 06 06 ...   1328      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022CA= 02 06 06 06 06 06 ...   1329      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022DF= 02 06 06 06 06 06 ...   1330      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022F4= 02 06 06 06 06 06 ...   1331      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002309= 02 06 06 06 06 06 ...   1332      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000231E= 02 06 06 06 06 06 ...   1333      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002333= 02 02 02 02 02 02 ...   1334      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002348                          1335          
00002348                          1336  HELL_1      ;MAP 6
00002348= 02 02 02 02 02 02 ...   1337      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
0000235D= 02 06 06 06 06 06 ...   1338      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002372= 02 06 06 06 06 06 ...   1339      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002387= 02 06 06 06 06 06 ...   1340      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000239C= 02 06 06 06 06 06 ...   1341      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000023B1= 02 06 06 06 06 06 ...   1342      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
000023C6= 02 06 06 06 06 06 ...   1343      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
000023DB= 02 06 06 06 06 06 ...   1344      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
000023F0= 02 06 06 06 06 06 ...   1345      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002405= 02 06 06 06 06 06 ...   1346      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000241A= 02 02 08 02 02 02 ...   1347      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
0000242F= 02 06 06 06 02 02 ...   1348      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002444= 02 06 06 06 02 02 ...   1349      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002459= 02 06 06 06 02 02 ...   1350      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
0000246E= 02 02 02 02 02 02 ...   1351      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002483                          1352          
00002483                          1353  HELL_END    ;MAP 7
00002483= 02 02 02 02 02 02 ...   1354      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00002498= 02 06 06 06 06 06 ...   1355      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024AD= 02 06 06 06 06 06 ...   1356      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024C2= 02 06 06 06 06 06 ...   1357      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000024D7= 02 06 06 06 06 06 ...   1358      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000024EC= 02 06 06 06 06 06 ...   1359      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002501= 02 06 06 06 06 06 ...   1360      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002516= 02 06 06 06 06 06 ...   1361      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000252B= 02 06 06 06 06 06 ...   1362      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002540= 02 06 06 06 06 06 ...   1363      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002555= 02 06 06 06 06 06 ...   1364      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000256A= 02 06 06 06 06 06 ...   1365      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000257F= 02 06 06 06 06 06 ...   1366      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002594= 02 06 06 06 06 06 ...   1367      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000025A9= 02 02 02 02 02 02 ...   1368      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
000025BE                          1369      
000025BE                          1370  HELL_ROOM   ;MAP 8
000025BE= 08 08 08 08 08 08 ...   1371      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000025D3= 08 08 08 08 08 08 ...   1372      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000025E8= 08 08 08 08 08 08 ...   1373      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000025FD= 08 08 08 08 08 08 ...   1374      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002612= 08 08 08 08 08 02 ...   1375      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
00002627= 08 08 08 08 08 02 ...   1376      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000263C= 08 08 08 08 08 02 ...   1377      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002651= 08 08 08 08 08 02 ...   1378      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002666= 08 08 08 08 08 02 ...   1379      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000267B= 08 08 08 08 08 02 ...   1380      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002690= 08 08 08 08 08 02 ...   1381      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
000026A5= 08 08 08 08 08 08 ...   1382      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026BA= 08 08 08 08 08 08 ...   1383      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026CF= 08 08 08 08 08 08 ...   1384      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026E4= 08 08 08 08 08 08 ...   1385      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
000026F9                          1386  
000026F9                          1387  
000026F9                          1388  
000026F9                          1389  
000026F9                          1390  
000026F9                          1391  
000026F9                          1392  
000026F9                          1393  -------------------- end include --------------------
000026F9                          1394              INCLUDE "ELEVATOR_MENU.X68"           
000026F9  =000000CC               1395  COLBUTHL    EQU $000000CC
000026F9  =00EEEEEE               1396  COLBUTHV    EQU $00EEEEEE
000026F9                          1397  
000026F9= 01                      1398      DC.B 1
000026FA                          1399  ELEVATORPLOT
000026FA                          1400      
000026FA  4CDF 7F00               1401      MOVEM.L (A7)+, A0-A6
000026FE  4CDF 00FF               1402      MOVEM.L (A7)+, D0-D7
00002702                          1403  
00002702                          1404  
00002702                          1405  ;SET PEN COLOR  
00002702  103C 0050               1406      MOVE.B #80, D0
00002706  223C 00010101           1407      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
0000270C  4E4F                    1408      TRAP #15
0000270E                          1409      
0000270E                          1410  ;END SET PEN COLOR 
0000270E                          1411  
0000270E                          1412      ;DRAW LINES
0000270E                          1413  ;DRAW LINE 1 
0000270E  103C 0054               1414      MOVE.B #84, D0
00002712  323C 0000               1415      MOVE.W #0, D1
00002716  343C 0000               1416      MOVE.W #0, D2
0000271A  363C 00A0               1417      MOVE.W #160, D3
0000271E  383C 0078               1418      MOVE.W #120, D4
00002722  4E4F                    1419      TRAP #15
00002724                          1420  
00002724                          1421  ;DRAW LINE 2
00002724  103C 0054               1422      MOVE.B #84, D0
00002728  323C 00A0               1423      MOVE.W #160, D1
0000272C  343C 0078               1424      MOVE.W #120, D2
00002730  363C 00A0               1425      MOVE.W #160, D3
00002734  383C 01E0               1426      MOVE.W #480, D4
00002738  4E4F                    1427      TRAP #15
0000273A                          1428      
0000273A                          1429  ;DRAW LINE 3
0000273A  103C 0054               1430      MOVE.B #84, D0
0000273E  323C 00A0               1431      MOVE.W #160, D1
00002742  343C 0078               1432      MOVE.W #120, D2
00002746  363C 01E0               1433      MOVE.W #480, D3
0000274A  383C 0078               1434      MOVE.W #120, D4
0000274E  4E4F                    1435      TRAP #15
00002750                          1436      
00002750                          1437  ;DRAW LINE 4
00002750  103C 0054               1438      MOVE.B #84, D0
00002754  323C 01E0               1439      MOVE.W #480, D1
00002758  343C 0078               1440      MOVE.W #120, D2
0000275C  363C 0280               1441      MOVE.W #640, D3
00002760  383C 0000               1442      MOVE.W #0, D4
00002764  4E4F                    1443      TRAP #15
00002766                          1444      
00002766                          1445  ;DRAW LINE 5
00002766  103C 0054               1446      MOVE.B #84, D0
0000276A  323C 01E0               1447      MOVE.W #480, D1
0000276E  343C 0078               1448      MOVE.W #120, D2
00002772  363C 01E0               1449      MOVE.W #480, D3
00002776  383C 01E0               1450      MOVE.W #480, D4
0000277A  4E4F                    1451      TRAP #15
0000277C                          1452  
0000277C                          1453  ;DRAW LINE 6 (TO GIVE SHADE) 
0000277C  103C 0054               1454      MOVE.B #84, D0
00002780  323C 0119               1455      MOVE.W #281, D1
00002784  343C 015A               1456      MOVE.W #346, D2
00002788  363C 0167               1457      MOVE.W #359, D3
0000278C  383C 015A               1458      MOVE.W #346, D4
00002790  4E4F                    1459      TRAP #15
00002792                          1460      
00002792                          1461  ;DRAW LINE 7 (TO GIVE SHADE) 
00002792  103C 0054               1462      MOVE.B #84, D0
00002796  323C 011A               1463      MOVE.W #282, D1
0000279A  343C 015B               1464      MOVE.W #347, D2
0000279E  363C 0166               1465      MOVE.W #358, D3
000027A2  383C 015B               1466      MOVE.W #347, D4
000027A6  4E4F                    1467      TRAP #15
000027A8                          1468      
000027A8                          1469      ;END DRAW LINES
000027A8                          1470      
000027A8                          1471  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
000027A8  103C 0057               1472      MOVE.B #87, D0
000027AC  323C 0118               1473      MOVE.W #280, D1
000027B0  343C 00D2               1474      MOVE.W #210, D2
000027B4  363C 0168               1475      MOVE.W #360, D3
000027B8  383C 0159               1476      MOVE.W #345, D4
000027BC  4E4F                    1477      TRAP #15
000027BE                          1478      
000027BE                          1479  ;DRAW ELLIPSE FOR THE LIGHT
000027BE  103C 005B               1480      MOVE.B #91, D0
000027C2  323C 00FA               1481      MOVE.W #250, D1
000027C6  343C 0028               1482      MOVE.W #40, D2
000027CA  363C 0186               1483      MOVE.W #390, D3
000027CE  383C 0050               1484      MOVE.W #80, D4
000027D2  4E4F                    1485      TRAP #15
000027D4                          1486      ;FILL SEGMENTS
000027D4                          1487  ;FILL SEGMENT 1 LEFT WALL
000027D4                          1488    ;SET FILL COLOR TO DARKER GREY, FOR W
000027D4  103C 0051               1489      MOVE.B #81, D0
000027D8                          1490      ;MOVE.L #$00969696, D1
000027D8  223C 0020202F           1491      MOVE.L #$0020202F, D1
000027DE  4E4F                    1492      TRAP #15
000027E0                          1493      ;END SET FILL COLOR
000027E0  103C 0059               1494      MOVE.B #89, D0
000027E4  323C 0064               1495      MOVE.W #100, D1
000027E8  343C 0064               1496      MOVE.W #100, D2
000027EC  4E4F                    1497      TRAP #15
000027EE                          1498      
000027EE                          1499  ;FILL SEGMENT 2 CEILING
000027EE                          1500    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
000027EE  103C 0051               1501      MOVE.B #81, D0
000027F2                          1502      ;MOVE.L #$00C0C0C0, D1
000027F2  223C 00141424           1503      MOVE.L #$00141424,D1
000027F8  4E4F                    1504      TRAP #15
000027FA                          1505      ;END SET FILL COLOR
000027FA  103C 0059               1506      MOVE.B #89, D0
000027FE  323C 0064               1507      MOVE.W #100, D1
00002802  343C 0032               1508      MOVE.W #50, D2
00002806  4E4F                    1509      TRAP #15
00002808                          1510      
00002808                          1511  ;FILL SEGMENT 3 RIGHT WALL
00002808                          1512    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00002808  103C 0051               1513      MOVE.B #81, D0
0000280C                          1514      ;MOVE.L #$00969696, D1
0000280C  223C 0020202F           1515      MOVE.L #$0020202F,D1
00002812  4E4F                    1516      TRAP #15
00002814                          1517      ;END SET FILL COLOR
00002814  103C 0059               1518      MOVE.B #89, D0
00002818  323C 0276               1519      MOVE.W #630, D1
0000281C  343C 01D6               1520      MOVE.W #470, D2
00002820  4E4F                    1521      TRAP #15
00002822                          1522      
00002822                          1523  ;FILL SEGMENT 4 BACKGROUND WALL
00002822                          1524    ;SET FILL COLOR TO 
00002822  103C 0051               1525      MOVE.B #81, D0
00002826                          1526      ;MOVE.L #$00ABABAB, D1
00002826  223C 001A1A2A           1527      MOVE.L #$001A1A2A, D1
0000282C  4E4F                    1528      TRAP #15
0000282E                          1529      ;END SET FILL COLOR
0000282E  103C 0059               1530      MOVE.B #89, D0
00002832  323C 00F0               1531      MOVE.W #240, D1
00002836  343C 0140               1532      MOVE.W #320, D2
0000283A  4E4F                    1533      TRAP #15
0000283C                          1534      
0000283C                          1535  ;FILL SEGMENT 5 PANEL 
0000283C                          1536    ;SET FILL COLOR TO 
0000283C  103C 0051               1537      MOVE.B #81, D0
00002840                          1538      ;MOVE.L #$00AFAFAF, D1
00002840  223C 001F1F2F           1539      MOVE.L #$001F1F2F, D1
00002846  4E4F                    1540      TRAP #15
00002848                          1541      ;END SET FILL COLOR
00002848  103C 0059               1542      MOVE.B #89, D0
0000284C  323C 011D               1543      MOVE.W #285, D1
00002850  343C 00D7               1544      MOVE.W #215, D2
00002854  4E4F                    1545      TRAP #15
00002856                          1546      
00002856                          1547  ;FILL ELLIPSE LIGHT 
00002856                          1548    ;SET FILL COLOR TO 
00002856  103C 0051               1549      MOVE.B #81, D0
0000285A                          1550      ;MOVE.L #$00A1E9E9, D1
0000285A  223C 000000FF           1551      MOVE.L #$000000FF, D1
00002860  4E4F                    1552      TRAP #15
00002862                          1553      ;END SET FILL COLOR
00002862  103C 0059               1554      MOVE.B #89, D0
00002866  323C 0140               1555      MOVE.W #320, D1
0000286A  343C 003C               1556      MOVE.W #60, D2
0000286E  4E4F                    1557      TRAP #15
00002870                          1558  
00002870                          1559  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
00002870                          1560      ;SET FILL COLOR 
00002870  103C 0051               1561      MOVE.B #81, D0
00002874  223C 000000CC           1562      MOVE.L #COLBUTHL, D1
0000287A  4E4F                    1563      TRAP #15
0000287C                          1564      ;END SET FILL COLOR
0000287C  3F3C 0135               1565      MOVE.W #309, -(A7) ;COORDENADA Y 
00002880  3F3C 0136               1566      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00002884  3F3C 0016               1567      MOVE.W #22, -(A7)
00002888  4EB9 000028C2           1568      JSR TRIANGLE
0000288E  3C1F                    1569      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
00002890  3C1F                    1570      MOVE.W (A7)+, D6
00002892  3C1F                    1571      MOVE.W (A7)+, D6
00002894                          1572  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
00002894                          1573     ;SET FILL COLOR
00002894  48E7 FFFE               1574     MOVEM.L D0-D7/A0-A6, -(A7)
00002898  103C 0051               1575     MOVE.B #81, D0
0000289C  223C 00EEEEEE           1576     MOVE.L #COLBUTHV, D1
000028A2  4E4F                    1577     TRAP #15
000028A4  4CDF 7FFF               1578     MOVEM.L (A7)+, D0-D7/A0-A6
000028A8                          1579      ;END SET FILL COLOR
000028A8  3F3C 00F9               1580     MOVE.W #249, -(A7) ;COORDENADA Y 
000028AC  3F3C 0136               1581     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
000028B0  3F3C FFEA               1582     MOVE.W #-22, -(A7)
000028B4  4EB9 000028C2           1583     JSR TRIANGLE
000028BA  3C1F                    1584     MOVE.W (A7)+, D6
000028BC  3C1F                    1585     MOVE.W (A7)+, D6
000028BE  3C1F                    1586     MOVE.W (A7)+, D6
000028C0                          1587     ;MOVEM.L (A7)+, D0-D7/A0-A6
000028C0                          1588  
000028C0  4E75                    1589     RTS
000028C2                          1590  ; ------------------------------------------------------------------------------
000028C2                          1591  TRIANGLE
000028C2                          1592  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
000028C2                          1593  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
000028C2                          1594  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
000028C2                          1595  ;            SIDES LENGTH (WORD) IN THAT ORDER
000028C2                          1596  ; OUTPUT   : NONE
000028C2                          1597  ; MODIFIES : NONE
000028C2                          1598  ; ------------------------------------------------------------------------------
000028C2  48A7 F800               1599      MOVEM.W D0-D4, -(A7)
000028C6                          1600      ; LINE FROM LEFT TO RIGHT
000028C6  103C 0054               1601      MOVE.B  #84,D0      ; TASK NUMBER
000028CA  322F 0010               1602      MOVE.W  16(A7),D1   ; X POSITION FROM
000028CE  342F 0012               1603      MOVE.W  18(A7),D2   ; Y POSITION FROM
000028D2  3802                    1604      MOVE.W  D2,D4       ; Y POSITION TO
000028D4  362F 000E               1605      MOVE.W  14(A7),D3   ; LENGTH
000028D8                          1606      
000028D8  6A00 0004               1607      BPL.W   .UPWARDS
000028DC  4443                    1608      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
000028DE                          1609  .UPWARDS
000028DE  D641                    1610      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
000028E0  4E4F                    1611      TRAP    #15         ; HORIZONTAL LINE DRAWN
000028E2                          1612      ; LINE FROM RIGHT TO UP/DOWN
000028E2  9641                    1613      SUB.W   D1,D3       ; I GET LENGTH IN D3
000028E4  3001                    1614      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
000028E6  D243                    1615      ADD.W   D3,D1       ; X POSITION FROM
000028E8  E24B                    1616      LSR.W   #1,D3       ; LENGTH/2
000028EA  D640                    1617      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
000028EC                          1618      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
000028EC  D86F 000E               1619      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
000028F0  103C 0054               1620      MOVE.B  #84,D0
000028F4  4E4F                    1621      TRAP    #15
000028F6                          1622      ; LINE FROM LEFT TO UP/DOWN
000028F6  322F 0010               1623      MOVE.W  16(A7),D1   ; X POSITION FROM
000028FA  4E4F                    1624      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
000028FC                          1625      
000028FC                          1626      ; FILLING TRIANGLE
000028FC  103C 0059               1627      MOVE.B  #89,D0
00002900  5241                    1628      ADDQ.W  #1,D1
00002902  363C 0001               1629      MOVE.W  #1,D3
00002906  4A6F 000E               1630      TST.W   14(A7)
0000290A  6A00 0004               1631      BPL.W   .ISPOSITIVE
0000290E  4443                    1632      NEG.W   D3
00002910                          1633  .ISPOSITIVE
00002910  D443                    1634      ADD.W   D3,D2
00002912  4E4F                    1635      TRAP    #15
00002914                          1636      
00002914  4C9F 001F               1637      MOVEM.W (A7)+,D0-D4
00002918  4E75                    1638      RTS
0000291A                          1639      
0000291A                          1640      
0000291A                          1641  ELEVATORUPDATE ; 1 = up 3 = down
0000291A  3F00                    1642      MOVE.W D0, -(A7)
0000291C  3039 00003798           1643      MOVE.W LOADEDMAP, D0
00002922  B07C 0000               1644      CMP #0, D0
00002926  6700 0006               1645      BEQ ESMENU
0000292A  301F                    1646      MOVE.W (A7)+, D0
0000292C  4E75                    1647      RTS
0000292E                          1648  ESMENU
0000292E  301F                    1649      MOVE.W (A7)+, D0
00002930  0839 0005 00003782      1650      BTST #5, KBDVAL
00002938  6600 0022               1651      BNE HLSEL
0000293C  0839 0007 00003782      1652      BTST #7, KBDVAL
00002944  6600 0004               1653      BNE HVSEL
00002948  4E75                    1654      RTS
0000294A                          1655  HVSEL   ;LOAD 1ST HEAVEN MAP
0000294A  13FC 0000 0000379A      1656      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
00002952  33FC 0001 00003798      1657      MOVE.W #1, LOADEDMAP    
0000295A  4E75                    1658      RTS
0000295C                          1659  HLSEL   ;LOAD 1ST HELL MAP
0000295C  13FC 0000 0000379A      1660      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
00002964  33FC 0005 00003798      1661      MOVE.W #5, LOADEDMAP
0000296C  4E75                    1662      RTS
0000296E                          1663      
0000296E                          1664          
0000296E                          1665  
0000296E                          1666  
0000296E                          1667  
0000296E                          1668  
0000296E                          1669  -------------------- end include --------------------
0000296E                          1670              INCLUDE "PLAYER.X68"    
0000296E                          1671  ; ==============================================================================
0000296E                          1672  ; PLAYER MANAGEMENT
0000296E                          1673  ; ==============================================================================
0000296E                          1674              
0000296E                          1675  ; ------------------------------------------------------------------------------
0000296E                          1676  PLAYERINIT
0000296E                          1677  ; INITIALIZE PLAYER.
0000296E                          1678  ; INPUT    : NONE 
0000296E                          1679  ; OUTPUT   : NONE
0000296E                          1680  ; MODIFIES : NONE
0000296E                          1681  ; ------------------------------------------------------------------------------
0000296E  4E75                    1682              RTS
00002970                          1683              
00002970                          1684  ; ------------------------------------------------------------------------------
00002970                          1685  PLAYERUPD
00002970                          1686  ; UPDATES THE PLAYER.
00002970                          1687  ; INPUT    : NONE 
00002970                          1688  ; OUTPUT   : NONE
00002970                          1689  ; MODIFIES : NONE
00002970                          1690  ; ------------------------------------------------------------------------------
00002970                          1691              ;;CHECK LIMITS IN MAPS
00002970  3F00                    1692                  MOVE.W D0, -(A7)
00002972  3039 00003798           1693              MOVE.W LOADEDMAP, D0
00002978  B07C 0000               1694              CMP #0, D0
0000297C  6700 0046               1695              BEQ NOLIMITMENU
00002980  B07C 0001               1696              CMP #1, D0
00002984  6700 0056               1697              BEQ LIMAPA1
00002988  B07C 0002               1698              CMP #2, D0
0000298C  6700 014C               1699              BEQ LIMAPA2
00002990  B07C 0003               1700              CMP #3, D0
00002994  6700 0354               1701              BEQ LIMAPA3
00002998  B07C 0004               1702              CMP #4, D0
0000299C  6700 0444               1703              BEQ LIMAPA4
000029A0  B07C 0005               1704              CMP #5, D0
000029A4  6700 0534               1705              BEQ LIMAPA5
000029A8  B07C 0006               1706              CMP #6, D0
000029AC  6700 06D4               1707              BEQ LIMAPA6
000029B0  B07C 0007               1708              CMP #7, D0
000029B4  6700 0880               1709              BEQ LIMAPA7
000029B8  B07C 0008               1710              CMP #8, D0
000029BC  6700 0970               1711              BEQ LIMAPA8
000029C0  301F                    1712              MOVE.W (A7)+, D0
000029C2                          1713  
000029C2  4E75                    1714              RTS
000029C4                          1715  NOLIMITMENU
000029C4  33FC 0080 0000378A      1716      MOVE.W #128, PLAYERPOSX
000029CC  33FC 0080 0000378C      1717      MOVE.W #128, PLAYERPOSY
000029D4  301F                    1718      MOVE.W (A7)+, D0
000029D6  4EF9 00003426           1719      JMP NOLIMIT
000029DC                          1720  LIMAPA1
000029DC  301F                    1721      MOVE.W (A7)+, D0
000029DE  48A7 F800               1722      MOVEM.W D0-D4, -(A7)
000029E2  3039 0000378A           1723      MOVE.W PLAYERPOSX, D0
000029E8  3239 0000378C           1724      MOVE.W PLAYERPOSY, D1
000029EE                          1725      ;CHECK FOR WALLS IN MAP 1
000029EE                          1726      ;CHECK UPPER WALL 
000029EE  B07C 0280               1727      CMP #640, D0  ; BGT = 352 > D0
000029F2  6E00 0026               1728      BGT MAP1NOLIMIT1   
000029F6  B07C 0000               1729      CMP #0, D0
000029FA  6D00 001E               1730      BLT MAP1NOLIMIT1
000029FE                          1731      ;NOW WE CHECK POS Y 
000029FE  B27C 0060               1732      CMP #96, D1  ; 
00002A02  6E00 0016               1733      BGT MAP1NOLIMIT1    
00002A06  B27C 0000               1734      CMP #0, D1
00002A0A  6D00 000E               1735      BLT MAP1NOLIMIT1
00002A0E                          1736      ;;;; AQUI PISA EL LIMITE
00002A0E  4C9F 001F               1737      MOVEM.W (A7)+, D0-D4
00002A12  5279 0000378C           1738      ADD.W #1, PLAYERPOSY
00002A18  4E75                    1739      RTS
00002A1A                          1740  MAP1NOLIMIT1
00002A1A                          1741      ;CHECK FOR RIGHT WALL   
00002A1A  B07C 0220               1742      CMP #544, D0  ; BGT = 352 > D0
00002A1E  6E00 0026               1743      BGT MAP1NOLIMIT2    
00002A22  B07C 0200               1744      CMP #512, D0
00002A26  6D00 001E               1745      BLT MAP1NOLIMIT2
00002A2A                          1746      ;NOW WE CHECK POS Y 
00002A2A  B27C 0280               1747      CMP #640, D1  ; 
00002A2E  6E00 0016               1748      BGT MAP1NOLIMIT2    
00002A32  B27C 0000               1749      CMP #0, D1
00002A36  6D00 000E               1750      BLT MAP1NOLIMIT2
00002A3A                          1751      ;;;; AQUI PISA EL LIMITE
00002A3A  4C9F 001F               1752      MOVEM.W (A7)+, D0-D4
00002A3E  5379 0000378A           1753      SUB.W #1, PLAYERPOSX
00002A44  4E75                    1754      RTS
00002A46                          1755  MAP1NOLIMIT2 
00002A46                          1756      ;CHECK FOR BOTTOM-RIGHT WALL
00002A46  B07C 0280               1757      CMP #640, D0  ; BGT = 352 > D0
00002A4A  6E00 002C               1758      BGT MAP1NOLIMIT3    
00002A4E  B07C 0140               1759      CMP #320, D0
00002A52  6D00 0024               1760      BLT MAP1NOLIMIT3
00002A56                          1761      ;NOW WE CHECK POS Y 
00002A56  B27C 01E0               1762      CMP #480, D1  ; 
00002A5A  6E00 001C               1763      BGT MAP1NOLIMIT3    
00002A5E  B27C 0180               1764      CMP #384, D1
00002A62  6D00 0014               1765      BLT MAP1NOLIMIT3
00002A66                          1766      ;;;; AQUI PISA EL LIMITE
00002A66  4C9F 001F               1767      MOVEM.W (A7)+, D0-D4
00002A6A  5279 0000378A           1768      ADD.W #1, PLAYERPOSX
00002A70  5379 0000378C           1769      SUB.W #1, PLAYERPOSY
00002A76  4E75                    1770      RTS
00002A78                          1771  MAP1NOLIMIT3
00002A78                          1772      ;CHECK FOR BOTTOM-LEFT WALL 
00002A78  B07C 0120               1773      CMP #288, D0  ; BGT = 352 > D0
00002A7C  6E00 0026               1774      BGT MAP1NOLIMIT4    
00002A80  B07C 0000               1775      CMP #0, D0
00002A84  6D00 001E               1776      BLT MAP1NOLIMIT4
00002A88                          1777      ;NOW WE CHECK POS Y 
00002A88  B27C 01E0               1778      CMP #480, D1  ; 
00002A8C  6E00 0016               1779      BGT MAP1NOLIMIT4    
00002A90  B27C 0180               1780      CMP #384, D1
00002A94  6D00 000E               1781      BLT MAP1NOLIMIT4
00002A98                          1782      ;;;; AQUI PISA EL LIMITE
00002A98  4C9F 001F               1783      MOVEM.W (A7)+, D0-D4
00002A9C  5379 0000378C           1784      SUB.W #1, PLAYERPOSY
00002AA2  4E75                    1785      RTS
00002AA4                          1786  MAP1NOLIMIT4 
00002AA4                          1787      ;CHECK FOR BOTTOM-LEFT WALL 
00002AA4  B07C 0060               1788      CMP #96, D0  ; BGT = 352 > D0
00002AA8  6E00 0026               1789      BGT MAP1NOLIMITEND    
00002AAC  B07C 0000               1790      CMP #0, D0
00002AB0  6D00 001E               1791      BLT MAP1NOLIMITEND
00002AB4                          1792      ;NOW WE CHECK POS Y 
00002AB4  B27C 0280               1793      CMP #640, D1  ; 
00002AB8  6E00 0016               1794      BGT MAP1NOLIMITEND    
00002ABC  B27C 0000               1795      CMP #0, D1
00002AC0  6D00 000E               1796      BLT MAP1NOLIMITEND
00002AC4                          1797      ;;;; AQUI PISA EL LIMITE
00002AC4  4C9F 001F               1798      MOVEM.W (A7)+, D0-D4
00002AC8  5279 0000378A           1799      ADD.W #1, PLAYERPOSX
00002ACE  4E75                    1800      RTS
00002AD0                          1801  MAP1NOLIMITEND
00002AD0  4C9F 001F               1802      MOVEM.W (A7)+, D0-D4
00002AD4  4EF9 00003426           1803      JMP NOLIMIT
00002ADA                          1804      
00002ADA                          1805  LIMAPA2
00002ADA  301F                    1806      MOVE.W (A7)+, D0
00002ADC  48A7 F800               1807      MOVEM.W D0-D4, -(A7)
00002AE0  3039 0000378A           1808      MOVE.W PLAYERPOSX, D0
00002AE6  3239 0000378C           1809      MOVE.W PLAYERPOSY, D1
00002AEC                          1810      ;CHECK FOR TOP-LEFT WALL 
00002AEC  B07C 0120               1811      CMP #288, D0  ; BGT = 352 > D0
00002AF0  6E00 002C               1812      BGT MAP2NOLIMIT1    
00002AF4  B07C 0000               1813      CMP #0, D0
00002AF8  6D00 0024               1814      BLT MAP2NOLIMIT1
00002AFC                          1815      ;NOW WE CHECK POS Y 
00002AFC  B27C 0060               1816      CMP #96, D1  ; 
00002B00  6E00 001C               1817      BGT MAP2NOLIMIT1    
00002B04  B27C 0000               1818      CMP #0, D1
00002B08  6D00 0014               1819      BLT MAP2NOLIMIT1
00002B0C                          1820      ;;;; AQUI PISA EL LIMITE
00002B0C  4C9F 001F               1821      MOVEM.W (A7)+, D0-D4
00002B10  5279 0000378C           1822      ADD.W #1, PLAYERPOSY
00002B16  5279 0000378A           1823      ADD.W #1, PLAYERPOSX
00002B1C  4E75                    1824      RTS
00002B1E                          1825  MAP2NOLIMIT1
00002B1E                          1826      ;CHECK FOR LEFT-UPPER-DOOR WALL
00002B1E  B07C 00C0               1827      CMP #192, D0  ; BGT = 352 > D0
00002B22  6E00 002C               1828      BGT MAP2NOLIMIT2    
00002B26  B07C 0000               1829      CMP #0, D0
00002B2A  6D00 0024               1830      BLT MAP2NOLIMIT2
00002B2E                          1831      ;NOW WE CHECK POS Y 
00002B2E  B27C 009F               1832      CMP #159, D1  ; 
00002B32  6E00 001C               1833      BGT MAP2NOLIMIT2    
00002B36  B27C 0000               1834      CMP #0, D1
00002B3A  6D00 0014               1835      BLT MAP2NOLIMIT2
00002B3E                          1836      ;;;; AQUI PISA EL LIMITE
00002B3E  4C9F 001F               1837      MOVEM.W (A7)+, D0-D4
00002B42  5279 0000378A           1838      ADD.W #1, PLAYERPOSX
00002B48  5279 0000378C           1839      ADD.W #1, PLAYERPOSY
00002B4E  4E75                    1840      RTS
00002B50                          1841  MAP2NOLIMIT2
00002B50                          1842      ;CHECK FOR LEFT-BOTTOM-DOOR WALL
00002B50  B07C 00C0               1843      CMP #192, D0  ; BGT = 352 > D0
00002B54  6E00 002C               1844      BGT MAP2NOLIMIT3    
00002B58  B07C 0000               1845      CMP #0, D0
00002B5C  6D00 0024               1846      BLT MAP2NOLIMIT3
00002B60                          1847      ;NOW WE CHECK POS Y 
00002B60  B27C 01E0               1848      CMP #480, D1  ; 
00002B64  6E00 001C               1849      BGT MAP2NOLIMIT3    
00002B68  B27C 00A2               1850      CMP #162, D1
00002B6C  6D00 0014               1851      BLT MAP2NOLIMIT3
00002B70                          1852      ;;;; AQUI PISA EL LIMITE
00002B70  4C9F 001F               1853      MOVEM.W (A7)+, D0-D4
00002B74  5279 0000378A           1854      ADD.W #1, PLAYERPOSX
00002B7A  5379 0000378C           1855      SUB.W #1, PLAYERPOSY
00002B80  4E75                    1856      RTS
00002B82                          1857  MAP2NOLIMIT3
00002B82                          1858      ;CHECK FOR LEFT CORNER
00002B82  B07C 00E0               1859      CMP #224, D0  ; BGT = 352 > D0
00002B86  6E00 002C               1860      BGT MAP2NOLIMIT4    
00002B8A  B07C 0000               1861      CMP #0, D0
00002B8E  6D00 0024               1862      BLT MAP2NOLIMIT4
00002B92                          1863      ;NOW WE CHECK POS Y 
00002B92  B27C 01E0               1864      CMP #480, D1  ; 
00002B96  6E00 001C               1865      BGT MAP2NOLIMIT4    
00002B9A  B27C 0100               1866      CMP #256, D1
00002B9E  6D00 0014               1867      BLT MAP2NOLIMIT4
00002BA2                          1868      ;;;; AQUI PISA EL LIMITE
00002BA2  4C9F 001F               1869      MOVEM.W (A7)+, D0-D4
00002BA6  5279 0000378A           1870      ADD.W #1, PLAYERPOSX
00002BAC  5379 0000378C           1871      SUB.W #1, PLAYERPOSY
00002BB2  4E75                    1872      RTS
00002BB4                          1873  MAP2NOLIMIT4
00002BB4                          1874      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002BB4  B07C 0120               1875      CMP #288, D0  ; BGT = 352 > D0
00002BB8  6E00 002C               1876      BGT MAP2NOLIMIT5    
00002BBC  B07C 00E0               1877      CMP #224, D0
00002BC0  6D00 0024               1878      BLT MAP2NOLIMIT5
00002BC4                          1879      ;NOW WE CHECK POS Y 
00002BC4  B27C 01E0               1880      CMP #480, D1  ; 
00002BC8  6E00 001C               1881      BGT MAP2NOLIMIT5    
00002BCC  B27C 0120               1882      CMP #288, D1
00002BD0  6D00 0014               1883      BLT MAP2NOLIMIT5
00002BD4                          1884      ;;;; AQUI PISA EL LIMITE
00002BD4  4C9F 001F               1885      MOVEM.W (A7)+, D0-D4
00002BD8  5279 0000378A           1886      ADD.W #1, PLAYERPOSX
00002BDE  5379 0000378C           1887      SUB.W #1, PLAYERPOSY
00002BE4  4E75                    1888      RTS
00002BE6                          1889  MAP2NOLIMIT5
00002BE6                          1890      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002BE6  B07C 0280               1891      CMP #640, D0  ; BGT = 352 > D0
00002BEA  6E00 002C               1892      BGT MAP2NOLIMIT6    
00002BEE  B07C 0140               1893      CMP #320, D0
00002BF2  6D00 0024               1894      BLT MAP2NOLIMIT6
00002BF6                          1895      ;NOW WE CHECK POS Y 
00002BF6  B27C 01E0               1896      CMP #480, D1  ; 
00002BFA  6E00 001C               1897      BGT MAP2NOLIMIT6    
00002BFE  B27C 0120               1898      CMP #288, D1
00002C02  6D00 0014               1899      BLT MAP2NOLIMIT6
00002C06                          1900      ;;;; AQUI PISA EL LIMITE
00002C06  4C9F 001F               1901      MOVEM.W (A7)+, D0-D4
00002C0A  5379 0000378A           1902      SUB.W #1, PLAYERPOSX
00002C10  5379 0000378C           1903      SUB.W #1, PLAYERPOSY
00002C16  4E75                    1904      RTS
00002C18                          1905  MAP2NOLIMIT6
00002C18                          1906  ;CHECK FOR RIGHT CORNER
00002C18  B07C 0280               1907      CMP #640, D0  ; BGT = 352 > D0
00002C1C  6E00 002C               1908      BGT MAP2NOLIMIT7    
00002C20  B07C 0180               1909      CMP #384, D0
00002C24  6D00 0024               1910      BLT MAP2NOLIMIT7
00002C28                          1911      ;NOW WE CHECK POS Y 
00002C28  B27C 01E0               1912      CMP #480, D1  ; 
00002C2C  6E00 001C               1913      BGT MAP2NOLIMIT7    
00002C30  B27C 0100               1914      CMP #256, D1
00002C34  6D00 0014               1915      BLT MAP2NOLIMIT7
00002C38                          1916      ;;;; AQUI PISA EL LIMITE
00002C38  4C9F 001F               1917      MOVEM.W (A7)+, D0-D4
00002C3C  5379 0000378A           1918      SUB.W #1, PLAYERPOSX
00002C42  5379 0000378C           1919      SUB.W #1, PLAYERPOSY
00002C48  4E75                    1920      RTS
00002C4A                          1921  MAP2NOLIMIT7
00002C4A                          1922      ;CHECK FOR RIGHT-BOTTOM-DOOR WALL
00002C4A  B07C 0280               1923      CMP #640, D0  ; BGT = 352 > D0
00002C4E  6E00 002C               1924      BGT MAP2NOLIMIT8    
00002C52  B07C 01A0               1925      CMP #416, D0
00002C56  6D00 0024               1926      BLT MAP2NOLIMIT8
00002C5A                          1927      ;NOW WE CHECK POS Y 
00002C5A  B27C 01E0               1928      CMP #480, D1  ; 
00002C5E  6E00 001C               1929      BGT MAP2NOLIMIT8    
00002C62  B27C 00A2               1930      CMP #162, D1
00002C66  6D00 0014               1931      BLT MAP2NOLIMIT8
00002C6A                          1932      ;;;; AQUI PISA EL LIMITE
00002C6A  4C9F 001F               1933      MOVEM.W (A7)+, D0-D4
00002C6E  5379 0000378A           1934      SUB.W #1, PLAYERPOSX
00002C74  5379 0000378C           1935      SUB.W #1, PLAYERPOSY
00002C7A  4E75                    1936      RTS
00002C7C                          1937  MAP2NOLIMIT8
00002C7C                          1938  ;CHECK FOR RIGHT-TOP-DOOR WALL
00002C7C  B07C 0280               1939      CMP #640, D0  ; BGT = 352 > D0
00002C80  6E00 002C               1940      BGT MAP2NOLIMIT9    
00002C84  B07C 01A0               1941      CMP #416, D0
00002C88  6D00 0024               1942      BLT MAP2NOLIMIT9
00002C8C                          1943      ;NOW WE CHECK POS Y 
00002C8C  B27C 00A0               1944      CMP #160, D1  ; 
00002C90  6E00 001C               1945      BGT MAP2NOLIMIT9    
00002C94  B27C 0000               1946      CMP #0, D1
00002C98  6D00 0014               1947      BLT MAP2NOLIMIT9
00002C9C                          1948      ;;;; AQUI PISA EL LIMITE
00002C9C  4C9F 001F               1949      MOVEM.W (A7)+, D0-D4
00002CA0  5379 0000378A           1950      SUB.W #1, PLAYERPOSX
00002CA6  5279 0000378C           1951      ADD.W #1, PLAYERPOSY
00002CAC  4E75                    1952      RTS
00002CAE                          1953  MAP2NOLIMIT9
00002CAE                          1954      ;CHECK FOR TOP RIGHT CORNER
00002CAE  B07C 0280               1955      CMP #640, D0  ; BGT = 352 > D0
00002CB2  6E00 002C               1956      BGT MAP2NOLIMIT10    
00002CB6  B07C 0140               1957      CMP #320, D0
00002CBA  6D00 0024               1958      BLT MAP2NOLIMIT10
00002CBE                          1959      ;NOW WE CHECK POS Y 
00002CBE  B27C 0060               1960      CMP #96, D1  ; 
00002CC2  6E00 001C               1961      BGT MAP2NOLIMIT10   
00002CC6  B27C 0000               1962      CMP #0, D1
00002CCA  6D00 0014               1963      BLT MAP2NOLIMIT10
00002CCE                          1964      ;;;; AQUI PISA EL LIMITE
00002CCE  4C9F 001F               1965      MOVEM.W (A7)+, D0-D4
00002CD2  5379 0000378A           1966      SUB.W #1, PLAYERPOSX
00002CD8  5279 0000378C           1967      ADD.W #1, PLAYERPOSY
00002CDE  4E75                    1968      RTS
00002CE0                          1969  MAP2NOLIMIT10
00002CE0  4C9F 001F               1970      MOVEM.W (A7)+, D0-D4
00002CE4  4EF9 00003426           1971      JMP NOLIMIT
00002CEA                          1972  LIMAPA3
00002CEA  301F                    1973      MOVE.W (A7)+, D0
00002CEC  48A7 F800               1974      MOVEM.W D0-D4, -(A7)
00002CF0  3039 0000378A           1975      MOVE.W PLAYERPOSX, D0
00002CF6  3239 0000378C           1976      MOVE.W PLAYERPOSY, D1
00002CFC                          1977      ;CHECK FOR TOP-LEFT WALL 
00002CFC  B07C 0120               1978      CMP #288, D0  ; BGT = 352 > D0
00002D00  6E00 0026               1979      BGT MAP3NOLIMIT1    
00002D04  B07C 0000               1980      CMP #0, D0
00002D08  6D00 001E               1981      BLT MAP3NOLIMIT1
00002D0C                          1982      ;NOW WE CHECK POS Y 
00002D0C  B27C 0020               1983      CMP #32, D1  ; 
00002D10  6E00 0016               1984      BGT MAP3NOLIMIT1    
00002D14  B27C 0000               1985      CMP #0, D1
00002D18  6D00 000E               1986      BLT MAP3NOLIMIT1
00002D1C                          1987      ;;;; AQUI PISA EL LIMITE
00002D1C  5279 0000378C           1988      ADD.W #1, PLAYERPOSY
00002D22  4C9F 001F               1989      MOVEM.W (A7)+, D0-D4
00002D26  4E75                    1990      RTS
00002D28                          1991  MAP3NOLIMIT1
00002D28                          1992      ;CHECK FOR LEFT WALL
00002D28  B07C 0020               1993      CMP #32, D0  ; BGT = 352 > D0
00002D2C  6E00 0026               1994      BGT MAP3NOLIMIT2    
00002D30  B07C 0000               1995      CMP #0, D0
00002D34  6D00 001E               1996      BLT MAP3NOLIMIT2
00002D38                          1997      ;NOW WE CHECK POS Y 
00002D38  B27C 01E0               1998      CMP #480, D1  ; 
00002D3C  6E00 0016               1999      BGT MAP3NOLIMIT2    
00002D40  B27C 0000               2000      CMP #0, D1
00002D44  6D00 000E               2001      BLT MAP3NOLIMIT2
00002D48                          2002      ;;;; AQUI PISA EL LIMITE
00002D48  5279 0000378A           2003      ADD.W #1, PLAYERPOSX
00002D4E  4C9F 001F               2004      MOVEM.W (A7)+, D0-D4
00002D52  4E75                    2005      RTS
00002D54                          2006  MAP3NOLIMIT2
00002D54                          2007      ;CHECK FOR BOTTOM WALL
00002D54  B07C 0280               2008      CMP #640, D0  ; BGT = 352 > D0
00002D58  6E00 0026               2009      BGT MAP3NOLIMIT3    
00002D5C  B07C 0000               2010      CMP #0, D0
00002D60  6D00 001E               2011      BLT MAP3NOLIMIT3
00002D64                          2012      ;NOW WE CHECK POS Y 
00002D64  B27C 01E0               2013      CMP #480, D1  ; 
00002D68  6E00 0016               2014      BGT MAP3NOLIMIT3    
00002D6C  B27C 01A0               2015      CMP #416, D1
00002D70  6D00 000E               2016      BLT MAP3NOLIMIT3
00002D74                          2017      ;;;; AQUI PISA EL LIMITE
00002D74  5379 0000378C           2018      SUB.W #1, PLAYERPOSY
00002D7A  4C9F 001F               2019      MOVEM.W (A7)+, D0-D4
00002D7E  4E75                    2020      RTS
00002D80                          2021  MAP3NOLIMIT3
00002D80                          2022      ;CHECK FOR RIGHT WALL
00002D80  B07C 0280               2023      CMP #640, D0  ; BGT = 352 > D0
00002D84  6E00 0026               2024      BGT MAP3NOLIMIT4    
00002D88  B07C 0240               2025      CMP #576, D0
00002D8C  6D00 001E               2026      BLT MAP3NOLIMIT4
00002D90                          2027      ;NOW WE CHECK POS Y 
00002D90  B27C 01E0               2028      CMP #480, D1  ; 
00002D94  6E00 0016               2029      BGT MAP3NOLIMIT4    
00002D98  B27C 0000               2030      CMP #0, D1
00002D9C  6D00 000E               2031      BLT MAP3NOLIMIT4
00002DA0                          2032      ;;;; AQUI PISA EL LIMITE
00002DA0  5379 0000378A           2033      SUB.W #1, PLAYERPOSX
00002DA6  4C9F 001F               2034      MOVEM.W (A7)+, D0-D4
00002DAA  4E75                    2035      RTS
00002DAC                          2036  MAP3NOLIMIT4
00002DAC                          2037      ;CHECK TOP-RIGHT WALL
00002DAC  B07C 0280               2038      CMP #640, D0  ; BGT = 352 > D0
00002DB0  6E00 0026               2039      BGT MAP3NOLIMIT5    
00002DB4  B07C 0160               2040      CMP #352, D0
00002DB8  6D00 001E               2041      BLT MAP3NOLIMIT5
00002DBC                          2042      ;NOW WE CHECK POS Y 
00002DBC  B27C 0020               2043      CMP #32, D1  ; 
00002DC0  6E00 0016               2044      BGT MAP3NOLIMIT5    
00002DC4  B27C 0000               2045      CMP #0, D1
00002DC8  6D00 000E               2046      BLT MAP3NOLIMIT5
00002DCC                          2047      ;;;; AQUI PISA EL LIMITE
00002DCC  5279 0000378C           2048      ADD.W #1, PLAYERPOSY
00002DD2  4C9F 001F               2049      MOVEM.W (A7)+, D0-D4
00002DD6  4E75                    2050      RTS
00002DD8                          2051  MAP3NOLIMIT5
00002DD8  4C9F 001F               2052      MOVEM.W (A7)+, D0-D4
00002DDC  4EF9 00003426           2053      JMP NOLIMIT
00002DE2                          2054      
00002DE2                          2055  LIMAPA4
00002DE2  301F                    2056      MOVE.W (A7)+, D0
00002DE4  48A7 F800               2057      MOVEM.W D0-D4, -(A7)
00002DE8  3039 0000378A           2058      MOVE.W PLAYERPOSX, D0
00002DEE  3239 0000378C           2059      MOVE.W PLAYERPOSY, D1
00002DF4                          2060      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00002DF4                          2061      ;CHECK UPPER LEFT WALL 
00002DF4  B07C 0120               2062      CMP #288, D0  ; BGT = 352 > D0
00002DF8  6E00 0026               2063      BGT MAP4NOLIMIT1   
00002DFC  B07C 0000               2064      CMP #0, D0
00002E00  6D00 001E               2065      BLT MAP4NOLIMIT1
00002E04                          2066      ;NOW WE CHECK POS Y 
00002E04  B27C 00A0               2067      CMP #160, D1  ; 
00002E08  6E00 0016               2068      BGT MAP4NOLIMIT1    
00002E0C  B27C 0000               2069      CMP #0, D1
00002E10  6D00 000E               2070      BLT MAP4NOLIMIT1
00002E14                          2071      ;;;; AQUI PISA EL LIMITE
00002E14  4C9F 001F               2072      MOVEM.W (A7)+, D0-D4
00002E18  5279 0000378C           2073      ADD.W #1, PLAYERPOSY
00002E1E  4E75                    2074      RTS
00002E20                          2075  MAP4NOLIMIT1
00002E20                          2076      ;CHECK BOTTOM WALL
00002E20  B07C 0280               2077      CMP #640, D0  ; BGT = 352 > D0
00002E24  6E00 0026               2078      BGT MAP4NOLIMIT2   
00002E28  B07C 0000               2079      CMP #0, D0
00002E2C  6D00 001E               2080      BLT MAP4NOLIMIT2
00002E30                          2081      ;NOW WE CHECK POS Y 
00002E30  B27C 01E0               2082      CMP #480, D1  ; 
00002E34  6E00 0016               2083      BGT MAP4NOLIMIT2    
00002E38  B27C 0120               2084      CMP #288, D1
00002E3C  6D00 000E               2085      BLT MAP4NOLIMIT2
00002E40                          2086      ;;;; AQUI PISA EL LIMITE
00002E40  4C9F 001F               2087      MOVEM.W (A7)+, D0-D4
00002E44  5379 0000378C           2088      SUB.W #1, PLAYERPOSY
00002E4A  4E75                    2089      RTS
00002E4C                          2090  MAP4NOLIMIT2
00002E4C                          2091      ;CHECK LEFT WALL
00002E4C  B07C 00C0               2092      CMP #192, D0  ; BGT = 352 > D0
00002E50  6E00 0026               2093      BGT MAP4NOLIMIT3   
00002E54  B07C 0000               2094      CMP #0, D0
00002E58  6D00 001E               2095      BLT MAP4NOLIMIT3
00002E5C                          2096      ;NOW WE CHECK POS Y 
00002E5C  B27C 01E0               2097      CMP #480, D1  ; 
00002E60  6E00 0016               2098      BGT MAP4NOLIMIT3    
00002E64  B27C 0000               2099      CMP #0, D1
00002E68  6D00 000E               2100      BLT MAP4NOLIMIT3
00002E6C                          2101      ;;;; AQUI PISA EL LIMITE
00002E6C  4C9F 001F               2102      MOVEM.W (A7)+, D0-D4
00002E70  5279 0000378A           2103      ADD.W #1, PLAYERPOSX
00002E76  4E75                    2104      RTS
00002E78                          2105  MAP4NOLIMIT3
00002E78                          2106      ;CHECK RIGHT WALL
00002E78  B07C 0280               2107      CMP #640, D0  ; BGT = 352 > D0
00002E7C  6E00 0026               2108      BGT MAP4NOLIMIT4   
00002E80  B07C 01A0               2109      CMP #416, D0
00002E84  6D00 001E               2110      BLT MAP4NOLIMIT4
00002E88                          2111      ;NOW WE CHECK POS Y 
00002E88  B27C 01E0               2112      CMP #480, D1  ; 
00002E8C  6E00 0016               2113      BGT MAP4NOLIMIT4    
00002E90  B27C 0000               2114      CMP #0, D1
00002E94  6D00 000E               2115      BLT MAP4NOLIMIT4
00002E98                          2116      ;;;; AQUI PISA EL LIMITE
00002E98  4C9F 001F               2117      MOVEM.W (A7)+, D0-D4
00002E9C  5379 0000378A           2118      SUB.W #1, PLAYERPOSX
00002EA2  4E75                    2119      RTS
00002EA4                          2120  MAP4NOLIMIT4
00002EA4                          2121  ;CHECK TOP RIGHT WALL
00002EA4  B07C 0280               2122      CMP #640, D0  ; BGT = 352 > D0
00002EA8  6E00 0026               2123      BGT MAP4NOLIMIT5   
00002EAC  B07C 0160               2124      CMP #352, D0
00002EB0  6D00 001E               2125      BLT MAP4NOLIMIT5
00002EB4                          2126      ;NOW WE CHECK POS Y 
00002EB4  B27C 00A0               2127      CMP #160, D1  ; 
00002EB8  6E00 0016               2128      BGT MAP4NOLIMIT5    
00002EBC  B27C 0000               2129      CMP #0, D1
00002EC0  6D00 000E               2130      BLT MAP4NOLIMIT5
00002EC4                          2131      ;;;; AQUI PISA EL LIMITE
00002EC4  4C9F 001F               2132      MOVEM.W (A7)+, D0-D4
00002EC8  5279 0000378C           2133      ADD.W #1, PLAYERPOSY
00002ECE  4E75                    2134      RTS
00002ED0                          2135  MAP4NOLIMIT5
00002ED0  4C9F 001F               2136      MOVEM.W (A7)+, D0-D4
00002ED4  4EF9 00003426           2137      JMP NOLIMIT
00002EDA                          2138  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;END HEAVEN MAPS
00002EDA                          2139  LIMAPA5
00002EDA  301F                    2140      MOVE.W (A7)+, D0
00002EDC  48A7 F800               2141      MOVEM.W D0-D4, -(A7)
00002EE0  3039 0000378A           2142      MOVE.W PLAYERPOSX, D0
00002EE6  3239 0000378C           2143      MOVE.W PLAYERPOSY, D1
00002EEC                          2144      ;CHECK FOR WALLS IN MAP 5
00002EEC                          2145      ;CHECK UPPER WALL 
00002EEC  B07C 0280               2146      CMP #640, D0  ; BGT = 352 > D0
00002EF0  6E00 0026               2147      BGT MAP5NOLIMIT1   
00002EF4  B07C 0000               2148      CMP #0, D0
00002EF8  6D00 001E               2149      BLT MAP5NOLIMIT1
00002EFC                          2150      ;NOW WE CHECK POS Y 
00002EFC  B27C 0020               2151      CMP #32, D1  ; 
00002F00  6E00 0016               2152      BGT MAP5NOLIMIT1    
00002F04  B27C 0000               2153      CMP #0, D1
00002F08  6D00 000E               2154      BLT MAP5NOLIMIT1
00002F0C                          2155      ;;;; AQUI PISA EL LIMITE
00002F0C  4C9F 001F               2156      MOVEM.W (A7)+, D0-D4
00002F10  5279 0000378C           2157      ADD.W #1, PLAYERPOSY
00002F16  4E75                    2158      RTS
00002F18                          2159  MAP5NOLIMIT1
00002F18                          2160      ;CHECK FOR RIGHT WALL 
00002F18  B07C 0280               2161      CMP #640, D0  ; BGT = 352 > D0
00002F1C  6E00 0026               2162      BGT MAP5NOLIMIT2    
00002F20  B07C 0240               2163      CMP #576, D0
00002F24  6D00 001E               2164      BLT MAP5NOLIMIT2
00002F28                          2165      ;NOW WE CHECK POS Y 
00002F28  B27C 01E0               2166      CMP #480, D1  ; 
00002F2C  6E00 0016               2167      BGT MAP5NOLIMIT2    
00002F30  B27C 0000               2168      CMP #0, D1
00002F34  6D00 000E               2169      BLT MAP5NOLIMIT2
00002F38                          2170      ;;;; AQUI PISA EL LIMITE
00002F38  5379 0000378A           2171      SUB.W #1, PLAYERPOSX
00002F3E  4C9F 001F               2172      MOVEM.W (A7)+, D0-D4
00002F42  4E75                    2173      RTS
00002F44                          2174  MAP5NOLIMIT2
00002F44                          2175      ;CHECK LEFT WALL
00002F44  B07C 0020               2176          CMP #32, D0  ; BGT = 352 > D0
00002F48  6E00 0026               2177      BGT MAP5NOLIMIT3    
00002F4C  B07C 0000               2178      CMP #0, D0
00002F50  6D00 001E               2179      BLT MAP5NOLIMIT3
00002F54                          2180      ;NOW WE CHECK POS Y 
00002F54  B27C 01E0               2181      CMP #480, D1  ; 
00002F58  6E00 0016               2182      BGT MAP5NOLIMIT3    
00002F5C  B27C 0000               2183      CMP #0, D1
00002F60  6D00 000E               2184      BLT MAP5NOLIMIT3
00002F64                          2185      ;;;; AQUI PISA EL LIMITE
00002F64  5279 0000378A           2186      ADD.W #1, PLAYERPOSX
00002F6A  4C9F 001F               2187      MOVEM.W (A7)+, D0-D4
00002F6E  4E75                    2188      RTS
00002F70                          2189  MAP5NOLIMIT3
00002F70                          2190      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002F70  B07C 0120               2191      CMP #288, D0  ; BGT = 352 > D0
00002F74  6E00 0026               2192      BGT MAP5NOLIMIT4    
00002F78  B07C 0000               2193      CMP #0, D0
00002F7C  6D00 001E               2194      BLT MAP5NOLIMIT4
00002F80                          2195      ;NOW WE CHECK POS Y 
00002F80  B27C 01E0               2196      CMP #480, D1  ; 
00002F84  6E00 0016               2197      BGT MAP5NOLIMIT4    
00002F88  B27C 01A0               2198      CMP #416, D1
00002F8C  6D00 000E               2199      BLT MAP5NOLIMIT4
00002F90                          2200      ;;;; AQUI PISA EL LIMITE
00002F90  4C9F 001F               2201      MOVEM.W (A7)+, D0-D4
00002F94  5379 0000378C           2202      SUB.W #1, PLAYERPOSY
00002F9A  4E75                    2203      RTS
00002F9C                          2204  MAP5NOLIMIT4
00002F9C                          2205      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002F9C  B07C 0280               2206      CMP #640, D0  ; BGT = 352 > D0
00002FA0  6E00 0026               2207      BGT MAP5NOLIMIT5    
00002FA4  B07C 0140               2208      CMP #320, D0
00002FA8  6D00 001E               2209      BLT MAP5NOLIMIT5
00002FAC                          2210      ;NOW WE CHECK POS Y 
00002FAC  B27C 01E0               2211      CMP #480, D1  ; 
00002FB0  6E00 0016               2212      BGT MAP5NOLIMIT5    
00002FB4  B27C 01A0               2213      CMP #416, D1
00002FB8  6D00 000E               2214      BLT MAP5NOLIMIT5
00002FBC                          2215      ;;;; AQUI PISA EL LIMITE
00002FBC  4C9F 001F               2216      MOVEM.W (A7)+, D0-D4
00002FC0  5379 0000378C           2217      SUB.W #1, PLAYERPOSY
00002FC6  4E75                    2218      RTS
00002FC8                          2219  MAP5NOLIMIT5
00002FC8                          2220      ;CHECK FOR MIDDLE-LEFT WALL 1
00002FC8  B07C 0120               2221      CMP #288, D0  ; BGT = 352 > D0
00002FCC  6E00 0026               2222      BGT MAP5NOLIMIT6    
00002FD0  B07C 0000               2223      CMP #0, D0
00002FD4  6D00 001E               2224      BLT MAP5NOLIMIT6
00002FD8                          2225      ;NOW WE CHECK POS Y 
00002FD8  B27C 00F0               2226      CMP #240, D1  ; 
00002FDC  6E00 0016               2227      BGT MAP5NOLIMIT6    
00002FE0  B27C 00C0               2228      CMP #192, D1 ;224
00002FE4  6D00 000E               2229      BLT MAP5NOLIMIT6
00002FE8                          2230      ;;;; AQUI PISA EL LIMITE
00002FE8  4C9F 001F               2231      MOVEM.W (A7)+, D0-D4
00002FEC  5379 0000378C           2232      SUB.W #1, PLAYERPOSY
00002FF2  4E75                    2233      RTS
00002FF4                          2234  MAP5NOLIMIT6
00002FF4                          2235      ;CHECK FOR MIDDLE-RIGHT WALL 1
00002FF4  B07C 0280               2236      CMP #640, D0  ; BGT = 352 > D0
00002FF8  6E00 0026               2237      BGT MAP5NOLIMIT7    
00002FFC  B07C 0140               2238      CMP #320 , D0
00003000  6D00 001E               2239      BLT MAP5NOLIMIT7
00003004                          2240      ;NOW WE CHECK POS Y 
00003004  B27C 00F0               2241      CMP #240, D1  ; 
00003008  6E00 0016               2242      BGT MAP5NOLIMIT7    
0000300C  B27C 00C0               2243      CMP #192, D1 ;224
00003010  6D00 000E               2244      BLT MAP5NOLIMIT7
00003014                          2245      ;;;; AQUI PISA EL LIMITE
00003014  4C9F 001F               2246      MOVEM.W (A7)+, D0-D4
00003018  5379 0000378C           2247      SUB.W #1, PLAYERPOSY
0000301E  4E75                    2248      RTS
00003020                          2249  MAP5NOLIMIT7
00003020                          2250      ;CHECK FOR MIDDLE-RIGHT WALL 2
00003020  B07C 0280               2251      CMP #640, D0  ; BGT = 352 > D0
00003024  6E00 0026               2252      BGT MAP5NOLIMIT8    
00003028  B07C 0140               2253      CMP #320 , D0
0000302C  6D00 001E               2254      BLT MAP5NOLIMIT8
00003030                          2255      ;NOW WE CHECK POS Y 
00003030  B27C 0100               2256      CMP #256, D1  ; 
00003034  6E00 0016               2257      BGT MAP5NOLIMIT8    
00003038  B27C 00F0               2258      CMP #240, D1 ;192
0000303C  6D00 000E               2259      BLT MAP5NOLIMIT8
00003040                          2260      ;;;; AQUI PISA EL LIMITE
00003040  4C9F 001F               2261      MOVEM.W (A7)+, D0-D4
00003044  5279 0000378C           2262      ADD.W #1, PLAYERPOSY
0000304A  4E75                    2263      RTS
0000304C                          2264  MAP5NOLIMIT8
0000304C                          2265      ;CHECK FOR MIDDLE-LEFT WALL 2
0000304C  B07C 0120               2266      CMP #288, D0  ; BGT = 352 > D0
00003050  6E00 0026               2267      BGT MAP5NOLIMIT9    
00003054  B07C 0000               2268      CMP #0, D0
00003058  6D00 001E               2269      BLT MAP5NOLIMIT9
0000305C                          2270      ;NOW WE CHECK POS Y 
0000305C  B27C 0100               2271      CMP #256, D1  ; 
00003060  6E00 0016               2272      BGT MAP5NOLIMIT9    
00003064  B27C 00F0               2273      CMP #240, D1 ;224
00003068  6D00 000E               2274      BLT MAP5NOLIMIT9
0000306C                          2275      ;;;; AQUI PISA EL LIMITE
0000306C  4C9F 001F               2276      MOVEM.W (A7)+, D0-D4
00003070  5279 0000378C           2277      ADD.W #1, PLAYERPOSY
00003076  4E75                    2278      RTS
00003078                          2279  MAP5NOLIMIT9
00003078  4C9F 001F               2280      MOVEM.W (A7)+, D0-D4
0000307C  4EF9 00003426           2281      JMP NOLIMIT
00003082                          2282  
00003082                          2283      
00003082                          2284  LIMAPA6
00003082  301F                    2285      MOVE.W (A7)+, D0
00003084  48A7 F800               2286      MOVEM.W D0-D4, -(A7)
00003088  3039 0000378A           2287      MOVE.W PLAYERPOSX, D0
0000308E  3239 0000378C           2288      MOVE.W PLAYERPOSY, D1
00003094                          2289      ;CHECK FOR WALLS IN MAP 5
00003094                          2290      ;CHECK LEFT UPPER WALL 
00003094  B07C 0120               2291      CMP #288, D0  ; BGT = 352 > D0
00003098  6E00 0026               2292      BGT MAP6NOLIMIT1   
0000309C  B07C 0000               2293      CMP #0, D0
000030A0  6D00 001E               2294      BLT MAP6NOLIMIT1
000030A4                          2295      ;NOW WE CHECK POS Y 
000030A4  B27C 0020               2296      CMP #32, D1  ; 
000030A8  6E00 0016               2297      BGT MAP6NOLIMIT1    
000030AC  B27C 0000               2298      CMP #0, D1
000030B0  6D00 000E               2299      BLT MAP6NOLIMIT1
000030B4                          2300      ;;;; AQUI PISA EL LIMITE
000030B4  4C9F 001F               2301      MOVEM.W (A7)+, D0-D4
000030B8  5279 0000378C           2302      ADD.W #1, PLAYERPOSY
000030BE  4E75                    2303      RTS
000030C0                          2304  MAP6NOLIMIT1
000030C0                          2305      ;CHECK LEFT WALL
000030C0  B07C 0020               2306      CMP #32, D0  ; BGT = 352 > D0
000030C4  6E00 0026               2307      BGT MAP6NOLIMIT2    
000030C8  B07C 0000               2308      CMP #0, D0
000030CC  6D00 001E               2309      BLT MAP6NOLIMIT2
000030D0                          2310      ;NOW WE CHECK POS Y 
000030D0  B27C 01E0               2311      CMP #480, D1  ; 
000030D4  6E00 0016               2312      BGT MAP6NOLIMIT2    
000030D8  B27C 0000               2313      CMP #0, D1
000030DC  6D00 000E               2314      BLT MAP6NOLIMIT2
000030E0                          2315      ;;;; AQUI PISA EL LIMITE
000030E0  5279 0000378A           2316      ADD.W #1, PLAYERPOSX
000030E6  4C9F 001F               2317      MOVEM.W (A7)+, D0-D4
000030EA  4E75                    2318      RTS
000030EC                          2319  MAP6NOLIMIT2
000030EC                          2320      ;CHECK FOR RIGHT WALL 
000030EC  B07C 0280               2321      CMP #640, D0  ; BGT = 352 > D0
000030F0  6E00 0026               2322      BGT MAP6NOLIMIT3    
000030F4  B07C 0240               2323      CMP #576, D0
000030F8  6D00 001E               2324      BLT MAP6NOLIMIT3
000030FC                          2325      ;NOW WE CHECK POS Y 
000030FC  B27C 01E0               2326      CMP #480, D1  ; 
00003100  6E00 0016               2327      BGT MAP6NOLIMIT3    
00003104  B27C 0000               2328      CMP #0, D1
00003108  6D00 000E               2329      BLT MAP6NOLIMIT3
0000310C                          2330      ;;;; AQUI PISA EL LIMITE
0000310C  5379 0000378A           2331      SUB.W #1, PLAYERPOSX
00003112  4C9F 001F               2332      MOVEM.W (A7)+, D0-D4
00003116  4E75                    2333      RTS
00003118                          2334  MAP6NOLIMIT3
00003118                          2335      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00003118  B07C 0120               2336      CMP #288, D0  ; BGT = 352 > D0
0000311C  6E00 0026               2337      BGT MAP6NOLIMIT5   
00003120  B07C 0000               2338      CMP #0, D0
00003124  6D00 001E               2339      BLT MAP6NOLIMIT5
00003128                          2340      ;NOW WE CHECK POS Y 
00003128  B27C 01E0               2341      CMP #480, D1  ; 
0000312C  6E00 0016               2342      BGT MAP6NOLIMIT5    
00003130  B27C 01A0               2343      CMP #416, D1
00003134  6D00 000E               2344      BLT MAP6NOLIMIT5
00003138                          2345      ;;;; AQUI PISA EL LIMITE
00003138  4C9F 001F               2346      MOVEM.W (A7)+, D0-D4
0000313C  5379 0000378C           2347      SUB.W #1, PLAYERPOSY
00003142  4E75                    2348      RTS
00003144                          2349  MAP6NOLIMIT5
00003144                          2350      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00003144  B07C 0280               2351      CMP #640, D0  ; BGT = 352 > D0
00003148  6E00 0026               2352      BGT MAP6NOLIMIT6    
0000314C  B07C 0140               2353      CMP #320, D0
00003150  6D00 001E               2354      BLT MAP6NOLIMIT6
00003154                          2355      ;NOW WE CHECK POS Y 
00003154  B27C 01E0               2356      CMP #480, D1  ; 
00003158  6E00 0016               2357      BGT MAP6NOLIMIT6    
0000315C  B27C 01A0               2358      CMP #416, D1
00003160  6D00 000E               2359      BLT MAP6NOLIMIT6
00003164                          2360      ;;;; AQUI PISA EL LIMITE
00003164  4C9F 001F               2361      MOVEM.W (A7)+, D0-D4
00003168  5379 0000378C           2362      SUB.W #1, PLAYERPOSY
0000316E  4E75                    2363      RTS
00003170                          2364  MAP6NOLIMIT6
00003170                          2365      ;CHECK RIGHT-RIGHT ROOM WALL
00003170  B07C 0280               2366      CMP #640, D0  ; BGT = 352 > D0
00003174  6E00 0026               2367      BGT MAP6NOLIMIT7    
00003178  B07C 0222               2368      CMP #546, D0
0000317C  6D00 001E               2369      BLT MAP6NOLIMIT7
00003180                          2370      ;NOW WE CHECK POS Y 
00003180  B27C 01E0               2371      CMP #480, D1  ; 
00003184  6E00 0016               2372      BGT MAP6NOLIMIT7    
00003188  B27C 0120               2373      CMP #288, D1
0000318C  6D00 000E               2374      BLT MAP6NOLIMIT7
00003190                          2375      ;;;; AQUI PISA EL LIMITE
00003190  4C9F 001F               2376      MOVEM.W (A7)+, D0-D4
00003194  5379 0000378C           2377      SUB.W #1, PLAYERPOSY
0000319A  4E75                    2378      RTS
0000319C                          2379  MAP6NOLIMIT7
0000319C                          2380      ;CHECK FOR LEFT-RIGHT ROOM WALL
0000319C  B07C 0218               2381      CMP #536, D0  ; BGT = 352 > D0
000031A0  6E00 002C               2382      BGT MAP6NOLIMIT8    
000031A4  B07C 0160               2383      CMP #352, D0
000031A8  6D00 0024               2384      BLT MAP6NOLIMIT8
000031AC                          2385      ;NOW WE CHECK POS Y 
000031AC  B27C 01E0               2386      CMP #480, D1  ; 
000031B0  6E00 001C               2387      BGT MAP6NOLIMIT8    
000031B4  B27C 0120               2388      CMP #288, D1
000031B8  6D00 0014               2389      BLT MAP6NOLIMIT8
000031BC                          2390      ;;;; AQUI PISA EL LIMITE
000031BC  4C9F 001F               2391      MOVEM.W (A7)+, D0-D4
000031C0  5379 0000378A           2392      SUB.W #1, PLAYERPOSX
000031C6  5379 0000378C           2393      SUB.W #1, PLAYERPOSY
000031CC  4E75                    2394      RTS
000031CE                          2395  MAP6NOLIMIT8
000031CE                          2396      ;CHECK LEFT-LEFT ROOM WALL
000031CE  B07C 003E               2397      CMP #62, D0  ; BGT = 352 > D0
000031D2  6E00 0026               2398      BGT MAP6NOLIMIT9    
000031D6  B07C 0000               2399      CMP #0, D0
000031DA  6D00 001E               2400      BLT MAP6NOLIMIT9
000031DE                          2401      ;NOW WE CHECK POS Y 
000031DE  B27C 01E0               2402      CMP #480, D1  ; 
000031E2  6E00 0016               2403      BGT MAP6NOLIMIT9    
000031E6  B27C 0120               2404      CMP #288, D1
000031EA  6D00 000E               2405      BLT MAP6NOLIMIT9
000031EE                          2406      ;;;; AQUI PISA EL LIMITE
000031EE  4C9F 001F               2407      MOVEM.W (A7)+, D0-D4
000031F2  5379 0000378C           2408      SUB.W #1, PLAYERPOSY
000031F8  4E75                    2409      RTS
000031FA                          2410  MAP6NOLIMIT9
000031FA                          2411      ;CHECK FOR RIGHT-LEFT ROOM WALL
000031FA  B07C 0100               2412      CMP #256, D0  ; BGT = 352 > D0
000031FE  6E00 002C               2413      BGT MAP6NOLIMIT10   
00003202  B07C 0044               2414      CMP #68, D0
00003206  6D00 0024               2415      BLT MAP6NOLIMIT10
0000320A                          2416      ;NOW WE CHECK POS Y 
0000320A  B27C 01E0               2417      CMP #480, D1  ; 
0000320E  6E00 001C               2418      BGT MAP6NOLIMIT10   
00003212  B27C 0120               2419      CMP #288, D1
00003216  6D00 0014               2420      BLT MAP6NOLIMIT10
0000321A                          2421      ;;;; AQUI PISA EL LIMITE
0000321A  4C9F 001F               2422      MOVEM.W (A7)+, D0-D4
0000321E  5279 0000378A           2423      ADD.W #1, PLAYERPOSX
00003224  5379 0000378C           2424      SUB.W #1, PLAYERPOSY
0000322A  4E75                    2425      RTS
0000322C                          2426  MAP6NOLIMIT10
0000322C  4C9F 001F               2427      MOVEM.W (A7)+, D0-D4
00003230  4EF9 00003426           2428      JMP NOLIMIT
00003236                          2429  LIMAPA7
00003236  301F                    2430      MOVE.W (A7)+, D0
00003238  48A7 F800               2431      MOVEM.W D0-D4, -(A7)
0000323C  3039 0000378A           2432      MOVE.W PLAYERPOSX, D0
00003242  3239 0000378C           2433      MOVE.W PLAYERPOSY, D1
00003248                          2434      ;CHECK FOR TOP-LEFT WALL 
00003248  B07C 0120               2435      CMP #288, D0  ; BGT = 352 > D0
0000324C  6E00 0026               2436      BGT MAP7NOLIMIT1    
00003250  B07C 0000               2437      CMP #0, D0
00003254  6D00 001E               2438      BLT MAP7NOLIMIT1
00003258                          2439      ;NOW WE CHECK POS Y 
00003258  B27C 0020               2440      CMP #32, D1  ; 
0000325C  6E00 0016               2441      BGT MAP7NOLIMIT1    
00003260  B27C 0000               2442      CMP #0, D1
00003264  6D00 000E               2443      BLT MAP7NOLIMIT1
00003268                          2444      ;;;; AQUI PISA EL LIMITE
00003268  5279 0000378C           2445      ADD.W #1, PLAYERPOSY
0000326E  4C9F 001F               2446      MOVEM.W (A7)+, D0-D4
00003272  4E75                    2447      RTS
00003274                          2448  MAP7NOLIMIT1
00003274                          2449      ;CHECK FOR LEFT WALL
00003274  B07C 0020               2450      CMP #32, D0  ; BGT = 352 > D0
00003278  6E00 0026               2451      BGT MAP7NOLIMIT2    
0000327C  B07C 0000               2452      CMP #0, D0
00003280  6D00 001E               2453      BLT MAP7NOLIMIT2
00003284                          2454      ;NOW WE CHECK POS Y 
00003284  B27C 01E0               2455      CMP #480, D1  ; 
00003288  6E00 0016               2456      BGT MAP7NOLIMIT2    
0000328C  B27C 0000               2457      CMP #0, D1
00003290  6D00 000E               2458      BLT MAP7NOLIMIT2
00003294                          2459      ;;;; AQUI PISA EL LIMITE
00003294  5279 0000378A           2460      ADD.W #1, PLAYERPOSX
0000329A  4C9F 001F               2461      MOVEM.W (A7)+, D0-D4
0000329E  4E75                    2462      RTS
000032A0                          2463  MAP7NOLIMIT2
000032A0                          2464      ;CHECK FOR BOTTOM WALL
000032A0  B07C 0280               2465      CMP #640, D0  ; BGT = 352 > D0
000032A4  6E00 0026               2466      BGT MAP7NOLIMIT3    
000032A8  B07C 0000               2467      CMP #0, D0
000032AC  6D00 001E               2468      BLT MAP7NOLIMIT3
000032B0                          2469      ;NOW WE CHECK POS Y 
000032B0  B27C 01E0               2470      CMP #480, D1  ; 
000032B4  6E00 0016               2471      BGT MAP7NOLIMIT3    
000032B8  B27C 01A0               2472      CMP #416, D1
000032BC  6D00 000E               2473      BLT MAP7NOLIMIT3
000032C0                          2474      ;;;; AQUI PISA EL LIMITE
000032C0  5379 0000378C           2475      SUB.W #1, PLAYERPOSY
000032C6  4C9F 001F               2476      MOVEM.W (A7)+, D0-D4
000032CA  4E75                    2477      RTS
000032CC                          2478  MAP7NOLIMIT3
000032CC                          2479      ;CHECK FOR RIGHT WALL
000032CC  B07C 0280               2480      CMP #640, D0  ; BGT = 352 > D0
000032D0  6E00 0026               2481      BGT MAP7NOLIMIT4    
000032D4  B07C 0240               2482      CMP #576, D0
000032D8  6D00 001E               2483      BLT MAP7NOLIMIT4
000032DC                          2484      ;NOW WE CHECK POS Y 
000032DC  B27C 01E0               2485      CMP #480, D1  ; 
000032E0  6E00 0016               2486      BGT MAP7NOLIMIT4    
000032E4  B27C 0000               2487      CMP #0, D1
000032E8  6D00 000E               2488      BLT MAP7NOLIMIT4
000032EC                          2489      ;;;; AQUI PISA EL LIMITE
000032EC  5379 0000378A           2490      SUB.W #1, PLAYERPOSX
000032F2  4C9F 001F               2491      MOVEM.W (A7)+, D0-D4
000032F6  4E75                    2492      RTS
000032F8                          2493  MAP7NOLIMIT4
000032F8                          2494      ;CHECK TOP-RIGHT WALL
000032F8  B07C 0280               2495      CMP #640, D0  ; BGT = 352 > D0
000032FC  6E00 0026               2496      BGT MAP7NOLIMIT5    
00003300  B07C 0160               2497      CMP #352, D0
00003304  6D00 001E               2498      BLT MAP7NOLIMIT5
00003308                          2499      ;NOW WE CHECK POS Y 
00003308  B27C 0020               2500      CMP #32, D1  ; 
0000330C  6E00 0016               2501      BGT MAP7NOLIMIT5    
00003310  B27C 0000               2502      CMP #0, D1
00003314  6D00 000E               2503      BLT MAP7NOLIMIT5
00003318                          2504      ;;;; AQUI PISA EL LIMITE
00003318  5279 0000378C           2505      ADD.W #1, PLAYERPOSY
0000331E  4C9F 001F               2506      MOVEM.W (A7)+, D0-D4
00003322  4E75                    2507      RTS
00003324                          2508  MAP7NOLIMIT5
00003324  4C9F 001F               2509      MOVEM.W (A7)+, D0-D4
00003328  4EF9 00003426           2510      JMP NOLIMIT
0000332E                          2511      
0000332E                          2512  LIMAPA8
0000332E  301F                    2513      MOVE.W (A7)+, D0
00003330  48A7 F800               2514      MOVEM.W D0-D4, -(A7)
00003334  3039 0000378A           2515      MOVE.W PLAYERPOSX, D0
0000333A  3239 0000378C           2516      MOVE.W PLAYERPOSY, D1
00003340                          2517      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00003340                          2518      ;CHECK UPPER LEFT WALL 
00003340  B07C 0120               2519      CMP #288, D0  ; BGT = 352 > D0
00003344  6E00 0026               2520      BGT MAP8NOLIMIT1   
00003348  B07C 0000               2521      CMP #0, D0
0000334C  6D00 001E               2522      BLT MAP8NOLIMIT1
00003350                          2523      ;NOW WE CHECK POS Y 
00003350  B27C 00A0               2524      CMP #160, D1  ; 
00003354  6E00 0016               2525      BGT MAP8NOLIMIT1    
00003358  B27C 0000               2526      CMP #0, D1
0000335C  6D00 000E               2527      BLT MAP8NOLIMIT1
00003360                          2528      ;;;; AQUI PISA EL LIMITE
00003360  4C9F 001F               2529      MOVEM.W (A7)+, D0-D4
00003364  5279 0000378C           2530      ADD.W #1, PLAYERPOSY
0000336A  4E75                    2531      RTS
0000336C                          2532  MAP8NOLIMIT1
0000336C                          2533      ;CHECK BOTTOM WALL
0000336C  B07C 0280               2534      CMP #640, D0  ; BGT = 352 > D0
00003370  6E00 0026               2535      BGT MAP8NOLIMIT2   
00003374  B07C 0000               2536      CMP #0, D0
00003378  6D00 001E               2537      BLT MAP8NOLIMIT2
0000337C                          2538      ;NOW WE CHECK POS Y 
0000337C  B27C 01E0               2539      CMP #480, D1  ; 
00003380  6E00 0016               2540      BGT MAP8NOLIMIT2    
00003384  B27C 0120               2541      CMP #288, D1
00003388  6D00 000E               2542      BLT MAP8NOLIMIT2
0000338C                          2543      ;;;; AQUI PISA EL LIMITE
0000338C  4C9F 001F               2544      MOVEM.W (A7)+, D0-D4
00003390  5379 0000378C           2545      SUB.W #1, PLAYERPOSY
00003396  4E75                    2546      RTS
00003398                          2547  MAP8NOLIMIT2
00003398                          2548      ;CHECK LEFT WALL
00003398  B07C 00C0               2549      CMP #192, D0  ; BGT = 352 > D0
0000339C  6E00 0026               2550      BGT MAP8NOLIMIT3   
000033A0  B07C 0000               2551      CMP #0, D0
000033A4  6D00 001E               2552      BLT MAP8NOLIMIT3
000033A8                          2553      ;NOW WE CHECK POS Y 
000033A8  B27C 01E0               2554      CMP #480, D1  ; 
000033AC  6E00 0016               2555      BGT MAP8NOLIMIT3    
000033B0  B27C 0000               2556      CMP #0, D1
000033B4  6D00 000E               2557      BLT MAP8NOLIMIT3
000033B8                          2558      ;;;; AQUI PISA EL LIMITE
000033B8  4C9F 001F               2559      MOVEM.W (A7)+, D0-D4
000033BC  5279 0000378A           2560      ADD.W #1, PLAYERPOSX
000033C2  4E75                    2561      RTS
000033C4                          2562  MAP8NOLIMIT3
000033C4                          2563      ;CHECK RIGHT WALL
000033C4  B07C 0280               2564      CMP #640, D0  ; BGT = 352 > D0
000033C8  6E00 0026               2565      BGT MAP8NOLIMIT4   
000033CC  B07C 01A0               2566      CMP #416, D0
000033D0  6D00 001E               2567      BLT MAP8NOLIMIT4
000033D4                          2568      ;NOW WE CHECK POS Y 
000033D4  B27C 01E0               2569      CMP #480, D1  ; 
000033D8  6E00 0016               2570      BGT MAP8NOLIMIT4    
000033DC  B27C 0000               2571      CMP #0, D1
000033E0  6D00 000E               2572      BLT MAP8NOLIMIT4
000033E4                          2573      ;;;; AQUI PISA EL LIMITE
000033E4  4C9F 001F               2574      MOVEM.W (A7)+, D0-D4
000033E8  5379 0000378A           2575      SUB.W #1, PLAYERPOSX
000033EE  4E75                    2576      RTS
000033F0                          2577  MAP8NOLIMIT4
000033F0                          2578  ;CHECK TOP RIGHT WALL
000033F0  B07C 0280               2579      CMP #640, D0  ; BGT = 352 > D0
000033F4  6E00 0026               2580      BGT MAP8NOLIMIT5   
000033F8  B07C 0160               2581      CMP #352, D0
000033FC  6D00 001E               2582      BLT MAP8NOLIMIT5
00003400                          2583      ;NOW WE CHECK POS Y 
00003400  B27C 00A0               2584      CMP #160, D1  ; 
00003404  6E00 0016               2585      BGT MAP8NOLIMIT5    
00003408  B27C 0000               2586      CMP #0, D1
0000340C  6D00 000E               2587      BLT MAP8NOLIMIT5
00003410                          2588      ;;;; AQUI PISA EL LIMITE
00003410  4C9F 001F               2589      MOVEM.W (A7)+, D0-D4
00003414  5279 0000378C           2590      ADD.W #1, PLAYERPOSY
0000341A  4E75                    2591      RTS
0000341C                          2592  MAP8NOLIMIT5
0000341C  4C9F 001F               2593      MOVEM.W (A7)+, D0-D4
00003420  4EF9 00003426           2594      JMP NOLIMIT
00003426                          2595      
00003426                          2596  NOLIMIT
00003426  3F00                    2597              MOVE.W  D0,-(A7)
00003428  0839 0000 00003782      2598        BTST #0, KBDVAL         
00003430  6700 000C               2599              BEQ .UP    
00003434  303C FFFC               2600              MOVE.W  #-PLAYERSPEED,D0     
00003438  4EB9 00003484           2601        JSR   MOVEHOR 
0000343E  0839 0001 00003782      2602  .UP   BTST #1, KBDVAL           
00003446  6700 000C               2603        BEQ   .RIGHT  
0000344A  303C FFFC               2604              MOVE.W  #-PLAYERSPEED,D0      
0000344E  4EB9 000034AA           2605        JSR   MOVEVER
00003454  0839 0002 00003782      2606  .RIGHT    BTST #2, KBDVAL
0000345C  6700 000C               2607        BEQ   .DOWN  
00003460  303C 0004               2608              MOVE.W  #PLAYERSPEED,D0     
00003464  4EB9 00003484           2609        JSR   MOVEHOR
0000346A  0839 0003 00003782      2610  .DOWN     BTST #3, KBDVAL
00003472  6700 000C               2611        BEQ   .NOTMOVED  
00003476  303C 0004               2612              MOVE.W  #PLAYERSPEED,D0       
0000347A  4EB9 000034AA           2613        JSR   MOVEVER
00003480  301F                    2614  .NOTMOVED     MOVE.W  (A7)+,D0
00003482  4E75                    2615              RTS
00003484                          2616  
00003484  D179 0000378A           2617  MOVEHOR     ADD.W   D0,(PLAYERPOSX)
0000348A  6A00 0008               2618              BPL.W   .NOTLEFTEDGE
0000348E  4279 0000378A           2619              CLR.W   (PLAYERPOSX)
00003494                          2620  .NOTLEFTEDGE
00003494  0C79 0260 0000378A      2621              CMP.W   #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
0000349C  6D00 000A               2622              BLT.W   .NORIGHTEDGE
000034A0  33FC 0260 0000378A      2623              MOVE.W  #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
000034A8                          2624  .NORIGHTEDGE 
000034A8  4E75                    2625              RTS
000034AA                          2626              
000034AA  D179 0000378C           2627  MOVEVER     ADD.W   D0,(PLAYERPOSY)
000034B0  6A00 0008               2628              BPL.W   .NOTUPPEREDGE
000034B4  4279 0000378C           2629              CLR.W   (PLAYERPOSY)
000034BA                          2630  .NOTUPPEREDGE
000034BA  0C79 01C0 0000378C      2631              CMP.W   #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
000034C2  6D00 000A               2632              BLT.W   .NOLOWEREDGE
000034C6  33FC 01C0 0000378C      2633              MOVE.W  #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
000034CE                          2634  .NOLOWEREDGE 
000034CE  4E75                    2635              RTS
000034D0                          2636          
000034D0                          2637  ; ------------------------------------------------------------------------------
000034D0                          2638  PLAYERPLOT
000034D0                          2639  ; PLOT THE PLAYER.
000034D0                          2640  ; INPUT    : NONE 
000034D0                          2641  ; OUTPUT   : NONE
000034D0                          2642  ; MODIFIES : NONE
000034D0                          2643  ; ------------------------------------------------------------------------------
000034D0                          2644              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
000034D0  1F00                    2645              MOVE.B  D0,-(A7)
000034D2  2F01                    2646              MOVE.L  D1,-(A7)
000034D4  48A7 3800               2647        MOVEM.W D2-D4, -(A7)
000034D8                          2648        
000034D8  223C 00CC954E           2649        MOVE.L #$00CC954E,D1 ;PEN COLOR
000034DE  103C 0050               2650        MOVE.B #80,D0
000034E2  4E4F                    2651        TRAP #15
000034E4  223C 00B53866           2652        MOVE.L #$00B53866,D1 ;FILL COLOR
000034EA  103C 0051               2653        MOVE.B #81,D0
000034EE  4E4F                    2654        TRAP #15
000034F0                          2655        ; SE DIBUJA EL CUADRADO
000034F0  3239 0000378A           2656        MOVE.W (PLAYERPOSX),D1    
000034F6  3439 0000378C           2657        MOVE.W (PLAYERPOSY),D2      
000034FC  3601                    2658        MOVE.W D1,D3
000034FE  0643 0020               2659              ADD.W  #PLAYERWIDTH,D3  
00003502  3802                    2660        MOVE.W D2,D4
00003504  0644 0020               2661              ADD.W  #PLAYERHEIGHT,D4
00003508  103C 0057               2662        MOVE.B #87,D0
0000350C  4E4F                    2663        TRAP #15
0000350E                          2664        
0000350E  4C9F 001C               2665              MOVEM.W (A7)+,D2-D4
00003512  221F                    2666              MOVE.L  (A7)+,D1      
00003514  101F                    2667              MOVE.B  (A7)+,D0
00003516                          2668    
00003516  4E75                    2669        RTS
00003518                          2670  
00003518                          2671  
00003518                          2672  
00003518                          2673  
00003518                          2674  -------------------- end include --------------------
00003518                          2675              INCLUDE "PROJECTILE.X68"
00003518                          2676  ; ==============================================================================
00003518                          2677  ; PROJECTILE MANAGEMENT (AGENT)
00003518                          2678  ; PROJPOSX (W)  (A0)
00003518                          2679  ; PROJPOSY (W) 2(A0)
00003518                          2680  ; PROJVELX (W) 4(A0)
00003518                          2681  ; PROJVELY (W) 6(A0)
00003518                          2682  ; ==============================================================================
00003518                          2683  
00003518                          2684  ; ------------------------------------------------------------------------------
00003518                          2685  PROJINIT 
00003518                          2686  ; INITIALIZES THE PROJECTILE.
00003518                          2687  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00003518                          2688  ; OUTPUT   : NONE
00003518                          2689  ; MODIFIES : NONE
00003518                          2690  ; ------------------------------------------------------------------------------
00003518  2F00                    2691             MOVE.L  D0,-(A7)
0000351A                          2692             
0000351A  4280                    2693              CLR.L   D0
0000351C  0839 0004 00003783      2694              BTST #4, (KBDEDGE)    
00003524  6700 0008               2695              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
00003528  0680 FFF80000           2696              ADD.L   #-PROJSPEEDX<<16,D0
0000352E  0839 0005 00003783      2697  .FUP        BTST #5, (KBDEDGE)      
00003536  6700 0006               2698              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
0000353A  0640 FFF8               2699              ADD.W   #-PROJSPEEDY,D0 
0000353E  0839 0006 00003783      2700  .FRIGHT     BTST #6, (KBDEDGE)
00003546  6700 0008               2701              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
0000354A  0680 00080000           2702              ADD.L   #PROJSPEEDX<<16,D0
00003550  0839 0007 00003783      2703  .FDOWN      BTST #7, (KBDEDGE)
00003558  6700 0004               2704              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
0000355C  5040                    2705              ADD.W   #PROJSPEEDY,D0
0000355E  4A80                    2706  .NOTFDOWN   TST.L   D0
00003560  6600 0006               2707              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
00003564  303C 0008               2708              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
00003568  20B9 0000378A           2709  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
0000356E  2140 0004               2710              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
00003572  5279 0000378E           2711              ADD.W   #1,(NPROJ)
00003578  201F                    2712              MOVE.L  (A7)+,D0
0000357A  4E75                    2713              RTS
0000357C                          2714              
0000357C                          2715  ; ------------------------------------------------------------------------------
0000357C                          2716  PROJUPD 
0000357C                          2717  ; UPDATES THE PROJECTILE.
0000357C                          2718  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
0000357C                          2719  ; OUTPUT   : NONE
0000357C                          2720  ; MODIFIES : NONE
0000357C                          2721  ; ------------------------------------------------------------------------------
0000357C  2F00                    2722              MOVE.L  D0,-(A7)
0000357E  2028 0004               2723              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
00003582  D168 0002               2724              ADD.W   D0,2(A0)
00003586  E088                    2725              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
00003588  E088                    2726              LSR.L   #8,D0
0000358A  D150                    2727              ADD.W   D0,(A0) 
0000358C  201F                    2728              MOVE.L  (A7)+,D0
0000358E  4E75                    2729              RTS
00003590                          2730      
00003590                          2731  ; ------------------------------------------------------------------------------
00003590                          2732  PROJPLOT 
00003590                          2733  ; PLOTS THE PROJECTILE.
00003590                          2734  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
00003590                          2735  ; OUTPUT   : NONE
00003590                          2736  ; MODIFIES : NONE
00003590                          2737  ; ------------------------------------------------------------------------------
00003590  1F00                    2738              MOVE.B  D0,-(A7)
00003592  2F01                    2739              MOVE.L  D1,-(A7)
00003594  48A7 3800               2740        MOVEM.W D2-D4, -(A7)
00003598                          2741        
00003598  223C 00C00FFE           2742        MOVE.L #$00C00FFE,D1 ;PEN COLOR
0000359E  103C 0050               2743        MOVE.B #80,D0
000035A2  4E4F                    2744        TRAP #15
000035A4  223C 00BFF006           2745        MOVE.L #$00BFF006,D1 ;FILL COLOR
000035AA  103C 0051               2746        MOVE.B #81,D0
000035AE  4E4F                    2747        TRAP #15
000035B0                          2748        ; SE DIBUJA EL CUADRADO
000035B0  3210                    2749        MOVE.W (A0),D1    
000035B2  3428 0002               2750        MOVE.W 2(A0),D2     
000035B6  3601                    2751        MOVE.W D1,D3
000035B8  0643 0010               2752              ADD.W  #PROJWIDTH,D3    
000035BC  3802                    2753        MOVE.W D2,D4
000035BE  0644 0010               2754              ADD.W  #PROJHEIGHT,D4
000035C2  103C 0057               2755        MOVE.B #87,D0
000035C6  4E4F                    2756        TRAP #15
000035C8                          2757        
000035C8  4C9F 001C               2758              MOVEM.W (A7)+,D2-D4
000035CC  221F                    2759              MOVE.L  (A7)+,D1      
000035CE  101F                    2760              MOVE.B  (A7)+,D0
000035D0  4E75                    2761              RTS
000035D2                          2762  
000035D2                          2763  
000035D2                          2764  -------------------- end include --------------------
000035D2                          2765              INCLUDE "AUDIO.X68"
000035D2                          2766     
000035D2                          2767  ; =============================================================================
000035D2                          2768  ; AUDIO MANAGEMENT
000035D2                          2769  ; =============================================================================
000035D2                          2770  
000035D2                          2771  
000035D2                          2772  ; -----------------------------------------------------------------------------
000035D2                          2773  AUDINIT
000035D2                          2774  ; CHANGES AUDIO TO PLAY
000035D2                          2775  ; INPUT    - NONE
000035D2                          2776  ; OUTPUT   - NONE
000035D2                          2777  ; MODIFIES - NONE
000035D2                          2778  ; -----------------------------------------------------------------------------
000035D2                          2779      
000035D2  48A7 E000               2780      MOVEM.W D0-D2, -(A7)
000035D6  48A7 00C0               2781      MOVEM.W A0-A1, -(A7)
000035DA                          2782  ;LOAD ELEVATOR MUSIC IN POS 0 
000035DA  103C 0047               2783      MOVE.B #71, D0
000035DE  43F8 100F               2784      LEA ELEVATOR_MUSIC, A1
000035E2  123C 0000               2785      MOVE.B #0, D1
000035E6  4E4F                    2786      TRAP #15
000035E8                          2787  ;LOAD HEAVEN MUSIC IN POS 1
000035E8  43F8 1000               2788      LEA HEAVENSOUND, A1
000035EC  123C 0001               2789      MOVE.B #1, D1
000035F0  4E4F                    2790      TRAP #15
000035F2                          2791  ;LOAD HELL MUSIC IN POS 2
000035F2  43F8 1026               2792      LEA HELLSOUND, A1
000035F6  123C 0002               2793      MOVE.B #2, D1
000035FA  4E4F                    2794      TRAP #15
000035FC  4C9F 0300               2795      MOVEM.W (A7)+, A0-A1
00003600  4C9F 0007               2796      MOVEM.W (A7)+, D0-D2
00003604                          2797  
00003604  4E75                    2798      RTS
00003606                          2799  
00003606                          2800  
00003606                          2801  ; -----------------------------------------------------------------------------
00003606                          2802  AUDPLAY
00003606                          2803  ; CHANGES AUDIO TO PLAY
00003606                          2804  ; INPUT    - NONE
00003606                          2805  ; OUTPUT   - NONE
00003606                          2806  ; MODIFIES - NONE
00003606                          2807  ; -----------------------------------------------------------------------------
00003606                          2808      
00003606  48E7 E000               2809      MOVEM.L D0-D2, -(A7)
0000360A  48A7 00C0               2810      MOVEM.W A0-A1, -(A7)    
0000360E                          2811      
0000360E  3239 00003798           2812      MOVE.W LOADEDMAP, D1
00003614  C2FC 0006               2813             MULU #6, D1
00003618  3241                    2814             MOVEA.W D1, A1
0000361A  4EE9 361E               2815             JMP MSCSEL(A1)
0000361E                          2816  MSCSEL:
0000361E  4EF9 00003654           2817             JMP ELEVATORMUSIC
00003624                          2818             
00003624  4EF9 00003672           2819             JMP HEAVENMUSIC
0000362A                          2820             
0000362A  4EF9 00003672           2821             JMP HEAVENMUSIC
00003630                          2822             
00003630  4EF9 00003672           2823             JMP HEAVENMUSIC
00003636                          2824             
00003636  4EF9 00003672           2825             JMP HEAVENMUSIC
0000363C                          2826             
0000363C  4EF9 00003694           2827             JMP HELLMUSIC
00003642                          2828             
00003642  4EF9 00003694           2829             JMP HELLMUSIC
00003648                          2830             
00003648  4EF9 00003694           2831             JMP HELLMUSIC
0000364E                          2832             
0000364E  4EF9 00003694           2833             JMP HELLMUSIC
00003654                          2834             
00003654                          2835  
00003654                          2836  ELEVATORMUSIC
00003654  103C 004C               2837      MOVE.B #76, D0
00003658  123C 0000               2838      MOVE.B #0, D1
0000365C  7400                    2839      MOVE.L #0, D2
0000365E  4E4F                    2840      TRAP #15
00003660  4C9F 0300               2841      MOVEM.W (A7)+, A0-A1
00003664  4CDF 0007               2842      MOVEM.L (A7)+, D0-D2
00003668  13FC 0001 0000379A      2843      MOVE.B #1, MUSICPLAYED
00003670  4E75                    2844      RTS
00003672                          2845  
00003672                          2846  HEAVENMUSIC 
00003672  103C 004C               2847      MOVE.B #76, D0
00003676  123C 0000               2848      MOVE.B #0, D1
0000367A  7402                    2849      MOVE.L #2, D2
0000367C  4E4F                    2850      TRAP #15
0000367E  103C 004C               2851      MOVE.B #76, D0
00003682  123C 0001               2852      MOVE.B #1, D1
00003686  7400                    2853      MOVE.L #0, D2
00003688  4E4F                    2854      TRAP #15
0000368A  4C9F 0300               2855      MOVEM.W (A7)+, A0-A1
0000368E  4CDF 0007               2856      MOVEM.L (A7)+, D0-D2
00003692  4E75                    2857      RTS
00003694                          2858  HELLMUSIC
00003694  103C 004C               2859      MOVE.B #76, D0
00003698  123C 0000               2860      MOVE.B #0, D1
0000369C  7402                    2861      MOVE.L #2, D2
0000369E  4E4F                    2862      TRAP #15
000036A0  103C 004C               2863      MOVE.B #76, D0
000036A4  123C 0002               2864      MOVE.B #2, D1
000036A8  7400                    2865      MOVE.L #0,  D2
000036AA  4E4F                    2866      TRAP #15
000036AC  4C9F 0300               2867      MOVEM.W (A7)+, A0-A1
000036B0  4CDF 0007               2868      MOVEM.L (A7)+, D0-D2
000036B4  4E75                    2869      RTS
000036B6                          2870  
000036B6                          2871  FIREDSOUND
000036B6  48A7 E000               2872      MOVEM.W D0-D2, -(A7)
000036BA  48A7 00C0               2873      MOVEM.W A0-A1, -(A7)
000036BE  103C 0049               2874      MOVE.B #73, D0
000036C2  43F8 1035               2875      LEA PROJ_SOUND, A1
000036C6  4E4F                    2876      TRAP #15
000036C8  4C9F 0300               2877      MOVEM.W (A7)+, A0-A1
000036CC  4C9F 0007               2878      MOVEM.W (A7)+, D0-D2
000036D0  4E75                    2879      RTS
000036D0  4E75                    2880  -------------------- end include --------------------
000036D2                          2881              INCLUDE "GAME.X68"
000036D2                          2882  ; ==============================================================================
000036D2                          2883  ; GAME MANAGEMENT
000036D2                          2884  ; ==============================================================================
000036D2                          2885  
000036D2                          2886  ; ------------------------------------------------------------------------------
000036D2                          2887  GAMINIT
000036D2                          2888  ; INITIALIZES GAME.
000036D2                          2889  ; INPUT    : NONE
000036D2                          2890  ; OUTPUT   : NONE
000036D2                          2891  ; MODIFIES : NONE
000036D2                          2892  ; ------------------------------------------------------------------------------
000036D2  4279 00003798           2893              CLR.W LOADEDMAP
000036D8  4EB8 296E               2894              JSR     PLAYERINIT
000036DC  6000 FEF4               2895              BRA     AUDINIT
000036E0                          2896  
000036E0                          2897  ; ------------------------------------------------------------------------------
000036E0                          2898  GAMUPD
000036E0                          2899  ; UPDATES THE GAME
000036E0                          2900  ; INPUT    : NONE
000036E0                          2901  ; OUTPUT   : NONE
000036E0                          2902  ; MODIFIES : NONE
000036E0                          2903  ; ------------------------------------------------------------------------------
000036E0  48E7 8070               2904              MOVEM.L D0/A1-A3,-(A7)
000036E4                          2905              
000036E4                          2906              ; CHECK IF MUSIC IS ALREADY PLAYING 
000036E4  1039 0000379A           2907              MOVE.B MUSICPLAYED, D0
000036EA  B07C 0001               2908              CMP #1, D0
000036EE  6700 0006               2909              BEQ NOMUSIC
000036F2  4EB8 3606               2910              JSR AUDPLAY
000036F6                          2911  ; GENERAL UPDATES
000036F6  4EB8 291A               2912  NOMUSIC     JSR ELEVATORUPDATE 
000036FA  4EB8 2970               2913              JSR PLAYERUPD   
000036FE  4EB8 14D8               2914              JSR MAPUPD
00003702                          2915  ; SHOTS LOGIC         
00003702  1039 00003783           2916              MOVE.B  (KBDEDGE),D0
00003708  C03C 00F0               2917              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
0000370C  6718                    2918              BEQ.B .NOTFIRED
0000370E  4EB8 36B6               2919              JSR FIREDSOUND
00003712  43F8 3518               2920              LEA     PROJINIT,A1
00003716  45F8 357C               2921              LEA     PROJUPD,A2
0000371A  47F8 3590               2922              LEA     PROJPLOT,A3
0000371E  303C 0001               2923              MOVE.W  #1,D0
00003722  4EB8 12BC               2924              JSR     AGLADD
00003726                          2925  .NOTFIRED
00003726  4A79 0000378E           2926              TST.W   (NPROJ)
0000372C  6700 0006               2927              BEQ     .NOPROJ1
00003730  4EB8 12D6               2928              JSR     AGLUPD
00003734                          2929  .NOPROJ1
00003734  4CDF 0E01               2930              MOVEM.L (A7)+,D0/A1-A3
00003738  4E75                    2931              RTS
0000373A                          2932  
0000373A                          2933  ; ------------------------------------------------------------------------------
0000373A                          2934  GAMPLOT
0000373A                          2935  ; PLOTS THE GAME
0000373A                          2936  ; INPUT    : NONE
0000373A                          2937  ; OUTPUT   : NONE
0000373A                          2938  ; MODIFIES : NONE
0000373A                          2939  ; ------------------------------------------------------------------------------
0000373A  4EB8 1454               2940              JSR MAPPLOT     
0000373E  4A79 0000378E           2941              TST.W   (NPROJ)
00003744  6700 0006               2942              BEQ     .NOPROJ2
00003748  4EB8 12FA               2943              JSR     AGLPLOT
0000374C  6000 FD82               2944  .NOPROJ2    BRA     PLAYERPLOT
00003750                          2945  
00003750                          2946  
00003750                          2947  
00003750                          2948  
00003750                          2949  
00003750                          2950  
00003750                          2951  -------------------- end include --------------------
00003750                          2952  START
00003750                          2953  
00003750                          2954  ; --- INITIALIZATION -----------------------------------------------------------
00003750                          2955  
00003750  007C 0700               2956              ORI.W   #$0700,SR
00003754  4EB8 110A               2957              JSR     SYSINIT
00003758                          2958              *JSR     UTLINIT
00003758  4EB8 36D2               2959              JSR GAMINIT *JSR     STAINIT
0000375C                          2960  
0000375C                          2961  .LOOP
0000375C                          2962  
0000375C                          2963  ; --- UPDATE -------------------------------------------------------------------
0000375C                          2964  
0000375C                          2965  ; READ INPUT DEVICES
0000375C                          2966  
0000375C  4E41                    2967              TRAP    #KBDUPTN
0000375E                          2968  
0000375E                          2969  ; UPDATE GAME LOGIC
0000375E                          2970  
0000375E  4EB8 36E0               2971              JSR GAMUPD *JSR     STAUPD
00003762                          2972  
00003762                          2973  ; --- SYNC ---------------------------------------------------------------------
00003762                          2974  
00003762  4A39 00003784           2975  .WINT       TST.B   (SCRINTCT)
00003768  67F8                    2976              BEQ     .WINT
0000376A  4239 00003784           2977              CLR.B   (SCRINTCT)
00003770  5239 00003786           2978              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
00003776                          2979  
00003776                          2980  ; --- PLOT ---------------------------------------------------------------------
00003776                          2981              
00003776  4EB8 373A               2982              JSR GAMPLOT *JSR     STAPLOT
0000377A                          2983              
0000377A  4E40                    2984              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
0000377C                          2985  
0000377C  60DE                    2986              BRA     .LOOP
0000377E                          2987              
0000377E  FFFF FFFF               2988              SIMHALT
00003782                          2989              
00003782                          2990              INCLUDE "VARS.X68"
00003782                          2991  ; ==============================================================================
00003782                          2992  ; VARIABLES
00003782                          2993  ; ==============================================================================
00003782                          2994              
00003782                          2995  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00003782                          2996              
00003782                          2997  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
00003783                          2998  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
00003784                          2999  
00003784                          3000  
00003784                          3001  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00003784                          3002  
00003784                          3003  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00003785                          3004  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00003786                          3005  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
00003788                          3006              DS.W    0
00003788                          3007  
00003788                          3008  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
00003788                          3009  
00003788= 0064                    3010  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
0000378A= 0140                    3011  PLAYERPOSX      DC.W    SCRWIDTH/2
0000378C= 00F0                    3012  PLAYERPOSY      DC.W    SCRHEIGH/2
0000378E                          3013  
0000378E                          3014  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
0000378E                          3015  
0000378E= 0000                    3016  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
00003790                          3017  
00003790                          3018  ; --- MAP RELATED VARIABLES ----------------------------------------------------
00003790                          3019  
00003790= 0000                    3020  BPOSX1  DC.W    0
00003792= 0000                    3021  BPOSY1  DC.W    0
00003794= 0020                    3022  BPOSX2  DC.W    32
00003796= 0020                    3023  BPOSY2  DC.W    32
00003798= 0000                    3024  LOADEDMAP   DC.W    0
0000379A                          3025  
0000379A                          3026  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
0000379A                          3027  
0000379A= 00                      3028  MUSICPLAYED DC.B    0
0000379C                          3029              DS.W    0
0000379C                          3030  
0000379C                          3031  ; --- FPS RELATED VARIABLES ----------------------------------------------------
0000379C                          3032  
0000379C                          3033  REALFPS     DS.W    1
0000379E= 47 4F 41 4C 3A 20 00    3034  STRFPS1     DC.B    'GOAL: ',0          ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
000037A5= 46 50 53 20 2D 20 ...   3035  STRFPS2     DC.B    'FPS - ACTUAL: ',0
000037B4= 46 50 53 00             3036  STRFPS3     DC.B    'FPS',0
000037B8                          3037  
000037B8                          3038  
000037B8                          3039  
000037B8                          3040  
000037B8                          3041  -------------------- end include --------------------
000037B8                          3042              INCLUDE "LIB/UTLVARS.X68"
000037B8                          3043  ; =============================================================================
000037B8                          3044  ; UTILITY VARIABLES
000037B8                          3045  ; =============================================================================
000037B8                          3046  
000037B8                          3047  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000037BA                          3048              DS.W    0
000037BA                          3049  -------------------- end include --------------------
000037BA                          3050              INCLUDE "LIB/DMMVARS.X68"
000037BA                          3051  ; =============================================================================
000037BA                          3052  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
000037BA                          3053  ; =============================================================================
000037BA                          3054  
000037C0                          3055              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
000037C0                          3056  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00004440                          3057              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00004440                          3058  -------------------- end include --------------------
00004440                          3059  
00004440                          3060              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12BC
AGLADD:END          12D2
AGLKILL             10F4
AGLPLOT             12FA
AGLPLOT:END         131A
AGLPLOT:LOOP        1302
AGLUPD              12D6
AGLUPD:END          12F4
AGLUPD:LOOP         12DE
AUDINIT             35D2
AUDPLAY             3606
BPOSX1              3790
BPOSX2              3794
BPOSY1              3792
BPOSY2              3796
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                1650
DBHV                16C4
DDHL                157A
DDHV                159A
DF1HL               17EE
DF1HV               17CE
DF2HL               1860
DF2HV               180E
DGHE                15BA
DGHL                1738
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             37C0
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           18B2
ELEVATORMUSIC       3654
ELEVATORPLOT        26FA
ELEVATORUPDATE      291A
ELEVATOR_MUSIC      100F
ENDBLOCK            190A
ENDMAP              191C
ESMENU              292E
FIREDSOUND          36B6
FPSTEXTPOS          2A01
FRAMES_PER_SECOND   32
GAMINIT             36D2
GAMPLOT             373A
GAMPLOT:NOPROJ2     374C
GAMUPD              36E0
HEAVENMUSIC         3672
HEAVENSOUND         1000
HEAVEN_0            1D0C
HEAVEN_1            1E5C
HEAVEN_END          1F97
HEAVEN_ROOM         20D2
HELLMUSIC           3694
HELLSOUND           1026
HELL_0              220D
HELL_1              2348
HELL_END            2483
HELL_ROOM           25BE
HLSEL               295C
HVSEL               294A
JMPLIST             1532
KBDDOWN             53
KBDEDGE             3783
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             1260
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              126E
KBDUPD:LOOP         12B2
KBDUPD:PACK         12AE
KBDUPTN             1
KBDVAL              3782
LIMAPA1             29DC
LIMAPA2             2ADA
LIMAPA3             2CEA
LIMAPA4             2DE2
LIMAPA5             2EDA
LIMAPA6             3082
LIMAPA7             3236
LIMAPA8             332E
LOADEDMAP           3798
MAP1NODOOR          1988
MAP1NOLIMIT1        2A1A
MAP1NOLIMIT2        2A46
MAP1NOLIMIT3        2A78
MAP1NOLIMIT4        2AA4
MAP1NOLIMITEND      2AD0
MAP2NODOOR1         19D6
MAP2NODOOR2         1A0C
MAP2NODOOR3         1A4A
MAP2NODOOR4         1A88
MAP2NOLIMIT1        2B1E
MAP2NOLIMIT10       2CE0
MAP2NOLIMIT2        2B50
MAP2NOLIMIT3        2B82
MAP2NOLIMIT4        2BB4
MAP2NOLIMIT5        2BE6
MAP2NOLIMIT6        2C18
MAP2NOLIMIT7        2C4A
MAP2NOLIMIT8        2C7C
MAP2NOLIMIT9        2CAE
MAP3NODOOR          1AD6
MAP3NOLIMIT1        2D28
MAP3NOLIMIT2        2D54
MAP3NOLIMIT3        2D80
MAP3NOLIMIT4        2DAC
MAP3NOLIMIT5        2DD8
MAP4NODOOR          1B1E
MAP4NOLIMIT1        2E20
MAP4NOLIMIT2        2E4C
MAP4NOLIMIT3        2E78
MAP4NOLIMIT4        2EA4
MAP4NOLIMIT5        2ED0
MAP5NODOOR          1B66
MAP5NOLIMIT1        2F18
MAP5NOLIMIT2        2F44
MAP5NOLIMIT3        2F70
MAP5NOLIMIT4        2F9C
MAP5NOLIMIT5        2FC8
MAP5NOLIMIT6        2FF4
MAP5NOLIMIT7        3020
MAP5NOLIMIT8        304C
MAP5NOLIMIT9        3078
MAP6NODOOR1         1BB4
MAP6NODOOR2         1BEA
MAP6NODOOR3         1C28
MAP6NODOOR4         1C66
MAP6NOLIMIT1        30C0
MAP6NOLIMIT10       322C
MAP6NOLIMIT2        30EC
MAP6NOLIMIT3        3118
MAP6NOLIMIT5        3144
MAP6NOLIMIT6        3170
MAP6NOLIMIT7        319C
MAP6NOLIMIT8        31CE
MAP6NOLIMIT9        31FA
MAP7NODOOR          1CB6
MAP7NOLIMIT1        3274
MAP7NOLIMIT2        32A0
MAP7NOLIMIT3        32CC
MAP7NOLIMIT4        32F8
MAP7NOLIMIT5        3324
MAP8NODOOR1         1D06
MAP8NOLIMIT1        336C
MAP8NOLIMIT2        3398
MAP8NOLIMIT3        33C4
MAP8NOLIMIT4        33F0
MAP8NOLIMIT5        341C
MAPA1               1946
MAPA2               198E
MAPA3               1A8E
MAPA4               1ADC
MAPA5               1B24
MAPA6               1B6C
MAPA7               1C6C
MAPA8               1CBC
MAPPLOT             1454
MAPSEL              146C
MAPUPD              14D8
MOVEHOR             3484
MOVEHOR:NORIGHTEDGE  34A8
MOVEHOR:NOTLEFTEDGE  3494
MOVEVER             34AA
MOVEVER:NOLOWEREDGE  34CE
MOVEVER:NOTUPPEREDGE  34BA
MSCSEL              361E
MUSICPLAYED         379A
NEWLINE             18E6
NEXT                1524
NOLIMIT             3426
NOLIMIT:DOWN        346A
NOLIMIT:NOTMOVED    3480
NOLIMIT:RIGHT       3454
NOLIMIT:UP          343E
NOLIMITMENU         29C4
NOMUSIC             36F6
NOMUSIC:NOPROJ1     3734
NOMUSIC:NOTFIRED    3726
NPROJ               378E
PLAYERHEALTH        3788
PLAYERHEIGHT        20
PLAYERINIT          296E
PLAYERPLOT          34D0
PLAYERPOSX          378A
PLAYERPOSY          378C
PLAYERSPEED         4
PLAYERUPD           2970
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            3518
PROJINIT:FDOWN      3550
PROJINIT:FRIGHT     353E
PROJINIT:FUP        352E
PROJINIT:NOTFDOWN   355E
PROJINIT:SHOOT      3568
PROJPLOT            3590
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             357C
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             379C
SCRCYCCT            3785
SCRHEIGH            1E0
SCRINIT             1142
SCRINTCT            3784
SCRINTFPS           3786
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             1198
SCRTIM              1240
SCRTIM1S            124E
SCRUPTN             0
SCRWIDTH            280
SNDPLTN             2
START               3750
START:LOOP          375C
START:WINT          3762
STRFPS1             379E
STRFPS2             37A5
STRFPS3             37B4
SYSINIT             110A
TRIANGLE            28C2
TRIANGLE:ISPOSITIVE  2910
TRIANGLE:UPWARDS    28DE
UTLINIT             1320
UTLRAND             1336
UTLRAND:RANDVEC     1354
UTLRNDIX            37B8
