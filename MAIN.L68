0000395A Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 14/01/2023 22:56:25

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002D01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/14)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000                            37  ;no lo usas SNDPLTN     EQU     3                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000                            45  
00001000  =00000004                 46  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 47  PLAYERWIDTH     EQU     32
00001000  =00000020                 48  PLAYERHEIGHT    EQU     32
00001000                            49  
00001000                            50  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            51  
00001000  =00000010                 52  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 53  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 54  PROJSPEEDX      EQU     8
00001000  =00000008                 55  PROJSPEEDY      EQU     8
00001000                            56  
00001000                            57  ; --- MUSIC RELATED CONSTANTS --------------------------------------------------
00001000                            58  
00001000= 53 4E 44 2F 4D 55 ...     59  HEAVENSOUND DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     60  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     61  HELLSOUND   DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     62  PROJ_SOUND  DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            63  
00001048                            64  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001048                            65  
00001048  =FFFFFFFF                 66  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001048                            67  
00001048                            68  
00001048                            69  
00001048                            70  
00001048                            71  
00001048                            72  
00001048                            73  
00001048                            74  
00001048                            75  
00001048                            76  
00001048                            77  
00001048                            78  
00001048                            79  -------------------- end include --------------------
00001048                            80              INCLUDE "LIB/DMMCONST.X68"
00001048                            81  ; =============================================================================
00001048                            82  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                            83  ; =============================================================================
00001048                            84  
00001048  =00000040                 85  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                 86  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                 87  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                 88  -------------------- end include --------------------
00001048                            89              INCLUDE "LIB/UTLCONST.X68"         
00001048                            90  ; ==============================================================================
00001048                            91  ; UTIL CONSTANTS
00001048                            92  ; ==============================================================================
00001048                            93  
00001048  =00000008                 94  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001048  =00000008                 95  -------------------- end include --------------------
00001048                            96              INCLUDE "LIB/DMMCODE.X68"
00001048                            97  ; =============================================================================
00001048                            98  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                            99  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                           100  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                           101  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                           102  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                           103  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                           104  ; =============================================================================
00001048                           105  
00001048                           106  ; -----------------------------------------------------------------------------
00001048                           107  DMMINIT
00001048                           108  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                           109  ; INPUT    - NONE
00001048                           110  ; OUTPUT   - NONE
00001048                           111  ; MODIFIES - NONE
00001048                           112  ; -----------------------------------------------------------------------------
00001048  48E7 8080                113              MOVEM.L D0/A0,-(A7)
0000104C  41F9 00003A00            114              LEA     DMMDATA,A0
00001052  303C 0031                115              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                116  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            117              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                118              DBRA.W  D0,.LOOP
00001064  4CDF 0101                119              MOVEM.L (A7)+,D0/A0
00001068  4E75                     120              RTS
0000106A                           121  
0000106A                           122  ; -----------------------------------------------------------------------------
0000106A                           123  DMMFIRST
0000106A                           124  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           125  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           126  ; INPUT    - NONE
0000106A                           127  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           128  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           129  ; -----------------------------------------------------------------------------
0000106A  41F9 00003A00            130              LEA     DMMDATA,A0
00001070  4A58                     131  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                132              BNE     DMMFRFND
00001076  D1FC 0000003E            133              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 0000467F            134  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     135              BLT     DMMFRLOP
00001084  207C 00000000            136              MOVE.L  #0,A0
0000108A  4E75                     137  DMMFRFND    RTS
0000108C                           138  
0000108C                           139  ; -----------------------------------------------------------------------------
0000108C                           140  DMMNEXT
0000108C                           141  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           142  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           143  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           144  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           145  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           146  ; -----------------------------------------------------------------------------
0000108C  2F00                     147              MOVE.L  D0,-(A7)
0000108E  2008                     148              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            149              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            150              ADD.L   #DMMBSIZE,D0
0000109C  2040                     151              MOVE.L  D0,A0
0000109E  201F                     152              MOVE.L  (A7)+,D0
000010A0  60DA                     153              BRA     DMMFRCOM
000010A2                           154  
000010A2                           155  ; -----------------------------------------------------------------------------
000010A2                           156  DMMFRSTO
000010A2                           157  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           158  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           159  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           160  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           161  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           162  ; -----------------------------------------------------------------------------
000010A2  41F9 00003A00            163              LEA     DMMDATA,A0
000010A8  B058                     164  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                165              BEQ     DMMFFND
000010AE  D1FC 0000003E            166              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 0000467F            167  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     168              BLT     DMMFLOOP
000010BC  207C 00000000            169              MOVE.L  #0,A0
000010C2  4E75                     170  DMMFFND     RTS
000010C4                           171  
000010C4                           172  ; -----------------------------------------------------------------------------
000010C4                           173  DMMNEXTO
000010C4                           174  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           175  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           176  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           177  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           178  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           179  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           180  ; -----------------------------------------------------------------------------
000010C4  2F00                     181              MOVE.L  D0,-(A7)
000010C6  2008                     182              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            183              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            184              ADD.L   #DMMBSIZE,D0
000010D4  2040                     185              MOVE.L  D0,A0
000010D6  201F                     186              MOVE.L  (A7)+,D0
000010D8  60DA                     187              BRA     DMMFCOM
000010DA                           188  
000010DA                           189  ; -----------------------------------------------------------------------------
000010DA                           190  DMMALLOC
000010DA                           191  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           192  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           193  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           194  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           195  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           196  ; -----------------------------------------------------------------------------
000010DA  3F00                     197              MOVE.W  D0,-(A7)
000010DC  4240                     198              CLR.W   D0
000010DE  4EB8 10A2                199              JSR     DMMFRSTO
000010E2  301F                     200              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            201              CMP.L   #0,A0
000010EA  6700 0006                202              BEQ     .END
000010EE  3140 FFFE                203              MOVE.W  D0,-2(A0)
000010F2  4E75                     204  .END        RTS
000010F4                           205  
000010F4                           206  ; -----------------------------------------------------------------------------
000010F4                           207  DMMFREE
000010F4                           208  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           209  ; SYSTEM (0)
000010F4                           210  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           211  ; OUTPUT   - NONE
000010F4                           212  ; MODIFIES - NONE
000010F4                           213  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                214              MOVEM.L D0/A0,-(A7)
000010F8  2008                     215              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            216              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     217              MOVE.L  D0,A0
00001102  4250                     218              CLR.W   (A0)
00001104  4CDF 0101                219              MOVEM.L (A7)+,D0/A0
00001108  4E75                     220              RTS
00001108  4E75                     221  -------------------- end include --------------------
0000110A                           222              INCLUDE "SYSTEM.X68"
0000110A                           223  ; ==============================================================================
0000110A                           224  ; SYSTEM
0000110A                           225  ; ==============================================================================
0000110A                           226              
0000110A                           227  ; ------------------------------------------------------------------------------
0000110A                           228  SYSINIT
0000110A                           229  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           230  ; INPUT    : NONE
0000110A                           231  ; OUTPUT   : NONE
0000110A                           232  ; MODIFIES : NONE
0000110A                           233  ; ------------------------------------------------------------------------------
0000110A                           234  
0000110A  21FC 00001198 0080       235              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000126E 0084       236              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 00001240 0064       237              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001122  21FC 0000124E 0068       238              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
0000112A                           239              
0000112A  4EB8 1048                240              JSR     DMMINIT
0000112E  4EB9 00001142            241              JSR     SCRINIT
00001134  4EB9 00001260            242              JSR     KBDINIT 
0000113A                           243              
0000113A  40E7                     244              MOVE.W  SR,-(A7)
0000113C  0257 D8FF                245              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
00001140  4E73                     246              RTE
00001142                           247              
00001142                           248  ; ------------------------------------------------------------------------------
00001142                           249  SCRINIT
00001142                           250  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001142                           251  ; ENABLE DOUBLE BUFFER.
00001142                           252  ; INPUT    : NONE
00001142                           253  ; OUTPUT   : NONE
00001142                           254  ; MODIFIES : NONE
00001142                           255  ; ------------------------------------------------------------------------------
00001142                           256  
00001142  48E7 F000                257              MOVEM.L D0-D3,-(A7)
00001146                           258  
00001146                           259              ; SET SCREEN RESOLUTION
00001146  103C 0021                260              MOVE.B  #33,D0
0000114A  223C 028001E0            261              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001150  4E4F                     262              TRAP    #15
00001152                           263              
00001152                           264              ; SET WINDOWED MODE
00001152  7201                     265              MOVE.L  #1,D1
00001154  4E4F                     266              TRAP    #15
00001156                           267              
00001156                           268              ; CLEAR SCREEN
00001156  103C 000B                269              MOVE.B  #11,D0
0000115A  323C FF00                270              MOVE.W  #$FF00,D1
0000115E  4E4F                     271              TRAP    #15
00001160                           272  
00001160                           273              ; ENABLE DOUBLE BUFFER
00001160  103C 005C                274              MOVE.B  #92,D0
00001164  123C 0011                275              MOVE.B  #17,D1
00001168  4E4F                     276              TRAP    #15
0000116A                           277              
0000116A                           278              ; ENABLE BOTH TIMED INTERRUPT
0000116A  103C 0020                279              MOVE.B  #32,D0
0000116E  123C 0006                280              MOVE.B  #6,D1
00001172  143C 0081                281              MOVE.B  #$80|SCRINTN,D2
00001176  7614                     282              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001178  4E4F                     283              TRAP    #15
0000117A  143C 0082                284              MOVE.B  #$80|SCRINTFPSN,D2
0000117E  263C 000003E8            285              MOVE.L  #1000,D3
00001184  4E4F                     286              TRAP    #15
00001186                           287              
00001186                           288              ; CLEAR INTERRUPT COUNTER
00001186  4279 0000398E            289              CLR.W   (SCRINTCT)
0000118C  4239 00003990            290              CLR.B   (SCRINTFPS) 
00001192                           291              
00001192  4CDF 000F                292              MOVEM.L (A7)+,D0-D3
00001196                           293              
00001196  4E75                     294              RTS
00001198                           295  
00001198                           296  ; ------------------------------------------------------------------------------
00001198                           297  SCRPLOT
00001198                           298  ; UPDATES DOUBLE BUFFER
00001198                           299  ; INPUT    : NONE
00001198                           300  ; OUTPUT   : NONE
00001198                           301  ; MODIFIES : NONE
00001198                           302  ; ------------------------------------------------------------------------------
00001198  48E7 E000                303              MOVEM.L D0-D2,-(A7)
0000119C  2F09                     304              MOVE.L  A1,-(A7)
0000119E                           305              
0000119E                           306              ; PLOT ACTUAL FPS AND GOAL FPS
0000119E                           307              
0000119E  103C 0051                308              MOVE.B  #81,D0
000011A2  7200                     309              MOVE.L  #$00000000,D1 ; FILL COLOR
000011A4  4E4F                     310              TRAP    #15
000011A6                           311              
000011A6  103C 0050                312              MOVE.B  #80,D0
000011AA  223C 00FFFFFF            313              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011B0  4E4F                     314              TRAP    #15
000011B2                           315              
000011B2  103C 000B                316              MOVE.B  #11,D0
000011B6  223C 00002D01            317              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011BC  4E4F                     318              TRAP    #15
000011BE                           319              
000011BE  43F9 000039A8            320              LEA.L   STRFPS1,A1 
000011C4  103C 000E                321              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011C8  4E4F                     322              TRAP    #15
000011CA                           323              
000011CA  103C 000B                324              MOVE.B  #11,D0
000011CE  323C 3601                325              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011D2  4E4F                     326              TRAP    #15
000011D4                           327              
000011D4  5E89                     328              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011D6  103C 000E                329              MOVE.B  #14,D0  
000011DA  4E4F                     330              TRAP    #15 
000011DC                           331              
000011DC  103C 000B                332              MOVE.B  #11,D0
000011E0  323C 4701                333              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E4  4E4F                     334              TRAP    #15
000011E6                           335              
000011E6  D3FC 0000000F            336              ADDA.L  #15,A1 ; PLOT 'FPS'
000011EC  103C 000E                337              MOVE.B  #14,D0 
000011F0  4E4F                     338              TRAP    #15
000011F2                           339              
000011F2  0643 0014                340              ADD.W   #20,D3
000011F6  103C 000B                341              MOVE.B  #11,D0
000011FA  323C 3301                342              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
000011FE  4E4F                     343              TRAP    #15
00001200                           344              
00001200  7232                     345              MOVE.L  #FRAMES_PER_SECOND,D1
00001202  740A                     346              MOVE.L  #10,D2
00001204  103C 000F                347              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001208  4E4F                     348              TRAP    #15
0000120A                           349              
0000120A  0643 0014                350              ADD.W   #20,D3
0000120E  103C 000B                351              MOVE.B  #11,D0
00001212  323C 4401                352              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001216  4E4F                     353              TRAP    #15
00001218                           354              
00001218  4281                     355              CLR.L   D1
0000121A  1239 000039A6            356              MOVE.B  (REALFPS),D1
00001220  740A                     357              MOVE.L  #10,D2
00001222  103C 000F                358              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001226  4E4F                     359              TRAP    #15
00001228                           360              
00001228                           361              ; SWITCH BUFFERS
00001228  103C 005E                362              MOVE.B  #94,D0
0000122C  4E4F                     363              TRAP    #15
0000122E                           364              
0000122E                           365              ; CLEAR HIDDEN BUFFER
0000122E  103C 000B                366              MOVE.B  #11,D0
00001232  323C FF00                367              MOVE.W  #$FF00,D1
00001236  4E4F                     368              TRAP    #15
00001238                           369              
00001238  225F                     370              MOVE.L  (A7)+,A1
0000123A  4CDF 0007                371              MOVEM.L (A7)+,D0-D2
0000123E  4E73                     372              RTE
00001240                           373              
00001240                           374  ; ------------------------------------------------------------------------------
00001240                           375  SCRTIM
00001240                           376  ; TIMED INTERRUPT SERVICE ROUTINE
00001240                           377  ; INPUT    : NONE
00001240                           378  ; OUTPUT   : NONE
00001240                           379  ; MODIFIES : NONE
00001240                           380  ; ------------------------------------------------------------------------------
00001240  5239 0000398E            381              ADDQ.B  #1,(SCRINTCT)
00001246  5239 0000398F            382              ADDQ.B  #1,(SCRCYCCT)
0000124C  4E73                     383              RTE
0000124E                           384              
0000124E                           385  ; ------------------------------------------------------------------------------
0000124E                           386  SCRTIM1S
0000124E                           387  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000124E                           388  ; INPUT    : NONE
0000124E                           389  ; OUTPUT   : NONE
0000124E                           390  ; MODIFIES : NONE
0000124E                           391  ; ------------------------------------------------------------------------------
0000124E  13F9 00003990 000039A6   392              MOVE.B  (SCRINTFPS),REALFPS
00001258  4239 00003990            393              CLR.B   SCRINTFPS
0000125E  4E73                     394              RTE
00001260                           395  
00001260                           396  ; ------------------------------------------------------------------------------
00001260                           397  KBDINIT
00001260                           398  ; INIT KEYBOARD
00001260                           399  ; INPUT    : NONE
00001260                           400  ; OUTPUT   : NONE
00001260                           401  ; MODIFIES : NONE
00001260                           402  ; ------------------------------------------------------------------------------
00001260  4239 0000398C            403              CLR.B   (KBDVAL)
00001266  4239 0000398D            404              CLR.B   (KBDEDGE)
0000126C  4E75                     405              RTS
0000126E                           406  
0000126E                           407  ; ------------------------------------------------------------------------------
0000126E                           408  KBDUPD
0000126E                           409  ; UPDATE KEYBOARD INFO.  
0000126E                           410  ; 7 -> FIRE DOWN
0000126E                           411  ; 6 -> FIRE RIGHT
0000126E                           412  ; 5 -> FIRE UP
0000126E                           413  ; 4 -> FIRE LEFT
0000126E                           414  ; 3 -> DOWN
0000126E                           415  ; 2 -> RIGHT
0000126E                           416  ; 1 -> UP
0000126E                           417  ; 0 -> LEFT
0000126E                           418  ; INPUT    : NONE
0000126E                           419  ; OUTPUT   : NONE
0000126E                           420  ; MODIFIES : NONE
0000126E                           421  ; ------------------------------------------------------------------------------
0000126E                           422  
0000126E  48E7 F000                423              MOVEM.L D0-D3,-(A7)
00001272                           424  
00001272                           425              ; READ FIRST PART
00001272  103C 0013                426              MOVE.B  #19,D0
00001276  223C 28272625            427              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000127C  4E4F                     428              TRAP    #15
0000127E                           429              
0000127E                           430              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000127E  4EB9 000012AE            431              JSR     .PACK
00001284                           432  
00001284                           433              ; READ SECOND PART
00001284  223C 53445741            434              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000128A  4E4F                     435              TRAP    #15
0000128C                           436  
0000128C                           437              ; CONVERT TO DESIRED FORMAT
0000128C  4EB9 000012AE            438              JSR     .PACK
00001292                           439              
00001292                           440              ; COMPUTE KBDEDGE
00001292  1039 0000398C            441              MOVE.B  (KBDVAL),D0
00001298  4600                     442              NOT.B   D0
0000129A  C002                     443              AND.B   D2,D0
0000129C  13C0 0000398D            444              MOVE.B  D0,(KBDEDGE)
000012A2                           445              
000012A2                           446              ; STORE KBDVAL
000012A2  13C2 0000398C            447              MOVE.B  D2,(KBDVAL)
000012A8                           448              
000012A8  4CDF 000F                449              MOVEM.L (A7)+,D0-D3
000012AC                           450  
000012AC  4E73                     451              RTE
000012AE                           452              
000012AE  363C 0003                453  .PACK       MOVE.W  #3,D3
000012B2  E189                     454  .LOOP       LSL.L   #8,D1
000012B4  E312                     455              ROXL.B  #1,D2
000012B6  51CB FFFA                456              DBRA.W  D3,.LOOP
000012BA  4E75                     457              RTS
000012BC                           458  
000012BC                           459  
000012BC                           460  
000012BC                           461  -------------------- end include --------------------
000012BC                           462              INCLUDE "LIB/AGLCODE.X68"
000012BC                           463  ; =============================================================================
000012BC                           464  ; AGENT MANAGEMENT
000012BC                           465  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012BC                           466  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012BC                           467  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012BC                           468  ; +8:END    : DATA (AGENT SPECIFIC)
000012BC                           469  ; =============================================================================
000012BC                           470  
000012BC                           471  ; -----------------------------------------------------------------------------
000012BC                           472  AGLADD
000012BC                           473  ; CREATES A NEW AGENT
000012BC                           474  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012BC                           475  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012BC                           476  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012BC                           477  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012BC                           478  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012BC                           479  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012BC                           480  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012BC                           481  ; OUTPUT   - NONE
000012BC                           482  ; MODIFIES - NONE
000012BC                           483  ; -----------------------------------------------------------------------------
000012BC  2F08                     484              MOVE.L  A0,-(A7)
000012BE  4EB8 10DA                485              JSR     DMMALLOC
000012C2  B1FC 00000000            486              CMP.L   #0,A0
000012C8  6700 0008                487              BEQ     .END
000012CC  20CA                     488              MOVE.L  A2,(A0)+
000012CE  20CB                     489              MOVE.L  A3,(A0)+
000012D0  4E91                     490              JSR     (A1)
000012D2  205F                     491  .END        MOVE.L  (A7)+,A0
000012D4  4E75                     492              RTS
000012D6                           493  
000012D6                           494  ; -----------------------------------------------------------------------------
000012D6                           495  AGLUPD
000012D6                           496  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012D6                           497  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012D6                           498  ; INPUT    - NONE
000012D6                           499  ; OUTPUT   - NONE
000012D6                           500  ; MODIFIES - NONE
000012D6                           501  ; -----------------------------------------------------------------------------
000012D6  48E7 00C0                502              MOVEM.L A0-A1,-(A7)
000012DA  4EB8 106A                503              JSR     DMMFIRST
000012DE  B1FC 00000000            504  .LOOP       CMP.L   #0,A0
000012E4  6700 000E                505              BEQ     .END
000012E8  2250                     506              MOVE.L  (A0),A1
000012EA  5088                     507              ADD.L   #8,A0
000012EC  4E91                     508              JSR     (A1)
000012EE  4EB8 108C                509              JSR     DMMNEXT
000012F2  60EA                     510              BRA     .LOOP
000012F4  4CDF 0300                511  .END        MOVEM.L (A7)+,A0-A1
000012F8  4E75                     512              RTS
000012FA                           513  
000012FA                           514  ; -----------------------------------------------------------------------------
000012FA                           515  AGLPLOT
000012FA                           516  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012FA                           517  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012FA                           518  ; INPUT    - NONE
000012FA                           519  ; OUTPUT   - NONE
000012FA                           520  ; MODIFIES - NONE
000012FA                           521  ; -----------------------------------------------------------------------------
000012FA  48E7 00C0                522              MOVEM.L A0-A1,-(A7)
000012FE  4EB8 106A                523              JSR     DMMFIRST
00001302  B1FC 00000000            524  .LOOP       CMP.L   #0,A0
00001308  6700 0010                525              BEQ     .END
0000130C  2268 0004                526              MOVE.L  4(A0),A1
00001310  5088                     527              ADD.L   #8,A0
00001312  4E91                     528              JSR     (A1)
00001314  4EB8 108C                529              JSR     DMMNEXT
00001318  60E8                     530              BRA     .LOOP
0000131A  4CDF 0300                531  .END        MOVEM.L (A7)+,A0-A1
0000131E  4E75                     532              RTS
00001320                           533  
00001320                           534  ; -----------------------------------------------------------------------------
00001320  =000010F4                535  AGLKILL     EQU     DMMFREE
00001320                           536  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001320                           537  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001320                           538  ; OUTPUT   - NONE
00001320                           539  ; MODIFIES - NONE
00001320                           540  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001320                           541  ; -----------------------------------------------------------------------------
00001320                           542  -------------------- end include --------------------
00001320                           543              INCLUDE "LIB/UTLCODE.X68"
00001320                           544  ; =============================================================================
00001320                           545  ; UTILITY CODE
00001320                           546  ; =============================================================================
00001320                           547  
00001320                           548  ; -----------------------------------------------------------------------------
00001320                           549  UTLINIT
00001320                           550  ; INITIALIZES UTILITY CODE
00001320                           551  ; INPUT    - NONE
00001320                           552  ; OUTPUT   - NONE
00001320                           553  ; MODIFIES - NONE
00001320                           554  ; -----------------------------------------------------------------------------
00001320  48E7 C000                555              MOVEM.L D0-D1,-(A7)
00001324  103C 0008                556              MOVE.B  #8,D0
00001328  4E4F                     557              TRAP    #15
0000132A  13C1 000039C6            558              MOVE.B  D1,(UTLRNDIX)
00001330  4CDF 0003                559              MOVEM.L (A7)+,D0-D1
00001334  4E75                     560              RTS
00001336                           561  
00001336                           562  ; -----------------------------------------------------------------------------
00001336                           563  UTLPRINT
00001336                           564  ; PRINT SCREEN CENTERED TEXT
00001336                           565  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001336                           566  ;            D0.B SCREEN ROW TO PRINT TEXT
00001336                           567  ; OUTPUT   : D0.B NEXT ROW
00001336                           568  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001336                           569  ; -----------------------------------------------------------------------------
00001336  48E7 C0C0                570              MOVEM.L D0-D1/A0-A1,-(A7)
0000133A  4201                     571              CLR.B   D1
0000133C  2248                     572              MOVE.L  A0,A1
0000133E  4A18                     573  .LOOP       TST.B   (A0)+
00001340  6700 0006                574              BEQ     .ENDLOOP
00001344  5201                     575              ADDQ.B  #1,D1
00001346  60F6                     576              BRA     .LOOP
00001348  E209                     577  .ENDLOOP    LSR.B   #1,D1
0000134A  0401 0028                578              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000134E  4401                     579              NEG.B   D1
00001350  E141                     580              ASL.W   #8,D1
00001352  8240                     581              OR.W    D0,D1
00001354  103C 000B                582              MOVE.B  #11,D0
00001358  4E4F                     583              TRAP    #15
0000135A  103C 000D                584              MOVE.B  #13,D0
0000135E  4E4F                     585              TRAP    #15
00001360  4CDF 0303                586              MOVEM.L (A7)+,D0-D1/A0-A1
00001364  5200                     587              ADDQ.B  #1,D0
00001366  4E75                     588              RTS
00001368                           589  
00001368                           590  ; -----------------------------------------------------------------------------
00001368                           591  UTLRAND
00001368                           592  ; PROVIDES A PSEUDO-RANDOM BYTE
00001368                           593  ; INPUT    - NONE
00001368                           594  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001368                           595  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001368                           596  ; -----------------------------------------------------------------------------
00001368  2F08                     597              MOVE.L  A0,-(A7)
0000136A  41F9 00001386            598              LEA     .RANDVEC,A0
00001370  4280                     599              CLR.L   D0
00001372  1039 000039C6            600              MOVE.B  (UTLRNDIX),D0
00001378  1030 0800                601              MOVE.B  (A0,D0.L),D0
0000137C  5239 000039C6            602              ADDQ.B  #1,(UTLRNDIX)
00001382  205F                     603              MOVE.L  (A7)+,A0
00001384  4E75                     604              RTS
00001386                           605  
00001386                           606  
00001386= A2 EE 9A 0C F5 24 ...    607  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000138E= 2A A3 51 26 E0 AC ...    608              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001396= 75 51 CA FD 33 EB ...    609              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000139E= 60 CC E7 B8 9A EB ...    610              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013A6= 1D 76 B5 95 B0 89 ...    611              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013AE= 39 15 48 C9 6E CA ...    612              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013B6= 43 E7 E2 7C 37 25 ...    613              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013BE= E9 94 CE E9 E4 52 ...    614              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013C6= 37 6D 9A 84 A2 28 ...    615              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013CE= 19 E2 C6 77 80 D4 ...    616              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013D6= 0A 5A 32 67 33 C2 ...    617              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013DE= 59 80 DC 0E 57 FC ...    618              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013E6= 8A AB BC F7 07 4D ...    619              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013EE= EF D5 77 6E 1E BB ...    620              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013F6= D6 E0 2A 8F BD 28 ...    621              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013FE= 13 4F 66 EC 0A 64 ...    622              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001406= 56 52 9A 16 9B 90 ...    623              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000140E= 06 8A A4 F7 01 DA ...    624              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001416= F2 E7 77 28 B1 76 ...    625              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000141E= A4 42 E3 81 B1 67 ...    626              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001426= BF CE FA 16 BF 38 ...    627              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000142E= D1 8B 50 0C 5F 49 ...    628              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001436= DE 4C 14 A2 40 DC ...    629              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000143E= B6 9B 0A 38 5D AB ...    630              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001446= E2 1B DD 75 15 82 ...    631              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000144E= 8A 26 51 30 9F 47 ...    632              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001456= 1E 8A BB 71 C6 6E ...    633              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000145E= 9F 47 E5 34 94 27 ...    634              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001466= 7D 06 D6 BA 30 0F ...    635              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000146E= EC 7F 7E 03 CF 2D ...    636              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001476= 94 5B 23 F2 8B CD ...    637              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000147E= 74 33 EC B9 0F D5 ...    638              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001486                           639  
00001486                           640  -------------------- end include --------------------
00001486                           641              INCLUDE "BLOCKS.X68"
00001486                           642  
00001486                           643  ; -----------------------------------------------------------------------------
00001486                           644  BLKCOLL 
00001486                           645  ; DETECTS BLOCK COLLISIONS
00001486                           646  ; INPUT    - D0 TOP LEFT CORNER OF OBJECT, D1 TOP RIGHT, D2 BOTTOM RIGHT, D3 BOTTOM LEFT
00001486                           647  ; OUTPUT   - ALL 1'S IN THE REGISTER THAT COLLIDES WITH A BLOCK THAT CANNOT BE TRAVERSED
00001486                           648  ; MODIFIES - D1, D2, D3, D4
00001486                           649  ; -----------------------------------------------------------------------------
00001486                           650      
00001486                           651      
00001486                           652  MAPPLOT
00001486  48E7 FF00                653          MOVEM.L D0-D7, -(A7)
0000148A  48E7 00FE                654          MOVEM.L A0-A6, -(A7)
0000148E  3239 000039A2            655             MOVE.W LOADEDMAP, D1
00001494  C2FC 000C                656             MULU #12, D1
00001498  3241                     657             MOVEA.W D1, A1
0000149A  4EE9 149E                658             JMP MAPSEL(A1)
0000149E                           659  MAPSEL:
0000149E  4EF9 0000272C            660             JMP ELEVATORPLOT
000014A4  4EF9 00001556            661             JMP NEXT
000014AA  41F9 00001D3E            662             LEA HEAVEN_0, A0
000014B0  4EF9 00001556            663             JMP NEXT
000014B6  41F9 00001E8E            664             LEA HEAVEN_1, A0
000014BC  4EF9 00001556            665             JMP NEXT
000014C2  41F9 00001FC9            666             LEA HEAVEN_END, A0
000014C8  4EF9 00001556            667             JMP NEXT
000014CE  41F9 00002104            668             LEA HEAVEN_ROOM, A0
000014D4  4EF9 00001556            669             JMP NEXT
000014DA  41F9 0000223F            670             LEA HELL_0, A0
000014E0  4EF9 00001556            671             JMP NEXT
000014E6  41F9 0000237A            672             LEA HELL_1, A0
000014EC  4EF9 00001556            673             JMP NEXT
000014F2  41F9 000024B5            674             LEA HELL_END, A0
000014F8  4EF9 00001556            675             JMP NEXT
000014FE  41F9 000025F0            676             LEA HELL_ROOM, A0
00001504  4EF9 00001556            677             JMP NEXT
0000150A                           678  MAPUPD
0000150A                           679              
0000150A  3F00                     680              MOVE.W D0, -(A7)
0000150C  3039 000039A2            681              MOVE.W LOADEDMAP, D0
00001512  B07C 0001                682              CMP #1, D0
00001516  6700 0460                683              BEQ MAPA1
0000151A  B07C 0002                684              CMP #2, D0
0000151E  6700 04A0                685              BEQ MAPA2
00001522  B07C 0003                686              CMP #3, D0
00001526  6700 0598                687              BEQ MAPA3
0000152A  B07C 0004                688              CMP #4, D0
0000152E  6700 05DE                689              BEQ MAPA4
00001532  B07C 0005                690              CMP #5, D0
00001536  6700 061E                691              BEQ MAPA5
0000153A  B07C 0006                692              CMP #6, D0
0000153E  6700 065E                693              BEQ MAPA6
00001542  B07C 0007                694              CMP #7, D0
00001546  6700 0756                695              BEQ MAPA7
0000154A  B07C 0008                696              CMP #8, D0
0000154E  6700 079E                697              BEQ MAPA8
00001552  301F                     698              MOVE.W (A7)+, D0
00001554  4E75                     699              RTS
00001556                           700  
00001556                           701      
00001556                           702              
00001556                           703  NEXT
00001556  4281                     704             CLR.L D1
00001558  1218                     705             MOVE.B (A0)+,D1
0000155A  C2FC 0006                706             MULU #6, D1
0000155E  2241                     707             MOVEA.L D1, A1
00001560  4EE9 1564                708             JMP JMPLIST(A1)
00001564                           709             
00001564                           710  JMPLIST: 
00001564  4EF9 00001918            711              JMP NEWLINE ; 0 = END OF ROW
0000156A  4EF9 000015EC            712              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
00001570  4EF9 00001682            713              JMP DBHL    ; 2 = DRAW BRICK HELL
00001576  4EF9 000016F6            714              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
0000157C  4EF9 0000176A            715              JMP DGHL    ; 4 = DRAW GRASS HELL
00001582  4EF9 00001800            716              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
00001588  4EF9 00001820            717              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
0000158E  4EF9 00001840            718              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
00001594  4EF9 000015AC            719              JMP DDHL    ; 8 = DRAW DOOR HELL
0000159A  4EF9 000015CC            720              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
000015A0  4EF9 00001892            721              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
000015A6  4EF9 0000194E            722              JMP ENDMAP  ; 11 = END OF THE MAP
000015AC                           723              
000015AC                           724  DDHL
000015AC  2F3C 00111111            725      MOVE.L #$00111111, -(A7)
000015B2  2F3C 00111111            726      MOVE.L #$00111111, -(A7)
000015B8  4EB9 000018E4            727      JSR DRAWBLOCK
000015BE  2C1F                     728      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000015C0  2C1F                     729      MOVE.L (A7)+, D6    
000015C2  4EB9 0000193C            730      JSR ENDBLOCK
000015C8  4EF8 1556                731      JMP NEXT
000015CC                           732  DDHV
000015CC  2F3C 00FFFFFF            733      MOVE.L #$00FFFFFF, -(A7)
000015D2  2F3C 00FFFFFF            734      MOVE.L #$00FFFFFF, -(A7)
000015D8  4EB9 000018E4            735      JSR DRAWBLOCK
000015DE  2C1F                     736      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000015E0  2C1F                     737      MOVE.L (A7)+, D6
000015E2  4EB9 0000193C            738      JSR ENDBLOCK
000015E8  4EF8 1556                739      JMP NEXT
000015EC                           740  DGHE ;DRAW-GRASS-HEAVEN vvvR
000015EC  2F3C 0099FF99            741      MOVE.L #$0099FF99, -(A7)
000015F2  2F3C 0099FF99            742      MOVE.L #$0099FF99, -(A7)
000015F8  4EB9 000018E4            743      JSR DRAWBLOCK
000015FE  2C1F                     744      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001600  2C1F                     745      MOVE.L (A7)+, D6
00001602                           746      ; SET PEN COLOR 
00001602  103C 0050                747      MOVE.B #80, D0
00001606  223C 0000CC00            748      MOVE.L #$0000CC00, D1
0000160C  4E4F                     749      TRAP #15
0000160E                           750      ;DRAW LINES   
0000160E  103C 0054                751      MOVE.B #84, D0 
00001612                           752      ;LINEA 11 
00001612  3239 0000399A            753      MOVE.W BPOSX1,D1
00001618  5C41                     754      ADD.W #6, D1
0000161A  3439 0000399C            755      MOVE.W BPOSY1, D2
00001620  5A42                     756      ADD.W #5, D2
00001622  3639 0000399A            757      MOVE.W BPOSX1, D3
00001628  0643 0009                758      ADD.W #9, D3
0000162C  3839 0000399C            759      MOVE.W BPOSY1, D4
00001632  0644 000A                760      ADD.W #10, D4
00001636  4E4F                     761      TRAP #15
00001638                           762      ;LINEA 12
00001638  5041                     763      ADD.W #8, D1    
0000163A  5043                     764      ADD.W #8, D3
0000163C  4E4F                     765      TRAP #15
0000163E                           766      ;LINEA 13
0000163E  5041                     767      ADD.W #8, D1    
00001640  5043                     768      ADD.W #8, D3
00001642  4E4F                     769      TRAP #15
00001644                           770      ;LINEA 21
00001644  3239 0000399A            771      MOVE.W BPOSX1,D1
0000164A  5C41                     772      ADD.W #6, D1
0000164C  3439 0000399C            773      MOVE.W BPOSY1, D2
00001652  0642 0014                774      ADD.W #20, D2
00001656  3639 0000399A            775      MOVE.W BPOSX1, D3
0000165C  0643 0009                776      ADD.W #9, D3
00001660  3839 0000399C            777      MOVE.W BPOSY1, D4
00001666  0644 0019                778      ADD.W #25, D4
0000166A  4E4F                     779      TRAP #15
0000166C                           780      ;LINEA 22
0000166C  5041                     781      ADD.W #8, D1    
0000166E  5043                     782      ADD.W #8, D3
00001670  4E4F                     783      TRAP #15
00001672                           784      ;LINEA 23
00001672  5041                     785      ADD.W #8, D1    
00001674  5043                     786      ADD.W #8, D3
00001676  4E4F                     787      TRAP #15
00001678  4EB9 0000193C            788      JSR ENDBLOCK
0000167E  4EF8 1556                789      JMP NEXT
00001682                           790  DBHL ;DRAW BRICK-HELL vvvR
00001682                           791      
00001682  2F3C 00010101            792      MOVE.L #$00010101, -(A7)
00001688  2F3C 00666666            793      MOVE.L #$00666666, -(A7)
0000168E  4EB9 000018E4            794      JSR DRAWBLOCK
00001694  2C1F                     795      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001696  2C1F                     796      MOVE.L (A7)+, D6
00001698                           797      ;DRAW HORIZONTAL LINE
00001698  103C 0054                798      MOVE.B #84, D0 
0000169C  3239 0000399A            799      MOVE.W BPOSX1, D1
000016A2  3439 0000399C            800      MOVE.W BPOSY1, D2
000016A8  0642 0010                801      ADD.W #16, D2
000016AC  3639 0000399A            802      MOVE.W BPOSX1, D3
000016B2  0643 0020                803      ADD.W #32, D3
000016B6  3839 0000399C            804      MOVE.W BPOSY1, D4
000016BC  0644 0010                805      ADD.W #16, D4
000016C0  4E4F                     806      TRAP #15
000016C2                           807      ;DRAW VERTICAL LINE 
000016C2  3239 0000399A            808      MOVE.W BPOSX1, D1
000016C8  0641 0010                809      ADD.W #16, D1
000016CC  3439 0000399C            810      MOVE.W BPOSY1, D2
000016D2  0642 0010                811      ADD.W #16, D2
000016D6  3639 0000399A            812      MOVE.W BPOSX1, D3
000016DC  0643 0010                813      ADD.W #16, D3
000016E0  3839 0000399C            814      MOVE.W BPOSY1, D4
000016E6  0644 0020                815      ADD.W #32, D4
000016EA  4E4F                     816      TRAP #15
000016EC  4EB9 0000193C            817      JSR ENDBLOCK    
000016F2  4EF8 1556                818      JMP NEXT
000016F6                           819  DBHV ;DRAW BRICK-HEAVEN vvvR
000016F6                           820      
000016F6  2F3C 00CCCCCC            821      MOVE.L #$00CCCCCC, -(A7)
000016FC  2F3C 00D7EBFA            822      MOVE.L #$00D7EBFA, -(A7)
00001702  4EB9 000018E4            823      JSR DRAWBLOCK
00001708  2C1F                     824      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000170A  2C1F                     825      MOVE.L (A7)+, D6
0000170C                           826      ;DRAW HORIZONTAL LINE
0000170C  103C 0054                827      MOVE.B #84, D0 
00001710  3239 0000399A            828      MOVE.W BPOSX1, D1
00001716  3439 0000399C            829      MOVE.W BPOSY1, D2
0000171C  0642 0010                830      ADD.W #16, D2
00001720  3639 0000399A            831      MOVE.W BPOSX1, D3
00001726  0643 0020                832      ADD.W #32, D3
0000172A  3839 0000399C            833      MOVE.W BPOSY1, D4
00001730  0644 0010                834      ADD.W #16, D4
00001734  4E4F                     835      TRAP #15
00001736                           836      ;DRAW VERTICAL LINE 
00001736  3239 0000399A            837      MOVE.W BPOSX1, D1
0000173C  0641 0010                838      ADD.W #16, D1
00001740  3439 0000399C            839      MOVE.W BPOSY1, D2
00001746  0642 0010                840      ADD.W #16, D2
0000174A  3639 0000399A            841      MOVE.W BPOSX1, D3
00001750  0643 0010                842      ADD.W #16, D3
00001754  3839 0000399C            843      MOVE.W BPOSY1, D4
0000175A  0644 0020                844      ADD.W #32, D4
0000175E  4E4F                     845      TRAP #15 
00001760  4EB9 0000193C            846      JSR ENDBLOCK
00001766  4EF8 1556                847      JMP NEXT
0000176A                           848  DGHL ;DRAW GRASS HELL vvvR
0000176A                           849  
0000176A  2F3C 002255EE            850      MOVE.L #$002255EE, -(A7)
00001770  2F3C 002255EE            851      MOVE.L #$002255EE, -(A7)
00001776  4EB9 000018E4            852      JSR DRAWBLOCK
0000177C  2C1F                     853      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000177E  2C1F                     854      MOVE.L (A7)+, D6
00001780                           855      ; SET PEN COLOR 
00001780  103C 0050                856      MOVE.B #80, D0
00001784  223C 000000CC            857      MOVE.L #$000000CC, D1
0000178A  4E4F                     858      TRAP #15
0000178C                           859      ;DRAW LINES   
0000178C  103C 0054                860      MOVE.B #84, D0 
00001790                           861      ;LINEA 11 
00001790  3239 0000399A            862      MOVE.W BPOSX1,D1
00001796  5C41                     863      ADD.W #6, D1
00001798  3439 0000399C            864      MOVE.W BPOSY1, D2
0000179E  5A42                     865      ADD.W #5, D2
000017A0  3639 0000399A            866      MOVE.W BPOSX1, D3
000017A6  0643 0009                867      ADD.W #9, D3
000017AA  3839 0000399C            868      MOVE.W BPOSY1, D4
000017B0  0644 000A                869      ADD.W #10, D4
000017B4  4E4F                     870      TRAP #15
000017B6                           871      ;LINEA 12
000017B6  5041                     872      ADD.W #8, D1    
000017B8  5043                     873      ADD.W #8, D3
000017BA  4E4F                     874      TRAP #15
000017BC                           875      ;LINEA 13
000017BC  5041                     876      ADD.W #8, D1    
000017BE  5043                     877      ADD.W #8, D3
000017C0  4E4F                     878      TRAP #15
000017C2                           879      ;LINEA 21
000017C2  3239 0000399A            880      MOVE.W BPOSX1,D1
000017C8  5C41                     881      ADD.W #6, D1
000017CA  3439 0000399C            882      MOVE.W BPOSY1, D2
000017D0  0642 0014                883      ADD.W #20, D2
000017D4  3639 0000399A            884      MOVE.W BPOSX1, D3
000017DA  0643 0009                885      ADD.W #9, D3
000017DE  3839 0000399C            886      MOVE.W BPOSY1, D4
000017E4  0644 0019                887      ADD.W #25, D4
000017E8  4E4F                     888      TRAP #15
000017EA                           889      ;LINEA 22
000017EA  5041                     890      ADD.W #8, D1    
000017EC  5043                     891      ADD.W #8, D3
000017EE  4E4F                     892      TRAP #15
000017F0                           893      ;LINEA 23
000017F0  5041                     894      ADD.W #8, D1    
000017F2  5043                     895      ADD.W #8, D3
000017F4  4E4F                     896      TRAP #15
000017F6  4EB9 0000193C            897      JSR ENDBLOCK
000017FC  4EF8 1556                898      JMP NEXT
00001800                           899  
00001800                           900  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
00001800  2F3C 00CCCCCC            901      MOVE.L #$00CCCCCC, -(A7)
00001806  2F3C 00C6DAE9            902      MOVE.L #$00C6DAE9, -(A7)
0000180C  4EB9 000018E4            903      JSR DRAWBLOCK
00001812  2C1F                     904      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001814  2C1F                     905      MOVE.L (A7)+, D6
00001816  4EB9 0000193C            906      JSR ENDBLOCK
0000181C  4EF8 1556                907      JMP NEXT
00001820                           908  DF1HL ; DRAW FLOOR_1 HELL vvvR 
00001820  2F3C 00010101            909      MOVE.L #$00010101, -(A7)
00001826  2F3C 00777777            910      MOVE.L #$00777777, -(A7)
0000182C  4EB9 000018E4            911      JSR DRAWBLOCK
00001832  2C1F                     912      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001834  2C1F                     913      MOVE.L (A7)+, D6
00001836                           914  
00001836  4EB9 0000193C            915      JSR ENDBLOCK
0000183C  4EF8 1556                916      JMP NEXT
00001840                           917      
00001840                           918  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
00001840  2F3C 00CCCCCC            919      MOVE.L #$00CCCCCC, -(A7)
00001846  2F3C 00C6DAE9            920      MOVE.L #$00C6DAE9, -(A7)
0000184C  4EB9 000018E4            921      JSR DRAWBLOCK
00001852  2C1F                     922      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001854  2C1F                     923      MOVE.L (A7)+, D6
00001856                           924      ;SET NEW FILL COLOR  
00001856  103C 0051                925      MOVE.B #81, D0
0000185A  223C 00D7EBFA            926      MOVE.L #$00D7EBFA, D1
00001860  4E4F                     927      TRAP #15 
00001862                           928      ;DRAW INSIDE SQUARE 
00001862  103C 0057                929      MOVE.B #87, D0
00001866  3239 0000399A            930      MOVE.W BPOSX1, D1
0000186C  5041                     931      ADD.W #8, D1
0000186E  3439 0000399C            932      MOVE.W BPOSY1, D2
00001874  5042                     933      ADD.W #8, D2
00001876  3639 0000399E            934      MOVE.W BPOSX2, D3
0000187C  5143                     935      SUB.W #8, D3
0000187E  3839 000039A0            936      MOVE.W BPOSY2, D4
00001884  5144                     937      SUB.W #8, D4
00001886  4E4F                     938      TRAP #15
00001888  4EB9 0000193C            939      JSR ENDBLOCK
0000188E  4EF8 1556                940      JMP NEXT
00001892                           941  DF2HL ; DRAW FLOOR_2 HELL vvvR
00001892  2F3C 00010101            942      MOVE.L #$00010101, -(A7)
00001898  2F3C 00777777            943      MOVE.L #$00777777, -(A7)
0000189E  4EB9 000018E4            944      JSR DRAWBLOCK
000018A4  2C1F                     945      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018A6  2C1F                     946      MOVE.L (A7)+, D6
000018A8                           947      ;SET NEW FILL COLOR  
000018A8  103C 0051                948      MOVE.B #81, D0
000018AC  223C 00666666            949      MOVE.L #$00666666, D1
000018B2  4E4F                     950      TRAP #15 
000018B4                           951  ;DRAW INSIDE SQUARE 
000018B4  103C 0057                952      MOVE.B #87, D0
000018B8  3239 0000399A            953      MOVE.W BPOSX1, D1
000018BE  5041                     954      ADD.W #8, D1
000018C0  3439 0000399C            955      MOVE.W BPOSY1, D2
000018C6  5042                     956      ADD.W #8, D2
000018C8  3639 0000399E            957      MOVE.W BPOSX2, D3
000018CE  5143                     958      SUB.W #8, D3
000018D0  3839 000039A0            959      MOVE.W BPOSY2, D4
000018D6  5144                     960      SUB.W #8, D4
000018D8  4E4F                     961      TRAP #15
000018DA  4EB9 0000193C            962      JSR ENDBLOCK
000018E0  4EF8 1556                963      JMP NEXT    
000018E4                           964      
000018E4                           965  DRAWBLOCK 
000018E4                           966  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPUS COMO LONGS. 
000018E4                           967      
000018E4                           968      ;SET FILL COLOR  
000018E4  103C 0051                969      MOVE.B #81, D0
000018E8  222F 0004                970      MOVE.L 4(A7), D1
000018EC  4E4F                     971      TRAP #15 
000018EE                           972      
000018EE                           973      ; SET PEN COLOR 
000018EE  103C 0050                974      MOVE.B #80, D0
000018F2  222F 0008                975      MOVE.L 8(A7), D1
000018F6  4E4F                     976      TRAP #15 
000018F8                           977  
000018F8                           978      ;DRAW BLOCK 
000018F8  103C 0057                979      MOVE.B #87, D0
000018FC  3239 0000399A            980      MOVE.W BPOSX1, D1
00001902  3439 0000399C            981      MOVE.W BPOSY1, D2
00001908  3639 0000399E            982      MOVE.W BPOSX2, D3
0000190E  3839 000039A0            983      MOVE.W BPOSY2, D4
00001914  4E4F                     984      TRAP #15
00001916  4E75                     985      RTS
00001918                           986  
00001918                           987  NEWLINE
00001918                           988      ;RESET X POSITION
00001918  33FC 0000 0000399A       989      MOVE.W #0, BPOSX1
00001920  33FC 0020 0000399E       990      MOVE.W #32, BPOSX2
00001928                           991      ;ADD 33 TO Y POSITION
00001928  0679 0020 0000399C       992      ADD.W #32, BPOSY1
00001930  0679 0020 000039A0       993      ADD.W #32, BPOSY2
00001938  4EF8 1556                994      JMP NEXT
0000193C                           995     
0000193C                           996  ENDBLOCK
0000193C                           997      ;SET NEW BLOCK POSITION
0000193C  0679 0020 0000399A       998      ADD.W #32, BPOSX1
00001944  0679 0020 0000399E       999      ADD.W #32, BPOSX2
0000194C  4E75                    1000      RTS
0000194E                          1001  ENDMAP
0000194E                          1002      ;SET DEFAULT BLOCK POSITION
0000194E  33FC 0000 0000399A      1003      MOVE.W #0, BPOSX1
00001956  33FC 0000 0000399C      1004      MOVE.W #0, BPOSY1
0000195E  33FC 0020 0000399E      1005      MOVE.W #32, BPOSX2
00001966  33FC 0020 000039A0      1006      MOVE.W #32, BPOSY2
0000196E  4CDF 7F00               1007      MOVEM.L (A7)+, A0-A6
00001972  4CDF 00FF               1008      MOVEM.L (A7)+, D0-D7
00001976  4E75                    1009      RTS
00001978                          1010      
00001978                          1011  
00001978                          1012  
00001978                          1013  MAPA1
00001978  301F                    1014      MOVE.W (A7)+, D0
0000197A  48A7 F800               1015      MOVEM.W D0-D4, -(A7)
0000197E  3039 00003994           1016      MOVE.W PLAYERPOSX, D0
00001984  3239 00003996           1017      MOVE.W PLAYERPOSY, D1
0000198A                          1018      ;GO TO THE NEXT ROOM DOOR
0000198A                          1019      ;FIRST LETS CHECH POS X
0000198A  B07C 0160               1020      CMP #352, D0  ; BGT = 352 > D0
0000198E  6E00 002A               1021      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001992  B07C 0120               1022      CMP #288, D0
00001996  6D00 0022               1023      BLT MAP1NODOOR
0000199A                          1024      ;NOW WE CHECK POS Y 
0000199A  B27C 01E0               1025      CMP #480, D1  ; 
0000199E  6E00 001A               1026      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019A2  B27C 01C0               1027      CMP #448, D1
000019A6  6D00 0012               1028      BLT MAP1NODOOR
000019AA  33FC 0020 00003996      1029      MOVE.W #32, PLAYERPOSY
000019B2  33FC 0002 000039A2      1030      MOVE.W #2, LOADEDMAP
000019BA                          1031  MAP1NODOOR
000019BA  4C9F 001F               1032      MOVEM.W (A7)+, D0-D4
000019BE  4E75                    1033      RTS
000019C0                          1034      
000019C0                          1035  MAPA2
000019C0  301F                    1036      MOVE.W (A7)+, D0
000019C2  48A7 F800               1037      MOVEM.W D0-D4, -(A7)
000019C6  3039 00003994           1038      MOVE.W PLAYERPOSX, D0
000019CC  3239 00003996           1039      MOVE.W PLAYERPOSY, D1
000019D2                          1040      ;GO TO THE NEXT ROOM DOOR
000019D2                          1041      ;FIRST LETS CHECK POS X
000019D2  B07C 0160               1042      CMP #352, D0  ; BGT = 352 > D0
000019D6  6E00 0030               1043      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019DA  B07C 0120               1044      CMP #288, D0
000019DE  6D00 0028               1045      BLT MAP2NODOOR1
000019E2                          1046      ;NOW WE CHECK POS Y 
000019E2  B27C 01E0               1047      CMP #480, D1  ; 
000019E6  6E00 0020               1048      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019EA  B27C 01C0               1049      CMP #448, D1
000019EE  6D00 0018               1050      BLT MAP2NODOOR1
000019F2  33FC 0020 00003996      1051      MOVE.W #32, PLAYERPOSY
000019FA  33FC 0003 000039A2      1052      MOVE.W #3, LOADEDMAP
00001A02  4C9F 001F               1053      MOVEM.W (A7)+, D0-D4
00001A06  4E75                    1054      RTS
00001A08                          1055  MAP2NODOOR1
00001A08                          1056      ;GO TO THE PREVIOUS ROOM DOOR
00001A08                          1057      ;FIRST LETS CHECK POS X
00001A08  B07C 0160               1058      CMP #352, D0  ; BGT = 352 > D0
00001A0C  6E00 0030               1059      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A10  B07C 0120               1060      CMP #288, D0
00001A14  6D00 0028               1061      BLT MAP2NODOOR2
00001A18                          1062      ;NOW WE CHECK POS Y 
00001A18  B27C 0020               1063      CMP #32, D1  ; 
00001A1C  6E00 0020               1064      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A20  B27C 0000               1065      CMP #0, D1
00001A24  6D00 0018               1066      BLT MAP2NODOOR2
00001A28  33FC 01A0 00003996      1067      MOVE.W  #416, PLAYERPOSY
00001A30  33FC 0001 000039A2      1068      MOVE.W #1, LOADEDMAP
00001A38  4C9F 001F               1069      MOVEM.W (A7)+, D0-D4
00001A3C  4E75                    1070      RTS
00001A3E                          1071  
00001A3E                          1072  MAP2NODOOR2
00001A3E                          1073      ;GO TO THE LEFT HEAVEN'S ROOM
00001A3E  B07C 00A0               1074      CMP #160, D0  ; BGT = 352 > D0
00001A42  6E00 0038               1075      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A46  B07C 0080               1076      CMP #128, D0
00001A4A  6D00 0030               1077      BLT MAP2NODOOR3
00001A4E                          1078      ;NOW WE CHECK POS Y 
00001A4E  B27C 00AA               1079      CMP #170, D1  ; 
00001A52  6E00 0028               1080      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A56  B27C 0078               1081      CMP #120, D1
00001A5A  6D00 0020               1082      BLT MAP2NODOOR3
00001A5E  33FC 0130 00003994      1083      MOVE.W #$130, PLAYERPOSX
00001A66  33FC 00B0 00003996      1084      MOVE.W #$0B0, PLAYERPOSY
00001A6E  33FC 0004 000039A2      1085      MOVE.W #4, LOADEDMAP
00001A76  4C9F 001F               1086      MOVEM.W (A7)+, D0-D4
00001A7A  4E75                    1087      RTS
00001A7C                          1088  MAP2NODOOR3
00001A7C                          1089      ;GO TO THE RIGHT HEAVEN'S ROOM
00001A7C  B07C 01E0               1090      CMP #480, D0  ; BGT = 352 > D0
00001A80  6E00 0038               1091      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A84  B07C 01C0               1092      CMP #448, D0
00001A88  6D00 0030               1093      BLT MAP2NODOOR4
00001A8C                          1094      ;NOW WE CHECK POS Y 
00001A8C  B27C 00AA               1095      CMP #170, D1  ; 
00001A90  6E00 0028               1096      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A94  B27C 0078               1097      CMP #120, D1
00001A98  6D00 0020               1098      BLT MAP2NODOOR4
00001A9C  33FC 0130 00003994      1099      MOVE.W #$130, PLAYERPOSX
00001AA4  33FC 00B0 00003996      1100      MOVE.W #$0B0, PLAYERPOSY
00001AAC  33FC 0004 000039A2      1101      MOVE.W #4, LOADEDMAP
00001AB4  4C9F 001F               1102      MOVEM.W (A7)+, D0-D4
00001AB8  4E75                    1103      RTS
00001ABA                          1104  MAP2NODOOR4
00001ABA  4C9F 001F               1105      MOVEM.W (A7)+, D0-D4
00001ABE  4E75                    1106      RTS
00001AC0                          1107  MAPA3 
00001AC0  301F                    1108      MOVE.W (A7)+, D0
00001AC2  48A7 F800               1109      MOVEM.W D0-D4, -(A7)
00001AC6  3039 00003994           1110      MOVE.W PLAYERPOSX, D0
00001ACC  3239 00003996           1111      MOVE.W PLAYERPOSY, D1
00001AD2                          1112      ;GO TO THE PREVIOUS ROOM DOOR
00001AD2                          1113      ;FIRST LETS CHECK POS X
00001AD2  B07C 0160               1114      CMP #352, D0  ; BGT = 352 > D0
00001AD6  6E00 0030               1115      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ADA  B07C 0120               1116      CMP #288, D0
00001ADE  6D00 0028               1117      BLT MAP3NODOOR
00001AE2                          1118      ;NOW WE CHECK POS Y 
00001AE2  B27C 0020               1119      CMP #32, D1  ; 
00001AE6  6E00 0020               1120      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AEA  B27C 0000               1121      CMP #0, D1
00001AEE  6D00 0018               1122      BLT MAP3NODOOR
00001AF2  33FC 01A0 00003996      1123      MOVE.W  #416, PLAYERPOSY
00001AFA  33FC 0002 000039A2      1124      MOVE.W #2, LOADEDMAP
00001B02  4C9F 001F               1125      MOVEM.W (A7)+, D0-D4
00001B06  4E75                    1126      RTS
00001B08                          1127  MAP3NODOOR
00001B08  4C9F 001F               1128      MOVEM.W (A7)+, D0-D4
00001B0C  4E75                    1129      RTS
00001B0E                          1130  MAPA4
00001B0E  301F                    1131      MOVE.W (A7)+, D0
00001B10  48A7 F800               1132      MOVEM.W D0-D4, -(A7)
00001B14  3039 00003994           1133      MOVE.W PLAYERPOSX, D0
00001B1A  3239 00003996           1134      MOVE.W PLAYERPOSY, D1
00001B20                          1135      ;GO BACK TO 2ND HEAVEN'S ROOM
00001B20  B07C 0180               1136      CMP #384, D0  ; BGT = 352 > D0
00001B24  6E00 002A               1137      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B28  B07C 0104               1138      CMP #260, D0
00001B2C  6D00 0022               1139      BLT MAP4NODOOR
00001B30                          1140      ;NOW WE CHECK POS Y 
00001B30  B27C 0080               1141      CMP #128, D1  ; 
00001B34  6E00 001A               1142      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B38  B27C 0060               1143      CMP #96, D1
00001B3C  6D00 0012               1144      BLT MAP4NODOOR
00001B40  33FC 00E0 00003994      1145      MOVE.W  #224, PLAYERPOSX
00001B48  33FC 0002 000039A2      1146      MOVE.W #2, LOADEDMAP
00001B50                          1147  MAP4NODOOR
00001B50  4C9F 001F               1148      MOVEM.W (A7)+, D0-D4
00001B54  4E75                    1149      RTS
00001B56                          1150  ;;;;;;;;;;HELL
00001B56                          1151  MAPA5
00001B56  301F                    1152      MOVE.W (A7)+, D0
00001B58  48A7 F800               1153      MOVEM.W D0-D4, -(A7)
00001B5C  3039 00003994           1154      MOVE.W PLAYERPOSX, D0
00001B62  3239 00003996           1155      MOVE.W PLAYERPOSY, D1
00001B68                          1156      ;GO TO THE NEXT ROOM DOOR
00001B68                          1157      ;FIRST LETS CHECH POS X
00001B68  B07C 0160               1158      CMP #352, D0  ; BGT = 352 > D0
00001B6C  6E00 002A               1159      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B70  B07C 0120               1160      CMP #288, D0
00001B74  6D00 0022               1161      BLT MAP5NODOOR
00001B78                          1162      ;NOW WE CHECK POS Y 
00001B78  B27C 01E0               1163      CMP #480, D1  ; 
00001B7C  6E00 001A               1164      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B80  B27C 01C0               1165      CMP #448, D1
00001B84  6D00 0012               1166      BLT MAP5NODOOR
00001B88  33FC 0020 00003996      1167      MOVE.W #32, PLAYERPOSY
00001B90  33FC 0006 000039A2      1168      MOVE.W #6, LOADEDMAP
00001B98                          1169  MAP5NODOOR
00001B98  4C9F 001F               1170      MOVEM.W (A7)+, D0-D4
00001B9C  4E75                    1171      RTS
00001B9E                          1172      
00001B9E                          1173  MAPA6
00001B9E  301F                    1174      MOVE.W (A7)+, D0
00001BA0  48A7 F800               1175      MOVEM.W D0-D4, -(A7)
00001BA4  3039 00003994           1176      MOVE.W PLAYERPOSX, D0
00001BAA  3239 00003996           1177      MOVE.W PLAYERPOSY, D1
00001BB0                          1178      ;GO TO THE NEXT ROOM DOOR
00001BB0                          1179      ;FIRST LETS CHECK POS X
00001BB0  B07C 0160               1180      CMP #352, D0  ; BGT = 352 > D0
00001BB4  6E00 0030               1181      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BB8  B07C 0120               1182      CMP #288, D0
00001BBC  6D00 0028               1183      BLT MAP6NODOOR1
00001BC0                          1184      ;NOW WE CHECK POS Y 
00001BC0  B27C 01E0               1185      CMP #480, D1  ; 
00001BC4  6E00 0020               1186      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BC8  B27C 01C0               1187      CMP #448, D1
00001BCC  6D00 0018               1188      BLT MAP6NODOOR1
00001BD0  33FC 0020 00003996      1189      MOVE.W #32, PLAYERPOSY
00001BD8  33FC 0007 000039A2      1190      MOVE.W #7, LOADEDMAP
00001BE0  4C9F 001F               1191      MOVEM.W (A7)+, D0-D4
00001BE4  4E75                    1192      RTS
00001BE6                          1193  MAP6NODOOR1
00001BE6                          1194      ;GO TO THE PREVIOUS ROOM DOOR
00001BE6                          1195      ;FIRST LETS CHECK POS X
00001BE6  B07C 0160               1196      CMP #352, D0  ; BGT = 352 > D0
00001BEA  6E00 0030               1197      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BEE  B07C 0120               1198      CMP #288, D0
00001BF2  6D00 0028               1199      BLT MAP6NODOOR2
00001BF6                          1200      ;NOW WE CHECK POS Y 
00001BF6  B27C 0020               1201      CMP #32, D1  ; 
00001BFA  6E00 0020               1202      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BFE  B27C 0000               1203      CMP #0, D1
00001C02  6D00 0018               1204      BLT MAP6NODOOR2
00001C06  33FC 01A0 00003996      1205      MOVE.W  #416, PLAYERPOSY
00001C0E  33FC 0005 000039A2      1206      MOVE.W #5, LOADEDMAP
00001C16  4C9F 001F               1207      MOVEM.W (A7)+, D0-D4
00001C1A  4E75                    1208      RTS
00001C1C                          1209  MAP6NODOOR2
00001C1C                          1210      ;CHECK FOR LEFT HELL ROOM
00001C1C  B07C 0060               1211      CMP #96, D0  ; BGT = 352 > D0
00001C20  6E00 0038               1212      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C24  B07C 0040               1213      CMP #64, D0
00001C28  6D00 0030               1214      BLT MAP6NODOOR3
00001C2C                          1215      ;NOW WE CHECK POS Y 
00001C2C  B27C 0180               1216      CMP #384, D1  ; 
00001C30  6E00 0028               1217      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C34  B27C 0140               1218      CMP #320, D1
00001C38  6D00 0020               1219      BLT MAP6NODOOR3
00001C3C  33FC 0130 00003994      1220      MOVE.W #$130, PLAYERPOSX
00001C44  33FC 00B0 00003996      1221      MOVE.W #$0B0, PLAYERPOSY
00001C4C  33FC 0008 000039A2      1222      MOVE.W #8, LOADEDMAP
00001C54  4C9F 001F               1223      MOVEM.W (A7)+, D0-D4
00001C58  4E75                    1224      RTS
00001C5A                          1225  MAP6NODOOR3
00001C5A                          1226      ;CHECK FOR THE RIGHT HELL ROOM
00001C5A  B07C 0240               1227      CMP #576, D0  ; BGT = 352 > D0
00001C5E  6E00 0038               1228      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C62  B07C 021C               1229      CMP #540, D0
00001C66  6D00 0030               1230      BLT MAP6NODOOR4
00001C6A                          1231      ;NOW WE CHECK POS Y 
00001C6A  B27C 0180               1232      CMP #384, D1  ; 
00001C6E  6E00 0028               1233      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C72  B27C 0140               1234      CMP #320, D1
00001C76  6D00 0020               1235      BLT MAP6NODOOR4
00001C7A  33FC 0130 00003994      1236      MOVE.W #$130, PLAYERPOSX
00001C82  33FC 00B0 00003996      1237      MOVE.W #$0B0, PLAYERPOSY
00001C8A  33FC 0008 000039A2      1238      MOVE.W #8, LOADEDMAP
00001C92  4C9F 001F               1239      MOVEM.W (A7)+, D0-D4
00001C96  4E75                    1240      RTS
00001C98                          1241  MAP6NODOOR4
00001C98  4C9F 001F               1242      MOVEM.W (A7)+, D0-D4
00001C9C  4E75                    1243      RTS
00001C9E                          1244  MAPA7 
00001C9E  301F                    1245      MOVE.W (A7)+, D0
00001CA0  48A7 F800               1246      MOVEM.W D0-D4, -(A7)
00001CA4  3039 00003994           1247      MOVE.W PLAYERPOSX, D0
00001CAA  3239 00003996           1248      MOVE.W PLAYERPOSY, D1
00001CB0                          1249      ;GO BACK TO PREVIOUS HELL'S ROOM
00001CB0  B07C 0180               1250      CMP #384, D0  ; BGT = 352 > D0
00001CB4  6E00 0032               1251      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CB8  B07C 0104               1252      CMP #260, D0
00001CBC  6D00 002A               1253      BLT MAP7NODOOR
00001CC0                          1254      ;NOW WE CHECK POS Y 
00001CC0  B27C 0020               1255      CMP #32, D1  ; 
00001CC4  6E00 0022               1256      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CC8  B27C 0000               1257      CMP #0, D1
00001CCC  6D00 001A               1258      BLT MAP7NODOOR
00001CD0  33FC 0140 00003994      1259      MOVE.W  #320, PLAYERPOSX
00001CD8  33FC 01A0 00003996      1260      MOVE.W #416, PLAYERPOSY
00001CE0  33FC 0006 000039A2      1261      MOVE.W #6, LOADEDMAP
00001CE8                          1262  MAP7NODOOR
00001CE8  4C9F 001F               1263      MOVEM.W (A7)+, D0-D4
00001CEC  4E75                    1264      RTS
00001CEE                          1265  MAPA8
00001CEE                          1266       ;HELLS ROOM
00001CEE  301F                    1267      MOVE.W (A7)+, D0
00001CF0  48A7 F800               1268      MOVEM.W D0-D4, -(A7)
00001CF4  3039 00003994           1269      MOVE.W PLAYERPOSX, D0
00001CFA  3239 00003996           1270      MOVE.W PLAYERPOSY, D1
00001D00                          1271      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D00  B07C 0180               1272      CMP #384, D0  ; BGT = 352 > D0
00001D04  6E00 0032               1273      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D08  B07C 0104               1274      CMP #260, D0
00001D0C  6D00 002A               1275      BLT MAP8NODOOR1
00001D10                          1276      ;NOW WE CHECK POS Y 
00001D10  B27C 0080               1277      CMP #128, D1  ; 
00001D14  6E00 0022               1278      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D18  B27C 0060               1279      CMP #96, D1
00001D1C  6D00 001A               1280      BLT MAP8NODOOR1
00001D20  33FC 0140 00003994      1281      MOVE.W  #320, PLAYERPOSX
00001D28  33FC 0080 00003996      1282      MOVE.W #128, PLAYERPOSY
00001D30  33FC 0006 000039A2      1283      MOVE.W #6, LOADEDMAP
00001D38                          1284  MAP8NODOOR1
00001D38  4C9F 001F               1285      MOVEM.W (A7)+, D0-D4
00001D3C  4E75                    1286      RTS
00001D3E                          1287  
00001D3E                          1288  
00001D3E                          1289  
00001D3E                          1290  
00001D3E                          1291  
00001D3E                          1292  
00001D3E                          1293  
00001D3E                          1294  
00001D3E                          1295  
00001D3E                          1296  
00001D3E                          1297  
00001D3E                          1298  
00001D3E                          1299  
00001D3E                          1300  
00001D3E                          1301  -------------------- end include --------------------
00001D3E                          1302              INCLUDE "MAPS.X68"
00001D3E                          1303  
00001D3E                          1304  ;MAP 0 INDICATES THAT WE ARE IN THE ELEVATOR MENU. 
00001D3E                          1305  
00001D3E                          1306  HEAVEN_0    ;MAP 1
00001D3E= 03 03 03 03 03 03 ...   1307      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00001D53= 03 01 01 01 01 01 ...   1308      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
00001D68= 03 01 03 03 03 03 ...   1309      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
00001D7D= 03 01 03 05 05 05 ...   1310      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00001D92= 03 01 03 05 05 05 ...   1311      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DA7= 03 01 03 05 05 05 ...   1312      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DBC= 03 01 03 05 05 05 ...   1313      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001DD1= 03 01 03 05 05 05 ...   1314      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001DE6= 03 01 03 05 05 05 ...   1315      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DFB= 03 01 03 05 05 05 ...   1316      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E10= 03 01 03 05 05 05 ...   1317      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E25= 03 01 03 05 05 05 ...   1318      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E3A= 03 01 03 05 05 05 ...   1319      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E4F= 03 01 03 03 03 03 ...   1320      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00001E64= 03 01 01 01 01 01 ...   1321      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001E79= 03 03 03 03 03 03 ...   1322      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001E8E                          1323          
00001E8E                          1324  HEAVEN_1    ;MAP 2
00001E8E= 03 03 03 03 03 03 ...   1325      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001EA3= 03 03 01 01 01 01 ...   1326      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
00001EB8= 03 03 03 03 03 03 ...   1327      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
00001ECD= 03 07 07 07 07 03 ...   1328      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001EE2= 03 07 07 07 07 03 ...   1329      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001EF7= 03 07 07 07 07 09 ...   1330      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
00001F0C= 03 07 07 07 07 03 ...   1331      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00001F21= 03 07 07 07 07 03 ...   1332      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F36= 03 03 03 03 03 03 ...   1333      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
00001F4B= 03 01 01 01 01 03 ...   1334      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00001F60= 03 01 01 01 01 01 ...   1335      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00001F75= 03 01 01 01 01 01 ...   1336      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001F8A= 03 01 01 01 01 01 ...   1337      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001F9F= 03 01 01 01 01 01 ...   1338      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001FB4= 03 03 03 03 03 03 ...   1339      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001FC9                          1340      
00001FC9                          1341  HEAVEN_END  ;MAP 3
00001FC9= 03 03 03 03 03 03 ...   1342      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001FDE= 03 05 05 05 05 05 ...   1343      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00001FF3= 03 05 05 07 05 05 ...   1344      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002008= 03 05 07 07 07 05 ...   1345      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
0000201D= 03 05 05 07 05 05 ...   1346      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00002032= 03 05 05 07 05 05 ...   1347      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00002047= 03 05 05 05 05 05 ...   1348      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
0000205C= 03 05 05 05 05 05 ...   1349      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00002071= 03 05 05 05 05 05 ...   1350      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00002086= 03 05 05 07 05 05 ...   1351      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000209B= 03 05 07 07 07 05 ...   1352      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
000020B0= 03 05 05 07 05 05 ...   1353      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000020C5= 03 05 05 07 05 05 ...   1354      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000020DA= 03 05 05 05 05 05 ...   1355      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
000020EF= 03 03 03 03 03 03 ...   1356      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
00002104                          1357      
00002104                          1358  HEAVEN_ROOM ;MAP 4
00002104= 09 09 09 09 09 09 ...   1359      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002119= 09 09 09 09 09 09 ...   1360      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000212E= 09 09 09 09 09 09 ...   1361      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002143= 09 09 09 09 09 09 ...   1362      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002158= 09 09 09 09 09 03 ...   1363      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
0000216D= 09 09 09 09 09 03 ...   1364      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002182= 09 09 09 09 09 03 ...   1365      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002197= 09 09 09 09 09 03 ...   1366      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021AC= 09 09 09 09 09 03 ...   1367      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021C1= 09 09 09 09 09 03 ...   1368      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021D6= 09 09 09 09 09 03 ...   1369      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
000021EB= 09 09 09 09 09 09 ...   1370      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002200= 09 09 09 09 09 09 ...   1371      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002215= 09 09 09 09 09 09 ...   1372      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000222A= 09 09 09 09 09 09 ...   1373      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
0000223F                          1374      
0000223F                          1375  HELL_0  ;MAP 5
0000223F= 02 02 02 02 02 02 ...   1376      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
00002254= 02 06 06 06 06 06 ...   1377      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002269= 02 06 06 04 06 06 ...   1378      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
0000227E= 02 06 06 04 06 06 ...   1379      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00002293= 02 06 04 04 04 06 ...   1380      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
000022A8= 02 06 06 04 06 06 ...   1381      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
000022BD= 02 06 06 06 06 06 ...   1382      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022D2= 02 02 02 02 02 02 ...   1383      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
000022E7= 02 06 06 06 06 06 ...   1384      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022FC= 02 06 06 06 06 06 ...   1385      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002311= 02 06 06 06 06 06 ...   1386      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002326= 02 06 06 06 06 06 ...   1387      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000233B= 02 06 06 06 06 06 ...   1388      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002350= 02 06 06 06 06 06 ...   1389      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002365= 02 02 02 02 02 02 ...   1390      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
0000237A                          1391          
0000237A                          1392  HELL_1      ;MAP 6
0000237A= 02 02 02 02 02 02 ...   1393      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
0000238F= 02 06 06 06 06 06 ...   1394      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023A4= 02 06 06 06 06 06 ...   1395      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023B9= 02 06 06 06 06 06 ...   1396      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023CE= 02 06 06 06 06 06 ...   1397      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000023E3= 02 06 06 06 06 06 ...   1398      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
000023F8= 02 06 06 06 06 06 ...   1399      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
0000240D= 02 06 06 06 06 06 ...   1400      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00002422= 02 06 06 06 06 06 ...   1401      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002437= 02 06 06 06 06 06 ...   1402      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000244C= 02 02 08 02 02 02 ...   1403      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
00002461= 02 06 06 06 02 02 ...   1404      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002476= 02 06 06 06 02 02 ...   1405      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
0000248B= 02 06 06 06 02 02 ...   1406      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
000024A0= 02 02 02 02 02 02 ...   1407      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
000024B5                          1408          
000024B5                          1409  HELL_END    ;MAP 7
000024B5= 02 02 02 02 02 02 ...   1410      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
000024CA= 02 06 06 06 06 06 ...   1411      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024DF= 02 06 06 06 06 06 ...   1412      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024F4= 02 06 06 06 06 06 ...   1413      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002509= 02 06 06 06 06 06 ...   1414      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000251E= 02 06 06 06 06 06 ...   1415      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002533= 02 06 06 06 06 06 ...   1416      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002548= 02 06 06 06 06 06 ...   1417      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000255D= 02 06 06 06 06 06 ...   1418      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002572= 02 06 06 06 06 06 ...   1419      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002587= 02 06 06 06 06 06 ...   1420      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000259C= 02 06 06 06 06 06 ...   1421      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025B1= 02 06 06 06 06 06 ...   1422      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000025C6= 02 06 06 06 06 06 ...   1423      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000025DB= 02 02 02 02 02 02 ...   1424      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
000025F0                          1425      
000025F0                          1426  HELL_ROOM   ;MAP 8
000025F0= 08 08 08 08 08 08 ...   1427      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002605= 08 08 08 08 08 08 ...   1428      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000261A= 08 08 08 08 08 08 ...   1429      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000262F= 08 08 08 08 08 08 ...   1430      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002644= 08 08 08 08 08 02 ...   1431      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
00002659= 08 08 08 08 08 02 ...   1432      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000266E= 08 08 08 08 08 02 ...   1433      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002683= 08 08 08 08 08 02 ...   1434      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002698= 08 08 08 08 08 02 ...   1435      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026AD= 08 08 08 08 08 02 ...   1436      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026C2= 08 08 08 08 08 02 ...   1437      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
000026D7= 08 08 08 08 08 08 ...   1438      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026EC= 08 08 08 08 08 08 ...   1439      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002701= 08 08 08 08 08 08 ...   1440      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002716= 08 08 08 08 08 08 ...   1441      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
0000272B                          1442  
0000272B                          1443  
0000272B                          1444  
0000272B                          1445  
0000272B                          1446  
0000272B                          1447  
0000272B                          1448  
0000272B                          1449  -------------------- end include --------------------
0000272B                          1450              INCLUDE "ELEVATOR_MENU.X68"           
0000272B  =000000CC               1451  COLBUTHL    EQU $000000CC
0000272B  =00EEEEEE               1452  COLBUTHV    EQU $00EEEEEE
0000272B                          1453  
0000272B= 01                      1454      DC.B 1
0000272C                          1455  ELEVATORPLOT
0000272C                          1456      
0000272C  4CDF 7F00               1457      MOVEM.L (A7)+, A0-A6
00002730  4CDF 00FF               1458      MOVEM.L (A7)+, D0-D7
00002734                          1459  
00002734                          1460  
00002734                          1461  ;SET PEN COLOR  
00002734  103C 0050               1462      MOVE.B #80, D0
00002738  223C 00010101           1463      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
0000273E  4E4F                    1464      TRAP #15
00002740                          1465      
00002740                          1466  ;END SET PEN COLOR 
00002740                          1467  
00002740                          1468      ;DRAW LINES
00002740                          1469  ;DRAW LINE 1 
00002740  103C 0054               1470      MOVE.B #84, D0
00002744  323C 0000               1471      MOVE.W #0, D1
00002748  343C 0000               1472      MOVE.W #0, D2
0000274C  363C 00A0               1473      MOVE.W #160, D3
00002750  383C 0078               1474      MOVE.W #120, D4
00002754  4E4F                    1475      TRAP #15
00002756                          1476  
00002756                          1477  ;DRAW LINE 2
00002756  103C 0054               1478      MOVE.B #84, D0
0000275A  323C 00A0               1479      MOVE.W #160, D1
0000275E  343C 0078               1480      MOVE.W #120, D2
00002762  363C 00A0               1481      MOVE.W #160, D3
00002766  383C 01E0               1482      MOVE.W #480, D4
0000276A  4E4F                    1483      TRAP #15
0000276C                          1484      
0000276C                          1485  ;DRAW LINE 3
0000276C  103C 0054               1486      MOVE.B #84, D0
00002770  323C 00A0               1487      MOVE.W #160, D1
00002774  343C 0078               1488      MOVE.W #120, D2
00002778  363C 01E0               1489      MOVE.W #480, D3
0000277C  383C 0078               1490      MOVE.W #120, D4
00002780  4E4F                    1491      TRAP #15
00002782                          1492      
00002782                          1493  ;DRAW LINE 4
00002782  103C 0054               1494      MOVE.B #84, D0
00002786  323C 01E0               1495      MOVE.W #480, D1
0000278A  343C 0078               1496      MOVE.W #120, D2
0000278E  363C 0280               1497      MOVE.W #640, D3
00002792  383C 0000               1498      MOVE.W #0, D4
00002796  4E4F                    1499      TRAP #15
00002798                          1500      
00002798                          1501  ;DRAW LINE 5
00002798  103C 0054               1502      MOVE.B #84, D0
0000279C  323C 01E0               1503      MOVE.W #480, D1
000027A0  343C 0078               1504      MOVE.W #120, D2
000027A4  363C 01E0               1505      MOVE.W #480, D3
000027A8  383C 01E0               1506      MOVE.W #480, D4
000027AC  4E4F                    1507      TRAP #15
000027AE                          1508  
000027AE                          1509  ;DRAW LINE 6 (TO GIVE SHADE) 
000027AE  103C 0054               1510      MOVE.B #84, D0
000027B2  323C 0119               1511      MOVE.W #281, D1
000027B6  343C 015A               1512      MOVE.W #346, D2
000027BA  363C 0167               1513      MOVE.W #359, D3
000027BE  383C 015A               1514      MOVE.W #346, D4
000027C2  4E4F                    1515      TRAP #15
000027C4                          1516      
000027C4                          1517  ;DRAW LINE 7 (TO GIVE SHADE) 
000027C4  103C 0054               1518      MOVE.B #84, D0
000027C8  323C 011A               1519      MOVE.W #282, D1
000027CC  343C 015B               1520      MOVE.W #347, D2
000027D0  363C 0166               1521      MOVE.W #358, D3
000027D4  383C 015B               1522      MOVE.W #347, D4
000027D8  4E4F                    1523      TRAP #15
000027DA                          1524      
000027DA                          1525      ;END DRAW LINES
000027DA                          1526      
000027DA                          1527  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
000027DA  103C 0057               1528      MOVE.B #87, D0
000027DE  323C 0118               1529      MOVE.W #280, D1
000027E2  343C 00D2               1530      MOVE.W #210, D2
000027E6  363C 0168               1531      MOVE.W #360, D3
000027EA  383C 0159               1532      MOVE.W #345, D4
000027EE  4E4F                    1533      TRAP #15
000027F0                          1534      
000027F0                          1535  ;DRAW ELLIPSE FOR THE LIGHT
000027F0  103C 005B               1536      MOVE.B #91, D0
000027F4  323C 00FA               1537      MOVE.W #250, D1
000027F8  343C 0028               1538      MOVE.W #40, D2
000027FC  363C 0186               1539      MOVE.W #390, D3
00002800  383C 0050               1540      MOVE.W #80, D4
00002804  4E4F                    1541      TRAP #15
00002806                          1542      ;FILL SEGMENTS
00002806                          1543  ;FILL SEGMENT 1 LEFT WALL
00002806                          1544    ;SET FILL COLOR TO DARKER GREY, FOR W
00002806  103C 0051               1545      MOVE.B #81, D0
0000280A                          1546      ;MOVE.L #$00969696, D1
0000280A  223C 0020202F           1547      MOVE.L #$0020202F, D1
00002810  4E4F                    1548      TRAP #15
00002812                          1549      ;END SET FILL COLOR
00002812  103C 0059               1550      MOVE.B #89, D0
00002816  323C 0064               1551      MOVE.W #100, D1
0000281A  343C 0064               1552      MOVE.W #100, D2
0000281E  4E4F                    1553      TRAP #15
00002820                          1554      
00002820                          1555  ;FILL SEGMENT 2 CEILING
00002820                          1556    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00002820  103C 0051               1557      MOVE.B #81, D0
00002824                          1558      ;MOVE.L #$00C0C0C0, D1
00002824  223C 00141424           1559      MOVE.L #$00141424,D1
0000282A  4E4F                    1560      TRAP #15
0000282C                          1561      ;END SET FILL COLOR
0000282C  103C 0059               1562      MOVE.B #89, D0
00002830  323C 0064               1563      MOVE.W #100, D1
00002834  343C 0032               1564      MOVE.W #50, D2
00002838  4E4F                    1565      TRAP #15
0000283A                          1566      
0000283A                          1567  ;FILL SEGMENT 3 RIGHT WALL
0000283A                          1568    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
0000283A  103C 0051               1569      MOVE.B #81, D0
0000283E                          1570      ;MOVE.L #$00969696, D1
0000283E  223C 0020202F           1571      MOVE.L #$0020202F,D1
00002844  4E4F                    1572      TRAP #15
00002846                          1573      ;END SET FILL COLOR
00002846  103C 0059               1574      MOVE.B #89, D0
0000284A  323C 0276               1575      MOVE.W #630, D1
0000284E  343C 01D6               1576      MOVE.W #470, D2
00002852  4E4F                    1577      TRAP #15
00002854                          1578      
00002854                          1579  ;FILL SEGMENT 4 BACKGROUND WALL
00002854                          1580    ;SET FILL COLOR TO 
00002854  103C 0051               1581      MOVE.B #81, D0
00002858                          1582      ;MOVE.L #$00ABABAB, D1
00002858  223C 001A1A2A           1583      MOVE.L #$001A1A2A, D1
0000285E  4E4F                    1584      TRAP #15
00002860                          1585      ;END SET FILL COLOR
00002860  103C 0059               1586      MOVE.B #89, D0
00002864  323C 00F0               1587      MOVE.W #240, D1
00002868  343C 0140               1588      MOVE.W #320, D2
0000286C  4E4F                    1589      TRAP #15
0000286E                          1590      
0000286E                          1591  ;FILL SEGMENT 5 PANEL 
0000286E                          1592    ;SET FILL COLOR TO 
0000286E  103C 0051               1593      MOVE.B #81, D0
00002872                          1594      ;MOVE.L #$00AFAFAF, D1
00002872  223C 001F1F2F           1595      MOVE.L #$001F1F2F, D1
00002878  4E4F                    1596      TRAP #15
0000287A                          1597      ;END SET FILL COLOR
0000287A  103C 0059               1598      MOVE.B #89, D0
0000287E  323C 011D               1599      MOVE.W #285, D1
00002882  343C 00D7               1600      MOVE.W #215, D2
00002886  4E4F                    1601      TRAP #15
00002888                          1602      
00002888                          1603  ;FILL ELLIPSE LIGHT 
00002888                          1604    ;SET FILL COLOR TO 
00002888  103C 0051               1605      MOVE.B #81, D0
0000288C                          1606      ;MOVE.L #$00A1E9E9, D1
0000288C  223C 000000FF           1607      MOVE.L #$000000FF, D1
00002892  4E4F                    1608      TRAP #15
00002894                          1609      ;END SET FILL COLOR
00002894  103C 0059               1610      MOVE.B #89, D0
00002898  323C 0140               1611      MOVE.W #320, D1
0000289C  343C 003C               1612      MOVE.W #60, D2
000028A0  4E4F                    1613      TRAP #15
000028A2                          1614  
000028A2                          1615  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
000028A2                          1616      ;SET FILL COLOR 
000028A2  103C 0051               1617      MOVE.B #81, D0
000028A6  223C 000000CC           1618      MOVE.L #COLBUTHL, D1
000028AC  4E4F                    1619      TRAP #15
000028AE                          1620      ;END SET FILL COLOR
000028AE  3F3C 0135               1621      MOVE.W #309, -(A7) ;COORDENADA Y 
000028B2  3F3C 0136               1622      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
000028B6  3F3C 0016               1623      MOVE.W #22, -(A7)
000028BA  4EB9 000028F4           1624      JSR TRIANGLE
000028C0  3C1F                    1625      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
000028C2  3C1F                    1626      MOVE.W (A7)+, D6
000028C4  3C1F                    1627      MOVE.W (A7)+, D6
000028C6                          1628  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
000028C6                          1629     ;SET FILL COLOR
000028C6  48E7 FFFE               1630     MOVEM.L D0-D7/A0-A6, -(A7)
000028CA  103C 0051               1631     MOVE.B #81, D0
000028CE  223C 00EEEEEE           1632     MOVE.L #COLBUTHV, D1
000028D4  4E4F                    1633     TRAP #15
000028D6  4CDF 7FFF               1634     MOVEM.L (A7)+, D0-D7/A0-A6
000028DA                          1635      ;END SET FILL COLOR
000028DA  3F3C 00F9               1636     MOVE.W #249, -(A7) ;COORDENADA Y 
000028DE  3F3C 0136               1637     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
000028E2  3F3C FFEA               1638     MOVE.W #-22, -(A7)
000028E6  4EB9 000028F4           1639     JSR TRIANGLE
000028EC  3C1F                    1640     MOVE.W (A7)+, D6
000028EE  3C1F                    1641     MOVE.W (A7)+, D6
000028F0  3C1F                    1642     MOVE.W (A7)+, D6
000028F2                          1643     ;MOVEM.L (A7)+, D0-D7/A0-A6
000028F2                          1644  
000028F2  4E75                    1645     RTS
000028F4                          1646  ; ------------------------------------------------------------------------------
000028F4                          1647  TRIANGLE
000028F4                          1648  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
000028F4                          1649  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
000028F4                          1650  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
000028F4                          1651  ;            SIDES LENGTH (WORD) IN THAT ORDER
000028F4                          1652  ; OUTPUT   : NONE
000028F4                          1653  ; MODIFIES : NONE
000028F4                          1654  ; ------------------------------------------------------------------------------
000028F4  48A7 F800               1655      MOVEM.W D0-D4, -(A7)
000028F8                          1656      ; LINE FROM LEFT TO RIGHT
000028F8  103C 0054               1657      MOVE.B  #84,D0      ; TASK NUMBER
000028FC  322F 0010               1658      MOVE.W  16(A7),D1   ; X POSITION FROM
00002900  342F 0012               1659      MOVE.W  18(A7),D2   ; Y POSITION FROM
00002904  3802                    1660      MOVE.W  D2,D4       ; Y POSITION TO
00002906  362F 000E               1661      MOVE.W  14(A7),D3   ; LENGTH
0000290A                          1662      
0000290A  6A00 0004               1663      BPL.W   .UPWARDS
0000290E  4443                    1664      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
00002910                          1665  .UPWARDS
00002910  D641                    1666      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
00002912  4E4F                    1667      TRAP    #15         ; HORIZONTAL LINE DRAWN
00002914                          1668      ; LINE FROM RIGHT TO UP/DOWN
00002914  9641                    1669      SUB.W   D1,D3       ; I GET LENGTH IN D3
00002916  3001                    1670      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
00002918  D243                    1671      ADD.W   D3,D1       ; X POSITION FROM
0000291A  E24B                    1672      LSR.W   #1,D3       ; LENGTH/2
0000291C  D640                    1673      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
0000291E                          1674      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
0000291E  D86F 000E               1675      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
00002922  103C 0054               1676      MOVE.B  #84,D0
00002926  4E4F                    1677      TRAP    #15
00002928                          1678      ; LINE FROM LEFT TO UP/DOWN
00002928  322F 0010               1679      MOVE.W  16(A7),D1   ; X POSITION FROM
0000292C  4E4F                    1680      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
0000292E                          1681      
0000292E                          1682      ; FILLING TRIANGLE
0000292E  103C 0059               1683      MOVE.B  #89,D0
00002932  5241                    1684      ADDQ.W  #1,D1
00002934  363C 0001               1685      MOVE.W  #1,D3
00002938  4A6F 000E               1686      TST.W   14(A7)
0000293C  6A00 0004               1687      BPL.W   .ISPOSITIVE
00002940  4443                    1688      NEG.W   D3
00002942                          1689  .ISPOSITIVE
00002942  D443                    1690      ADD.W   D3,D2
00002944  4E4F                    1691      TRAP    #15
00002946                          1692      
00002946  4C9F 001F               1693      MOVEM.W (A7)+,D0-D4
0000294A  4E75                    1694      RTS
0000294C                          1695      
0000294C                          1696      
0000294C                          1697  ELEVATORUPDATE ; 1 = up 3 = down
0000294C  3F00                    1698      MOVE.W D0, -(A7)
0000294E  3039 000039A2           1699      MOVE.W LOADEDMAP, D0
00002954  B07C 0000               1700      CMP #0, D0
00002958  6700 0006               1701      BEQ ESMENU
0000295C  301F                    1702      MOVE.W (A7)+, D0
0000295E  4E75                    1703      RTS
00002960                          1704  ESMENU
00002960  301F                    1705      MOVE.W (A7)+, D0
00002962  0839 0005 0000398C      1706      BTST #5, KBDVAL
0000296A  6600 0022               1707      BNE HLSEL
0000296E  0839 0007 0000398C      1708      BTST #7, KBDVAL
00002976  6600 0004               1709      BNE HVSEL
0000297A  4E75                    1710      RTS
0000297C                          1711  HVSEL   ;LOAD 1ST HEAVEN MAP
0000297C  13FC 0000 000039A4      1712      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
00002984  33FC 0001 000039A2      1713      MOVE.W #1, LOADEDMAP    
0000298C  4E75                    1714      RTS
0000298E                          1715  HLSEL   ;LOAD 1ST HELL MAP
0000298E  13FC 0000 000039A4      1716      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
00002996  33FC 0005 000039A2      1717      MOVE.W #5, LOADEDMAP
0000299E  4E75                    1718      RTS
000029A0                          1719      
000029A0                          1720          
000029A0                          1721  
000029A0                          1722  
000029A0                          1723  
000029A0                          1724  
000029A0                          1725  -------------------- end include --------------------
000029A0                          1726              INCLUDE "PLAYER.X68"    
000029A0                          1727  ; ==============================================================================
000029A0                          1728  ; PLAYER MANAGEMENT
000029A0                          1729  ; ==============================================================================
000029A0                          1730              
000029A0                          1731  ; ------------------------------------------------------------------------------
000029A0                          1732  PLAYERINIT
000029A0                          1733  ; INITIALIZE PLAYER.
000029A0                          1734  ; INPUT    : NONE 
000029A0                          1735  ; OUTPUT   : NONE
000029A0                          1736  ; MODIFIES : NONE
000029A0                          1737  ; ------------------------------------------------------------------------------
000029A0  4E75                    1738              RTS
000029A2                          1739              
000029A2                          1740  ; ------------------------------------------------------------------------------
000029A2                          1741  PLAYERUPD
000029A2                          1742  ; UPDATES THE PLAYER.
000029A2                          1743  ; INPUT    : NONE 
000029A2                          1744  ; OUTPUT   : NONE
000029A2                          1745  ; MODIFIES : NONE
000029A2                          1746  ; ------------------------------------------------------------------------------
000029A2                          1747              ;;CHECK LIMITS IN MAPS
000029A2  3F00                    1748                  MOVE.W D0, -(A7)
000029A4  3039 000039A2           1749              MOVE.W LOADEDMAP, D0
000029AA  B07C 0000               1750              CMP #0, D0
000029AE  6700 0046               1751              BEQ NOLIMITMENU
000029B2  B07C 0001               1752              CMP #1, D0
000029B6  6700 0056               1753              BEQ LIMAPA1
000029BA  B07C 0002               1754              CMP #2, D0
000029BE  6700 014C               1755              BEQ LIMAPA2
000029C2  B07C 0003               1756              CMP #3, D0
000029C6  6700 0354               1757              BEQ LIMAPA3
000029CA  B07C 0004               1758              CMP #4, D0
000029CE  6700 0444               1759              BEQ LIMAPA4
000029D2  B07C 0005               1760              CMP #5, D0
000029D6  6700 0534               1761              BEQ LIMAPA5
000029DA  B07C 0006               1762              CMP #6, D0
000029DE  6700 06D4               1763              BEQ LIMAPA6
000029E2  B07C 0007               1764              CMP #7, D0
000029E6  6700 0880               1765              BEQ LIMAPA7
000029EA  B07C 0008               1766              CMP #8, D0
000029EE  6700 0970               1767              BEQ LIMAPA8
000029F2  301F                    1768              MOVE.W (A7)+, D0
000029F4                          1769  
000029F4  4E75                    1770              RTS
000029F6                          1771  NOLIMITMENU
000029F6  33FC 0080 00003994      1772      MOVE.W #128, PLAYERPOSX
000029FE  33FC 0080 00003996      1773      MOVE.W #128, PLAYERPOSY
00002A06  301F                    1774      MOVE.W (A7)+, D0
00002A08  4EF9 00003458           1775      JMP NOLIMIT
00002A0E                          1776  LIMAPA1
00002A0E  301F                    1777      MOVE.W (A7)+, D0
00002A10  48A7 F800               1778      MOVEM.W D0-D4, -(A7)
00002A14  3039 00003994           1779      MOVE.W PLAYERPOSX, D0
00002A1A  3239 00003996           1780      MOVE.W PLAYERPOSY, D1
00002A20                          1781      ;CHECK FOR WALLS IN MAP 1
00002A20                          1782      ;CHECK UPPER WALL 
00002A20  B07C 0280               1783      CMP #640, D0  ; BGT = 352 > D0
00002A24  6E00 0026               1784      BGT MAP1NOLIMIT1   
00002A28  B07C 0000               1785      CMP #0, D0
00002A2C  6D00 001E               1786      BLT MAP1NOLIMIT1
00002A30                          1787      ;NOW WE CHECK POS Y 
00002A30  B27C 0060               1788      CMP #96, D1  ; 
00002A34  6E00 0016               1789      BGT MAP1NOLIMIT1    
00002A38  B27C 0000               1790      CMP #0, D1
00002A3C  6D00 000E               1791      BLT MAP1NOLIMIT1
00002A40                          1792      ;;;; AQUI PISA EL LIMITE
00002A40  4C9F 001F               1793      MOVEM.W (A7)+, D0-D4
00002A44  5279 00003996           1794      ADD.W #1, PLAYERPOSY
00002A4A  4E75                    1795      RTS
00002A4C                          1796  MAP1NOLIMIT1
00002A4C                          1797      ;CHECK FOR RIGHT WALL   
00002A4C  B07C 0220               1798      CMP #544, D0  ; BGT = 352 > D0
00002A50  6E00 0026               1799      BGT MAP1NOLIMIT2    
00002A54  B07C 0200               1800      CMP #512, D0
00002A58  6D00 001E               1801      BLT MAP1NOLIMIT2
00002A5C                          1802      ;NOW WE CHECK POS Y 
00002A5C  B27C 0280               1803      CMP #640, D1  ; 
00002A60  6E00 0016               1804      BGT MAP1NOLIMIT2    
00002A64  B27C 0000               1805      CMP #0, D1
00002A68  6D00 000E               1806      BLT MAP1NOLIMIT2
00002A6C                          1807      ;;;; AQUI PISA EL LIMITE
00002A6C  4C9F 001F               1808      MOVEM.W (A7)+, D0-D4
00002A70  5379 00003994           1809      SUB.W #1, PLAYERPOSX
00002A76  4E75                    1810      RTS
00002A78                          1811  MAP1NOLIMIT2 
00002A78                          1812      ;CHECK FOR BOTTOM-RIGHT WALL
00002A78  B07C 0280               1813      CMP #640, D0  ; BGT = 352 > D0
00002A7C  6E00 002C               1814      BGT MAP1NOLIMIT3    
00002A80  B07C 0140               1815      CMP #320, D0
00002A84  6D00 0024               1816      BLT MAP1NOLIMIT3
00002A88                          1817      ;NOW WE CHECK POS Y 
00002A88  B27C 01E0               1818      CMP #480, D1  ; 
00002A8C  6E00 001C               1819      BGT MAP1NOLIMIT3    
00002A90  B27C 0180               1820      CMP #384, D1
00002A94  6D00 0014               1821      BLT MAP1NOLIMIT3
00002A98                          1822      ;;;; AQUI PISA EL LIMITE
00002A98  4C9F 001F               1823      MOVEM.W (A7)+, D0-D4
00002A9C  5279 00003994           1824      ADD.W #1, PLAYERPOSX
00002AA2  5379 00003996           1825      SUB.W #1, PLAYERPOSY
00002AA8  4E75                    1826      RTS
00002AAA                          1827  MAP1NOLIMIT3
00002AAA                          1828      ;CHECK FOR BOTTOM-LEFT WALL 
00002AAA  B07C 0120               1829      CMP #288, D0  ; BGT = 352 > D0
00002AAE  6E00 0026               1830      BGT MAP1NOLIMIT4    
00002AB2  B07C 0000               1831      CMP #0, D0
00002AB6  6D00 001E               1832      BLT MAP1NOLIMIT4
00002ABA                          1833      ;NOW WE CHECK POS Y 
00002ABA  B27C 01E0               1834      CMP #480, D1  ; 
00002ABE  6E00 0016               1835      BGT MAP1NOLIMIT4    
00002AC2  B27C 0180               1836      CMP #384, D1
00002AC6  6D00 000E               1837      BLT MAP1NOLIMIT4
00002ACA                          1838      ;;;; AQUI PISA EL LIMITE
00002ACA  4C9F 001F               1839      MOVEM.W (A7)+, D0-D4
00002ACE  5379 00003996           1840      SUB.W #1, PLAYERPOSY
00002AD4  4E75                    1841      RTS
00002AD6                          1842  MAP1NOLIMIT4 
00002AD6                          1843      ;CHECK FOR BOTTOM-LEFT WALL 
00002AD6  B07C 0060               1844      CMP #96, D0  ; BGT = 352 > D0
00002ADA  6E00 0026               1845      BGT MAP1NOLIMITEND    
00002ADE  B07C 0000               1846      CMP #0, D0
00002AE2  6D00 001E               1847      BLT MAP1NOLIMITEND
00002AE6                          1848      ;NOW WE CHECK POS Y 
00002AE6  B27C 0280               1849      CMP #640, D1  ; 
00002AEA  6E00 0016               1850      BGT MAP1NOLIMITEND    
00002AEE  B27C 0000               1851      CMP #0, D1
00002AF2  6D00 000E               1852      BLT MAP1NOLIMITEND
00002AF6                          1853      ;;;; AQUI PISA EL LIMITE
00002AF6  4C9F 001F               1854      MOVEM.W (A7)+, D0-D4
00002AFA  5279 00003994           1855      ADD.W #1, PLAYERPOSX
00002B00  4E75                    1856      RTS
00002B02                          1857  MAP1NOLIMITEND
00002B02  4C9F 001F               1858      MOVEM.W (A7)+, D0-D4
00002B06  4EF9 00003458           1859      JMP NOLIMIT
00002B0C                          1860      
00002B0C                          1861  LIMAPA2
00002B0C  301F                    1862      MOVE.W (A7)+, D0
00002B0E  48A7 F800               1863      MOVEM.W D0-D4, -(A7)
00002B12  3039 00003994           1864      MOVE.W PLAYERPOSX, D0
00002B18  3239 00003996           1865      MOVE.W PLAYERPOSY, D1
00002B1E                          1866      ;CHECK FOR TOP-LEFT WALL 
00002B1E  B07C 0120               1867      CMP #288, D0  ; BGT = 352 > D0
00002B22  6E00 002C               1868      BGT MAP2NOLIMIT1    
00002B26  B07C 0000               1869      CMP #0, D0
00002B2A  6D00 0024               1870      BLT MAP2NOLIMIT1
00002B2E                          1871      ;NOW WE CHECK POS Y 
00002B2E  B27C 0060               1872      CMP #96, D1  ; 
00002B32  6E00 001C               1873      BGT MAP2NOLIMIT1    
00002B36  B27C 0000               1874      CMP #0, D1
00002B3A  6D00 0014               1875      BLT MAP2NOLIMIT1
00002B3E                          1876      ;;;; AQUI PISA EL LIMITE
00002B3E  4C9F 001F               1877      MOVEM.W (A7)+, D0-D4
00002B42  5279 00003996           1878      ADD.W #1, PLAYERPOSY
00002B48  5279 00003994           1879      ADD.W #1, PLAYERPOSX
00002B4E  4E75                    1880      RTS
00002B50                          1881  MAP2NOLIMIT1
00002B50                          1882      ;CHECK FOR LEFT-UPPER-DOOR WALL
00002B50  B07C 00C0               1883      CMP #192, D0  ; BGT = 352 > D0
00002B54  6E00 002C               1884      BGT MAP2NOLIMIT2    
00002B58  B07C 0000               1885      CMP #0, D0
00002B5C  6D00 0024               1886      BLT MAP2NOLIMIT2
00002B60                          1887      ;NOW WE CHECK POS Y 
00002B60  B27C 009F               1888      CMP #159, D1  ; 
00002B64  6E00 001C               1889      BGT MAP2NOLIMIT2    
00002B68  B27C 0000               1890      CMP #0, D1
00002B6C  6D00 0014               1891      BLT MAP2NOLIMIT2
00002B70                          1892      ;;;; AQUI PISA EL LIMITE
00002B70  4C9F 001F               1893      MOVEM.W (A7)+, D0-D4
00002B74  5279 00003994           1894      ADD.W #1, PLAYERPOSX
00002B7A  5279 00003996           1895      ADD.W #1, PLAYERPOSY
00002B80  4E75                    1896      RTS
00002B82                          1897  MAP2NOLIMIT2
00002B82                          1898      ;CHECK FOR LEFT-BOTTOM-DOOR WALL
00002B82  B07C 00C0               1899      CMP #192, D0  ; BGT = 352 > D0
00002B86  6E00 002C               1900      BGT MAP2NOLIMIT3    
00002B8A  B07C 0000               1901      CMP #0, D0
00002B8E  6D00 0024               1902      BLT MAP2NOLIMIT3
00002B92                          1903      ;NOW WE CHECK POS Y 
00002B92  B27C 01E0               1904      CMP #480, D1  ; 
00002B96  6E00 001C               1905      BGT MAP2NOLIMIT3    
00002B9A  B27C 00A2               1906      CMP #162, D1
00002B9E  6D00 0014               1907      BLT MAP2NOLIMIT3
00002BA2                          1908      ;;;; AQUI PISA EL LIMITE
00002BA2  4C9F 001F               1909      MOVEM.W (A7)+, D0-D4
00002BA6  5279 00003994           1910      ADD.W #1, PLAYERPOSX
00002BAC  5379 00003996           1911      SUB.W #1, PLAYERPOSY
00002BB2  4E75                    1912      RTS
00002BB4                          1913  MAP2NOLIMIT3
00002BB4                          1914      ;CHECK FOR LEFT CORNER
00002BB4  B07C 00E0               1915      CMP #224, D0  ; BGT = 352 > D0
00002BB8  6E00 002C               1916      BGT MAP2NOLIMIT4    
00002BBC  B07C 0000               1917      CMP #0, D0
00002BC0  6D00 0024               1918      BLT MAP2NOLIMIT4
00002BC4                          1919      ;NOW WE CHECK POS Y 
00002BC4  B27C 01E0               1920      CMP #480, D1  ; 
00002BC8  6E00 001C               1921      BGT MAP2NOLIMIT4    
00002BCC  B27C 0100               1922      CMP #256, D1
00002BD0  6D00 0014               1923      BLT MAP2NOLIMIT4
00002BD4                          1924      ;;;; AQUI PISA EL LIMITE
00002BD4  4C9F 001F               1925      MOVEM.W (A7)+, D0-D4
00002BD8  5279 00003994           1926      ADD.W #1, PLAYERPOSX
00002BDE  5379 00003996           1927      SUB.W #1, PLAYERPOSY
00002BE4  4E75                    1928      RTS
00002BE6                          1929  MAP2NOLIMIT4
00002BE6                          1930      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002BE6  B07C 0120               1931      CMP #288, D0  ; BGT = 352 > D0
00002BEA  6E00 002C               1932      BGT MAP2NOLIMIT5    
00002BEE  B07C 00E0               1933      CMP #224, D0
00002BF2  6D00 0024               1934      BLT MAP2NOLIMIT5
00002BF6                          1935      ;NOW WE CHECK POS Y 
00002BF6  B27C 01E0               1936      CMP #480, D1  ; 
00002BFA  6E00 001C               1937      BGT MAP2NOLIMIT5    
00002BFE  B27C 0120               1938      CMP #288, D1
00002C02  6D00 0014               1939      BLT MAP2NOLIMIT5
00002C06                          1940      ;;;; AQUI PISA EL LIMITE
00002C06  4C9F 001F               1941      MOVEM.W (A7)+, D0-D4
00002C0A  5279 00003994           1942      ADD.W #1, PLAYERPOSX
00002C10  5379 00003996           1943      SUB.W #1, PLAYERPOSY
00002C16  4E75                    1944      RTS
00002C18                          1945  MAP2NOLIMIT5
00002C18                          1946      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002C18  B07C 0280               1947      CMP #640, D0  ; BGT = 352 > D0
00002C1C  6E00 002C               1948      BGT MAP2NOLIMIT6    
00002C20  B07C 0140               1949      CMP #320, D0
00002C24  6D00 0024               1950      BLT MAP2NOLIMIT6
00002C28                          1951      ;NOW WE CHECK POS Y 
00002C28  B27C 01E0               1952      CMP #480, D1  ; 
00002C2C  6E00 001C               1953      BGT MAP2NOLIMIT6    
00002C30  B27C 0120               1954      CMP #288, D1
00002C34  6D00 0014               1955      BLT MAP2NOLIMIT6
00002C38                          1956      ;;;; AQUI PISA EL LIMITE
00002C38  4C9F 001F               1957      MOVEM.W (A7)+, D0-D4
00002C3C  5379 00003994           1958      SUB.W #1, PLAYERPOSX
00002C42  5379 00003996           1959      SUB.W #1, PLAYERPOSY
00002C48  4E75                    1960      RTS
00002C4A                          1961  MAP2NOLIMIT6
00002C4A                          1962  ;CHECK FOR RIGHT CORNER
00002C4A  B07C 0280               1963      CMP #640, D0  ; BGT = 352 > D0
00002C4E  6E00 002C               1964      BGT MAP2NOLIMIT7    
00002C52  B07C 0180               1965      CMP #384, D0
00002C56  6D00 0024               1966      BLT MAP2NOLIMIT7
00002C5A                          1967      ;NOW WE CHECK POS Y 
00002C5A  B27C 01E0               1968      CMP #480, D1  ; 
00002C5E  6E00 001C               1969      BGT MAP2NOLIMIT7    
00002C62  B27C 0100               1970      CMP #256, D1
00002C66  6D00 0014               1971      BLT MAP2NOLIMIT7
00002C6A                          1972      ;;;; AQUI PISA EL LIMITE
00002C6A  4C9F 001F               1973      MOVEM.W (A7)+, D0-D4
00002C6E  5379 00003994           1974      SUB.W #1, PLAYERPOSX
00002C74  5379 00003996           1975      SUB.W #1, PLAYERPOSY
00002C7A  4E75                    1976      RTS
00002C7C                          1977  MAP2NOLIMIT7
00002C7C                          1978      ;CHECK FOR RIGHT-BOTTOM-DOOR WALL
00002C7C  B07C 0280               1979      CMP #640, D0  ; BGT = 352 > D0
00002C80  6E00 002C               1980      BGT MAP2NOLIMIT8    
00002C84  B07C 01A0               1981      CMP #416, D0
00002C88  6D00 0024               1982      BLT MAP2NOLIMIT8
00002C8C                          1983      ;NOW WE CHECK POS Y 
00002C8C  B27C 01E0               1984      CMP #480, D1  ; 
00002C90  6E00 001C               1985      BGT MAP2NOLIMIT8    
00002C94  B27C 00A2               1986      CMP #162, D1
00002C98  6D00 0014               1987      BLT MAP2NOLIMIT8
00002C9C                          1988      ;;;; AQUI PISA EL LIMITE
00002C9C  4C9F 001F               1989      MOVEM.W (A7)+, D0-D4
00002CA0  5379 00003994           1990      SUB.W #1, PLAYERPOSX
00002CA6  5379 00003996           1991      SUB.W #1, PLAYERPOSY
00002CAC  4E75                    1992      RTS
00002CAE                          1993  MAP2NOLIMIT8
00002CAE                          1994  ;CHECK FOR RIGHT-TOP-DOOR WALL
00002CAE  B07C 0280               1995      CMP #640, D0  ; BGT = 352 > D0
00002CB2  6E00 002C               1996      BGT MAP2NOLIMIT9    
00002CB6  B07C 01A0               1997      CMP #416, D0
00002CBA  6D00 0024               1998      BLT MAP2NOLIMIT9
00002CBE                          1999      ;NOW WE CHECK POS Y 
00002CBE  B27C 00A0               2000      CMP #160, D1  ; 
00002CC2  6E00 001C               2001      BGT MAP2NOLIMIT9    
00002CC6  B27C 0000               2002      CMP #0, D1
00002CCA  6D00 0014               2003      BLT MAP2NOLIMIT9
00002CCE                          2004      ;;;; AQUI PISA EL LIMITE
00002CCE  4C9F 001F               2005      MOVEM.W (A7)+, D0-D4
00002CD2  5379 00003994           2006      SUB.W #1, PLAYERPOSX
00002CD8  5279 00003996           2007      ADD.W #1, PLAYERPOSY
00002CDE  4E75                    2008      RTS
00002CE0                          2009  MAP2NOLIMIT9
00002CE0                          2010      ;CHECK FOR TOP RIGHT CORNER
00002CE0  B07C 0280               2011      CMP #640, D0  ; BGT = 352 > D0
00002CE4  6E00 002C               2012      BGT MAP2NOLIMIT10    
00002CE8  B07C 0140               2013      CMP #320, D0
00002CEC  6D00 0024               2014      BLT MAP2NOLIMIT10
00002CF0                          2015      ;NOW WE CHECK POS Y 
00002CF0  B27C 0060               2016      CMP #96, D1  ; 
00002CF4  6E00 001C               2017      BGT MAP2NOLIMIT10   
00002CF8  B27C 0000               2018      CMP #0, D1
00002CFC  6D00 0014               2019      BLT MAP2NOLIMIT10
00002D00                          2020      ;;;; AQUI PISA EL LIMITE
00002D00  4C9F 001F               2021      MOVEM.W (A7)+, D0-D4
00002D04  5379 00003994           2022      SUB.W #1, PLAYERPOSX
00002D0A  5279 00003996           2023      ADD.W #1, PLAYERPOSY
00002D10  4E75                    2024      RTS
00002D12                          2025  MAP2NOLIMIT10
00002D12  4C9F 001F               2026      MOVEM.W (A7)+, D0-D4
00002D16  4EF9 00003458           2027      JMP NOLIMIT
00002D1C                          2028  LIMAPA3
00002D1C  301F                    2029      MOVE.W (A7)+, D0
00002D1E  48A7 F800               2030      MOVEM.W D0-D4, -(A7)
00002D22  3039 00003994           2031      MOVE.W PLAYERPOSX, D0
00002D28  3239 00003996           2032      MOVE.W PLAYERPOSY, D1
00002D2E                          2033      ;CHECK FOR TOP-LEFT WALL 
00002D2E  B07C 0120               2034      CMP #288, D0  ; BGT = 352 > D0
00002D32  6E00 0026               2035      BGT MAP3NOLIMIT1    
00002D36  B07C 0000               2036      CMP #0, D0
00002D3A  6D00 001E               2037      BLT MAP3NOLIMIT1
00002D3E                          2038      ;NOW WE CHECK POS Y 
00002D3E  B27C 0020               2039      CMP #32, D1  ; 
00002D42  6E00 0016               2040      BGT MAP3NOLIMIT1    
00002D46  B27C 0000               2041      CMP #0, D1
00002D4A  6D00 000E               2042      BLT MAP3NOLIMIT1
00002D4E                          2043      ;;;; AQUI PISA EL LIMITE
00002D4E  5279 00003996           2044      ADD.W #1, PLAYERPOSY
00002D54  4C9F 001F               2045      MOVEM.W (A7)+, D0-D4
00002D58  4E75                    2046      RTS
00002D5A                          2047  MAP3NOLIMIT1
00002D5A                          2048      ;CHECK FOR LEFT WALL
00002D5A  B07C 0020               2049      CMP #32, D0  ; BGT = 352 > D0
00002D5E  6E00 0026               2050      BGT MAP3NOLIMIT2    
00002D62  B07C 0000               2051      CMP #0, D0
00002D66  6D00 001E               2052      BLT MAP3NOLIMIT2
00002D6A                          2053      ;NOW WE CHECK POS Y 
00002D6A  B27C 01E0               2054      CMP #480, D1  ; 
00002D6E  6E00 0016               2055      BGT MAP3NOLIMIT2    
00002D72  B27C 0000               2056      CMP #0, D1
00002D76  6D00 000E               2057      BLT MAP3NOLIMIT2
00002D7A                          2058      ;;;; AQUI PISA EL LIMITE
00002D7A  5279 00003994           2059      ADD.W #1, PLAYERPOSX
00002D80  4C9F 001F               2060      MOVEM.W (A7)+, D0-D4
00002D84  4E75                    2061      RTS
00002D86                          2062  MAP3NOLIMIT2
00002D86                          2063      ;CHECK FOR BOTTOM WALL
00002D86  B07C 0280               2064      CMP #640, D0  ; BGT = 352 > D0
00002D8A  6E00 0026               2065      BGT MAP3NOLIMIT3    
00002D8E  B07C 0000               2066      CMP #0, D0
00002D92  6D00 001E               2067      BLT MAP3NOLIMIT3
00002D96                          2068      ;NOW WE CHECK POS Y 
00002D96  B27C 01E0               2069      CMP #480, D1  ; 
00002D9A  6E00 0016               2070      BGT MAP3NOLIMIT3    
00002D9E  B27C 01A0               2071      CMP #416, D1
00002DA2  6D00 000E               2072      BLT MAP3NOLIMIT3
00002DA6                          2073      ;;;; AQUI PISA EL LIMITE
00002DA6  5379 00003996           2074      SUB.W #1, PLAYERPOSY
00002DAC  4C9F 001F               2075      MOVEM.W (A7)+, D0-D4
00002DB0  4E75                    2076      RTS
00002DB2                          2077  MAP3NOLIMIT3
00002DB2                          2078      ;CHECK FOR RIGHT WALL
00002DB2  B07C 0280               2079      CMP #640, D0  ; BGT = 352 > D0
00002DB6  6E00 0026               2080      BGT MAP3NOLIMIT4    
00002DBA  B07C 0240               2081      CMP #576, D0
00002DBE  6D00 001E               2082      BLT MAP3NOLIMIT4
00002DC2                          2083      ;NOW WE CHECK POS Y 
00002DC2  B27C 01E0               2084      CMP #480, D1  ; 
00002DC6  6E00 0016               2085      BGT MAP3NOLIMIT4    
00002DCA  B27C 0000               2086      CMP #0, D1
00002DCE  6D00 000E               2087      BLT MAP3NOLIMIT4
00002DD2                          2088      ;;;; AQUI PISA EL LIMITE
00002DD2  5379 00003994           2089      SUB.W #1, PLAYERPOSX
00002DD8  4C9F 001F               2090      MOVEM.W (A7)+, D0-D4
00002DDC  4E75                    2091      RTS
00002DDE                          2092  MAP3NOLIMIT4
00002DDE                          2093      ;CHECK TOP-RIGHT WALL
00002DDE  B07C 0280               2094      CMP #640, D0  ; BGT = 352 > D0
00002DE2  6E00 0026               2095      BGT MAP3NOLIMIT5    
00002DE6  B07C 0160               2096      CMP #352, D0
00002DEA  6D00 001E               2097      BLT MAP3NOLIMIT5
00002DEE                          2098      ;NOW WE CHECK POS Y 
00002DEE  B27C 0020               2099      CMP #32, D1  ; 
00002DF2  6E00 0016               2100      BGT MAP3NOLIMIT5    
00002DF6  B27C 0000               2101      CMP #0, D1
00002DFA  6D00 000E               2102      BLT MAP3NOLIMIT5
00002DFE                          2103      ;;;; AQUI PISA EL LIMITE
00002DFE  5279 00003996           2104      ADD.W #1, PLAYERPOSY
00002E04  4C9F 001F               2105      MOVEM.W (A7)+, D0-D4
00002E08  4E75                    2106      RTS
00002E0A                          2107  MAP3NOLIMIT5
00002E0A  4C9F 001F               2108      MOVEM.W (A7)+, D0-D4
00002E0E  4EF9 00003458           2109      JMP NOLIMIT
00002E14                          2110      
00002E14                          2111  LIMAPA4
00002E14  301F                    2112      MOVE.W (A7)+, D0
00002E16  48A7 F800               2113      MOVEM.W D0-D4, -(A7)
00002E1A  3039 00003994           2114      MOVE.W PLAYERPOSX, D0
00002E20  3239 00003996           2115      MOVE.W PLAYERPOSY, D1
00002E26                          2116      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00002E26                          2117      ;CHECK UPPER LEFT WALL 
00002E26  B07C 0120               2118      CMP #288, D0  ; BGT = 352 > D0
00002E2A  6E00 0026               2119      BGT MAP4NOLIMIT1   
00002E2E  B07C 0000               2120      CMP #0, D0
00002E32  6D00 001E               2121      BLT MAP4NOLIMIT1
00002E36                          2122      ;NOW WE CHECK POS Y 
00002E36  B27C 00A0               2123      CMP #160, D1  ; 
00002E3A  6E00 0016               2124      BGT MAP4NOLIMIT1    
00002E3E  B27C 0000               2125      CMP #0, D1
00002E42  6D00 000E               2126      BLT MAP4NOLIMIT1
00002E46                          2127      ;;;; AQUI PISA EL LIMITE
00002E46  4C9F 001F               2128      MOVEM.W (A7)+, D0-D4
00002E4A  5279 00003996           2129      ADD.W #1, PLAYERPOSY
00002E50  4E75                    2130      RTS
00002E52                          2131  MAP4NOLIMIT1
00002E52                          2132      ;CHECK BOTTOM WALL
00002E52  B07C 0280               2133      CMP #640, D0  ; BGT = 352 > D0
00002E56  6E00 0026               2134      BGT MAP4NOLIMIT2   
00002E5A  B07C 0000               2135      CMP #0, D0
00002E5E  6D00 001E               2136      BLT MAP4NOLIMIT2
00002E62                          2137      ;NOW WE CHECK POS Y 
00002E62  B27C 01E0               2138      CMP #480, D1  ; 
00002E66  6E00 0016               2139      BGT MAP4NOLIMIT2    
00002E6A  B27C 0120               2140      CMP #288, D1
00002E6E  6D00 000E               2141      BLT MAP4NOLIMIT2
00002E72                          2142      ;;;; AQUI PISA EL LIMITE
00002E72  4C9F 001F               2143      MOVEM.W (A7)+, D0-D4
00002E76  5379 00003996           2144      SUB.W #1, PLAYERPOSY
00002E7C  4E75                    2145      RTS
00002E7E                          2146  MAP4NOLIMIT2
00002E7E                          2147      ;CHECK LEFT WALL
00002E7E  B07C 00C0               2148      CMP #192, D0  ; BGT = 352 > D0
00002E82  6E00 0026               2149      BGT MAP4NOLIMIT3   
00002E86  B07C 0000               2150      CMP #0, D0
00002E8A  6D00 001E               2151      BLT MAP4NOLIMIT3
00002E8E                          2152      ;NOW WE CHECK POS Y 
00002E8E  B27C 01E0               2153      CMP #480, D1  ; 
00002E92  6E00 0016               2154      BGT MAP4NOLIMIT3    
00002E96  B27C 0000               2155      CMP #0, D1
00002E9A  6D00 000E               2156      BLT MAP4NOLIMIT3
00002E9E                          2157      ;;;; AQUI PISA EL LIMITE
00002E9E  4C9F 001F               2158      MOVEM.W (A7)+, D0-D4
00002EA2  5279 00003994           2159      ADD.W #1, PLAYERPOSX
00002EA8  4E75                    2160      RTS
00002EAA                          2161  MAP4NOLIMIT3
00002EAA                          2162      ;CHECK RIGHT WALL
00002EAA  B07C 0280               2163      CMP #640, D0  ; BGT = 352 > D0
00002EAE  6E00 0026               2164      BGT MAP4NOLIMIT4   
00002EB2  B07C 01A0               2165      CMP #416, D0
00002EB6  6D00 001E               2166      BLT MAP4NOLIMIT4
00002EBA                          2167      ;NOW WE CHECK POS Y 
00002EBA  B27C 01E0               2168      CMP #480, D1  ; 
00002EBE  6E00 0016               2169      BGT MAP4NOLIMIT4    
00002EC2  B27C 0000               2170      CMP #0, D1
00002EC6  6D00 000E               2171      BLT MAP4NOLIMIT4
00002ECA                          2172      ;;;; AQUI PISA EL LIMITE
00002ECA  4C9F 001F               2173      MOVEM.W (A7)+, D0-D4
00002ECE  5379 00003994           2174      SUB.W #1, PLAYERPOSX
00002ED4  4E75                    2175      RTS
00002ED6                          2176  MAP4NOLIMIT4
00002ED6                          2177  ;CHECK TOP RIGHT WALL
00002ED6  B07C 0280               2178      CMP #640, D0  ; BGT = 352 > D0
00002EDA  6E00 0026               2179      BGT MAP4NOLIMIT5   
00002EDE  B07C 0160               2180      CMP #352, D0
00002EE2  6D00 001E               2181      BLT MAP4NOLIMIT5
00002EE6                          2182      ;NOW WE CHECK POS Y 
00002EE6  B27C 00A0               2183      CMP #160, D1  ; 
00002EEA  6E00 0016               2184      BGT MAP4NOLIMIT5    
00002EEE  B27C 0000               2185      CMP #0, D1
00002EF2  6D00 000E               2186      BLT MAP4NOLIMIT5
00002EF6                          2187      ;;;; AQUI PISA EL LIMITE
00002EF6  4C9F 001F               2188      MOVEM.W (A7)+, D0-D4
00002EFA  5279 00003996           2189      ADD.W #1, PLAYERPOSY
00002F00  4E75                    2190      RTS
00002F02                          2191  MAP4NOLIMIT5
00002F02  4C9F 001F               2192      MOVEM.W (A7)+, D0-D4
00002F06  4EF9 00003458           2193      JMP NOLIMIT
00002F0C                          2194  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;END HEAVEN MAPS
00002F0C                          2195  LIMAPA5
00002F0C  301F                    2196      MOVE.W (A7)+, D0
00002F0E  48A7 F800               2197      MOVEM.W D0-D4, -(A7)
00002F12  3039 00003994           2198      MOVE.W PLAYERPOSX, D0
00002F18  3239 00003996           2199      MOVE.W PLAYERPOSY, D1
00002F1E                          2200      ;CHECK FOR WALLS IN MAP 5
00002F1E                          2201      ;CHECK UPPER WALL 
00002F1E  B07C 0280               2202      CMP #640, D0  ; BGT = 352 > D0
00002F22  6E00 0026               2203      BGT MAP5NOLIMIT1   
00002F26  B07C 0000               2204      CMP #0, D0
00002F2A  6D00 001E               2205      BLT MAP5NOLIMIT1
00002F2E                          2206      ;NOW WE CHECK POS Y 
00002F2E  B27C 0020               2207      CMP #32, D1  ; 
00002F32  6E00 0016               2208      BGT MAP5NOLIMIT1    
00002F36  B27C 0000               2209      CMP #0, D1
00002F3A  6D00 000E               2210      BLT MAP5NOLIMIT1
00002F3E                          2211      ;;;; AQUI PISA EL LIMITE
00002F3E  4C9F 001F               2212      MOVEM.W (A7)+, D0-D4
00002F42  5279 00003996           2213      ADD.W #1, PLAYERPOSY
00002F48  4E75                    2214      RTS
00002F4A                          2215  MAP5NOLIMIT1
00002F4A                          2216      ;CHECK FOR RIGHT WALL 
00002F4A  B07C 0280               2217      CMP #640, D0  ; BGT = 352 > D0
00002F4E  6E00 0026               2218      BGT MAP5NOLIMIT2    
00002F52  B07C 0240               2219      CMP #576, D0
00002F56  6D00 001E               2220      BLT MAP5NOLIMIT2
00002F5A                          2221      ;NOW WE CHECK POS Y 
00002F5A  B27C 01E0               2222      CMP #480, D1  ; 
00002F5E  6E00 0016               2223      BGT MAP5NOLIMIT2    
00002F62  B27C 0000               2224      CMP #0, D1
00002F66  6D00 000E               2225      BLT MAP5NOLIMIT2
00002F6A                          2226      ;;;; AQUI PISA EL LIMITE
00002F6A  5379 00003994           2227      SUB.W #1, PLAYERPOSX
00002F70  4C9F 001F               2228      MOVEM.W (A7)+, D0-D4
00002F74  4E75                    2229      RTS
00002F76                          2230  MAP5NOLIMIT2
00002F76                          2231      ;CHECK LEFT WALL
00002F76  B07C 0020               2232          CMP #32, D0  ; BGT = 352 > D0
00002F7A  6E00 0026               2233      BGT MAP5NOLIMIT3    
00002F7E  B07C 0000               2234      CMP #0, D0
00002F82  6D00 001E               2235      BLT MAP5NOLIMIT3
00002F86                          2236      ;NOW WE CHECK POS Y 
00002F86  B27C 01E0               2237      CMP #480, D1  ; 
00002F8A  6E00 0016               2238      BGT MAP5NOLIMIT3    
00002F8E  B27C 0000               2239      CMP #0, D1
00002F92  6D00 000E               2240      BLT MAP5NOLIMIT3
00002F96                          2241      ;;;; AQUI PISA EL LIMITE
00002F96  5279 00003994           2242      ADD.W #1, PLAYERPOSX
00002F9C  4C9F 001F               2243      MOVEM.W (A7)+, D0-D4
00002FA0  4E75                    2244      RTS
00002FA2                          2245  MAP5NOLIMIT3
00002FA2                          2246      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002FA2  B07C 0120               2247      CMP #288, D0  ; BGT = 352 > D0
00002FA6  6E00 0026               2248      BGT MAP5NOLIMIT4    
00002FAA  B07C 0000               2249      CMP #0, D0
00002FAE  6D00 001E               2250      BLT MAP5NOLIMIT4
00002FB2                          2251      ;NOW WE CHECK POS Y 
00002FB2  B27C 01E0               2252      CMP #480, D1  ; 
00002FB6  6E00 0016               2253      BGT MAP5NOLIMIT4    
00002FBA  B27C 01A0               2254      CMP #416, D1
00002FBE  6D00 000E               2255      BLT MAP5NOLIMIT4
00002FC2                          2256      ;;;; AQUI PISA EL LIMITE
00002FC2  4C9F 001F               2257      MOVEM.W (A7)+, D0-D4
00002FC6  5379 00003996           2258      SUB.W #1, PLAYERPOSY
00002FCC  4E75                    2259      RTS
00002FCE                          2260  MAP5NOLIMIT4
00002FCE                          2261      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002FCE  B07C 0280               2262      CMP #640, D0  ; BGT = 352 > D0
00002FD2  6E00 0026               2263      BGT MAP5NOLIMIT5    
00002FD6  B07C 0140               2264      CMP #320, D0
00002FDA  6D00 001E               2265      BLT MAP5NOLIMIT5
00002FDE                          2266      ;NOW WE CHECK POS Y 
00002FDE  B27C 01E0               2267      CMP #480, D1  ; 
00002FE2  6E00 0016               2268      BGT MAP5NOLIMIT5    
00002FE6  B27C 01A0               2269      CMP #416, D1
00002FEA  6D00 000E               2270      BLT MAP5NOLIMIT5
00002FEE                          2271      ;;;; AQUI PISA EL LIMITE
00002FEE  4C9F 001F               2272      MOVEM.W (A7)+, D0-D4
00002FF2  5379 00003996           2273      SUB.W #1, PLAYERPOSY
00002FF8  4E75                    2274      RTS
00002FFA                          2275  MAP5NOLIMIT5
00002FFA                          2276      ;CHECK FOR MIDDLE-LEFT WALL 1
00002FFA  B07C 0120               2277      CMP #288, D0  ; BGT = 352 > D0
00002FFE  6E00 0026               2278      BGT MAP5NOLIMIT6    
00003002  B07C 0000               2279      CMP #0, D0
00003006  6D00 001E               2280      BLT MAP5NOLIMIT6
0000300A                          2281      ;NOW WE CHECK POS Y 
0000300A  B27C 00F0               2282      CMP #240, D1  ; 
0000300E  6E00 0016               2283      BGT MAP5NOLIMIT6    
00003012  B27C 00C0               2284      CMP #192, D1 ;224
00003016  6D00 000E               2285      BLT MAP5NOLIMIT6
0000301A                          2286      ;;;; AQUI PISA EL LIMITE
0000301A  4C9F 001F               2287      MOVEM.W (A7)+, D0-D4
0000301E  5379 00003996           2288      SUB.W #1, PLAYERPOSY
00003024  4E75                    2289      RTS
00003026                          2290  MAP5NOLIMIT6
00003026                          2291      ;CHECK FOR MIDDLE-RIGHT WALL 1
00003026  B07C 0280               2292      CMP #640, D0  ; BGT = 352 > D0
0000302A  6E00 0026               2293      BGT MAP5NOLIMIT7    
0000302E  B07C 0140               2294      CMP #320 , D0
00003032  6D00 001E               2295      BLT MAP5NOLIMIT7
00003036                          2296      ;NOW WE CHECK POS Y 
00003036  B27C 00F0               2297      CMP #240, D1  ; 
0000303A  6E00 0016               2298      BGT MAP5NOLIMIT7    
0000303E  B27C 00C0               2299      CMP #192, D1 ;224
00003042  6D00 000E               2300      BLT MAP5NOLIMIT7
00003046                          2301      ;;;; AQUI PISA EL LIMITE
00003046  4C9F 001F               2302      MOVEM.W (A7)+, D0-D4
0000304A  5379 00003996           2303      SUB.W #1, PLAYERPOSY
00003050  4E75                    2304      RTS
00003052                          2305  MAP5NOLIMIT7
00003052                          2306      ;CHECK FOR MIDDLE-RIGHT WALL 2
00003052  B07C 0280               2307      CMP #640, D0  ; BGT = 352 > D0
00003056  6E00 0026               2308      BGT MAP5NOLIMIT8    
0000305A  B07C 0140               2309      CMP #320 , D0
0000305E  6D00 001E               2310      BLT MAP5NOLIMIT8
00003062                          2311      ;NOW WE CHECK POS Y 
00003062  B27C 0100               2312      CMP #256, D1  ; 
00003066  6E00 0016               2313      BGT MAP5NOLIMIT8    
0000306A  B27C 00F0               2314      CMP #240, D1 ;192
0000306E  6D00 000E               2315      BLT MAP5NOLIMIT8
00003072                          2316      ;;;; AQUI PISA EL LIMITE
00003072  4C9F 001F               2317      MOVEM.W (A7)+, D0-D4
00003076  5279 00003996           2318      ADD.W #1, PLAYERPOSY
0000307C  4E75                    2319      RTS
0000307E                          2320  MAP5NOLIMIT8
0000307E                          2321      ;CHECK FOR MIDDLE-LEFT WALL 2
0000307E  B07C 0120               2322      CMP #288, D0  ; BGT = 352 > D0
00003082  6E00 0026               2323      BGT MAP5NOLIMIT9    
00003086  B07C 0000               2324      CMP #0, D0
0000308A  6D00 001E               2325      BLT MAP5NOLIMIT9
0000308E                          2326      ;NOW WE CHECK POS Y 
0000308E  B27C 0100               2327      CMP #256, D1  ; 
00003092  6E00 0016               2328      BGT MAP5NOLIMIT9    
00003096  B27C 00F0               2329      CMP #240, D1 ;224
0000309A  6D00 000E               2330      BLT MAP5NOLIMIT9
0000309E                          2331      ;;;; AQUI PISA EL LIMITE
0000309E  4C9F 001F               2332      MOVEM.W (A7)+, D0-D4
000030A2  5279 00003996           2333      ADD.W #1, PLAYERPOSY
000030A8  4E75                    2334      RTS
000030AA                          2335  MAP5NOLIMIT9
000030AA  4C9F 001F               2336      MOVEM.W (A7)+, D0-D4
000030AE  4EF9 00003458           2337      JMP NOLIMIT
000030B4                          2338  
000030B4                          2339      
000030B4                          2340  LIMAPA6
000030B4  301F                    2341      MOVE.W (A7)+, D0
000030B6  48A7 F800               2342      MOVEM.W D0-D4, -(A7)
000030BA  3039 00003994           2343      MOVE.W PLAYERPOSX, D0
000030C0  3239 00003996           2344      MOVE.W PLAYERPOSY, D1
000030C6                          2345      ;CHECK FOR WALLS IN MAP 5
000030C6                          2346      ;CHECK LEFT UPPER WALL 
000030C6  B07C 0120               2347      CMP #288, D0  ; BGT = 352 > D0
000030CA  6E00 0026               2348      BGT MAP6NOLIMIT1   
000030CE  B07C 0000               2349      CMP #0, D0
000030D2  6D00 001E               2350      BLT MAP6NOLIMIT1
000030D6                          2351      ;NOW WE CHECK POS Y 
000030D6  B27C 0020               2352      CMP #32, D1  ; 
000030DA  6E00 0016               2353      BGT MAP6NOLIMIT1    
000030DE  B27C 0000               2354      CMP #0, D1
000030E2  6D00 000E               2355      BLT MAP6NOLIMIT1
000030E6                          2356      ;;;; AQUI PISA EL LIMITE
000030E6  4C9F 001F               2357      MOVEM.W (A7)+, D0-D4
000030EA  5279 00003996           2358      ADD.W #1, PLAYERPOSY
000030F0  4E75                    2359      RTS
000030F2                          2360  MAP6NOLIMIT1
000030F2                          2361      ;CHECK LEFT WALL
000030F2  B07C 0020               2362      CMP #32, D0  ; BGT = 352 > D0
000030F6  6E00 0026               2363      BGT MAP6NOLIMIT2    
000030FA  B07C 0000               2364      CMP #0, D0
000030FE  6D00 001E               2365      BLT MAP6NOLIMIT2
00003102                          2366      ;NOW WE CHECK POS Y 
00003102  B27C 01E0               2367      CMP #480, D1  ; 
00003106  6E00 0016               2368      BGT MAP6NOLIMIT2    
0000310A  B27C 0000               2369      CMP #0, D1
0000310E  6D00 000E               2370      BLT MAP6NOLIMIT2
00003112                          2371      ;;;; AQUI PISA EL LIMITE
00003112  5279 00003994           2372      ADD.W #1, PLAYERPOSX
00003118  4C9F 001F               2373      MOVEM.W (A7)+, D0-D4
0000311C  4E75                    2374      RTS
0000311E                          2375  MAP6NOLIMIT2
0000311E                          2376      ;CHECK FOR RIGHT WALL 
0000311E  B07C 0280               2377      CMP #640, D0  ; BGT = 352 > D0
00003122  6E00 0026               2378      BGT MAP6NOLIMIT3    
00003126  B07C 0240               2379      CMP #576, D0
0000312A  6D00 001E               2380      BLT MAP6NOLIMIT3
0000312E                          2381      ;NOW WE CHECK POS Y 
0000312E  B27C 01E0               2382      CMP #480, D1  ; 
00003132  6E00 0016               2383      BGT MAP6NOLIMIT3    
00003136  B27C 0000               2384      CMP #0, D1
0000313A  6D00 000E               2385      BLT MAP6NOLIMIT3
0000313E                          2386      ;;;; AQUI PISA EL LIMITE
0000313E  5379 00003994           2387      SUB.W #1, PLAYERPOSX
00003144  4C9F 001F               2388      MOVEM.W (A7)+, D0-D4
00003148  4E75                    2389      RTS
0000314A                          2390  MAP6NOLIMIT3
0000314A                          2391      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
0000314A  B07C 0120               2392      CMP #288, D0  ; BGT = 352 > D0
0000314E  6E00 0026               2393      BGT MAP6NOLIMIT5   
00003152  B07C 0000               2394      CMP #0, D0
00003156  6D00 001E               2395      BLT MAP6NOLIMIT5
0000315A                          2396      ;NOW WE CHECK POS Y 
0000315A  B27C 01E0               2397      CMP #480, D1  ; 
0000315E  6E00 0016               2398      BGT MAP6NOLIMIT5    
00003162  B27C 01A0               2399      CMP #416, D1
00003166  6D00 000E               2400      BLT MAP6NOLIMIT5
0000316A                          2401      ;;;; AQUI PISA EL LIMITE
0000316A  4C9F 001F               2402      MOVEM.W (A7)+, D0-D4
0000316E  5379 00003996           2403      SUB.W #1, PLAYERPOSY
00003174  4E75                    2404      RTS
00003176                          2405  MAP6NOLIMIT5
00003176                          2406      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00003176  B07C 0280               2407      CMP #640, D0  ; BGT = 352 > D0
0000317A  6E00 0026               2408      BGT MAP6NOLIMIT6    
0000317E  B07C 0140               2409      CMP #320, D0
00003182  6D00 001E               2410      BLT MAP6NOLIMIT6
00003186                          2411      ;NOW WE CHECK POS Y 
00003186  B27C 01E0               2412      CMP #480, D1  ; 
0000318A  6E00 0016               2413      BGT MAP6NOLIMIT6    
0000318E  B27C 01A0               2414      CMP #416, D1
00003192  6D00 000E               2415      BLT MAP6NOLIMIT6
00003196                          2416      ;;;; AQUI PISA EL LIMITE
00003196  4C9F 001F               2417      MOVEM.W (A7)+, D0-D4
0000319A  5379 00003996           2418      SUB.W #1, PLAYERPOSY
000031A0  4E75                    2419      RTS
000031A2                          2420  MAP6NOLIMIT6
000031A2                          2421      ;CHECK RIGHT-RIGHT ROOM WALL
000031A2  B07C 0280               2422      CMP #640, D0  ; BGT = 352 > D0
000031A6  6E00 0026               2423      BGT MAP6NOLIMIT7    
000031AA  B07C 0222               2424      CMP #546, D0
000031AE  6D00 001E               2425      BLT MAP6NOLIMIT7
000031B2                          2426      ;NOW WE CHECK POS Y 
000031B2  B27C 01E0               2427      CMP #480, D1  ; 
000031B6  6E00 0016               2428      BGT MAP6NOLIMIT7    
000031BA  B27C 0120               2429      CMP #288, D1
000031BE  6D00 000E               2430      BLT MAP6NOLIMIT7
000031C2                          2431      ;;;; AQUI PISA EL LIMITE
000031C2  4C9F 001F               2432      MOVEM.W (A7)+, D0-D4
000031C6  5379 00003996           2433      SUB.W #1, PLAYERPOSY
000031CC  4E75                    2434      RTS
000031CE                          2435  MAP6NOLIMIT7
000031CE                          2436      ;CHECK FOR LEFT-RIGHT ROOM WALL
000031CE  B07C 0218               2437      CMP #536, D0  ; BGT = 352 > D0
000031D2  6E00 002C               2438      BGT MAP6NOLIMIT8    
000031D6  B07C 0160               2439      CMP #352, D0
000031DA  6D00 0024               2440      BLT MAP6NOLIMIT8
000031DE                          2441      ;NOW WE CHECK POS Y 
000031DE  B27C 01E0               2442      CMP #480, D1  ; 
000031E2  6E00 001C               2443      BGT MAP6NOLIMIT8    
000031E6  B27C 0120               2444      CMP #288, D1
000031EA  6D00 0014               2445      BLT MAP6NOLIMIT8
000031EE                          2446      ;;;; AQUI PISA EL LIMITE
000031EE  4C9F 001F               2447      MOVEM.W (A7)+, D0-D4
000031F2  5379 00003994           2448      SUB.W #1, PLAYERPOSX
000031F8  5379 00003996           2449      SUB.W #1, PLAYERPOSY
000031FE  4E75                    2450      RTS
00003200                          2451  MAP6NOLIMIT8
00003200                          2452      ;CHECK LEFT-LEFT ROOM WALL
00003200  B07C 003E               2453      CMP #62, D0  ; BGT = 352 > D0
00003204  6E00 0026               2454      BGT MAP6NOLIMIT9    
00003208  B07C 0000               2455      CMP #0, D0
0000320C  6D00 001E               2456      BLT MAP6NOLIMIT9
00003210                          2457      ;NOW WE CHECK POS Y 
00003210  B27C 01E0               2458      CMP #480, D1  ; 
00003214  6E00 0016               2459      BGT MAP6NOLIMIT9    
00003218  B27C 0120               2460      CMP #288, D1
0000321C  6D00 000E               2461      BLT MAP6NOLIMIT9
00003220                          2462      ;;;; AQUI PISA EL LIMITE
00003220  4C9F 001F               2463      MOVEM.W (A7)+, D0-D4
00003224  5379 00003996           2464      SUB.W #1, PLAYERPOSY
0000322A  4E75                    2465      RTS
0000322C                          2466  MAP6NOLIMIT9
0000322C                          2467      ;CHECK FOR RIGHT-LEFT ROOM WALL
0000322C  B07C 0100               2468      CMP #256, D0  ; BGT = 352 > D0
00003230  6E00 002C               2469      BGT MAP6NOLIMIT10   
00003234  B07C 0044               2470      CMP #68, D0
00003238  6D00 0024               2471      BLT MAP6NOLIMIT10
0000323C                          2472      ;NOW WE CHECK POS Y 
0000323C  B27C 01E0               2473      CMP #480, D1  ; 
00003240  6E00 001C               2474      BGT MAP6NOLIMIT10   
00003244  B27C 0120               2475      CMP #288, D1
00003248  6D00 0014               2476      BLT MAP6NOLIMIT10
0000324C                          2477      ;;;; AQUI PISA EL LIMITE
0000324C  4C9F 001F               2478      MOVEM.W (A7)+, D0-D4
00003250  5279 00003994           2479      ADD.W #1, PLAYERPOSX
00003256  5379 00003996           2480      SUB.W #1, PLAYERPOSY
0000325C  4E75                    2481      RTS
0000325E                          2482  MAP6NOLIMIT10
0000325E  4C9F 001F               2483      MOVEM.W (A7)+, D0-D4
00003262  4EF9 00003458           2484      JMP NOLIMIT
00003268                          2485  LIMAPA7
00003268  301F                    2486      MOVE.W (A7)+, D0
0000326A  48A7 F800               2487      MOVEM.W D0-D4, -(A7)
0000326E  3039 00003994           2488      MOVE.W PLAYERPOSX, D0
00003274  3239 00003996           2489      MOVE.W PLAYERPOSY, D1
0000327A                          2490      ;CHECK FOR TOP-LEFT WALL 
0000327A  B07C 0120               2491      CMP #288, D0  ; BGT = 352 > D0
0000327E  6E00 0026               2492      BGT MAP7NOLIMIT1    
00003282  B07C 0000               2493      CMP #0, D0
00003286  6D00 001E               2494      BLT MAP7NOLIMIT1
0000328A                          2495      ;NOW WE CHECK POS Y 
0000328A  B27C 0020               2496      CMP #32, D1  ; 
0000328E  6E00 0016               2497      BGT MAP7NOLIMIT1    
00003292  B27C 0000               2498      CMP #0, D1
00003296  6D00 000E               2499      BLT MAP7NOLIMIT1
0000329A                          2500      ;;;; AQUI PISA EL LIMITE
0000329A  5279 00003996           2501      ADD.W #1, PLAYERPOSY
000032A0  4C9F 001F               2502      MOVEM.W (A7)+, D0-D4
000032A4  4E75                    2503      RTS
000032A6                          2504  MAP7NOLIMIT1
000032A6                          2505      ;CHECK FOR LEFT WALL
000032A6  B07C 0020               2506      CMP #32, D0  ; BGT = 352 > D0
000032AA  6E00 0026               2507      BGT MAP7NOLIMIT2    
000032AE  B07C 0000               2508      CMP #0, D0
000032B2  6D00 001E               2509      BLT MAP7NOLIMIT2
000032B6                          2510      ;NOW WE CHECK POS Y 
000032B6  B27C 01E0               2511      CMP #480, D1  ; 
000032BA  6E00 0016               2512      BGT MAP7NOLIMIT2    
000032BE  B27C 0000               2513      CMP #0, D1
000032C2  6D00 000E               2514      BLT MAP7NOLIMIT2
000032C6                          2515      ;;;; AQUI PISA EL LIMITE
000032C6  5279 00003994           2516      ADD.W #1, PLAYERPOSX
000032CC  4C9F 001F               2517      MOVEM.W (A7)+, D0-D4
000032D0  4E75                    2518      RTS
000032D2                          2519  MAP7NOLIMIT2
000032D2                          2520      ;CHECK FOR BOTTOM WALL
000032D2  B07C 0280               2521      CMP #640, D0  ; BGT = 352 > D0
000032D6  6E00 0026               2522      BGT MAP7NOLIMIT3    
000032DA  B07C 0000               2523      CMP #0, D0
000032DE  6D00 001E               2524      BLT MAP7NOLIMIT3
000032E2                          2525      ;NOW WE CHECK POS Y 
000032E2  B27C 01E0               2526      CMP #480, D1  ; 
000032E6  6E00 0016               2527      BGT MAP7NOLIMIT3    
000032EA  B27C 01A0               2528      CMP #416, D1
000032EE  6D00 000E               2529      BLT MAP7NOLIMIT3
000032F2                          2530      ;;;; AQUI PISA EL LIMITE
000032F2  5379 00003996           2531      SUB.W #1, PLAYERPOSY
000032F8  4C9F 001F               2532      MOVEM.W (A7)+, D0-D4
000032FC  4E75                    2533      RTS
000032FE                          2534  MAP7NOLIMIT3
000032FE                          2535      ;CHECK FOR RIGHT WALL
000032FE  B07C 0280               2536      CMP #640, D0  ; BGT = 352 > D0
00003302  6E00 0026               2537      BGT MAP7NOLIMIT4    
00003306  B07C 0240               2538      CMP #576, D0
0000330A  6D00 001E               2539      BLT MAP7NOLIMIT4
0000330E                          2540      ;NOW WE CHECK POS Y 
0000330E  B27C 01E0               2541      CMP #480, D1  ; 
00003312  6E00 0016               2542      BGT MAP7NOLIMIT4    
00003316  B27C 0000               2543      CMP #0, D1
0000331A  6D00 000E               2544      BLT MAP7NOLIMIT4
0000331E                          2545      ;;;; AQUI PISA EL LIMITE
0000331E  5379 00003994           2546      SUB.W #1, PLAYERPOSX
00003324  4C9F 001F               2547      MOVEM.W (A7)+, D0-D4
00003328  4E75                    2548      RTS
0000332A                          2549  MAP7NOLIMIT4
0000332A                          2550      ;CHECK TOP-RIGHT WALL
0000332A  B07C 0280               2551      CMP #640, D0  ; BGT = 352 > D0
0000332E  6E00 0026               2552      BGT MAP7NOLIMIT5    
00003332  B07C 0160               2553      CMP #352, D0
00003336  6D00 001E               2554      BLT MAP7NOLIMIT5
0000333A                          2555      ;NOW WE CHECK POS Y 
0000333A  B27C 0020               2556      CMP #32, D1  ; 
0000333E  6E00 0016               2557      BGT MAP7NOLIMIT5    
00003342  B27C 0000               2558      CMP #0, D1
00003346  6D00 000E               2559      BLT MAP7NOLIMIT5
0000334A                          2560      ;;;; AQUI PISA EL LIMITE
0000334A  5279 00003996           2561      ADD.W #1, PLAYERPOSY
00003350  4C9F 001F               2562      MOVEM.W (A7)+, D0-D4
00003354  4E75                    2563      RTS
00003356                          2564  MAP7NOLIMIT5
00003356  4C9F 001F               2565      MOVEM.W (A7)+, D0-D4
0000335A  4EF9 00003458           2566      JMP NOLIMIT
00003360                          2567      
00003360                          2568  LIMAPA8
00003360  301F                    2569      MOVE.W (A7)+, D0
00003362  48A7 F800               2570      MOVEM.W D0-D4, -(A7)
00003366  3039 00003994           2571      MOVE.W PLAYERPOSX, D0
0000336C  3239 00003996           2572      MOVE.W PLAYERPOSY, D1
00003372                          2573      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00003372                          2574      ;CHECK UPPER LEFT WALL 
00003372  B07C 0120               2575      CMP #288, D0  ; BGT = 352 > D0
00003376  6E00 0026               2576      BGT MAP8NOLIMIT1   
0000337A  B07C 0000               2577      CMP #0, D0
0000337E  6D00 001E               2578      BLT MAP8NOLIMIT1
00003382                          2579      ;NOW WE CHECK POS Y 
00003382  B27C 00A0               2580      CMP #160, D1  ; 
00003386  6E00 0016               2581      BGT MAP8NOLIMIT1    
0000338A  B27C 0000               2582      CMP #0, D1
0000338E  6D00 000E               2583      BLT MAP8NOLIMIT1
00003392                          2584      ;;;; AQUI PISA EL LIMITE
00003392  4C9F 001F               2585      MOVEM.W (A7)+, D0-D4
00003396  5279 00003996           2586      ADD.W #1, PLAYERPOSY
0000339C  4E75                    2587      RTS
0000339E                          2588  MAP8NOLIMIT1
0000339E                          2589      ;CHECK BOTTOM WALL
0000339E  B07C 0280               2590      CMP #640, D0  ; BGT = 352 > D0
000033A2  6E00 0026               2591      BGT MAP8NOLIMIT2   
000033A6  B07C 0000               2592      CMP #0, D0
000033AA  6D00 001E               2593      BLT MAP8NOLIMIT2
000033AE                          2594      ;NOW WE CHECK POS Y 
000033AE  B27C 01E0               2595      CMP #480, D1  ; 
000033B2  6E00 0016               2596      BGT MAP8NOLIMIT2    
000033B6  B27C 0120               2597      CMP #288, D1
000033BA  6D00 000E               2598      BLT MAP8NOLIMIT2
000033BE                          2599      ;;;; AQUI PISA EL LIMITE
000033BE  4C9F 001F               2600      MOVEM.W (A7)+, D0-D4
000033C2  5379 00003996           2601      SUB.W #1, PLAYERPOSY
000033C8  4E75                    2602      RTS
000033CA                          2603  MAP8NOLIMIT2
000033CA                          2604      ;CHECK LEFT WALL
000033CA  B07C 00C0               2605      CMP #192, D0  ; BGT = 352 > D0
000033CE  6E00 0026               2606      BGT MAP8NOLIMIT3   
000033D2  B07C 0000               2607      CMP #0, D0
000033D6  6D00 001E               2608      BLT MAP8NOLIMIT3
000033DA                          2609      ;NOW WE CHECK POS Y 
000033DA  B27C 01E0               2610      CMP #480, D1  ; 
000033DE  6E00 0016               2611      BGT MAP8NOLIMIT3    
000033E2  B27C 0000               2612      CMP #0, D1
000033E6  6D00 000E               2613      BLT MAP8NOLIMIT3
000033EA                          2614      ;;;; AQUI PISA EL LIMITE
000033EA  4C9F 001F               2615      MOVEM.W (A7)+, D0-D4
000033EE  5279 00003994           2616      ADD.W #1, PLAYERPOSX
000033F4  4E75                    2617      RTS
000033F6                          2618  MAP8NOLIMIT3
000033F6                          2619      ;CHECK RIGHT WALL
000033F6  B07C 0280               2620      CMP #640, D0  ; BGT = 352 > D0
000033FA  6E00 0026               2621      BGT MAP8NOLIMIT4   
000033FE  B07C 01A0               2622      CMP #416, D0
00003402  6D00 001E               2623      BLT MAP8NOLIMIT4
00003406                          2624      ;NOW WE CHECK POS Y 
00003406  B27C 01E0               2625      CMP #480, D1  ; 
0000340A  6E00 0016               2626      BGT MAP8NOLIMIT4    
0000340E  B27C 0000               2627      CMP #0, D1
00003412  6D00 000E               2628      BLT MAP8NOLIMIT4
00003416                          2629      ;;;; AQUI PISA EL LIMITE
00003416  4C9F 001F               2630      MOVEM.W (A7)+, D0-D4
0000341A  5379 00003994           2631      SUB.W #1, PLAYERPOSX
00003420  4E75                    2632      RTS
00003422                          2633  MAP8NOLIMIT4
00003422                          2634  ;CHECK TOP RIGHT WALL
00003422  B07C 0280               2635      CMP #640, D0  ; BGT = 352 > D0
00003426  6E00 0026               2636      BGT MAP8NOLIMIT5   
0000342A  B07C 0160               2637      CMP #352, D0
0000342E  6D00 001E               2638      BLT MAP8NOLIMIT5
00003432                          2639      ;NOW WE CHECK POS Y 
00003432  B27C 00A0               2640      CMP #160, D1  ; 
00003436  6E00 0016               2641      BGT MAP8NOLIMIT5    
0000343A  B27C 0000               2642      CMP #0, D1
0000343E  6D00 000E               2643      BLT MAP8NOLIMIT5
00003442                          2644      ;;;; AQUI PISA EL LIMITE
00003442  4C9F 001F               2645      MOVEM.W (A7)+, D0-D4
00003446  5279 00003996           2646      ADD.W #1, PLAYERPOSY
0000344C  4E75                    2647      RTS
0000344E                          2648  MAP8NOLIMIT5
0000344E  4C9F 001F               2649      MOVEM.W (A7)+, D0-D4
00003452  4EF9 00003458           2650      JMP NOLIMIT
00003458                          2651      
00003458                          2652  NOLIMIT
00003458  3F00                    2653              MOVE.W  D0,-(A7)
0000345A  0839 0000 0000398C      2654        BTST #0, KBDVAL         
00003462  6700 000C               2655              BEQ .UP    
00003466  303C FFFC               2656              MOVE.W  #-PLAYERSPEED,D0     
0000346A  4EB9 000034B6           2657        JSR   MOVEHOR 
00003470  0839 0001 0000398C      2658  .UP   BTST #1, KBDVAL           
00003478  6700 000C               2659        BEQ   .RIGHT  
0000347C  303C FFFC               2660              MOVE.W  #-PLAYERSPEED,D0      
00003480  4EB9 000034DC           2661        JSR   MOVEVER
00003486  0839 0002 0000398C      2662  .RIGHT    BTST #2, KBDVAL
0000348E  6700 000C               2663        BEQ   .DOWN  
00003492  303C 0004               2664              MOVE.W  #PLAYERSPEED,D0     
00003496  4EB9 000034B6           2665        JSR   MOVEHOR
0000349C  0839 0003 0000398C      2666  .DOWN     BTST #3, KBDVAL
000034A4  6700 000C               2667        BEQ   .NOTMOVED  
000034A8  303C 0004               2668              MOVE.W  #PLAYERSPEED,D0       
000034AC  4EB9 000034DC           2669        JSR   MOVEVER
000034B2  301F                    2670  .NOTMOVED     MOVE.W  (A7)+,D0
000034B4  4E75                    2671              RTS
000034B6                          2672  
000034B6  D179 00003994           2673  MOVEHOR     ADD.W   D0,(PLAYERPOSX)
000034BC  6A00 0008               2674              BPL.W   .NOTLEFTEDGE
000034C0  4279 00003994           2675              CLR.W   (PLAYERPOSX)
000034C6                          2676  .NOTLEFTEDGE
000034C6  0C79 0260 00003994      2677              CMP.W   #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
000034CE  6D00 000A               2678              BLT.W   .NORIGHTEDGE
000034D2  33FC 0260 00003994      2679              MOVE.W  #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
000034DA                          2680  .NORIGHTEDGE 
000034DA  4E75                    2681              RTS
000034DC                          2682              
000034DC  D179 00003996           2683  MOVEVER     ADD.W   D0,(PLAYERPOSY)
000034E2  6A00 0008               2684              BPL.W   .NOTUPPEREDGE
000034E6  4279 00003996           2685              CLR.W   (PLAYERPOSY)
000034EC                          2686  .NOTUPPEREDGE
000034EC  0C79 01C0 00003996      2687              CMP.W   #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
000034F4  6D00 000A               2688              BLT.W   .NOLOWEREDGE
000034F8  33FC 01C0 00003996      2689              MOVE.W  #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
00003500                          2690  .NOLOWEREDGE 
00003500  4E75                    2691              RTS
00003502                          2692          
00003502                          2693  ; ------------------------------------------------------------------------------
00003502                          2694  PLAYERPLOT
00003502                          2695  ; PLOT THE PLAYER.
00003502                          2696  ; INPUT    : NONE 
00003502                          2697  ; OUTPUT   : NONE
00003502                          2698  ; MODIFIES : NONE
00003502                          2699  ; ------------------------------------------------------------------------------
00003502                          2700              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
00003502  1F00                    2701              MOVE.B  D0,-(A7)
00003504  2F01                    2702              MOVE.L  D1,-(A7)
00003506  48A7 3800               2703        MOVEM.W D2-D4, -(A7)
0000350A                          2704        
0000350A  223C 00CC954E           2705        MOVE.L #$00CC954E,D1 ;PEN COLOR
00003510  103C 0050               2706        MOVE.B #80,D0
00003514  4E4F                    2707        TRAP #15
00003516  223C 00B53866           2708        MOVE.L #$00B53866,D1 ;FILL COLOR
0000351C  103C 0051               2709        MOVE.B #81,D0
00003520  4E4F                    2710        TRAP #15
00003522                          2711        ; SE DIBUJA EL CUADRADO
00003522  3239 00003994           2712        MOVE.W (PLAYERPOSX),D1    
00003528  3439 00003996           2713        MOVE.W (PLAYERPOSY),D2      
0000352E  3601                    2714        MOVE.W D1,D3
00003530  0643 0020               2715              ADD.W  #PLAYERWIDTH,D3  
00003534  3802                    2716        MOVE.W D2,D4
00003536  0644 0020               2717              ADD.W  #PLAYERHEIGHT,D4
0000353A  103C 0057               2718        MOVE.B #87,D0
0000353E  4E4F                    2719        TRAP #15
00003540                          2720        
00003540  4C9F 001C               2721              MOVEM.W (A7)+,D2-D4
00003544  221F                    2722              MOVE.L  (A7)+,D1      
00003546  101F                    2723              MOVE.B  (A7)+,D0
00003548                          2724    
00003548  4E75                    2725        RTS
0000354A                          2726  
0000354A                          2727  
0000354A                          2728  
0000354A                          2729  
0000354A                          2730  -------------------- end include --------------------
0000354A                          2731              INCLUDE "PROJECTILE.X68"
0000354A                          2732  ; ==============================================================================
0000354A                          2733  ; PROJECTILE MANAGEMENT (AGENT)
0000354A                          2734  ; PROJPOSX (W)  (A0)
0000354A                          2735  ; PROJPOSY (W) 2(A0)
0000354A                          2736  ; PROJVELX (W) 4(A0)
0000354A                          2737  ; PROJVELY (W) 6(A0)
0000354A                          2738  ; ==============================================================================
0000354A                          2739  
0000354A                          2740  ; ------------------------------------------------------------------------------
0000354A                          2741  PROJINIT 
0000354A                          2742  ; INITIALIZES THE PROJECTILE.
0000354A                          2743  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
0000354A                          2744  ; OUTPUT   : NONE
0000354A                          2745  ; MODIFIES : NONE
0000354A                          2746  ; ------------------------------------------------------------------------------
0000354A  2F00                    2747             MOVE.L  D0,-(A7)
0000354C                          2748             
0000354C  4280                    2749              CLR.L   D0
0000354E  0839 0004 0000398D      2750              BTST #4, (KBDEDGE)    
00003556  6700 0008               2751              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
0000355A  0680 FFF80000           2752              ADD.L   #-PROJSPEEDX<<16,D0
00003560  0839 0005 0000398D      2753  .FUP        BTST #5, (KBDEDGE)      
00003568  6700 0006               2754              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
0000356C  0640 FFF8               2755              ADD.W   #-PROJSPEEDY,D0 
00003570  0839 0006 0000398D      2756  .FRIGHT     BTST #6, (KBDEDGE)
00003578  6700 0008               2757              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
0000357C  0680 00080000           2758              ADD.L   #PROJSPEEDX<<16,D0
00003582  0839 0007 0000398D      2759  .FDOWN      BTST #7, (KBDEDGE)
0000358A  6700 0004               2760              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
0000358E  5040                    2761              ADD.W   #PROJSPEEDY,D0
00003590  4A80                    2762  .NOTFDOWN   TST.L   D0
00003592  6600 0006               2763              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
00003596  303C 0008               2764              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
0000359A  20B9 00003994           2765  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
000035A0  2140 0004               2766              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
000035A4  5279 00003998           2767              ADD.W   #1,(NPROJ)
000035AA  201F                    2768              MOVE.L  (A7)+,D0
000035AC  4E75                    2769              RTS
000035AE                          2770              
000035AE                          2771  ; ------------------------------------------------------------------------------
000035AE                          2772  PROJUPD 
000035AE                          2773  ; UPDATES THE PROJECTILE.
000035AE                          2774  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
000035AE                          2775  ; OUTPUT   : NONE
000035AE                          2776  ; MODIFIES : NONE
000035AE                          2777  ; ------------------------------------------------------------------------------
000035AE  2F00                    2778              MOVE.L  D0,-(A7)
000035B0  2028 0004               2779              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
000035B4  D168 0002               2780              ADD.W   D0,2(A0)
000035B8  E088                    2781              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
000035BA  E088                    2782              LSR.L   #8,D0
000035BC  D150                    2783              ADD.W   D0,(A0) 
000035BE  201F                    2784              MOVE.L  (A7)+,D0
000035C0  4E75                    2785              RTS
000035C2                          2786      
000035C2                          2787  ; ------------------------------------------------------------------------------
000035C2                          2788  PROJPLOT 
000035C2                          2789  ; PLOTS THE PROJECTILE.
000035C2                          2790  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
000035C2                          2791  ; OUTPUT   : NONE
000035C2                          2792  ; MODIFIES : NONE
000035C2                          2793  ; ------------------------------------------------------------------------------
000035C2  1F00                    2794              MOVE.B  D0,-(A7)
000035C4  2F01                    2795              MOVE.L  D1,-(A7)
000035C6  48A7 3800               2796        MOVEM.W D2-D4, -(A7)
000035CA                          2797        
000035CA  223C 00C00FFE           2798        MOVE.L #$00C00FFE,D1 ;PEN COLOR
000035D0  103C 0050               2799        MOVE.B #80,D0
000035D4  4E4F                    2800        TRAP #15
000035D6  223C 00BFF006           2801        MOVE.L #$00BFF006,D1 ;FILL COLOR
000035DC  103C 0051               2802        MOVE.B #81,D0
000035E0  4E4F                    2803        TRAP #15
000035E2                          2804        ; SE DIBUJA EL CUADRADO
000035E2  3210                    2805        MOVE.W (A0),D1    
000035E4  3428 0002               2806        MOVE.W 2(A0),D2     
000035E8  3601                    2807        MOVE.W D1,D3
000035EA  0643 0010               2808              ADD.W  #PROJWIDTH,D3    
000035EE  3802                    2809        MOVE.W D2,D4
000035F0  0644 0010               2810              ADD.W  #PROJHEIGHT,D4
000035F4  103C 0057               2811        MOVE.B #87,D0
000035F8  4E4F                    2812        TRAP #15
000035FA                          2813        
000035FA  4C9F 001C               2814              MOVEM.W (A7)+,D2-D4
000035FE  221F                    2815              MOVE.L  (A7)+,D1      
00003600  101F                    2816              MOVE.B  (A7)+,D0
00003602  4E75                    2817              RTS
00003604                          2818  
00003604                          2819  
00003604                          2820  -------------------- end include --------------------
00003604                          2821              INCLUDE "AUDIO.X68"
00003604                          2822     
00003604                          2823  ; =============================================================================
00003604                          2824  ; AUDIO MANAGEMENT
00003604                          2825  ; =============================================================================
00003604                          2826  
00003604                          2827  
00003604                          2828  ; -----------------------------------------------------------------------------
00003604                          2829  AUDINIT
00003604                          2830  ; CHANGES AUDIO TO PLAY
00003604                          2831  ; INPUT    - NONE
00003604                          2832  ; OUTPUT   - NONE
00003604                          2833  ; MODIFIES - NONE
00003604                          2834  ; -----------------------------------------------------------------------------
00003604                          2835      
00003604  48A7 E000               2836      MOVEM.W D0-D2, -(A7)
00003608  48A7 00C0               2837      MOVEM.W A0-A1, -(A7)
0000360C                          2838  ;LOAD ELEVATOR MUSIC IN POS 0 
0000360C  103C 0047               2839      MOVE.B #71, D0
00003610  43F8 100F               2840      LEA ELEVATOR_MUSIC, A1
00003614  123C 0000               2841      MOVE.B #0, D1
00003618  4E4F                    2842      TRAP #15
0000361A                          2843  ;LOAD HEAVEN MUSIC IN POS 1
0000361A  43F8 1000               2844      LEA HEAVENSOUND, A1
0000361E  123C 0001               2845      MOVE.B #1, D1
00003622  4E4F                    2846      TRAP #15
00003624                          2847  ;LOAD HELL MUSIC IN POS 2
00003624  43F8 1026               2848      LEA HELLSOUND, A1
00003628  123C 0002               2849      MOVE.B #2, D1
0000362C  4E4F                    2850      TRAP #15
0000362E  4C9F 0300               2851      MOVEM.W (A7)+, A0-A1
00003632  4C9F 0007               2852      MOVEM.W (A7)+, D0-D2
00003636                          2853  
00003636  4E75                    2854      RTS
00003638                          2855  
00003638                          2856  
00003638                          2857  ; -----------------------------------------------------------------------------
00003638                          2858  AUDPLAY
00003638                          2859  ; CHANGES AUDIO TO PLAY
00003638                          2860  ; INPUT    - NONE
00003638                          2861  ; OUTPUT   - NONE
00003638                          2862  ; MODIFIES - NONE
00003638                          2863  ; -----------------------------------------------------------------------------
00003638                          2864      
00003638  48E7 E000               2865      MOVEM.L D0-D2, -(A7)
0000363C  48A7 00C0               2866      MOVEM.W A0-A1, -(A7)    
00003640                          2867      
00003640  3239 000039A2           2868      MOVE.W LOADEDMAP, D1
00003646  C2FC 0006               2869             MULU #6, D1
0000364A  3241                    2870             MOVEA.W D1, A1
0000364C  4EE9 3650               2871             JMP MSCSEL(A1)
00003650                          2872  MSCSEL:
00003650  4EF9 00003686           2873             JMP ELEVATORMUSIC
00003656                          2874             
00003656  4EF9 000036A4           2875             JMP HEAVENMUSIC
0000365C                          2876             
0000365C  4EF9 000036A4           2877             JMP HEAVENMUSIC
00003662                          2878             
00003662  4EF9 000036A4           2879             JMP HEAVENMUSIC
00003668                          2880             
00003668  4EF9 000036A4           2881             JMP HEAVENMUSIC
0000366E                          2882             
0000366E  4EF9 000036C6           2883             JMP HELLMUSIC
00003674                          2884             
00003674  4EF9 000036C6           2885             JMP HELLMUSIC
0000367A                          2886             
0000367A  4EF9 000036C6           2887             JMP HELLMUSIC
00003680                          2888             
00003680  4EF9 000036C6           2889             JMP HELLMUSIC
00003686                          2890             
00003686                          2891  
00003686                          2892  ELEVATORMUSIC
00003686  103C 004C               2893      MOVE.B #76, D0
0000368A  123C 0000               2894      MOVE.B #0, D1
0000368E  7400                    2895      MOVE.L #0, D2
00003690  4E4F                    2896      TRAP #15
00003692  4C9F 0300               2897      MOVEM.W (A7)+, A0-A1
00003696  4CDF 0007               2898      MOVEM.L (A7)+, D0-D2
0000369A  13FC 0001 000039A4      2899      MOVE.B #1, MUSICPLAYED
000036A2  4E75                    2900      RTS
000036A4                          2901  
000036A4                          2902  HEAVENMUSIC 
000036A4  103C 004C               2903      MOVE.B #76, D0
000036A8  123C 0000               2904      MOVE.B #0, D1
000036AC  7402                    2905      MOVE.L #2, D2
000036AE  4E4F                    2906      TRAP #15
000036B0  103C 004C               2907      MOVE.B #76, D0
000036B4  123C 0001               2908      MOVE.B #1, D1
000036B8  7400                    2909      MOVE.L #0, D2
000036BA  4E4F                    2910      TRAP #15
000036BC  4C9F 0300               2911      MOVEM.W (A7)+, A0-A1
000036C0  4CDF 0007               2912      MOVEM.L (A7)+, D0-D2
000036C4  4E75                    2913      RTS
000036C6                          2914  HELLMUSIC
000036C6  103C 004C               2915      MOVE.B #76, D0
000036CA  123C 0000               2916      MOVE.B #0, D1
000036CE  7402                    2917      MOVE.L #2, D2
000036D0  4E4F                    2918      TRAP #15
000036D2  103C 004C               2919      MOVE.B #76, D0
000036D6  123C 0002               2920      MOVE.B #2, D1
000036DA  7400                    2921      MOVE.L #0,  D2
000036DC  4E4F                    2922      TRAP #15
000036DE  4C9F 0300               2923      MOVEM.W (A7)+, A0-A1
000036E2  4CDF 0007               2924      MOVEM.L (A7)+, D0-D2
000036E6  4E75                    2925      RTS
000036E8                          2926  
000036E8                          2927  FIREDSOUND
000036E8  48A7 E000               2928      MOVEM.W D0-D2, -(A7)
000036EC  48A7 00C0               2929      MOVEM.W A0-A1, -(A7)
000036F0  103C 0049               2930      MOVE.B #73, D0
000036F4  43F8 1035               2931      LEA PROJ_SOUND, A1
000036F8  4E4F                    2932      TRAP #15
000036FA  4C9F 0300               2933      MOVEM.W (A7)+, A0-A1
000036FE  4C9F 0007               2934      MOVEM.W (A7)+, D0-D2
00003702  4E75                    2935      RTS
00003702  4E75                    2936  -------------------- end include --------------------
00003704                          2937              INCLUDE "STATES.X68"
00003704                          2938  ; =============================================================================
00003704                          2939  ; GAME STATE MANAGEMENT
00003704                          2940  ; =============================================================================
00003704                          2941  
00003704                          2942  ; -----------------------------------------------------------------------------
00003704                          2943  STAINIT
00003704                          2944  ; INITALIZES THE STATE MANAGER
00003704                          2945  ; INPUT    - NONE
00003704                          2946  ; OUTPUT   - NONE
00003704                          2947  ; MODIFIES - NONE
00003704                          2948  ; -----------------------------------------------------------------------------
00003704  33FC FFFF 000039C2      2949              MOVE.W  #STANONE,(STACUR)
0000370C  4279 000039C4           2950              CLR.W   (STANEXT)
00003712  4E75                    2951              RTS
00003714                          2952  
00003714                          2953  ; -----------------------------------------------------------------------------
00003714                          2954  STAUPD
00003714                          2955  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00003714                          2956  ; INPUT    - NONE
00003714                          2957  ; OUTPUT   - NONE
00003714                          2958  ; MODIFIES - NONE
00003714                          2959  ; -----------------------------------------------------------------------------
00003714  48E7 8080               2960              MOVEM.L D0/A0,-(A7)
00003718  4280                    2961              CLR.L   D0
0000371A  3039 000039C4           2962              MOVE.W  (STANEXT),D0
00003720  B079 000039C2           2963              CMP.W   (STACUR),D0
00003726  6700 0012               2964              BEQ     .DOUPD
0000372A  33C0 000039C2           2965              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00003730  E588                    2966              LSL.L   #2,D0
00003732  2040                    2967              MOVE.L  D0,A0
00003734  2068 3752               2968              MOVE.L  .INITBL(A0),A0
00003738  4E90                    2969              JSR     (A0)
0000373A  4280                    2970  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
0000373C  3039 000039C2           2971              MOVE.W  (STACUR),D0
00003742  E588                    2972              LSL.L   #2,D0
00003744  2040                    2973              MOVE.L  D0,A0
00003746  2068 375E               2974              MOVE.L  .UPDTBL(A0),A0
0000374A  4E90                    2975              JSR     (A0)
0000374C  4CDF 0101               2976              MOVEM.L (A7)+,D0/A0
00003750  4E75                    2977              RTS
00003752= 00003792 00003794 ...   2978  .INITBL     DC.L    STAEMPTY,GAMINIT,ENDGINIT
0000375E= 00003812 000037A2 ...   2979  .UPDTBL     DC.L    ISCUPD,GAMUPD,ENDGUPD
0000376A                          2980  
0000376A                          2981  ; -----------------------------------------------------------------------------
0000376A                          2982  STAPLOT
0000376A                          2983  ; PERFORMS STATE PLOT
0000376A                          2984  ; INPUT    - NONE
0000376A                          2985  ; OUTPUT   - NONE
0000376A                          2986  ; MODIFIES - NONE
0000376A                          2987  ; -----------------------------------------------------------------------------
0000376A  48E7 8080               2988              MOVEM.L D0/A0,-(A7)
0000376E  4280                    2989              CLR.L   D0
00003770  3039 000039C2           2990              MOVE.W  (STACUR),D0
00003776  E588                    2991              LSL.L   #2,D0
00003778  2040                    2992              MOVE.L  D0,A0
0000377A  2068 3786               2993              MOVE.L  .PLTTBL(A0),A0
0000377E  4E90                    2994              JSR     (A0)
00003780  4CDF 0101               2995              MOVEM.L (A7)+,D0/A0
00003784  4E75                    2996              RTS
00003786= 0000382C 000037FC ...   2997  .PLTTBL     DC.L    ISCPLOT,GAMPLOT,ENDGPLOT
00003792                          2998  
00003792                          2999  ; -----------------------------------------------------------------------------
00003792                          3000  STAEMPTY
00003792                          3001  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00003792                          3002  ; INPUT    - NONE
00003792                          3003  ; OUTPUT   - NONE
00003792                          3004  ; MODIFIES - NONE
00003792                          3005  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00003792                          3006  ; -----------------------------------------------------------------------------
00003792  4E75                    3007              RTS
00003794                          3008  
00003794                          3009  
00003794                          3010  
00003794                          3011  
00003794                          3012  
00003794                          3013  
00003794                          3014  
00003794                          3015  
00003794                          3016  
00003794                          3017  -------------------- end include --------------------
00003794                          3018              INCLUDE "GAME.X68"
00003794                          3019  ; ==============================================================================
00003794                          3020  ; GAME MANAGEMENT
00003794                          3021  ; ==============================================================================
00003794                          3022  
00003794                          3023  ; ------------------------------------------------------------------------------
00003794                          3024  GAMINIT
00003794                          3025  ; INITIALIZES GAME.
00003794                          3026  ; INPUT    : NONE
00003794                          3027  ; OUTPUT   : NONE
00003794                          3028  ; MODIFIES : NONE
00003794                          3029  ; ------------------------------------------------------------------------------
00003794  4279 000039A2           3030              CLR.W LOADEDMAP
0000379A  4EB8 29A0               3031              JSR     PLAYERINIT
0000379E  6000 FE64               3032              BRA     AUDINIT
000037A2                          3033  
000037A2                          3034  ; ------------------------------------------------------------------------------
000037A2                          3035  GAMUPD
000037A2                          3036  ; UPDATES THE GAME
000037A2                          3037  ; INPUT    : NONE
000037A2                          3038  ; OUTPUT   : NONE
000037A2                          3039  ; MODIFIES : NONE
000037A2                          3040  ; ------------------------------------------------------------------------------
000037A2  48E7 8070               3041              MOVEM.L D0/A1-A3,-(A7)
000037A6                          3042              
000037A6                          3043              ; CHECK IF MUSIC IS ALREADY PLAYING 
000037A6  1039 000039A4           3044              MOVE.B MUSICPLAYED, D0
000037AC  B07C 0001               3045              CMP #1, D0
000037B0  6700 0006               3046              BEQ NOMUSIC
000037B4  4EB8 3638               3047              JSR AUDPLAY
000037B8                          3048  ; GENERAL UPDATES
000037B8  4EB8 294C               3049  NOMUSIC     JSR ELEVATORUPDATE 
000037BC  4EB8 29A2               3050              JSR PLAYERUPD   
000037C0  4EB8 150A               3051              JSR MAPUPD
000037C4                          3052  ; SHOTS LOGIC         
000037C4  1039 0000398D           3053              MOVE.B  (KBDEDGE),D0
000037CA  C03C 00F0               3054              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
000037CE  6718                    3055              BEQ.B .NOTFIRED
000037D0  4EB8 36E8               3056              JSR FIREDSOUND
000037D4  43F8 354A               3057              LEA     PROJINIT,A1
000037D8  45F8 35AE               3058              LEA     PROJUPD,A2
000037DC  47F8 35C2               3059              LEA     PROJPLOT,A3
000037E0  303C 0001               3060              MOVE.W  #1,D0
000037E4  4EB8 12BC               3061              JSR     AGLADD
000037E8                          3062  .NOTFIRED
000037E8  4A79 00003998           3063              TST.W   (NPROJ)
000037EE  6700 0006               3064              BEQ     .NOPROJ1
000037F2  4EB8 12D6               3065              JSR     AGLUPD
000037F6                          3066  .NOPROJ1
000037F6  4CDF 0E01               3067              MOVEM.L (A7)+,D0/A1-A3
000037FA  4E75                    3068              RTS
000037FC                          3069  
000037FC                          3070  ; ------------------------------------------------------------------------------
000037FC                          3071  GAMPLOT
000037FC                          3072  ; PLOTS THE GAME
000037FC                          3073  ; INPUT    : NONE
000037FC                          3074  ; OUTPUT   : NONE
000037FC                          3075  ; MODIFIES : NONE
000037FC                          3076  ; ------------------------------------------------------------------------------
000037FC  4EB8 1486               3077              JSR MAPPLOT     
00003800  4A79 00003998           3078              TST.W   (NPROJ)
00003806  6700 0006               3079              BEQ     .NOPROJ2
0000380A  4EB8 12FA               3080              JSR     AGLPLOT
0000380E  6000 FCF2               3081  .NOPROJ2    BRA     PLAYERPLOT
00003812                          3082  
00003812                          3083  
00003812                          3084  
00003812                          3085  
00003812                          3086  
00003812                          3087  
00003812                          3088  -------------------- end include --------------------
00003812                          3089              INCLUDE "INTRO.X68"
00003812                          3090  ; ==============================================================================
00003812                          3091  ; INTRO SCREEN
00003812                          3092  ; ==============================================================================
00003812                          3093  
00003812                          3094  ; ------------------------------------------------------------------------------
00003812                          3095  ISCUPD
00003812                          3096  ; INTRO SCREEN UPDATE
00003812                          3097  ; INPUT    : NONE
00003812                          3098  ; OUTPUT   : NONE
00003812                          3099  ; MODIFIES : NONE
00003812                          3100  ; ------------------------------------------------------------------------------
00003812  103C 003D               3101              MOVE.B  #61,D0          ; READ MOUSE
00003816  123C 0002               3102              MOVE.B  #2,D1           ; MOUSE DOWN STATE
0000381A  4E4F                    3103              TRAP    #15
0000381C  0200 000F               3104              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00003820  6708                    3105              BEQ.B   .DONE ; IF NO CLICK
00003822  33FC 0001 000039C4      3106              MOVE.W  #1,(STANEXT)
0000382A                          3107  .DONE
0000382A  4E75                    3108              RTS
0000382C                          3109  ; ------------------------------------------------------------------------------
0000382C                          3110  ISCPLOT
0000382C                          3111  ; INTRO SCREEN PLOT
0000382C                          3112  ; INPUT    : NONE
0000382C                          3113  ; OUTPUT   : NONE
0000382C                          3114  ; MODIFIES : NONE
0000382C                          3115  ; ------------------------------------------------------------------------------
0000382C  48E7 C080               3116              MOVEM.L D0-D1/A0,-(A7)
00003830                          3117              
00003830  4281                    3118              CLR.L   D1
00003832  103C 0051               3119              MOVE.B  #81,D0
00003836  4E4F                    3120              TRAP    #15
00003838                          3121              
00003838  41F9 00003866           3122              LEA     .TITLE,A0
0000383E  103C 000A               3123              MOVE.B  #10,D0
00003842  4EB8 1336               3124              JSR     UTLPRINT
00003846                          3125              
00003846  0839 0004 0000398F      3126              BTST.B  #4,(SCRCYCCT)
0000384E  6700 0010               3127              BEQ     .DONE
00003852                          3128              
00003852  41F9 00003892           3129              LEA     .HINT,A0
00003858  103C 0019               3130              MOVE.B  #25,D0
0000385C  4EB8 1336               3131              JSR     UTLPRINT
00003860                          3132              
00003860  4CDF 0103               3133  .DONE       MOVEM.L (A7)+,D0-D1/A0
00003864                          3134  
00003864  4E75                    3135              RTS
00003866= 50 41 54 45 52 4E ...   3136  .TITLE      DC.B    'PATERNOSTER: Beyond the pillars of Hercules',0
00003892= 43 4C 49 43 4B 20 ...   3137  .HINT       DC.B    'CLICK ANYWHERE TO START',0
000038AA                          3138              DS.W    0
000038AA                          3139  
000038AA                          3140  
000038AA                          3141  
000038AA                          3142  
000038AA                          3143  
000038AA                          3144  
000038AA                          3145  
000038AA                          3146  
000038AA                          3147  -------------------- end include --------------------
000038AA                          3148              INCLUDE "ENDGAME.X68"
000038AA                          3149  ; ==============================================================================
000038AA                          3150  ; VICTORY SCREEN
000038AA                          3151  ; ==============================================================================
000038AA                          3152  
000038AA                          3153  ; ------------------------------------------------------------------------------
000038AA                          3154  ENDGINIT
000038AA                          3155  ; END GAME SCREEN INIT
000038AA                          3156  ; INPUT    : NONE
000038AA                          3157  ; OUTPUT   : NONE
000038AA                          3158  ; MODIFIES : NONE
000038AA                          3159  ; ------------------------------------------------------------------------------
000038AA                          3160  
000038AA                          3161              ; GUARDAR SU RECORD EN UN FICHERO
000038AA                          3162              ; LEER FICHERO QUE GUARDE LOS RECORDS Y GUARDAR EN MEMORIA
000038AA  4E75                    3163              RTS
000038AC                          3164  ; ------------------------------------------------------------------------------
000038AC                          3165  ENDGUPD
000038AC                          3166  ; END GAME SCREEN UPDATE
000038AC                          3167  ; INPUT    : NONE
000038AC                          3168  ; OUTPUT   : NONE
000038AC                          3169  ; MODIFIES : NONE
000038AC                          3170  ; ------------------------------------------------------------------------------
000038AC  103C 003D               3171              MOVE.B  #61,D0          ; READ MOUSE
000038B0  123C 0002               3172              MOVE.B  #2,D1           ; MOUSE DOWN STATE
000038B4  4E4F                    3173              TRAP    #15
000038B6  0200 000F               3174              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
000038BA  6708                    3175              BEQ.B   .DONE           ; IF NO CLICK
000038BC  33FC 0001 000039C4      3176              MOVE.W  #1,(STANEXT)
000038C4                          3177  .DONE
000038C4  4E75                    3178              RTS
000038C6                          3179  
000038C6                          3180  ; ------------------------------------------------------------------------------
000038C6                          3181  ENDGPLOT
000038C6                          3182  ; END GAME SCREEN PLOT
000038C6                          3183  ; INPUT    : NONE
000038C6                          3184  ; OUTPUT   : NONE
000038C6                          3185  ; MODIFIES : NONE
000038C6                          3186  ; ------------------------------------------------------------------------------
000038C6  48E7 C080               3187              MOVEM.L D0-D1/A0,-(A7)
000038CA                          3188              
000038CA  4281                    3189              CLR.L   D1
000038CC  103C 0051               3190              MOVE.B  #81,D0
000038D0  4E4F                    3191              TRAP    #15
000038D2                          3192              
000038D2  41F9 0000390E           3193              LEA     .TXT1,A0
000038D8  103C 000A               3194              MOVE.B  #10,D0
000038DC  4EB8 1336               3195              JSR     UTLPRINT
000038E0                          3196              
000038E0  0839 0008 0000398F      3197              BTST.B  #8,(SCRCYCCT)
000038E8  6700 0010               3198              BEQ     .NOTPRINT
000038EC                          3199              
000038EC  41F9 00003928           3200              LEA     .TXT2,A0
000038F2  103C 0019               3201              MOVE.B  #25,D0
000038F6  4EB8 1336               3202              JSR     UTLPRINT
000038FA                          3203              
000038FA                          3204  .NOTPRINT
000038FA  41F9 00003940           3205              LEA     .TXT3,A0
00003900  103C 0019               3206              MOVE.B  #25,D0
00003904  4EB8 1336               3207              JSR     UTLPRINT
00003908                          3208              
00003908                          3209              ; MOSTRAR FICHERO QUE GUARDE LOS RECORDS
00003908                          3210              
00003908  4CDF 0103               3211              MOVEM.L (A7)+,D0-D1/A0
0000390C                          3212  
0000390C  4E75                    3213              RTS
0000390E= 59 4F 55 52 20 52 ...   3214  .TXT1       DC.B    'YOUR RECORD THIS TIME WAS',0
00003928= 43 4C 49 43 4B 20 ...   3215  .TXT2       DC.B    'CLICK ANYWHERE TO START',0
00003940= 48 45 52 45 20 41 ...   3216  .TXT3       DC.B    'HERE ARE THE BEST RECORDS',0
0000395A                          3217              DS.W    0
0000395A                          3218  
0000395A                          3219  
0000395A                          3220  
0000395A                          3221  
0000395A                          3222  
0000395A                          3223  -------------------- end include --------------------
0000395A                          3224  START
0000395A                          3225  
0000395A                          3226  ; --- INITIALIZATION -----------------------------------------------------------
0000395A                          3227  
0000395A  007C 0700               3228              ORI.W   #$0700,SR
0000395E  4EB8 110A               3229              JSR     SYSINIT
00003962                          3230              *JSR     UTLINIT
00003962  4EB8 3704               3231              JSR     STAINIT
00003966                          3232  
00003966                          3233  .LOOP
00003966                          3234  
00003966                          3235  ; --- UPDATE -------------------------------------------------------------------
00003966                          3236  
00003966                          3237  ; READ INPUT DEVICES
00003966                          3238  
00003966  4E41                    3239              TRAP    #KBDUPTN
00003968                          3240  
00003968                          3241  ; UPDATE GAME LOGIC
00003968                          3242  
00003968  4EB8 3714               3243              JSR     STAUPD
0000396C                          3244  
0000396C                          3245  ; --- SYNC ---------------------------------------------------------------------
0000396C                          3246  
0000396C  4A39 0000398E           3247  .WINT       TST.B   (SCRINTCT)
00003972  67F8                    3248              BEQ     .WINT
00003974  4239 0000398E           3249              CLR.B   (SCRINTCT)
0000397A  5239 00003990           3250              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
00003980                          3251  
00003980                          3252  ; --- PLOT ---------------------------------------------------------------------
00003980                          3253              
00003980  4EB8 376A               3254              JSR     STAPLOT
00003984                          3255              
00003984  4E40                    3256              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
00003986                          3257  
00003986  60DE                    3258              BRA     .LOOP
00003988                          3259              
00003988  FFFF FFFF               3260              SIMHALT
0000398C                          3261              
0000398C                          3262              INCLUDE "VARS.X68"
0000398C                          3263  ; ==============================================================================
0000398C                          3264  ; VARIABLES
0000398C                          3265  ; ==============================================================================
0000398C                          3266              
0000398C                          3267  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
0000398C                          3268              
0000398C                          3269  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
0000398D                          3270  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
0000398E                          3271  
0000398E                          3272  
0000398E                          3273  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
0000398E                          3274  
0000398E                          3275  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
0000398F                          3276  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00003990                          3277  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
00003992                          3278              DS.W    0
00003992                          3279  
00003992                          3280  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
00003992                          3281  
00003992= 0064                    3282  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
00003994= 0140                    3283  PLAYERPOSX      DC.W    SCRWIDTH/2
00003996= 00F0                    3284  PLAYERPOSY      DC.W    SCRHEIGH/2
00003998                          3285  
00003998                          3286  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
00003998                          3287  
00003998= 0000                    3288  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
0000399A                          3289  
0000399A                          3290  ; --- MAP RELATED VARIABLES ----------------------------------------------------
0000399A                          3291  
0000399A= 0000                    3292  BPOSX1  DC.W    0
0000399C= 0000                    3293  BPOSY1  DC.W    0
0000399E= 0020                    3294  BPOSX2  DC.W    32
000039A0= 0020                    3295  BPOSY2  DC.W    32
000039A2= 0000                    3296  LOADEDMAP   DC.W    0
000039A4                          3297  
000039A4                          3298  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
000039A4                          3299  
000039A4= 00                      3300  MUSICPLAYED DC.B    0
000039A6                          3301              DS.W    0
000039A6                          3302  
000039A6                          3303  ; --- FPS RELATED VARIABLES ----------------------------------------------------
000039A6                          3304  
000039A6                          3305  REALFPS     DS.W    1
000039A8= 47 4F 41 4C 3A 20 00    3306  STRFPS1     DC.B    'GOAL: ',0   ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
000039AF= 46 50 53 20 2D 20 ...   3307  STRFPS2     DC.B    'FPS - ACTUAL: ',0
000039BE= 46 50 53 00             3308  STRFPS3     DC.B    'FPS',0
000039C2                          3309  
000039C2                          3310  ; --- STATE RELATED VARIABLES --------------------------------------------------
000039C2                          3311  
000039C2                          3312  STACUR      DS.W    1                       ; CURRENT STATE
000039C4                          3313  STANEXT     DS.W    1                       ; NEXT STATE
000039C6                          3314  
000039C6                          3315  
000039C6                          3316  
000039C6                          3317  
000039C6                          3318  
000039C6                          3319  -------------------- end include --------------------
000039C6                          3320              INCLUDE "LIB/UTLVARS.X68"
000039C6                          3321  ; =============================================================================
000039C6                          3322  ; UTILITY VARIABLES
000039C6                          3323  ; =============================================================================
000039C6                          3324  
000039C6                          3325  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000039C8                          3326              DS.W    0
000039C8                          3327  -------------------- end include --------------------
000039C8                          3328              INCLUDE "LIB/DMMVARS.X68"
000039C8                          3329  ; =============================================================================
000039C8                          3330  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
000039C8                          3331  ; =============================================================================
000039C8                          3332  
00003A00                          3333              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00003A00                          3334  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00004680                          3335              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00004680                          3336  -------------------- end include --------------------
00004680                          3337  
00004680                          3338              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12BC
AGLADD:END          12D2
AGLKILL             10F4
AGLPLOT             12FA
AGLPLOT:END         131A
AGLPLOT:LOOP        1302
AGLUPD              12D6
AGLUPD:END          12F4
AGLUPD:LOOP         12DE
AUDINIT             3604
AUDPLAY             3638
BLKCOLL             1486
BPOSX1              399A
BPOSX2              399E
BPOSY1              399C
BPOSY2              39A0
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                1682
DBHV                16F6
DDHL                15AC
DDHV                15CC
DF1HL               1820
DF1HV               1800
DF2HL               1892
DF2HV               1840
DGHE                15EC
DGHL                176A
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             3A00
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           18E4
ELEVATORMUSIC       3686
ELEVATORPLOT        272C
ELEVATORUPDATE      294C
ELEVATOR_MUSIC      100F
ENDBLOCK            193C
ENDGINIT            38AA
ENDGPLOT            38C6
ENDGPLOT:NOTPRINT   38FA
ENDGPLOT:TXT1       390E
ENDGPLOT:TXT2       3928
ENDGPLOT:TXT3       3940
ENDGUPD             38AC
ENDGUPD:DONE        38C4
ENDMAP              194E
ESMENU              2960
FIREDSOUND          36E8
FPSTEXTPOS          2D01
FRAMES_PER_SECOND   32
GAMINIT             3794
GAMPLOT             37FC
GAMPLOT:NOPROJ2     380E
GAMUPD              37A2
HEAVENMUSIC         36A4
HEAVENSOUND         1000
HEAVEN_0            1D3E
HEAVEN_1            1E8E
HEAVEN_END          1FC9
HEAVEN_ROOM         2104
HELLMUSIC           36C6
HELLSOUND           1026
HELL_0              223F
HELL_1              237A
HELL_END            24B5
HELL_ROOM           25F0
HLSEL               298E
HVSEL               297C
ISCPLOT             382C
ISCPLOT:DONE        3860
ISCPLOT:HINT        3892
ISCPLOT:TITLE       3866
ISCUPD              3812
ISCUPD:DONE         382A
JMPLIST             1564
KBDDOWN             53
KBDEDGE             398D
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             1260
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              126E
KBDUPD:LOOP         12B2
KBDUPD:PACK         12AE
KBDUPTN             1
KBDVAL              398C
LIMAPA1             2A0E
LIMAPA2             2B0C
LIMAPA3             2D1C
LIMAPA4             2E14
LIMAPA5             2F0C
LIMAPA6             30B4
LIMAPA7             3268
LIMAPA8             3360
LOADEDMAP           39A2
MAP1NODOOR          19BA
MAP1NOLIMIT1        2A4C
MAP1NOLIMIT2        2A78
MAP1NOLIMIT3        2AAA
MAP1NOLIMIT4        2AD6
MAP1NOLIMITEND      2B02
MAP2NODOOR1         1A08
MAP2NODOOR2         1A3E
MAP2NODOOR3         1A7C
MAP2NODOOR4         1ABA
MAP2NOLIMIT1        2B50
MAP2NOLIMIT10       2D12
MAP2NOLIMIT2        2B82
MAP2NOLIMIT3        2BB4
MAP2NOLIMIT4        2BE6
MAP2NOLIMIT5        2C18
MAP2NOLIMIT6        2C4A
MAP2NOLIMIT7        2C7C
MAP2NOLIMIT8        2CAE
MAP2NOLIMIT9        2CE0
MAP3NODOOR          1B08
MAP3NOLIMIT1        2D5A
MAP3NOLIMIT2        2D86
MAP3NOLIMIT3        2DB2
MAP3NOLIMIT4        2DDE
MAP3NOLIMIT5        2E0A
MAP4NODOOR          1B50
MAP4NOLIMIT1        2E52
MAP4NOLIMIT2        2E7E
MAP4NOLIMIT3        2EAA
MAP4NOLIMIT4        2ED6
MAP4NOLIMIT5        2F02
MAP5NODOOR          1B98
MAP5NOLIMIT1        2F4A
MAP5NOLIMIT2        2F76
MAP5NOLIMIT3        2FA2
MAP5NOLIMIT4        2FCE
MAP5NOLIMIT5        2FFA
MAP5NOLIMIT6        3026
MAP5NOLIMIT7        3052
MAP5NOLIMIT8        307E
MAP5NOLIMIT9        30AA
MAP6NODOOR1         1BE6
MAP6NODOOR2         1C1C
MAP6NODOOR3         1C5A
MAP6NODOOR4         1C98
MAP6NOLIMIT1        30F2
MAP6NOLIMIT10       325E
MAP6NOLIMIT2        311E
MAP6NOLIMIT3        314A
MAP6NOLIMIT5        3176
MAP6NOLIMIT6        31A2
MAP6NOLIMIT7        31CE
MAP6NOLIMIT8        3200
MAP6NOLIMIT9        322C
MAP7NODOOR          1CE8
MAP7NOLIMIT1        32A6
MAP7NOLIMIT2        32D2
MAP7NOLIMIT3        32FE
MAP7NOLIMIT4        332A
MAP7NOLIMIT5        3356
MAP8NODOOR1         1D38
MAP8NOLIMIT1        339E
MAP8NOLIMIT2        33CA
MAP8NOLIMIT3        33F6
MAP8NOLIMIT4        3422
MAP8NOLIMIT5        344E
MAPA1               1978
MAPA2               19C0
MAPA3               1AC0
MAPA4               1B0E
MAPA5               1B56
MAPA6               1B9E
MAPA7               1C9E
MAPA8               1CEE
MAPPLOT             1486
MAPSEL              149E
MAPUPD              150A
MOVEHOR             34B6
MOVEHOR:NORIGHTEDGE  34DA
MOVEHOR:NOTLEFTEDGE  34C6
MOVEVER             34DC
MOVEVER:NOLOWEREDGE  3500
MOVEVER:NOTUPPEREDGE  34EC
MSCSEL              3650
MUSICPLAYED         39A4
NEWLINE             1918
NEXT                1556
NOLIMIT             3458
NOLIMIT:DOWN        349C
NOLIMIT:NOTMOVED    34B2
NOLIMIT:RIGHT       3486
NOLIMIT:UP          3470
NOLIMITMENU         29F6
NOMUSIC             37B8
NOMUSIC:NOPROJ1     37F6
NOMUSIC:NOTFIRED    37E8
NPROJ               3998
PLAYERHEALTH        3992
PLAYERHEIGHT        20
PLAYERINIT          29A0
PLAYERPLOT          3502
PLAYERPOSX          3994
PLAYERPOSY          3996
PLAYERSPEED         4
PLAYERUPD           29A2
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            354A
PROJINIT:FDOWN      3582
PROJINIT:FRIGHT     3570
PROJINIT:FUP        3560
PROJINIT:NOTFDOWN   3590
PROJINIT:SHOOT      359A
PROJPLOT            35C2
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             35AE
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             39A6
SCRCYCCT            398F
SCRHEIGH            1E0
SCRINIT             1142
SCRINTCT            398E
SCRINTFPS           3990
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             1198
SCRTIM              1240
SCRTIM1S            124E
SCRUPTN             0
SCRWIDTH            280
STACUR              39C2
STAEMPTY            3792
STAINIT             3704
STANEXT             39C4
STANONE             FFFFFFFF
STAPLOT             376A
STAPLOT:PLTTBL      3786
START               395A
START:LOOP          3966
START:WINT          396C
STAUPD              3714
STAUPD:DOUPD        373A
STAUPD:INITBL       3752
STAUPD:UPDTBL       375E
STRFPS1             39A8
STRFPS2             39AF
STRFPS3             39BE
SYSINIT             110A
TRIANGLE            28F4
TRIANGLE:ISPOSITIVE  2942
TRIANGLE:UPWARDS    2910
UTLCHRWD            8
UTLINIT             1320
UTLPRINT            1336
UTLPRINT:ENDLOOP    1348
UTLPRINT:LOOP       133E
UTLRAND             1368
UTLRAND:RANDVEC     1386
UTLRNDIX            39C6
