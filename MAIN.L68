00002FD4 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 15/01/2023 23:58:50

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002D01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/14)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000                            37  ;no lo usas SNDPLTN     EQU     3                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000                            45  
00001000  =00000004                 46  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 47  PLAYERWIDTH     EQU     32
00001000  =00000020                 48  PLAYERHEIGHT    EQU     32
00001000                            49  
00001000                            50  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            51  
00001000  =00000010                 52  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 53  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 54  PROJSPEEDX      EQU     8
00001000  =00000008                 55  PROJSPEEDY      EQU     8
00001000                            56  
00001000                            57  ; --- MUSIC RELATED CONSTANTS --------------------------------------------------
00001000                            58  
00001000= 53 4E 44 2F 4D 55 ...     59  HEAVENSOUND     DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     60  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     61  HELLSOUND       DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     62  PROJ_SOUND      DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            63  
00001048                            64  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001048                            65  
00001048  =FFFFFFFF                 66  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001048                            67  
00001048                            68  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001048                            69  
00001048  =00000014                 70  BLOCKSROW   EQU     20                      ; BLOCKS PER ROW
00001048  =0000000F                 71  BLOCKSCOL   EQU     15                      ; BLOCKS PER COLUMN
00001048  =00000020                 72  BLOCKSIZE   EQU     32                      ; BLOCK SIZE IN PIXELS
00001048                            73  
00001048                            74  ; --- ELEVATOR RELATED CONSTANTS -----------------------------------------------
00001048                            75  
00001048  =000000CC                 76  COLBUTHL    EQU     $000000CC
00001048  =00EEEEEE                 77  COLBUTHV    EQU     $00EEEEEE
00001048                            78  
00001048                            79  ; --- INTRO RELATED CONSTANTS --------------------------------------------------
00001048                            80  
00001048  =000000D5                 81  BTONPOSX    EQU     SCRWIDTH/3
00001048  =00000170                 82  BTONPOSY    EQU     SCRHEIGH-112
00001048  =000000DA                 83  BTONWIDTH   EQU     218
00001048  =00000020                 84  BTONHEIGHT  EQU     32
00001048                            85  
00001048                            86  
00001048                            87  
00001048                            88  
00001048                            89  
00001048                            90  
00001048                            91  
00001048                            92  
00001048                            93  
00001048                            94  
00001048                            95  
00001048                            96  -------------------- end include --------------------
00001048                            97              INCLUDE "LIB/DMMCONST.X68"
00001048                            98  ; =============================================================================
00001048                            99  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                           100  ; =============================================================================
00001048                           101  
00001048  =00000040                102  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                103  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                104  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                105  -------------------- end include --------------------
00001048                           106              INCLUDE "LIB/UTLCONST.X68"         
00001048                           107  ; ==============================================================================
00001048                           108  ; UTIL CONSTANTS
00001048                           109  ; ==============================================================================
00001048                           110  
00001048  =00000008                111  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001048  =00000008                112  -------------------- end include --------------------
00001048                           113              INCLUDE "LIB/DMMCODE.X68"
00001048                           114  ; =============================================================================
00001048                           115  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                           116  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                           117  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                           118  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                           119  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                           120  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                           121  ; =============================================================================
00001048                           122  
00001048                           123  ; -----------------------------------------------------------------------------
00001048                           124  DMMINIT
00001048                           125  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                           126  ; INPUT    - NONE
00001048                           127  ; OUTPUT   - NONE
00001048                           128  ; MODIFIES - NONE
00001048                           129  ; -----------------------------------------------------------------------------
00001048  48E7 8080                130              MOVEM.L D0/A0,-(A7)
0000104C  41F9 000030C0            131              LEA     DMMDATA,A0
00001052  303C 0031                132              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                133  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            134              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                135              DBRA.W  D0,.LOOP
00001064  4CDF 0101                136              MOVEM.L (A7)+,D0/A0
00001068  4E75                     137              RTS
0000106A                           138  
0000106A                           139  ; -----------------------------------------------------------------------------
0000106A                           140  DMMFIRST
0000106A                           141  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           142  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           143  ; INPUT    - NONE
0000106A                           144  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           145  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           146  ; -----------------------------------------------------------------------------
0000106A  41F9 000030C0            147              LEA     DMMDATA,A0
00001070  4A58                     148  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                149              BNE     DMMFRFND
00001076  D1FC 0000003E            150              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 00003D3F            151  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     152              BLT     DMMFRLOP
00001084  207C 00000000            153              MOVE.L  #0,A0
0000108A  4E75                     154  DMMFRFND    RTS
0000108C                           155  
0000108C                           156  ; -----------------------------------------------------------------------------
0000108C                           157  DMMNEXT
0000108C                           158  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           159  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           160  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           161  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           162  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           163  ; -----------------------------------------------------------------------------
0000108C  2F00                     164              MOVE.L  D0,-(A7)
0000108E  2008                     165              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            166              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            167              ADD.L   #DMMBSIZE,D0
0000109C  2040                     168              MOVE.L  D0,A0
0000109E  201F                     169              MOVE.L  (A7)+,D0
000010A0  60DA                     170              BRA     DMMFRCOM
000010A2                           171  
000010A2                           172  ; -----------------------------------------------------------------------------
000010A2                           173  DMMFRSTO
000010A2                           174  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           175  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           176  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           177  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           178  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           179  ; -----------------------------------------------------------------------------
000010A2  41F9 000030C0            180              LEA     DMMDATA,A0
000010A8  B058                     181  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                182              BEQ     DMMFFND
000010AE  D1FC 0000003E            183              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 00003D3F            184  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     185              BLT     DMMFLOOP
000010BC  207C 00000000            186              MOVE.L  #0,A0
000010C2  4E75                     187  DMMFFND     RTS
000010C4                           188  
000010C4                           189  ; -----------------------------------------------------------------------------
000010C4                           190  DMMNEXTO
000010C4                           191  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           192  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           193  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           194  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           195  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           196  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           197  ; -----------------------------------------------------------------------------
000010C4  2F00                     198              MOVE.L  D0,-(A7)
000010C6  2008                     199              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            200              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            201              ADD.L   #DMMBSIZE,D0
000010D4  2040                     202              MOVE.L  D0,A0
000010D6  201F                     203              MOVE.L  (A7)+,D0
000010D8  60DA                     204              BRA     DMMFCOM
000010DA                           205  
000010DA                           206  ; -----------------------------------------------------------------------------
000010DA                           207  DMMALLOC
000010DA                           208  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           209  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           210  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           211  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           212  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           213  ; -----------------------------------------------------------------------------
000010DA  3F00                     214              MOVE.W  D0,-(A7)
000010DC  4240                     215              CLR.W   D0
000010DE  4EB8 10A2                216              JSR     DMMFRSTO
000010E2  301F                     217              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            218              CMP.L   #0,A0
000010EA  6700 0006                219              BEQ     .END
000010EE  3140 FFFE                220              MOVE.W  D0,-2(A0)
000010F2  4E75                     221  .END        RTS
000010F4                           222  
000010F4                           223  ; -----------------------------------------------------------------------------
000010F4                           224  DMMFREE
000010F4                           225  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           226  ; SYSTEM (0)
000010F4                           227  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           228  ; OUTPUT   - NONE
000010F4                           229  ; MODIFIES - NONE
000010F4                           230  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                231              MOVEM.L D0/A0,-(A7)
000010F8  2008                     232              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            233              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     234              MOVE.L  D0,A0
00001102  4250                     235              CLR.W   (A0)
00001104  4CDF 0101                236              MOVEM.L (A7)+,D0/A0
00001108  4E75                     237              RTS
00001108  4E75                     238  -------------------- end include --------------------
0000110A                           239              INCLUDE "SYSTEM.X68"
0000110A                           240  ; ==============================================================================
0000110A                           241  ; SYSTEM
0000110A                           242  ; ==============================================================================
0000110A                           243              
0000110A                           244  ; ------------------------------------------------------------------------------
0000110A                           245  SYSINIT
0000110A                           246  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           247  ; INPUT    : NONE
0000110A                           248  ; OUTPUT   : NONE
0000110A                           249  ; MODIFIES : NONE
0000110A                           250  ; ------------------------------------------------------------------------------
0000110A                           251  
0000110A  21FC 00001198 0080       252              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000126E 0084       253              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 00001240 0064       254              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001122  21FC 0000124E 0068       255              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
0000112A                           256              
0000112A  4EB8 1048                257              JSR     DMMINIT
0000112E  4EB9 00001142            258              JSR     SCRINIT
00001134  4EB9 00001260            259              JSR     KBDINIT 
0000113A                           260              
0000113A  40E7                     261              MOVE.W  SR,-(A7)
0000113C  0257 D8FF                262              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
00001140  4E73                     263              RTE
00001142                           264              
00001142                           265  ; ------------------------------------------------------------------------------
00001142                           266  SCRINIT
00001142                           267  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001142                           268  ; ENABLE DOUBLE BUFFER.
00001142                           269  ; INPUT    : NONE
00001142                           270  ; OUTPUT   : NONE
00001142                           271  ; MODIFIES : NONE
00001142                           272  ; ------------------------------------------------------------------------------
00001142                           273  
00001142  48E7 F000                274              MOVEM.L D0-D3,-(A7)
00001146                           275  
00001146                           276              ; SET SCREEN RESOLUTION
00001146  103C 0021                277              MOVE.B  #33,D0
0000114A  223C 028001E0            278              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001150  4E4F                     279              TRAP    #15
00001152                           280              
00001152                           281              ; SET WINDOWED MODE
00001152  7201                     282              MOVE.L  #1,D1
00001154  4E4F                     283              TRAP    #15
00001156                           284              
00001156                           285              ; CLEAR SCREEN
00001156  103C 000B                286              MOVE.B  #11,D0
0000115A  323C FF00                287              MOVE.W  #$FF00,D1
0000115E  4E4F                     288              TRAP    #15
00001160                           289  
00001160                           290              ; ENABLE DOUBLE BUFFER
00001160  103C 005C                291              MOVE.B  #92,D0
00001164  123C 0011                292              MOVE.B  #17,D1
00001168  4E4F                     293              TRAP    #15
0000116A                           294              
0000116A                           295              ; ENABLE BOTH TIMED INTERRUPT
0000116A  103C 0020                296              MOVE.B  #32,D0
0000116E  123C 0006                297              MOVE.B  #6,D1
00001172  143C 0081                298              MOVE.B  #$80|SCRINTN,D2
00001176  7614                     299              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001178  4E4F                     300              TRAP    #15
0000117A  143C 0082                301              MOVE.B  #$80|SCRINTFPSN,D2
0000117E  263C 000003E8            302              MOVE.L  #1000,D3
00001184  4E4F                     303              TRAP    #15
00001186                           304              
00001186                           305              ; CLEAR INTERRUPT COUNTER
00001186  4279 00003008            306              CLR.W   (SCRINTCT)
0000118C  4239 0000300A            307              CLR.B   (SCRINTFPS) 
00001192                           308              
00001192  4CDF 000F                309              MOVEM.L (A7)+,D0-D3
00001196                           310              
00001196  4E75                     311              RTS
00001198                           312  
00001198                           313  ; ------------------------------------------------------------------------------
00001198                           314  SCRPLOT
00001198                           315  ; UPDATES DOUBLE BUFFER
00001198                           316  ; INPUT    : NONE
00001198                           317  ; OUTPUT   : NONE
00001198                           318  ; MODIFIES : NONE
00001198                           319  ; ------------------------------------------------------------------------------
00001198  48E7 E000                320              MOVEM.L D0-D2,-(A7)
0000119C  2F09                     321              MOVE.L  A1,-(A7)
0000119E                           322              
0000119E                           323              ; PLOT ACTUAL FPS AND GOAL FPS
0000119E                           324              
0000119E  103C 0051                325              MOVE.B  #81,D0
000011A2  7200                     326              MOVE.L  #$00000000,D1 ; FILL COLOR
000011A4  4E4F                     327              TRAP    #15
000011A6                           328              
000011A6  103C 0050                329              MOVE.B  #80,D0
000011AA  223C 00FFFFFF            330              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011B0  4E4F                     331              TRAP    #15
000011B2                           332              
000011B2  103C 000B                333              MOVE.B  #11,D0
000011B6  223C 00002D01            334              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011BC  4E4F                     335              TRAP    #15
000011BE                           336              
000011BE  43F9 0000306A            337              LEA.L   STRFPS1,A1 
000011C4  103C 000E                338              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011C8  4E4F                     339              TRAP    #15
000011CA                           340              
000011CA  103C 000B                341              MOVE.B  #11,D0
000011CE  323C 3601                342              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011D2  4E4F                     343              TRAP    #15
000011D4                           344              
000011D4  5E89                     345              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011D6  103C 000E                346              MOVE.B  #14,D0  
000011DA  4E4F                     347              TRAP    #15 
000011DC                           348              
000011DC  103C 000B                349              MOVE.B  #11,D0
000011E0  323C 4701                350              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E4  4E4F                     351              TRAP    #15
000011E6                           352              
000011E6  D3FC 0000000F            353              ADDA.L  #15,A1 ; PLOT 'FPS'
000011EC  103C 000E                354              MOVE.B  #14,D0 
000011F0  4E4F                     355              TRAP    #15
000011F2                           356              
000011F2  0643 0014                357              ADD.W   #20,D3
000011F6  103C 000B                358              MOVE.B  #11,D0
000011FA  323C 3301                359              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
000011FE  4E4F                     360              TRAP    #15
00001200                           361              
00001200  7232                     362              MOVE.L  #FRAMES_PER_SECOND,D1
00001202  740A                     363              MOVE.L  #10,D2
00001204  103C 000F                364              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001208  4E4F                     365              TRAP    #15
0000120A                           366              
0000120A  0643 0014                367              ADD.W   #20,D3
0000120E  103C 000B                368              MOVE.B  #11,D0
00001212  323C 4401                369              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001216  4E4F                     370              TRAP    #15
00001218                           371              
00001218  4281                     372              CLR.L   D1
0000121A  1239 00003068            373              MOVE.B  (REALFPS),D1
00001220  740A                     374              MOVE.L  #10,D2
00001222  103C 000F                375              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001226  4E4F                     376              TRAP    #15
00001228                           377              
00001228                           378              ; SWITCH BUFFERS
00001228  103C 005E                379              MOVE.B  #94,D0
0000122C  4E4F                     380              TRAP    #15
0000122E                           381              
0000122E                           382              ; CLEAR HIDDEN BUFFER
0000122E  103C 000B                383              MOVE.B  #11,D0
00001232  323C FF00                384              MOVE.W  #$FF00,D1
00001236  4E4F                     385              TRAP    #15
00001238                           386              
00001238  225F                     387              MOVE.L  (A7)+,A1
0000123A  4CDF 0007                388              MOVEM.L (A7)+,D0-D2
0000123E  4E73                     389              RTE
00001240                           390              
00001240                           391  ; ------------------------------------------------------------------------------
00001240                           392  SCRTIM
00001240                           393  ; TIMED INTERRUPT SERVICE ROUTINE
00001240                           394  ; INPUT    : NONE
00001240                           395  ; OUTPUT   : NONE
00001240                           396  ; MODIFIES : NONE
00001240                           397  ; ------------------------------------------------------------------------------
00001240  5239 00003008            398              ADDQ.B  #1,(SCRINTCT)
00001246  5239 00003009            399              ADDQ.B  #1,(SCRCYCCT)
0000124C  4E73                     400              RTE
0000124E                           401              
0000124E                           402  ; ------------------------------------------------------------------------------
0000124E                           403  SCRTIM1S
0000124E                           404  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000124E                           405  ; INPUT    : NONE
0000124E                           406  ; OUTPUT   : NONE
0000124E                           407  ; MODIFIES : NONE
0000124E                           408  ; ------------------------------------------------------------------------------
0000124E  13F9 0000300A 00003068   409              MOVE.B  (SCRINTFPS),REALFPS
00001258  4239 0000300A            410              CLR.B   SCRINTFPS
0000125E  4E73                     411              RTE
00001260                           412  
00001260                           413  ; ------------------------------------------------------------------------------
00001260                           414  KBDINIT
00001260                           415  ; INIT KEYBOARD
00001260                           416  ; INPUT    : NONE
00001260                           417  ; OUTPUT   : NONE
00001260                           418  ; MODIFIES : NONE
00001260                           419  ; ------------------------------------------------------------------------------
00001260  4239 00003006            420              CLR.B   (KBDVAL)
00001266  4239 00003007            421              CLR.B   (KBDEDGE)
0000126C  4E75                     422              RTS
0000126E                           423  
0000126E                           424  ; ------------------------------------------------------------------------------
0000126E                           425  KBDUPD
0000126E                           426  ; UPDATE KEYBOARD INFO.  
0000126E                           427  ; 7 -> FIRE DOWN
0000126E                           428  ; 6 -> FIRE RIGHT
0000126E                           429  ; 5 -> FIRE UP
0000126E                           430  ; 4 -> FIRE LEFT
0000126E                           431  ; 3 -> DOWN
0000126E                           432  ; 2 -> RIGHT
0000126E                           433  ; 1 -> UP
0000126E                           434  ; 0 -> LEFT
0000126E                           435  ; INPUT    : NONE
0000126E                           436  ; OUTPUT   : NONE
0000126E                           437  ; MODIFIES : NONE
0000126E                           438  ; ------------------------------------------------------------------------------
0000126E                           439  
0000126E  48E7 F000                440              MOVEM.L D0-D3,-(A7)
00001272                           441  
00001272                           442              ; READ FIRST PART
00001272  103C 0013                443              MOVE.B  #19,D0
00001276  223C 28272625            444              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000127C  4E4F                     445              TRAP    #15
0000127E                           446              
0000127E                           447              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000127E  4EB9 000012AE            448              JSR     .PACK
00001284                           449  
00001284                           450              ; READ SECOND PART
00001284  223C 53445741            451              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000128A  4E4F                     452              TRAP    #15
0000128C                           453  
0000128C                           454              ; CONVERT TO DESIRED FORMAT
0000128C  4EB9 000012AE            455              JSR     .PACK
00001292                           456              
00001292                           457              ; COMPUTE KBDEDGE
00001292  1039 00003006            458              MOVE.B  (KBDVAL),D0
00001298  4600                     459              NOT.B   D0
0000129A  C002                     460              AND.B   D2,D0
0000129C  13C0 00003007            461              MOVE.B  D0,(KBDEDGE)
000012A2                           462              
000012A2                           463              ; STORE KBDVAL
000012A2  13C2 00003006            464              MOVE.B  D2,(KBDVAL)
000012A8                           465              
000012A8  4CDF 000F                466              MOVEM.L (A7)+,D0-D3
000012AC                           467  
000012AC  4E73                     468              RTE
000012AE                           469              
000012AE  363C 0003                470  .PACK       MOVE.W  #3,D3
000012B2  E189                     471  .LOOP       LSL.L   #8,D1
000012B4  E312                     472              ROXL.B  #1,D2
000012B6  51CB FFFA                473              DBRA.W  D3,.LOOP
000012BA  4E75                     474              RTS
000012BC                           475  
000012BC                           476  
000012BC                           477  
000012BC                           478  -------------------- end include --------------------
000012BC                           479              INCLUDE "LIB/AGLCODE.X68"
000012BC                           480  ; =============================================================================
000012BC                           481  ; AGENT MANAGEMENT
000012BC                           482  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012BC                           483  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012BC                           484  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012BC                           485  ; +8:END    : DATA (AGENT SPECIFIC)
000012BC                           486  ; =============================================================================
000012BC                           487  
000012BC                           488  ; -----------------------------------------------------------------------------
000012BC                           489  AGLADD
000012BC                           490  ; CREATES A NEW AGENT
000012BC                           491  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012BC                           492  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012BC                           493  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012BC                           494  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012BC                           495  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012BC                           496  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012BC                           497  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012BC                           498  ; OUTPUT   - NONE
000012BC                           499  ; MODIFIES - NONE
000012BC                           500  ; -----------------------------------------------------------------------------
000012BC  2F08                     501              MOVE.L  A0,-(A7)
000012BE  4EB8 10DA                502              JSR     DMMALLOC
000012C2  B1FC 00000000            503              CMP.L   #0,A0
000012C8  6700 0008                504              BEQ     .END
000012CC  20CA                     505              MOVE.L  A2,(A0)+
000012CE  20CB                     506              MOVE.L  A3,(A0)+
000012D0  4E91                     507              JSR     (A1)
000012D2  205F                     508  .END        MOVE.L  (A7)+,A0
000012D4  4E75                     509              RTS
000012D6                           510  
000012D6                           511  ; -----------------------------------------------------------------------------
000012D6                           512  AGLUPD
000012D6                           513  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012D6                           514  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012D6                           515  ; INPUT    - NONE
000012D6                           516  ; OUTPUT   - NONE
000012D6                           517  ; MODIFIES - NONE
000012D6                           518  ; -----------------------------------------------------------------------------
000012D6  48E7 00C0                519              MOVEM.L A0-A1,-(A7)
000012DA  4EB8 106A                520              JSR     DMMFIRST
000012DE  B1FC 00000000            521  .LOOP       CMP.L   #0,A0
000012E4  6700 000E                522              BEQ     .END
000012E8  2250                     523              MOVE.L  (A0),A1
000012EA  5088                     524              ADD.L   #8,A0
000012EC  4E91                     525              JSR     (A1)
000012EE  4EB8 108C                526              JSR     DMMNEXT
000012F2  60EA                     527              BRA     .LOOP
000012F4  4CDF 0300                528  .END        MOVEM.L (A7)+,A0-A1
000012F8  4E75                     529              RTS
000012FA                           530  
000012FA                           531  ; -----------------------------------------------------------------------------
000012FA                           532  AGLPLOT
000012FA                           533  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012FA                           534  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012FA                           535  ; INPUT    - NONE
000012FA                           536  ; OUTPUT   - NONE
000012FA                           537  ; MODIFIES - NONE
000012FA                           538  ; -----------------------------------------------------------------------------
000012FA  48E7 00C0                539              MOVEM.L A0-A1,-(A7)
000012FE  4EB8 106A                540              JSR     DMMFIRST
00001302  B1FC 00000000            541  .LOOP       CMP.L   #0,A0
00001308  6700 0010                542              BEQ     .END
0000130C  2268 0004                543              MOVE.L  4(A0),A1
00001310  5088                     544              ADD.L   #8,A0
00001312  4E91                     545              JSR     (A1)
00001314  4EB8 108C                546              JSR     DMMNEXT
00001318  60E8                     547              BRA     .LOOP
0000131A  4CDF 0300                548  .END        MOVEM.L (A7)+,A0-A1
0000131E  4E75                     549              RTS
00001320                           550  
00001320                           551  ; -----------------------------------------------------------------------------
00001320  =000010F4                552  AGLKILL     EQU     DMMFREE
00001320                           553  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001320                           554  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001320                           555  ; OUTPUT   - NONE
00001320                           556  ; MODIFIES - NONE
00001320                           557  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001320                           558  ; -----------------------------------------------------------------------------
00001320                           559  -------------------- end include --------------------
00001320                           560              INCLUDE "LIB/UTLCODE.X68"
00001320                           561  ; =============================================================================
00001320                           562  ; UTILITY CODE
00001320                           563  ; =============================================================================
00001320                           564  
00001320                           565  ; -----------------------------------------------------------------------------
00001320                           566  UTLINIT
00001320                           567  ; INITIALIZES UTILITY CODE
00001320                           568  ; INPUT    - NONE
00001320                           569  ; OUTPUT   - NONE
00001320                           570  ; MODIFIES - NONE
00001320                           571  ; -----------------------------------------------------------------------------
00001320  48E7 C000                572              MOVEM.L D0-D1,-(A7)
00001324  103C 0008                573              MOVE.B  #8,D0
00001328  4E4F                     574              TRAP    #15
0000132A  13C1 00003088            575              MOVE.B  D1,(UTLRNDIX)
00001330  4CDF 0003                576              MOVEM.L (A7)+,D0-D1
00001334  4E75                     577              RTS
00001336                           578  
00001336                           579  ; -----------------------------------------------------------------------------
00001336                           580  UTLPRINT
00001336                           581  ; PRINT SCREEN CENTERED TEXT
00001336                           582  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001336                           583  ;            D0.B SCREEN ROW TO PRINT TEXT
00001336                           584  ; OUTPUT   : D0.B NEXT ROW
00001336                           585  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001336                           586  ; -----------------------------------------------------------------------------
00001336  48E7 C0C0                587              MOVEM.L D0-D1/A0-A1,-(A7)
0000133A  4201                     588              CLR.B   D1
0000133C  2248                     589              MOVE.L  A0,A1
0000133E  4A18                     590  .LOOP       TST.B   (A0)+
00001340  6700 0006                591              BEQ     .ENDLOOP
00001344  5201                     592              ADDQ.B  #1,D1
00001346  60F6                     593              BRA     .LOOP
00001348  E209                     594  .ENDLOOP    LSR.B   #1,D1
0000134A  0401 0028                595              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000134E  4401                     596              NEG.B   D1
00001350  E141                     597              ASL.W   #8,D1
00001352  8240                     598              OR.W    D0,D1
00001354  103C 000B                599              MOVE.B  #11,D0
00001358  4E4F                     600              TRAP    #15
0000135A  103C 000D                601              MOVE.B  #13,D0
0000135E  4E4F                     602              TRAP    #15
00001360  4CDF 0303                603              MOVEM.L (A7)+,D0-D1/A0-A1
00001364  5200                     604              ADDQ.B  #1,D0
00001366  4E75                     605              RTS
00001368                           606  
00001368                           607  ; -----------------------------------------------------------------------------
00001368                           608  UTLRAND
00001368                           609  ; PROVIDES A PSEUDO-RANDOM BYTE
00001368                           610  ; INPUT    - NONE
00001368                           611  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001368                           612  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001368                           613  ; -----------------------------------------------------------------------------
00001368  2F08                     614              MOVE.L  A0,-(A7)
0000136A  41F9 00001386            615              LEA     .RANDVEC,A0
00001370  4280                     616              CLR.L   D0
00001372  1039 00003088            617              MOVE.B  (UTLRNDIX),D0
00001378  1030 0800                618              MOVE.B  (A0,D0.L),D0
0000137C  5239 00003088            619              ADDQ.B  #1,(UTLRNDIX)
00001382  205F                     620              MOVE.L  (A7)+,A0
00001384  4E75                     621              RTS
00001386                           622  
00001386                           623  
00001386= A2 EE 9A 0C F5 24 ...    624  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000138E= 2A A3 51 26 E0 AC ...    625              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001396= 75 51 CA FD 33 EB ...    626              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000139E= 60 CC E7 B8 9A EB ...    627              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013A6= 1D 76 B5 95 B0 89 ...    628              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013AE= 39 15 48 C9 6E CA ...    629              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013B6= 43 E7 E2 7C 37 25 ...    630              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013BE= E9 94 CE E9 E4 52 ...    631              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013C6= 37 6D 9A 84 A2 28 ...    632              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013CE= 19 E2 C6 77 80 D4 ...    633              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013D6= 0A 5A 32 67 33 C2 ...    634              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013DE= 59 80 DC 0E 57 FC ...    635              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013E6= 8A AB BC F7 07 4D ...    636              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013EE= EF D5 77 6E 1E BB ...    637              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013F6= D6 E0 2A 8F BD 28 ...    638              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013FE= 13 4F 66 EC 0A 64 ...    639              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001406= 56 52 9A 16 9B 90 ...    640              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000140E= 06 8A A4 F7 01 DA ...    641              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001416= F2 E7 77 28 B1 76 ...    642              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000141E= A4 42 E3 81 B1 67 ...    643              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001426= BF CE FA 16 BF 38 ...    644              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000142E= D1 8B 50 0C 5F 49 ...    645              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001436= DE 4C 14 A2 40 DC ...    646              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000143E= B6 9B 0A 38 5D AB ...    647              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001446= E2 1B DD 75 15 82 ...    648              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000144E= 8A 26 51 30 9F 47 ...    649              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001456= 1E 8A BB 71 C6 6E ...    650              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000145E= 9F 47 E5 34 94 27 ...    651              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001466= 7D 06 D6 BA 30 0F ...    652              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000146E= EC 7F 7E 03 CF 2D ...    653              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001476= 94 5B 23 F2 8B CD ...    654              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000147E= 74 33 EC B9 0F D5 ...    655              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001486                           656  
00001486                           657  -------------------- end include --------------------
00001486                           658              INCLUDE "BLOCKS.X68"
00001486                           659  
00001486                           660  ; -----------------------------------------------------------------------------
00001486                           661  ISBLWHICHCOLL 
00001486                           662  ; CHECKS IF THE BLOCK IN D4 PRODUCES COLLISIONS
00001486                           663  ; INPUT    - D4.B
00001486                           664  ; OUTPUT   - ALL 1'S IF D4.L PRODUCES COLLISIONS, ALL 0'S IF NOT
00001486                           665  ; MODIFIES - D4.L, A0
00001486                           666  ; -----------------------------------------------------------------------------
00001486  41F9 0000301C            667              LEA.L   BLWHICHCOLL, A0
0000148C  4A10                     668  .BNEXTCHCK  TST.B   (A0)
0000148E  6712                     669              BEQ.B   .BNOCOLL
00001490  B810                     670              CMP.B   (A0),D4
00001492  6704                     671              BEQ.B   .BCOLL
00001494  5288                     672              ADDA.L  #1,A0
00001496  60F4                     673              BRA     .BNEXTCHCK
00001498  0084 FFFFFFFF            674  .BCOLL      ORI.L   #$FFFFFFFF, D4
0000149E  6000 0004                675              BRA     .BEND
000014A2  4284                     676  .BNOCOLL    CLR.L   D4
000014A4                           677  .BEND
000014A4  4E75                     678              RTS
000014A6                           679  
000014A6                           680  ; -----------------------------------------------------------------------------
000014A6                           681  BLKCOLL 
000014A6                           682  ; DETECTS BLOCK COLLISIONS
000014A6                           683  ; INPUT    - D0 TOP LEFT CORNER OF OBJECT, D1 BOTTOM RIGHT, WHERE UPPER WORD
000014A6                           684  ;            IS THE X COORDINATE AND LOWER WORD Y COORDINATE
000014A6                           685  ; OUTPUT   - ALL 1'S IN THE THE REGISTER THAT COLLIDES WITH A BLOCK
000014A6                           686  ;            THAT CANNOT BE TRAVERSED. THESE ARE D0 FOR LEFT UPPER BLOCK,
000014A6                           687  ;            D1 FOR RIGHT UPPER BLOCK, D2 FOR LEFT LOWER BLOCK AND D3 FOR 
000014A6                           688  ;            RIGHT LOWER BLOCK
000014A6                           689  ; MODIFIES - D0.L, D1.L, D2.L, D3.L
000014A6                           690  ; -----------------------------------------------------------------------------
000014A6  48E7 0E80                691              MOVEM.L D4-D6/A0,-(A7)
000014AA                           692              
000014AA  7810                     693              MOVE.L  #16,D4
000014AC  3400                     694              MOVE.W  D0,D2   ; D2 CONTAINS X LEFT
000014AE  E8A8                     695              LSR.L   D4,D0   ; D0 CONTAINS Y UPPER
000014B0  3601                     696              MOVE.W  D1,D3   ; D3 CONTAINS X RIGHT
000014B2  E8A9                     697              LSR.L   D4,D1   ; D1 CONTAINS Y LOWER
000014B4                           698              
000014B4  48C0                     699              EXT.L   D0
000014B6  48C1                     700              EXT.L   D1
000014B8  48C2                     701              EXT.L   D2
000014BA  48C3                     702              EXT.L   D3
000014BC                           703              
000014BC  80FC 0020                704              DIVU.W  #BLOCKSIZE,D0   ; LEFT BLOCK
000014C0  82FC 0020                705              DIVU.W  #BLOCKSIZE,D1   ; RIGHT BLOCK
000014C4  84FC 0020                706              DIVU.W  #BLOCKSIZE,D2   ; UPPER BLOCK
000014C8  86FC 0020                707              DIVU.W  #BLOCKSIZE,D3   ; LOWER BLOCK
000014CC                           708              
000014CC  48C0                     709              EXT.L   D0
000014CE  48C1                     710              EXT.L   D1
000014D0  48C2                     711              EXT.L   D2
000014D2  48C3                     712              EXT.L   D3
000014D4                           713              
000014D4  7815                     714              MOVE.L  #BLOCKSROW+1,D4 ; +1 BECAUSE OF NULL
000014D6  C8C2                     715              MULU.W  D2,D4           ; INDEX OF COLUMN OF UPPER LEFT AND RIGHT BLOCKS
000014D8  7A15                     716              MOVE.L  #BLOCKSROW+1,D5 ; +1 BECAUSE OF NULL
000014DA  CAC3                     717              MULU.W  D3,D5           ; INDEX OF COLUMN OF LOWER LEFT AND RIGHT BLOCKS
000014DC                           718              
000014DC  3C39 00003020            719              MOVE.W  (LOADEDMAP),D6
000014E2  48C6                     720              EXT.L   D6
000014E4  CCFC 0004                721              MULU    #4,D6
000014E8  41F9 00003042            722              LEA.L   MAPLIST,A0
000014EE  D1C6                     723              ADDA.L  D6,A0
000014F0  2050                     724              MOVEA.L (A0),A0         ; CURRENT MAP ADDRESS
000014F2                           725              
000014F2  2248                     726              MOVEA.L A0,A1
000014F4  D3C5                     727              ADDA.L  D5,A1   
000014F6  D3C1                     728              ADDA.L  D1,A1           ; RIGHT LOWER BLOCK
000014F8  1611                     729              MOVE.B  (A1),D3         ; STORING BOTTOM RIGHT BLOCK IN D3
000014FA                           730              
000014FA  2248                     731              MOVEA.L A0,A1
000014FC  D3C5                     732              ADDA.L  D5,A1   
000014FE  D3C0                     733              ADDA.L  D0,A1           ; LEFT LOWER BLOCK
00001500  1411                     734              MOVE.B  (A1),D2         ; STORING BOTTOM LEFT BLOCK IN D2
00001502                           735              
00001502  2248                     736              MOVEA.L A0,A1
00001504  D3C4                     737              ADDA.L  D4,A1   
00001506  D3C1                     738              ADDA.L  D1,A1           ; RIGHT UPPER BLOCK
00001508  1211                     739              MOVE.B  (A1),D1         ; STORING TOP RIGHT BLOCK IN D1
0000150A                           740              
0000150A  2248                     741              MOVEA.L A0,A1
0000150C  D3C4                     742              ADDA.L  D4,A1   
0000150E  D3C0                     743              ADDA.L  D0,A1           ; LEFT UPPER BLOCK
00001510  1011                     744              MOVE.B  (A1),D0         ; STORING TOP LEFT BLOCK IN D0
00001512                           745              
00001512  1800                     746              MOVE.B  D0,D4
00001514  4EB8 1486                747              JSR     ISBLWHICHCOLL
00001518  2004                     748              MOVE.L  D4,D0
0000151A                           749              
0000151A  1801                     750              MOVE.B  D1,D4
0000151C  4EB8 1486                751              JSR     ISBLWHICHCOLL
00001520  2204                     752              MOVE.L  D4,D1
00001522                           753              
00001522  1802                     754              MOVE.B  D2,D4
00001524  4EB8 1486                755              JSR     ISBLWHICHCOLL
00001528  2404                     756              MOVE.L  D4,D2
0000152A                           757              
0000152A  1803                     758              MOVE.B  D3,D4
0000152C  4EB8 1486                759              JSR     ISBLWHICHCOLL
00001530  2604                     760              MOVE.L  D4,D3
00001532                           761              
00001532  4CDF 0170                762              MOVEM.L (A7)+,D4-D6/A0
00001536                           763              
00001536  4E75                     764              RTS
00001538                           765  
00001538                           766  ; -----------------------------------------------------------------------------
00001538                           767  MAPPLOT
00001538                           768  ; INPUT    - 
00001538                           769  ; OUTPUT   - 
00001538                           770  ; MODIFIES - 
00001538                           771  ; -----------------------------------------------------------------------------
00001538                           772  
00001538  48E7 FF00                773          MOVEM.L D0-D7, -(A7)
0000153C  48E7 00FE                774          MOVEM.L A0-A6, -(A7)
00001540  3239 00003020            775             MOVE.W LOADEDMAP, D1
00001546  C2FC 000C                776             MULU #12, D1
0000154A  3241                     777             MOVEA.W D1, A1
0000154C  4EE9 1550                778             JMP MAPSEL(A1)
00001550                           779  MAPSEL:
00001550  41F9 00001DB2            780             LEA HEAVEN_0, A0
00001556  4EF9 000015CA            781             JMP NEXT
0000155C  41F9 00001F02            782             LEA HEAVEN_1, A0
00001562  4EF9 000015CA            783             JMP NEXT
00001568  41F9 0000203D            784             LEA HEAVEN_END, A0
0000156E  4EF9 000015CA            785             JMP NEXT
00001574  41F9 00002178            786             LEA HEAVEN_ROOM, A0
0000157A  4EF9 000015CA            787             JMP NEXT
00001580  41F9 000022B3            788             LEA HELL_0, A0
00001586  4EF9 000015CA            789             JMP NEXT
0000158C  41F9 000023EE            790             LEA HELL_1, A0
00001592  4EF9 000015CA            791             JMP NEXT
00001598  41F9 00002529            792             LEA HELL_END, A0
0000159E  4EF9 000015CA            793             JMP NEXT
000015A4  41F9 00002664            794             LEA HELL_ROOM, A0
000015AA  4EF9 000015CA            795             JMP NEXT
000015B0                           796  ; -----------------------------------------------------------------------------
000015B0                           797  MAPUPD
000015B0                           798  ; INPUT    - 
000015B0                           799  ; OUTPUT   - 
000015B0                           800  ; MODIFIES - A0
000015B0                           801  ; -----------------------------------------------------------------------------
000015B0  3F00                     802              MOVE.W D0,-(A7)
000015B2                           803              
000015B2  3039 00003020            804              MOVE.W  LOADEDMAP, D0
000015B8                           805              
000015B8  48C0                     806              EXT.L   D0
000015BA  C0FC 0004                807              MULU    #4,D0
000015BE  41F9 00003022            808              LEA.L   MAPUPDLIST,A0
000015C4  D1C0                     809              ADDA.L  D0,A0
000015C6  2050                     810              MOVEA.L (A0),A0
000015C8  4ED0                     811              JMP     (A0)
000015CA                           812  
000015CA                           813              
000015CA                           814  NEXT
000015CA  4281                     815             CLR.L D1
000015CC  1218                     816             MOVE.B (A0)+,D1
000015CE  C2FC 0006                817             MULU #6, D1
000015D2  2241                     818             MOVEA.L D1, A1
000015D4  4EE9 15D8                819             JMP JMPLIST(A1)
000015D8                           820             
000015D8                           821  JMPLIST: 
000015D8  4EF9 0000198C            822              JMP NEWLINE ; 0 = END OF ROW
000015DE  4EF9 00001660            823              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
000015E4  4EF9 000016F6            824              JMP DBHL    ; 2 = DRAW BRICK HELL
000015EA  4EF9 0000176A            825              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
000015F0  4EF9 000017DE            826              JMP DGHL    ; 4 = DRAW GRASS HELL
000015F6  4EF9 00001874            827              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
000015FC  4EF9 00001894            828              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
00001602  4EF9 000018B4            829              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
00001608  4EF9 00001620            830              JMP DDHL    ; 8 = DRAW DOOR HELL
0000160E  4EF9 00001640            831              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
00001614  4EF9 00001906            832              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
0000161A  4EF9 000019C2            833              JMP ENDMAP  ; 11 = END OF THE MAP
00001620                           834              
00001620                           835  DDHL
00001620  2F3C 00111111            836      MOVE.L #$00111111, -(A7)
00001626  2F3C 00111111            837      MOVE.L #$00111111, -(A7)
0000162C  4EB9 00001958            838      JSR DRAWBLOCK
00001632  2C1F                     839      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001634  2C1F                     840      MOVE.L (A7)+, D6    
00001636  4EB9 000019B0            841      JSR ENDBLOCK
0000163C  4EF8 15CA                842      JMP NEXT
00001640                           843  DDHV
00001640  2F3C 00FFFFFF            844      MOVE.L #$00FFFFFF, -(A7)
00001646  2F3C 00FFFFFF            845      MOVE.L #$00FFFFFF, -(A7)
0000164C  4EB9 00001958            846      JSR DRAWBLOCK
00001652  2C1F                     847      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001654  2C1F                     848      MOVE.L (A7)+, D6
00001656  4EB9 000019B0            849      JSR ENDBLOCK
0000165C  4EF8 15CA                850      JMP NEXT
00001660                           851  DGHE ;DRAW-GRASS-HEAVEN vvvR
00001660  2F3C 0099FF99            852      MOVE.L #$0099FF99, -(A7)
00001666  2F3C 0099FF99            853      MOVE.L #$0099FF99, -(A7)
0000166C  4EB9 00001958            854      JSR DRAWBLOCK
00001672  2C1F                     855      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001674  2C1F                     856      MOVE.L (A7)+, D6
00001676                           857      ; SET PEN COLOR 
00001676  103C 0050                858      MOVE.B #80, D0
0000167A  223C 0000CC00            859      MOVE.L #$0000CC00, D1
00001680  4E4F                     860      TRAP #15
00001682                           861      ;DRAW LINES   
00001682  103C 0054                862      MOVE.B #84, D0 
00001686                           863      ;LINEA 11 
00001686  3239 00003014            864      MOVE.W BPOSX1,D1
0000168C  5C41                     865      ADD.W #6, D1
0000168E  3439 00003016            866      MOVE.W BPOSY1, D2
00001694  5A42                     867      ADD.W #5, D2
00001696  3639 00003014            868      MOVE.W BPOSX1, D3
0000169C  0643 0009                869      ADD.W #9, D3
000016A0  3839 00003016            870      MOVE.W BPOSY1, D4
000016A6  0644 000A                871      ADD.W #10, D4
000016AA  4E4F                     872      TRAP #15
000016AC                           873      ;LINEA 12
000016AC  5041                     874      ADD.W #8, D1    
000016AE  5043                     875      ADD.W #8, D3
000016B0  4E4F                     876      TRAP #15
000016B2                           877      ;LINEA 13
000016B2  5041                     878      ADD.W #8, D1    
000016B4  5043                     879      ADD.W #8, D3
000016B6  4E4F                     880      TRAP #15
000016B8                           881      ;LINEA 21
000016B8  3239 00003014            882      MOVE.W BPOSX1,D1
000016BE  5C41                     883      ADD.W #6, D1
000016C0  3439 00003016            884      MOVE.W BPOSY1, D2
000016C6  0642 0014                885      ADD.W #20, D2
000016CA  3639 00003014            886      MOVE.W BPOSX1, D3
000016D0  0643 0009                887      ADD.W #9, D3
000016D4  3839 00003016            888      MOVE.W BPOSY1, D4
000016DA  0644 0019                889      ADD.W #25, D4
000016DE  4E4F                     890      TRAP #15
000016E0                           891      ;LINEA 22
000016E0  5041                     892      ADD.W #8, D1    
000016E2  5043                     893      ADD.W #8, D3
000016E4  4E4F                     894      TRAP #15
000016E6                           895      ;LINEA 23
000016E6  5041                     896      ADD.W #8, D1    
000016E8  5043                     897      ADD.W #8, D3
000016EA  4E4F                     898      TRAP #15
000016EC  4EB9 000019B0            899      JSR ENDBLOCK
000016F2  4EF8 15CA                900      JMP NEXT
000016F6                           901  DBHL ;DRAW BRICK-HELL vvvR
000016F6                           902      
000016F6  2F3C 00010101            903      MOVE.L #$00010101, -(A7)
000016FC  2F3C 00666666            904      MOVE.L #$00666666, -(A7)
00001702  4EB9 00001958            905      JSR DRAWBLOCK
00001708  2C1F                     906      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000170A  2C1F                     907      MOVE.L (A7)+, D6
0000170C                           908      ;DRAW HORIZONTAL LINE
0000170C  103C 0054                909      MOVE.B #84, D0 
00001710  3239 00003014            910      MOVE.W BPOSX1, D1
00001716  3439 00003016            911      MOVE.W BPOSY1, D2
0000171C  0642 0010                912      ADD.W #16, D2
00001720  3639 00003014            913      MOVE.W BPOSX1, D3
00001726  0643 0020                914      ADD.W #32, D3
0000172A  3839 00003016            915      MOVE.W BPOSY1, D4
00001730  0644 0010                916      ADD.W #16, D4
00001734  4E4F                     917      TRAP #15
00001736                           918      ;DRAW VERTICAL LINE 
00001736  3239 00003014            919      MOVE.W BPOSX1, D1
0000173C  0641 0010                920      ADD.W #16, D1
00001740  3439 00003016            921      MOVE.W BPOSY1, D2
00001746  0642 0010                922      ADD.W #16, D2
0000174A  3639 00003014            923      MOVE.W BPOSX1, D3
00001750  0643 0010                924      ADD.W #16, D3
00001754  3839 00003016            925      MOVE.W BPOSY1, D4
0000175A  0644 0020                926      ADD.W #32, D4
0000175E  4E4F                     927      TRAP #15
00001760  4EB9 000019B0            928      JSR ENDBLOCK    
00001766  4EF8 15CA                929      JMP NEXT
0000176A                           930  DBHV ;DRAW BRICK-HEAVEN vvvR
0000176A                           931      
0000176A  2F3C 00CCCCCC            932      MOVE.L #$00CCCCCC, -(A7)
00001770  2F3C 00D7EBFA            933      MOVE.L #$00D7EBFA, -(A7)
00001776  4EB9 00001958            934      JSR DRAWBLOCK
0000177C  2C1F                     935      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000177E  2C1F                     936      MOVE.L (A7)+, D6
00001780                           937      ;DRAW HORIZONTAL LINE
00001780  103C 0054                938      MOVE.B #84, D0 
00001784  3239 00003014            939      MOVE.W BPOSX1, D1
0000178A  3439 00003016            940      MOVE.W BPOSY1, D2
00001790  0642 0010                941      ADD.W #16, D2
00001794  3639 00003014            942      MOVE.W BPOSX1, D3
0000179A  0643 0020                943      ADD.W #32, D3
0000179E  3839 00003016            944      MOVE.W BPOSY1, D4
000017A4  0644 0010                945      ADD.W #16, D4
000017A8  4E4F                     946      TRAP #15
000017AA                           947      ;DRAW VERTICAL LINE 
000017AA  3239 00003014            948      MOVE.W BPOSX1, D1
000017B0  0641 0010                949      ADD.W #16, D1
000017B4  3439 00003016            950      MOVE.W BPOSY1, D2
000017BA  0642 0010                951      ADD.W #16, D2
000017BE  3639 00003014            952      MOVE.W BPOSX1, D3
000017C4  0643 0010                953      ADD.W #16, D3
000017C8  3839 00003016            954      MOVE.W BPOSY1, D4
000017CE  0644 0020                955      ADD.W #32, D4
000017D2  4E4F                     956      TRAP #15 
000017D4  4EB9 000019B0            957      JSR ENDBLOCK
000017DA  4EF8 15CA                958      JMP NEXT
000017DE                           959  DGHL ;DRAW GRASS HELL vvvR
000017DE                           960  
000017DE  2F3C 002255EE            961      MOVE.L #$002255EE, -(A7)
000017E4  2F3C 002255EE            962      MOVE.L #$002255EE, -(A7)
000017EA  4EB9 00001958            963      JSR DRAWBLOCK
000017F0  2C1F                     964      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000017F2  2C1F                     965      MOVE.L (A7)+, D6
000017F4                           966      ; SET PEN COLOR 
000017F4  103C 0050                967      MOVE.B #80, D0
000017F8  223C 000000CC            968      MOVE.L #$000000CC, D1
000017FE  4E4F                     969      TRAP #15
00001800                           970      ;DRAW LINES   
00001800  103C 0054                971      MOVE.B #84, D0 
00001804                           972      ;LINEA 11 
00001804  3239 00003014            973      MOVE.W BPOSX1,D1
0000180A  5C41                     974      ADD.W #6, D1
0000180C  3439 00003016            975      MOVE.W BPOSY1, D2
00001812  5A42                     976      ADD.W #5, D2
00001814  3639 00003014            977      MOVE.W BPOSX1, D3
0000181A  0643 0009                978      ADD.W #9, D3
0000181E  3839 00003016            979      MOVE.W BPOSY1, D4
00001824  0644 000A                980      ADD.W #10, D4
00001828  4E4F                     981      TRAP #15
0000182A                           982      ;LINEA 12
0000182A  5041                     983      ADD.W #8, D1    
0000182C  5043                     984      ADD.W #8, D3
0000182E  4E4F                     985      TRAP #15
00001830                           986      ;LINEA 13
00001830  5041                     987      ADD.W #8, D1    
00001832  5043                     988      ADD.W #8, D3
00001834  4E4F                     989      TRAP #15
00001836                           990      ;LINEA 21
00001836  3239 00003014            991      MOVE.W BPOSX1,D1
0000183C  5C41                     992      ADD.W #6, D1
0000183E  3439 00003016            993      MOVE.W BPOSY1, D2
00001844  0642 0014                994      ADD.W #20, D2
00001848  3639 00003014            995      MOVE.W BPOSX1, D3
0000184E  0643 0009                996      ADD.W #9, D3
00001852  3839 00003016            997      MOVE.W BPOSY1, D4
00001858  0644 0019                998      ADD.W #25, D4
0000185C  4E4F                     999      TRAP #15
0000185E                          1000      ;LINEA 22
0000185E  5041                    1001      ADD.W #8, D1    
00001860  5043                    1002      ADD.W #8, D3
00001862  4E4F                    1003      TRAP #15
00001864                          1004      ;LINEA 23
00001864  5041                    1005      ADD.W #8, D1    
00001866  5043                    1006      ADD.W #8, D3
00001868  4E4F                    1007      TRAP #15
0000186A  4EB9 000019B0           1008      JSR ENDBLOCK
00001870  4EF8 15CA               1009      JMP NEXT
00001874                          1010  
00001874                          1011  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
00001874  2F3C 00CCCCCC           1012      MOVE.L #$00CCCCCC, -(A7)
0000187A  2F3C 00C6DAE9           1013      MOVE.L #$00C6DAE9, -(A7)
00001880  4EB9 00001958           1014      JSR DRAWBLOCK
00001886  2C1F                    1015      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001888  2C1F                    1016      MOVE.L (A7)+, D6
0000188A  4EB9 000019B0           1017      JSR ENDBLOCK
00001890  4EF8 15CA               1018      JMP NEXT
00001894                          1019  DF1HL ; DRAW FLOOR_1 HELL vvvR 
00001894  2F3C 00010101           1020      MOVE.L #$00010101, -(A7)
0000189A  2F3C 00777777           1021      MOVE.L #$00777777, -(A7)
000018A0  4EB9 00001958           1022      JSR DRAWBLOCK
000018A6  2C1F                    1023      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018A8  2C1F                    1024      MOVE.L (A7)+, D6
000018AA                          1025  
000018AA  4EB9 000019B0           1026      JSR ENDBLOCK
000018B0  4EF8 15CA               1027      JMP NEXT
000018B4                          1028      
000018B4                          1029  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
000018B4  2F3C 00CCCCCC           1030      MOVE.L #$00CCCCCC, -(A7)
000018BA  2F3C 00C6DAE9           1031      MOVE.L #$00C6DAE9, -(A7)
000018C0  4EB9 00001958           1032      JSR DRAWBLOCK
000018C6  2C1F                    1033      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018C8  2C1F                    1034      MOVE.L (A7)+, D6
000018CA                          1035      ;SET NEW FILL COLOR  
000018CA  103C 0051               1036      MOVE.B #81, D0
000018CE  223C 00D7EBFA           1037      MOVE.L #$00D7EBFA, D1
000018D4  4E4F                    1038      TRAP #15 
000018D6                          1039      ;DRAW INSIDE SQUARE 
000018D6  103C 0057               1040      MOVE.B #87, D0
000018DA  3239 00003014           1041      MOVE.W BPOSX1, D1
000018E0  5041                    1042      ADD.W #8, D1
000018E2  3439 00003016           1043      MOVE.W BPOSY1, D2
000018E8  5042                    1044      ADD.W #8, D2
000018EA  3639 00003018           1045      MOVE.W BPOSX2, D3
000018F0  5143                    1046      SUB.W #8, D3
000018F2  3839 0000301A           1047      MOVE.W BPOSY2, D4
000018F8  5144                    1048      SUB.W #8, D4
000018FA  4E4F                    1049      TRAP #15
000018FC  4EB9 000019B0           1050      JSR ENDBLOCK
00001902  4EF8 15CA               1051      JMP NEXT
00001906                          1052  DF2HL ; DRAW FLOOR_2 HELL vvvR
00001906  2F3C 00010101           1053      MOVE.L #$00010101, -(A7)
0000190C  2F3C 00777777           1054      MOVE.L #$00777777, -(A7)
00001912  4EB9 00001958           1055      JSR DRAWBLOCK
00001918  2C1F                    1056      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000191A  2C1F                    1057      MOVE.L (A7)+, D6
0000191C                          1058      ;SET NEW FILL COLOR  
0000191C  103C 0051               1059      MOVE.B #81, D0
00001920  223C 00666666           1060      MOVE.L #$00666666, D1
00001926  4E4F                    1061      TRAP #15 
00001928                          1062  ;DRAW INSIDE SQUARE 
00001928  103C 0057               1063      MOVE.B #87, D0
0000192C  3239 00003014           1064      MOVE.W BPOSX1, D1
00001932  5041                    1065      ADD.W #8, D1
00001934  3439 00003016           1066      MOVE.W BPOSY1, D2
0000193A  5042                    1067      ADD.W #8, D2
0000193C  3639 00003018           1068      MOVE.W BPOSX2, D3
00001942  5143                    1069      SUB.W #8, D3
00001944  3839 0000301A           1070      MOVE.W BPOSY2, D4
0000194A  5144                    1071      SUB.W #8, D4
0000194C  4E4F                    1072      TRAP #15
0000194E  4EB9 000019B0           1073      JSR ENDBLOCK
00001954  4EF8 15CA               1074      JMP NEXT    
00001958                          1075      
00001958                          1076  DRAWBLOCK 
00001958                          1077  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPUS COMO LONGS. 
00001958                          1078      
00001958                          1079      ;SET FILL COLOR  
00001958  103C 0051               1080      MOVE.B #81, D0
0000195C  222F 0004               1081      MOVE.L 4(A7), D1
00001960  4E4F                    1082      TRAP #15 
00001962                          1083      
00001962                          1084      ; SET PEN COLOR 
00001962  103C 0050               1085      MOVE.B #80, D0
00001966  222F 0008               1086      MOVE.L 8(A7), D1
0000196A  4E4F                    1087      TRAP #15 
0000196C                          1088  
0000196C                          1089      ;DRAW BLOCK 
0000196C  103C 0057               1090      MOVE.B #87, D0
00001970  3239 00003014           1091      MOVE.W BPOSX1, D1
00001976  3439 00003016           1092      MOVE.W BPOSY1, D2
0000197C  3639 00003018           1093      MOVE.W BPOSX2, D3
00001982  3839 0000301A           1094      MOVE.W BPOSY2, D4
00001988  4E4F                    1095      TRAP #15
0000198A  4E75                    1096      RTS
0000198C                          1097  
0000198C                          1098  NEWLINE
0000198C                          1099      ;RESET X POSITION
0000198C  33FC 0000 00003014      1100      MOVE.W #0, BPOSX1
00001994  33FC 0020 00003018      1101      MOVE.W #32, BPOSX2
0000199C                          1102      ;ADD 33 TO Y POSITION
0000199C  0679 0020 00003016      1103      ADD.W #32, BPOSY1
000019A4  0679 0020 0000301A      1104      ADD.W #32, BPOSY2
000019AC  4EF8 15CA               1105      JMP NEXT
000019B0                          1106     
000019B0                          1107  ENDBLOCK
000019B0                          1108      ;SET NEW BLOCK POSITION
000019B0  0679 0020 00003014      1109      ADD.W #32, BPOSX1
000019B8  0679 0020 00003018      1110      ADD.W #32, BPOSX2
000019C0  4E75                    1111      RTS
000019C2                          1112  ENDMAP
000019C2                          1113      ;SET DEFAULT BLOCK POSITION
000019C2  33FC 0000 00003014      1114      MOVE.W #0, BPOSX1
000019CA  33FC 0000 00003016      1115      MOVE.W #0, BPOSY1
000019D2  33FC 0020 00003018      1116      MOVE.W #32, BPOSX2
000019DA  33FC 0020 0000301A      1117      MOVE.W #32, BPOSY2
000019E2  4CDF 7F00               1118      MOVEM.L (A7)+, A0-A6
000019E6  4CDF 00FF               1119      MOVEM.L (A7)+, D0-D7
000019EA  4E75                    1120      RTS
000019EC                          1121      
000019EC                          1122  
000019EC                          1123  
000019EC                          1124  MAPA1
000019EC  301F                    1125      MOVE.W (A7)+, D0
000019EE  48A7 F800               1126      MOVEM.W D0-D4, -(A7)
000019F2  3039 0000300E           1127      MOVE.W PLAYERPOSX, D0
000019F8  3239 00003010           1128      MOVE.W PLAYERPOSY, D1
000019FE                          1129      ;GO TO THE NEXT ROOM DOOR
000019FE                          1130      ;FIRST LETS CHECH POS X
000019FE  B07C 0160               1131      CMP #352, D0  ; BGT = 352 > D0
00001A02  6E00 002A               1132      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A06  B07C 0120               1133      CMP #288, D0
00001A0A  6D00 0022               1134      BLT MAP1NODOOR
00001A0E                          1135      ;NOW WE CHECK POS Y 
00001A0E  B27C 01E0               1136      CMP #480, D1  ; 
00001A12  6E00 001A               1137      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A16  B27C 01C0               1138      CMP #448, D1
00001A1A  6D00 0012               1139      BLT MAP1NODOOR
00001A1E  33FC 0020 00003010      1140      MOVE.W #32, PLAYERPOSY
00001A26  33FC 0001 00003020      1141      MOVE.W #1, LOADEDMAP
00001A2E                          1142  MAP1NODOOR
00001A2E  4C9F 001F               1143      MOVEM.W (A7)+, D0-D4
00001A32  4E75                    1144      RTS
00001A34                          1145      
00001A34                          1146  MAPA2
00001A34  301F                    1147      MOVE.W (A7)+, D0
00001A36  48A7 F800               1148      MOVEM.W D0-D4, -(A7)
00001A3A  3039 0000300E           1149      MOVE.W PLAYERPOSX, D0
00001A40  3239 00003010           1150      MOVE.W PLAYERPOSY, D1
00001A46                          1151      ;GO TO THE NEXT ROOM DOOR
00001A46                          1152      ;FIRST LETS CHECK POS X
00001A46  B07C 0160               1153      CMP #352, D0  ; BGT = 352 > D0
00001A4A  6E00 0030               1154      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A4E  B07C 0120               1155      CMP #288, D0
00001A52  6D00 0028               1156      BLT MAP2NODOOR1
00001A56                          1157      ;NOW WE CHECK POS Y 
00001A56  B27C 01E0               1158      CMP #480, D1  ; 
00001A5A  6E00 0020               1159      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A5E  B27C 01C0               1160      CMP #448, D1
00001A62  6D00 0018               1161      BLT MAP2NODOOR1
00001A66  33FC 0020 00003010      1162      MOVE.W #32, PLAYERPOSY
00001A6E  33FC 0002 00003020      1163      MOVE.W #2, LOADEDMAP
00001A76  4C9F 001F               1164      MOVEM.W (A7)+, D0-D4
00001A7A  4E75                    1165      RTS
00001A7C                          1166  MAP2NODOOR1
00001A7C                          1167      ;GO TO THE PREVIOUS ROOM DOOR
00001A7C                          1168      ;FIRST LETS CHECK POS X
00001A7C  B07C 0160               1169      CMP #352, D0  ; BGT = 352 > D0
00001A80  6E00 0030               1170      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A84  B07C 0120               1171      CMP #288, D0
00001A88  6D00 0028               1172      BLT MAP2NODOOR2
00001A8C                          1173      ;NOW WE CHECK POS Y 
00001A8C  B27C 0020               1174      CMP #32, D1  ; 
00001A90  6E00 0020               1175      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A94  B27C 0000               1176      CMP #0, D1
00001A98  6D00 0018               1177      BLT MAP2NODOOR2
00001A9C  33FC 01A0 00003010      1178      MOVE.W  #416, PLAYERPOSY
00001AA4  33FC 0000 00003020      1179      MOVE.W #0, LOADEDMAP
00001AAC  4C9F 001F               1180      MOVEM.W (A7)+, D0-D4
00001AB0  4E75                    1181      RTS
00001AB2                          1182  
00001AB2                          1183  MAP2NODOOR2
00001AB2                          1184      ;GO TO THE LEFT HEAVEN'S ROOM
00001AB2  B07C 00A0               1185      CMP #160, D0  ; BGT = 352 > D0
00001AB6  6E00 0038               1186      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ABA  B07C 0080               1187      CMP #128, D0
00001ABE  6D00 0030               1188      BLT MAP2NODOOR3
00001AC2                          1189      ;NOW WE CHECK POS Y 
00001AC2  B27C 00AA               1190      CMP #170, D1  ; 
00001AC6  6E00 0028               1191      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001ACA  B27C 0078               1192      CMP #120, D1
00001ACE  6D00 0020               1193      BLT MAP2NODOOR3
00001AD2  33FC 0130 0000300E      1194      MOVE.W #$130, PLAYERPOSX
00001ADA  33FC 00B0 00003010      1195      MOVE.W #$0B0, PLAYERPOSY
00001AE2  33FC 0003 00003020      1196      MOVE.W #3, LOADEDMAP
00001AEA  4C9F 001F               1197      MOVEM.W (A7)+, D0-D4
00001AEE  4E75                    1198      RTS
00001AF0                          1199  MAP2NODOOR3
00001AF0                          1200      ;GO TO THE RIGHT HEAVEN'S ROOM
00001AF0  B07C 01E0               1201      CMP #480, D0  ; BGT = 352 > D0
00001AF4  6E00 0038               1202      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AF8  B07C 01C0               1203      CMP #448, D0
00001AFC  6D00 0030               1204      BLT MAP2NODOOR4
00001B00                          1205      ;NOW WE CHECK POS Y 
00001B00  B27C 00AA               1206      CMP #170, D1  ; 
00001B04  6E00 0028               1207      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B08  B27C 0078               1208      CMP #120, D1
00001B0C  6D00 0020               1209      BLT MAP2NODOOR4
00001B10  33FC 0130 0000300E      1210      MOVE.W #$130, PLAYERPOSX
00001B18  33FC 00B0 00003010      1211      MOVE.W #$0B0, PLAYERPOSY
00001B20  33FC 0003 00003020      1212      MOVE.W #3, LOADEDMAP
00001B28  4C9F 001F               1213      MOVEM.W (A7)+, D0-D4
00001B2C  4E75                    1214      RTS
00001B2E                          1215  MAP2NODOOR4
00001B2E  4C9F 001F               1216      MOVEM.W (A7)+, D0-D4
00001B32  4E75                    1217      RTS
00001B34                          1218  MAPA3 
00001B34  301F                    1219      MOVE.W (A7)+, D0
00001B36  48A7 F800               1220      MOVEM.W D0-D4, -(A7)
00001B3A  3039 0000300E           1221      MOVE.W PLAYERPOSX, D0
00001B40  3239 00003010           1222      MOVE.W PLAYERPOSY, D1
00001B46                          1223      ;GO TO THE PREVIOUS ROOM DOOR
00001B46                          1224      ;FIRST LETS CHECK POS X
00001B46  B07C 0160               1225      CMP #352, D0  ; BGT = 352 > D0
00001B4A  6E00 0030               1226      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B4E  B07C 0120               1227      CMP #288, D0
00001B52  6D00 0028               1228      BLT MAP3NODOOR
00001B56                          1229      ;NOW WE CHECK POS Y 
00001B56  B27C 0020               1230      CMP #32, D1  ; 
00001B5A  6E00 0020               1231      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B5E  B27C 0000               1232      CMP #0, D1
00001B62  6D00 0018               1233      BLT MAP3NODOOR
00001B66  33FC 01A0 00003010      1234      MOVE.W  #416, PLAYERPOSY
00001B6E  33FC 0001 00003020      1235      MOVE.W #1, LOADEDMAP
00001B76  4C9F 001F               1236      MOVEM.W (A7)+, D0-D4
00001B7A  4E75                    1237      RTS
00001B7C                          1238  MAP3NODOOR
00001B7C  4C9F 001F               1239      MOVEM.W (A7)+, D0-D4
00001B80  4E75                    1240      RTS
00001B82                          1241  MAPA4
00001B82  301F                    1242      MOVE.W (A7)+, D0
00001B84  48A7 F800               1243      MOVEM.W D0-D4, -(A7)
00001B88  3039 0000300E           1244      MOVE.W PLAYERPOSX, D0
00001B8E  3239 00003010           1245      MOVE.W PLAYERPOSY, D1
00001B94                          1246      ;GO BACK TO 2ND HEAVEN'S ROOM
00001B94  B07C 0180               1247      CMP #384, D0  ; BGT = 352 > D0
00001B98  6E00 002A               1248      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B9C  B07C 0104               1249      CMP #260, D0
00001BA0  6D00 0022               1250      BLT MAP4NODOOR
00001BA4                          1251      ;NOW WE CHECK POS Y 
00001BA4  B27C 0080               1252      CMP #128, D1  ; 
00001BA8  6E00 001A               1253      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BAC  B27C 0060               1254      CMP #96, D1
00001BB0  6D00 0012               1255      BLT MAP4NODOOR
00001BB4  33FC 00E0 0000300E      1256      MOVE.W  #224, PLAYERPOSX
00001BBC  33FC 0001 00003020      1257      MOVE.W #1, LOADEDMAP
00001BC4                          1258  MAP4NODOOR
00001BC4  4C9F 001F               1259      MOVEM.W (A7)+, D0-D4
00001BC8  4E75                    1260      RTS
00001BCA                          1261  ;;;;;;;;;;HELL
00001BCA                          1262  MAPA5
00001BCA  301F                    1263      MOVE.W (A7)+, D0
00001BCC  48A7 F800               1264      MOVEM.W D0-D4, -(A7)
00001BD0  3039 0000300E           1265      MOVE.W PLAYERPOSX, D0
00001BD6  3239 00003010           1266      MOVE.W PLAYERPOSY, D1
00001BDC                          1267      ;GO TO THE NEXT ROOM DOOR
00001BDC                          1268      ;FIRST LETS CHECH POS X
00001BDC  B07C 0160               1269      CMP #352, D0  ; BGT = 352 > D0
00001BE0  6E00 002A               1270      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BE4  B07C 0120               1271      CMP #288, D0
00001BE8  6D00 0022               1272      BLT MAP5NODOOR
00001BEC                          1273      ;NOW WE CHECK POS Y 
00001BEC  B27C 01E0               1274      CMP #480, D1  ; 
00001BF0  6E00 001A               1275      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BF4  B27C 01C0               1276      CMP #448, D1
00001BF8  6D00 0012               1277      BLT MAP5NODOOR
00001BFC  33FC 0020 00003010      1278      MOVE.W #32, PLAYERPOSY
00001C04  33FC 0005 00003020      1279      MOVE.W #5, LOADEDMAP
00001C0C                          1280  MAP5NODOOR
00001C0C  4C9F 001F               1281      MOVEM.W (A7)+, D0-D4
00001C10  4E75                    1282      RTS
00001C12                          1283      
00001C12                          1284  MAPA6
00001C12  301F                    1285      MOVE.W (A7)+, D0
00001C14  48A7 F800               1286      MOVEM.W D0-D4, -(A7)
00001C18  3039 0000300E           1287      MOVE.W PLAYERPOSX, D0
00001C1E  3239 00003010           1288      MOVE.W PLAYERPOSY, D1
00001C24                          1289      ;GO TO THE NEXT ROOM DOOR
00001C24                          1290      ;FIRST LETS CHECK POS X
00001C24  B07C 0160               1291      CMP #352, D0  ; BGT = 352 > D0
00001C28  6E00 0030               1292      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C2C  B07C 0120               1293      CMP #288, D0
00001C30  6D00 0028               1294      BLT MAP6NODOOR1
00001C34                          1295      ;NOW WE CHECK POS Y 
00001C34  B27C 01E0               1296      CMP #480, D1  ; 
00001C38  6E00 0020               1297      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C3C  B27C 01C0               1298      CMP #448, D1
00001C40  6D00 0018               1299      BLT MAP6NODOOR1
00001C44  33FC 0020 00003010      1300      MOVE.W #32, PLAYERPOSY
00001C4C  33FC 0006 00003020      1301      MOVE.W #6, LOADEDMAP
00001C54  4C9F 001F               1302      MOVEM.W (A7)+, D0-D4
00001C58  4E75                    1303      RTS
00001C5A                          1304  MAP6NODOOR1
00001C5A                          1305      ;GO TO THE PREVIOUS ROOM DOOR
00001C5A                          1306      ;FIRST LETS CHECK POS X
00001C5A  B07C 0160               1307      CMP #352, D0  ; BGT = 352 > D0
00001C5E  6E00 0030               1308      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C62  B07C 0120               1309      CMP #288, D0
00001C66  6D00 0028               1310      BLT MAP6NODOOR2
00001C6A                          1311      ;NOW WE CHECK POS Y 
00001C6A  B27C 0020               1312      CMP #32, D1  ; 
00001C6E  6E00 0020               1313      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C72  B27C 0000               1314      CMP #0, D1
00001C76  6D00 0018               1315      BLT MAP6NODOOR2
00001C7A  33FC 01A0 00003010      1316      MOVE.W  #416, PLAYERPOSY
00001C82  33FC 0004 00003020      1317      MOVE.W #4, LOADEDMAP
00001C8A  4C9F 001F               1318      MOVEM.W (A7)+, D0-D4
00001C8E  4E75                    1319      RTS
00001C90                          1320  MAP6NODOOR2
00001C90                          1321      ;CHECK FOR LEFT HELL ROOM
00001C90  B07C 0060               1322      CMP #96, D0  ; BGT = 352 > D0
00001C94  6E00 0038               1323      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C98  B07C 0040               1324      CMP #64, D0
00001C9C  6D00 0030               1325      BLT MAP6NODOOR3
00001CA0                          1326      ;NOW WE CHECK POS Y 
00001CA0  B27C 0180               1327      CMP #384, D1  ; 
00001CA4  6E00 0028               1328      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CA8  B27C 0140               1329      CMP #320, D1
00001CAC  6D00 0020               1330      BLT MAP6NODOOR3
00001CB0  33FC 0130 0000300E      1331      MOVE.W #$130, PLAYERPOSX
00001CB8  33FC 00B0 00003010      1332      MOVE.W #$0B0, PLAYERPOSY
00001CC0  33FC 0007 00003020      1333      MOVE.W #7, LOADEDMAP
00001CC8  4C9F 001F               1334      MOVEM.W (A7)+, D0-D4
00001CCC  4E75                    1335      RTS
00001CCE                          1336  MAP6NODOOR3
00001CCE                          1337      ;CHECK FOR THE RIGHT HELL ROOM
00001CCE  B07C 0240               1338      CMP #576, D0  ; BGT = 352 > D0
00001CD2  6E00 0038               1339      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CD6  B07C 021C               1340      CMP #540, D0
00001CDA  6D00 0030               1341      BLT MAP6NODOOR4
00001CDE                          1342      ;NOW WE CHECK POS Y 
00001CDE  B27C 0180               1343      CMP #384, D1  ; 
00001CE2  6E00 0028               1344      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CE6  B27C 0140               1345      CMP #320, D1
00001CEA  6D00 0020               1346      BLT MAP6NODOOR4
00001CEE  33FC 0130 0000300E      1347      MOVE.W #$130, PLAYERPOSX
00001CF6  33FC 00B0 00003010      1348      MOVE.W #$0B0, PLAYERPOSY
00001CFE  33FC 0007 00003020      1349      MOVE.W #7, LOADEDMAP
00001D06  4C9F 001F               1350      MOVEM.W (A7)+, D0-D4
00001D0A  4E75                    1351      RTS
00001D0C                          1352  MAP6NODOOR4
00001D0C  4C9F 001F               1353      MOVEM.W (A7)+, D0-D4
00001D10  4E75                    1354      RTS
00001D12                          1355  MAPA7 
00001D12  301F                    1356      MOVE.W (A7)+, D0
00001D14  48A7 F800               1357      MOVEM.W D0-D4, -(A7)
00001D18  3039 0000300E           1358      MOVE.W PLAYERPOSX, D0
00001D1E  3239 00003010           1359      MOVE.W PLAYERPOSY, D1
00001D24                          1360      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D24  B07C 0180               1361      CMP #384, D0  ; BGT = 352 > D0
00001D28  6E00 0032               1362      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D2C  B07C 0104               1363      CMP #260, D0
00001D30  6D00 002A               1364      BLT MAP7NODOOR
00001D34                          1365      ;NOW WE CHECK POS Y 
00001D34  B27C 0020               1366      CMP #32, D1  ; 
00001D38  6E00 0022               1367      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D3C  B27C 0000               1368      CMP #0, D1
00001D40  6D00 001A               1369      BLT MAP7NODOOR
00001D44  33FC 0140 0000300E      1370      MOVE.W  #320, PLAYERPOSX
00001D4C  33FC 01A0 00003010      1371      MOVE.W #416, PLAYERPOSY
00001D54  33FC 0005 00003020      1372      MOVE.W #5, LOADEDMAP
00001D5C                          1373  MAP7NODOOR
00001D5C  4C9F 001F               1374      MOVEM.W (A7)+, D0-D4
00001D60  4E75                    1375      RTS
00001D62                          1376  MAPA8
00001D62                          1377       ;HELLS ROOM
00001D62  301F                    1378      MOVE.W (A7)+, D0
00001D64  48A7 F800               1379      MOVEM.W D0-D4, -(A7)
00001D68  3039 0000300E           1380      MOVE.W PLAYERPOSX, D0
00001D6E  3239 00003010           1381      MOVE.W PLAYERPOSY, D1
00001D74                          1382      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D74  B07C 0180               1383      CMP #384, D0  ; BGT = 352 > D0
00001D78  6E00 0032               1384      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D7C  B07C 0104               1385      CMP #260, D0
00001D80  6D00 002A               1386      BLT MAP8NODOOR1
00001D84                          1387      ;NOW WE CHECK POS Y 
00001D84  B27C 0080               1388      CMP #128, D1  ; 
00001D88  6E00 0022               1389      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D8C  B27C 0060               1390      CMP #96, D1
00001D90  6D00 001A               1391      BLT MAP8NODOOR1
00001D94  33FC 0140 0000300E      1392      MOVE.W  #320, PLAYERPOSX
00001D9C  33FC 0080 00003010      1393      MOVE.W #128, PLAYERPOSY
00001DA4  33FC 0005 00003020      1394      MOVE.W #5, LOADEDMAP
00001DAC                          1395  MAP8NODOOR1
00001DAC  4C9F 001F               1396      MOVEM.W (A7)+, D0-D4
00001DB0  4E75                    1397      RTS
00001DB2                          1398  
00001DB2                          1399  
00001DB2                          1400  
00001DB2                          1401  
00001DB2                          1402  
00001DB2                          1403  
00001DB2                          1404  
00001DB2                          1405  
00001DB2                          1406  
00001DB2                          1407  
00001DB2                          1408  
00001DB2                          1409  
00001DB2                          1410  
00001DB2                          1411  
00001DB2                          1412  
00001DB2                          1413  
00001DB2                          1414  
00001DB2                          1415  
00001DB2                          1416  
00001DB2                          1417  
00001DB2                          1418  -------------------- end include --------------------
00001DB2                          1419              INCLUDE "MAPS.X68"
00001DB2                          1420  
00001DB2                          1421  HEAVEN_0    ;MAP 1
00001DB2= 03 03 03 03 03 03 ...   1422      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00001DC7= 03 01 01 01 01 01 ...   1423      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
00001DDC= 03 01 03 03 03 03 ...   1424      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
00001DF1= 03 01 03 05 05 05 ...   1425      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00001E06= 03 01 03 05 05 05 ...   1426      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E1B= 03 01 03 05 05 05 ...   1427      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E30= 03 01 03 05 05 05 ...   1428      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001E45= 03 01 03 05 05 05 ...   1429      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001E5A= 03 01 03 05 05 05 ...   1430      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E6F= 03 01 03 05 05 05 ...   1431      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E84= 03 01 03 05 05 05 ...   1432      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E99= 03 01 03 05 05 05 ...   1433      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001EAE= 03 01 03 05 05 05 ...   1434      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001EC3= 03 01 03 03 03 03 ...   1435      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00001ED8= 03 01 01 01 01 01 ...   1436      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001EED= 03 03 03 03 03 03 ...   1437      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001F02                          1438          
00001F02                          1439  HEAVEN_1    ;MAP 2
00001F02= 03 03 03 03 03 03 ...   1440      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001F17= 03 03 01 01 01 01 ...   1441      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
00001F2C= 03 03 03 03 03 03 ...   1442      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
00001F41= 03 07 07 07 07 03 ...   1443      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F56= 03 07 07 07 07 03 ...   1444      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F6B= 03 07 07 07 07 09 ...   1445      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
00001F80= 03 07 07 07 07 03 ...   1446      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00001F95= 03 07 07 07 07 03 ...   1447      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001FAA= 03 03 03 03 03 03 ...   1448      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
00001FBF= 03 01 01 01 01 03 ...   1449      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00001FD4= 03 01 01 01 01 01 ...   1450      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00001FE9= 03 01 01 01 01 01 ...   1451      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001FFE= 03 01 01 01 01 01 ...   1452      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00002013= 03 01 01 01 01 01 ...   1453      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00002028= 03 03 03 03 03 03 ...   1454      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
0000203D                          1455      
0000203D                          1456  HEAVEN_END  ;MAP 3
0000203D= 03 03 03 03 03 03 ...   1457      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00002052= 03 05 05 05 05 05 ...   1458      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00002067= 03 05 05 07 05 05 ...   1459      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000207C= 03 05 07 07 07 05 ...   1460      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00002091= 03 05 05 07 05 05 ...   1461      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
000020A6= 03 05 05 07 05 05 ...   1462      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
000020BB= 03 05 05 05 05 05 ...   1463      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020D0= 03 05 05 05 05 05 ...   1464      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020E5= 03 05 05 05 05 05 ...   1465      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020FA= 03 05 05 07 05 05 ...   1466      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000210F= 03 05 07 07 07 05 ...   1467      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00002124= 03 05 05 07 05 05 ...   1468      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002139= 03 05 05 07 05 05 ...   1469      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000214E= 03 05 05 05 05 05 ...   1470      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00002163= 03 03 03 03 03 03 ...   1471      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
00002178                          1472      
00002178                          1473  HEAVEN_ROOM ;MAP 4
00002178= 09 09 09 09 09 09 ...   1474      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000218D= 09 09 09 09 09 09 ...   1475      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021A2= 09 09 09 09 09 09 ...   1476      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021B7= 09 09 09 09 09 09 ...   1477      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000021CC= 09 09 09 09 09 03 ...   1478      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
000021E1= 09 09 09 09 09 03 ...   1479      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021F6= 09 09 09 09 09 03 ...   1480      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000220B= 09 09 09 09 09 03 ...   1481      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002220= 09 09 09 09 09 03 ...   1482      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00002235= 09 09 09 09 09 03 ...   1483      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000224A= 09 09 09 09 09 03 ...   1484      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
0000225F= 09 09 09 09 09 09 ...   1485      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002274= 09 09 09 09 09 09 ...   1486      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002289= 09 09 09 09 09 09 ...   1487      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000229E= 09 09 09 09 09 09 ...   1488      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
000022B3                          1489      
000022B3                          1490  HELL_0  ;MAP 5
000022B3= 02 02 02 02 02 02 ...   1491      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
000022C8= 02 06 06 06 06 06 ...   1492      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022DD= 02 06 06 04 06 06 ...   1493      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
000022F2= 02 06 06 04 06 06 ...   1494      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00002307= 02 06 04 04 04 06 ...   1495      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
0000231C= 02 06 06 04 06 06 ...   1496      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00002331= 02 06 06 06 06 06 ...   1497      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002346= 02 02 02 02 02 02 ...   1498      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
0000235B= 02 06 06 06 06 06 ...   1499      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002370= 02 06 06 06 06 06 ...   1500      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002385= 02 06 06 06 06 06 ...   1501      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000239A= 02 06 06 06 06 06 ...   1502      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023AF= 02 06 06 06 06 06 ...   1503      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023C4= 02 06 06 06 06 06 ...   1504      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023D9= 02 02 02 02 02 02 ...   1505      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
000023EE                          1506          
000023EE                          1507  HELL_1      ;MAP 6
000023EE= 02 02 02 02 02 02 ...   1508      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00002403= 02 06 06 06 06 06 ...   1509      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002418= 02 06 06 06 06 06 ...   1510      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000242D= 02 06 06 06 06 06 ...   1511      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002442= 02 06 06 06 06 06 ...   1512      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002457= 02 06 06 06 06 06 ...   1513      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
0000246C= 02 06 06 06 06 06 ...   1514      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002481= 02 06 06 06 06 06 ...   1515      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00002496= 02 06 06 06 06 06 ...   1516      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000024AB= 02 06 06 06 06 06 ...   1517      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024C0= 02 02 08 02 02 02 ...   1518      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
000024D5= 02 06 06 06 02 02 ...   1519      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
000024EA= 02 06 06 06 02 02 ...   1520      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
000024FF= 02 06 06 06 02 02 ...   1521      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002514= 02 02 02 02 02 02 ...   1522      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002529                          1523          
00002529                          1524  HELL_END    ;MAP 7
00002529= 02 02 02 02 02 02 ...   1525      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
0000253E= 02 06 06 06 06 06 ...   1526      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002553= 02 06 06 06 06 06 ...   1527      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002568= 02 06 06 06 06 06 ...   1528      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000257D= 02 06 06 06 06 06 ...   1529      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002592= 02 06 06 06 06 06 ...   1530      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025A7= 02 06 06 06 06 06 ...   1531      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025BC= 02 06 06 06 06 06 ...   1532      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025D1= 02 06 06 06 06 06 ...   1533      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
000025E6= 02 06 06 06 06 06 ...   1534      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
000025FB= 02 06 06 06 06 06 ...   1535      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002610= 02 06 06 06 06 06 ...   1536      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002625= 02 06 06 06 06 06 ...   1537      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000263A= 02 06 06 06 06 06 ...   1538      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000264F= 02 02 02 02 02 02 ...   1539      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
00002664                          1540      
00002664                          1541  HELL_ROOM   ;MAP 8
00002664= 08 08 08 08 08 08 ...   1542      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002679= 08 08 08 08 08 08 ...   1543      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000268E= 08 08 08 08 08 08 ...   1544      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026A3= 08 08 08 08 08 08 ...   1545      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000026B8= 08 08 08 08 08 02 ...   1546      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
000026CD= 08 08 08 08 08 02 ...   1547      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026E2= 08 08 08 08 08 02 ...   1548      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026F7= 08 08 08 08 08 02 ...   1549      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000270C= 08 08 08 08 08 02 ...   1550      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002721= 08 08 08 08 08 02 ...   1551      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002736= 08 08 08 08 08 02 ...   1552      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
0000274B= 08 08 08 08 08 08 ...   1553      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002760= 08 08 08 08 08 08 ...   1554      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002775= 08 08 08 08 08 08 ...   1555      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000278A= 08 08 08 08 08 08 ...   1556      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
0000279F                          1557  
000027A0= 0000                    1558      DC.W    0
000027A2                          1559  
000027A2                          1560  
000027A2                          1561  
000027A2                          1562  
000027A2                          1563  
000027A2                          1564  
000027A2                          1565  
000027A2                          1566  
000027A2                          1567  
000027A2                          1568  -------------------- end include --------------------
000027A2                          1569              INCLUDE "ELEVATOR.X68"           
000027A2                          1570  ELEVATORINIT
000027A2  6000 048E               1571      BRA     AUDINIT
000027A6                          1572  
000027A6                          1573  ELEVATORPLOT
000027A6                          1574      
000027A6  48E7 FFFE               1575      MOVEM.L D0-D7/A0-A6,-(A7)
000027AA                          1576  
000027AA                          1577  
000027AA                          1578  ;SET PEN COLOR  
000027AA  103C 0050               1579      MOVE.B #80, D0
000027AE  223C 00010101           1580      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
000027B4  4E4F                    1581      TRAP #15
000027B6                          1582      
000027B6                          1583  ;END SET PEN COLOR 
000027B6                          1584  
000027B6                          1585      ;DRAW LINES
000027B6                          1586  ;DRAW LINE 1 
000027B6  103C 0054               1587      MOVE.B #84, D0
000027BA  323C 0000               1588      MOVE.W #0, D1
000027BE  343C 0000               1589      MOVE.W #0, D2
000027C2  363C 00A0               1590      MOVE.W #160, D3
000027C6  383C 0078               1591      MOVE.W #120, D4
000027CA  4E4F                    1592      TRAP #15
000027CC                          1593  
000027CC                          1594  ;DRAW LINE 2
000027CC  103C 0054               1595      MOVE.B #84, D0
000027D0  323C 00A0               1596      MOVE.W #160, D1
000027D4  343C 0078               1597      MOVE.W #120, D2
000027D8  363C 00A0               1598      MOVE.W #160, D3
000027DC  383C 01E0               1599      MOVE.W #480, D4
000027E0  4E4F                    1600      TRAP #15
000027E2                          1601      
000027E2                          1602  ;DRAW LINE 3
000027E2  103C 0054               1603      MOVE.B #84, D0
000027E6  323C 00A0               1604      MOVE.W #160, D1
000027EA  343C 0078               1605      MOVE.W #120, D2
000027EE  363C 01E0               1606      MOVE.W #480, D3
000027F2  383C 0078               1607      MOVE.W #120, D4
000027F6  4E4F                    1608      TRAP #15
000027F8                          1609      
000027F8                          1610  ;DRAW LINE 4
000027F8  103C 0054               1611      MOVE.B #84, D0
000027FC  323C 01E0               1612      MOVE.W #480, D1
00002800  343C 0078               1613      MOVE.W #120, D2
00002804  363C 0280               1614      MOVE.W #640, D3
00002808  383C 0000               1615      MOVE.W #0, D4
0000280C  4E4F                    1616      TRAP #15
0000280E                          1617      
0000280E                          1618  ;DRAW LINE 5
0000280E  103C 0054               1619      MOVE.B #84, D0
00002812  323C 01E0               1620      MOVE.W #480, D1
00002816  343C 0078               1621      MOVE.W #120, D2
0000281A  363C 01E0               1622      MOVE.W #480, D3
0000281E  383C 01E0               1623      MOVE.W #480, D4
00002822  4E4F                    1624      TRAP #15
00002824                          1625  
00002824                          1626  ;DRAW LINE 6 (TO GIVE SHADE) 
00002824  103C 0054               1627      MOVE.B #84, D0
00002828  323C 0119               1628      MOVE.W #281, D1
0000282C  343C 015A               1629      MOVE.W #346, D2
00002830  363C 0167               1630      MOVE.W #359, D3
00002834  383C 015A               1631      MOVE.W #346, D4
00002838  4E4F                    1632      TRAP #15
0000283A                          1633      
0000283A                          1634  ;DRAW LINE 7 (TO GIVE SHADE) 
0000283A  103C 0054               1635      MOVE.B #84, D0
0000283E  323C 011A               1636      MOVE.W #282, D1
00002842  343C 015B               1637      MOVE.W #347, D2
00002846  363C 0166               1638      MOVE.W #358, D3
0000284A  383C 015B               1639      MOVE.W #347, D4
0000284E  4E4F                    1640      TRAP #15
00002850                          1641      
00002850                          1642      ;END DRAW LINES
00002850                          1643      
00002850                          1644  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
00002850  103C 0057               1645      MOVE.B #87, D0
00002854  323C 0118               1646      MOVE.W #280, D1
00002858  343C 00D2               1647      MOVE.W #210, D2
0000285C  363C 0168               1648      MOVE.W #360, D3
00002860  383C 0159               1649      MOVE.W #345, D4
00002864  4E4F                    1650      TRAP #15
00002866                          1651      
00002866                          1652  ;DRAW ELLIPSE FOR THE LIGHT
00002866  103C 005B               1653      MOVE.B #91, D0
0000286A  323C 00FA               1654      MOVE.W #250, D1
0000286E  343C 0028               1655      MOVE.W #40, D2
00002872  363C 0186               1656      MOVE.W #390, D3
00002876  383C 0050               1657      MOVE.W #80, D4
0000287A  4E4F                    1658      TRAP #15
0000287C                          1659      ;FILL SEGMENTS
0000287C                          1660  ;FILL SEGMENT 1 LEFT WALL
0000287C                          1661    ;SET FILL COLOR TO DARKER GREY, FOR W
0000287C  103C 0051               1662      MOVE.B #81, D0
00002880                          1663      ;MOVE.L #$00969696, D1
00002880  223C 0020202F           1664      MOVE.L #$0020202F, D1
00002886  4E4F                    1665      TRAP #15
00002888                          1666      ;END SET FILL COLOR
00002888  103C 0059               1667      MOVE.B #89, D0
0000288C  323C 0064               1668      MOVE.W #100, D1
00002890  343C 0064               1669      MOVE.W #100, D2
00002894  4E4F                    1670      TRAP #15
00002896                          1671      
00002896                          1672  ;FILL SEGMENT 2 CEILING
00002896                          1673    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00002896  103C 0051               1674      MOVE.B #81, D0
0000289A                          1675      ;MOVE.L #$00C0C0C0, D1
0000289A  223C 00141424           1676      MOVE.L #$00141424,D1
000028A0  4E4F                    1677      TRAP #15
000028A2                          1678      ;END SET FILL COLOR
000028A2  103C 0059               1679      MOVE.B #89, D0
000028A6  323C 0064               1680      MOVE.W #100, D1
000028AA  343C 0032               1681      MOVE.W #50, D2
000028AE  4E4F                    1682      TRAP #15
000028B0                          1683      
000028B0                          1684  ;FILL SEGMENT 3 RIGHT WALL
000028B0                          1685    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
000028B0  103C 0051               1686      MOVE.B #81, D0
000028B4                          1687      ;MOVE.L #$00969696, D1
000028B4  223C 0020202F           1688      MOVE.L #$0020202F,D1
000028BA  4E4F                    1689      TRAP #15
000028BC                          1690      ;END SET FILL COLOR
000028BC  103C 0059               1691      MOVE.B #89, D0
000028C0  323C 0276               1692      MOVE.W #630, D1
000028C4  343C 01D6               1693      MOVE.W #470, D2
000028C8  4E4F                    1694      TRAP #15
000028CA                          1695      
000028CA                          1696  ;FILL SEGMENT 4 BACKGROUND WALL
000028CA                          1697    ;SET FILL COLOR TO 
000028CA  103C 0051               1698      MOVE.B #81, D0
000028CE                          1699      ;MOVE.L #$00ABABAB, D1
000028CE  223C 001A1A2A           1700      MOVE.L #$001A1A2A, D1
000028D4  4E4F                    1701      TRAP #15
000028D6                          1702      ;END SET FILL COLOR
000028D6  103C 0059               1703      MOVE.B #89, D0
000028DA  323C 00F0               1704      MOVE.W #240, D1
000028DE  343C 0140               1705      MOVE.W #320, D2
000028E2  4E4F                    1706      TRAP #15
000028E4                          1707      
000028E4                          1708  ;FILL SEGMENT 5 PANEL 
000028E4                          1709    ;SET FILL COLOR TO 
000028E4  103C 0051               1710      MOVE.B #81, D0
000028E8                          1711      ;MOVE.L #$00AFAFAF, D1
000028E8  223C 001F1F2F           1712      MOVE.L #$001F1F2F, D1
000028EE  4E4F                    1713      TRAP #15
000028F0                          1714      ;END SET FILL COLOR
000028F0  103C 0059               1715      MOVE.B #89, D0
000028F4  323C 011D               1716      MOVE.W #285, D1
000028F8  343C 00D7               1717      MOVE.W #215, D2
000028FC  4E4F                    1718      TRAP #15
000028FE                          1719      
000028FE                          1720  ;FILL ELLIPSE LIGHT 
000028FE                          1721    ;SET FILL COLOR TO 
000028FE  103C 0051               1722      MOVE.B #81, D0
00002902                          1723      ;MOVE.L #$00A1E9E9, D1
00002902  223C 000000FF           1724      MOVE.L #$000000FF, D1
00002908  4E4F                    1725      TRAP #15
0000290A                          1726      ;END SET FILL COLOR
0000290A  103C 0059               1727      MOVE.B #89, D0
0000290E  323C 0140               1728      MOVE.W #320, D1
00002912  343C 003C               1729      MOVE.W #60, D2
00002916  4E4F                    1730      TRAP #15
00002918                          1731  
00002918                          1732  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
00002918                          1733      ;SET FILL COLOR 
00002918  103C 0051               1734      MOVE.B #81, D0
0000291C  223C 000000CC           1735      MOVE.L #COLBUTHL, D1
00002922  4E4F                    1736      TRAP #15
00002924                          1737      ;END SET FILL COLOR
00002924  3F3C 0135               1738      MOVE.W #309, -(A7) ;COORDENADA Y 
00002928  3F3C 0136               1739      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
0000292C  3F3C 0016               1740      MOVE.W #22, -(A7)
00002930  4EB9 00002966           1741      JSR TRIANGLE
00002936  3C1F                    1742      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
00002938  3C1F                    1743      MOVE.W (A7)+, D6
0000293A  3C1F                    1744      MOVE.W (A7)+, D6
0000293C                          1745  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
0000293C                          1746     ;SET FILL COLOR
0000293C  103C 0051               1747     MOVE.B #81, D0
00002940  223C 00EEEEEE           1748     MOVE.L #COLBUTHV, D1
00002946  4E4F                    1749     TRAP #15
00002948                          1750     
00002948                          1751      ;END SET FILL COLOR
00002948  3F3C 00F9               1752     MOVE.W #249, -(A7) ;COORDENADA Y 
0000294C  3F3C 0136               1753     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00002950  3F3C FFEA               1754     MOVE.W #-22, -(A7)
00002954  4EB9 00002966           1755     JSR TRIANGLE
0000295A  3C1F                    1756     MOVE.W (A7)+, D6
0000295C  3C1F                    1757     MOVE.W (A7)+, D6
0000295E  3C1F                    1758     MOVE.W (A7)+, D6
00002960  4CDF 7FFF               1759     MOVEM.L (A7)+, D0-D7/A0-A6
00002964                          1760  
00002964  4E75                    1761     RTS
00002966                          1762  ; ------------------------------------------------------------------------------
00002966                          1763  TRIANGLE
00002966                          1764  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
00002966                          1765  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
00002966                          1766  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
00002966                          1767  ;            SIDES LENGTH (WORD) IN THAT ORDER
00002966                          1768  ; OUTPUT   : NONE
00002966                          1769  ; MODIFIES : NONE
00002966                          1770  ; ------------------------------------------------------------------------------
00002966  48A7 F800               1771      MOVEM.W D0-D4, -(A7)
0000296A                          1772      ; LINE FROM LEFT TO RIGHT
0000296A  103C 0054               1773      MOVE.B  #84,D0      ; TASK NUMBER
0000296E  322F 0010               1774      MOVE.W  16(A7),D1   ; X POSITION FROM
00002972  342F 0012               1775      MOVE.W  18(A7),D2   ; Y POSITION FROM
00002976  3802                    1776      MOVE.W  D2,D4       ; Y POSITION TO
00002978  362F 000E               1777      MOVE.W  14(A7),D3   ; LENGTH
0000297C                          1778      
0000297C  6A00 0004               1779      BPL.W   .UPWARDS
00002980  4443                    1780      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
00002982                          1781  .UPWARDS
00002982  D641                    1782      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
00002984  4E4F                    1783      TRAP    #15         ; HORIZONTAL LINE DRAWN
00002986                          1784      ; LINE FROM RIGHT TO UP/DOWN
00002986  9641                    1785      SUB.W   D1,D3       ; I GET LENGTH IN D3
00002988  3001                    1786      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
0000298A  D243                    1787      ADD.W   D3,D1       ; X POSITION FROM
0000298C  E24B                    1788      LSR.W   #1,D3       ; LENGTH/2
0000298E  D640                    1789      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
00002990                          1790      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
00002990  D86F 000E               1791      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
00002994  103C 0054               1792      MOVE.B  #84,D0
00002998  4E4F                    1793      TRAP    #15
0000299A                          1794      ; LINE FROM LEFT TO UP/DOWN
0000299A  322F 0010               1795      MOVE.W  16(A7),D1   ; X POSITION FROM
0000299E  4E4F                    1796      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
000029A0                          1797      
000029A0                          1798      ; FILLING TRIANGLE
000029A0  103C 0059               1799      MOVE.B  #89,D0
000029A4  5241                    1800      ADDQ.W  #1,D1
000029A6  363C 0001               1801      MOVE.W  #1,D3
000029AA  4A6F 000E               1802      TST.W   14(A7)
000029AE  6A00 0004               1803      BPL.W   .ISPOSITIVE
000029B2  4443                    1804      NEG.W   D3
000029B4                          1805  .ISPOSITIVE
000029B4  D443                    1806      ADD.W   D3,D2
000029B6  4E4F                    1807      TRAP    #15
000029B8                          1808      
000029B8  4C9F 001F               1809      MOVEM.W (A7)+,D0-D4
000029BC  4E75                    1810      RTS
000029BE                          1811      
000029BE                          1812  ; ------------------------------------------------------------------------------
000029BE                          1813  ELEVATORUPDATE ; 1 = up 3 = down
000029BE                          1814  ; INPUT    : 
000029BE                          1815  ; OUTPUT   : 
000029BE                          1816  ; MODIFIES : 
000029BE                          1817  ; ------------------------------------------------------------------------------
000029BE  4EB9 00002CAE           1818      JSR  ELEVATORMUSIC  
000029C4  0839 0005 00003006      1819      BTST #5, KBDVAL
000029CC  6600 002A               1820      BNE .HLSEL
000029D0  0839 0007 00003006      1821      BTST #7, KBDVAL
000029D8  6600 0004               1822      BNE .HVSEL
000029DC  4E75                    1823      RTS
000029DE                          1824  .HVSEL  ;LOAD 1ST HEAVEN MAP
000029DE  33FC 0002 00003086      1825      MOVE.W  #2,(STANEXT)
000029E6  13FC 0000 00003066      1826      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
000029EE  33FC 0000 00003020      1827      MOVE.W #0, LOADEDMAP    
000029F6  4E75                    1828      RTS
000029F8                          1829  .HLSEL  ;LOAD 1ST HELL MAP
000029F8  33FC 0002 00003086      1830      MOVE.W  #2,(STANEXT)
00002A00  13FC 0000 00003066      1831      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
00002A08  33FC 0004 00003020      1832      MOVE.W #4, LOADEDMAP
00002A10  4E75                    1833      RTS
00002A12                          1834      
00002A12                          1835          
00002A12                          1836  
00002A12                          1837  
00002A12                          1838  
00002A12                          1839  
00002A12                          1840  
00002A12                          1841  
00002A12                          1842  
00002A12                          1843  
00002A12                          1844  
00002A12                          1845  
00002A12                          1846  
00002A12                          1847  -------------------- end include --------------------
00002A12                          1848              INCLUDE "PLAYER.X68"    
00002A12                          1849  ; ==============================================================================
00002A12                          1850  ; PLAYER MANAGEMENT
00002A12                          1851  ; ==============================================================================
00002A12                          1852              
00002A12                          1853  ; ------------------------------------------------------------------------------
00002A12                          1854  PLAYERUPD
00002A12                          1855  ; UPDATES THE PLAYER.
00002A12                          1856  ; INPUT    : NONE 
00002A12                          1857  ; OUTPUT   : NONE
00002A12                          1858  ; MODIFIES : NONE
00002A12                          1859  ; ------------------------------------------------------------------------------
00002A12  48E7 F000               1860              MOVEM.L D0-D3,-(A7)
00002A16                          1861              ; CHECK COLLISIONS
00002A16                          1862              ; TOP LEFT CORNER
00002A16  3039 0000300E           1863              MOVE.W  (PLAYERPOSX),D0
00002A1C  E188                    1864              LSL.L   #8,D0
00002A1E  E188                    1865              LSL.L   #8,D0
00002A20  3039 00003010           1866              MOVE.W  (PLAYERPOSY),D0
00002A26                          1867              
00002A26  3239 0000300E           1868              MOVE.W  (PLAYERPOSX),D1
00002A2C  0641 0020               1869              ADD.W   #PLAYERWIDTH,D1
00002A30  E189                    1870              LSL.L   #8,D1
00002A32  E189                    1871              LSL.L   #8,D1
00002A34  3239 00003010           1872              MOVE.W  (PLAYERPOSY),D1
00002A3A  0641 0020               1873              ADD.W   #PLAYERHEIGHT,D1
00002A3E                          1874              
00002A3E  4EB8 14A6               1875              JSR BLKCOLL    
00002A42                          1876                              
00002A42  0839 0000 00003006      1877              BTST #0, KBDVAL         ; SI NO VA HACIA LA IZQUIERDA
00002A4A  6700 001E               1878              BEQ .NOLEFT
00002A4E  5979 0000300E           1879              SUB.W   #PLAYERSPEED,(PLAYERPOSX)
00002A54  4A80                    1880              TST.L   D0              ; SI HAY COLISIONES CON D0
00002A56  6600 000C               1881              BNE .LEFT             
00002A5A  4A83                    1882              TST.L   D3              ; SI HAY COLISIONES CON D3
00002A5C  6600 0006               1883              BNE .LEFT
00002A60  6000 0008               1884              BRA  .NOLEFT
00002A64  5879 0000300E           1885  .LEFT       ADD.W   #PLAYERSPEED,(PLAYERPOSX)
00002A6A                          1886  .NOLEFT     
00002A6A  0839 0001 00003006      1887              BTST #1, KBDVAL         ; SI NO VA ARRIBA
00002A72  6700 001E               1888              BEQ .NOUP
00002A76  5979 00003010           1889              SUB.W   #PLAYERSPEED,(PLAYERPOSY)
00002A7C  4A80                    1890              TST.L   D0              ; SI HAY COLISIONES CON D0
00002A7E  6600 000C               1891              BNE .UP             
00002A82  4A81                    1892              TST.L   D1              ; SI HAY COLISIONES CON D1
00002A84  6600 0006               1893              BNE .UP
00002A88  6000 0008               1894              BRA .NOUP
00002A8C  5879 00003010           1895  .UP         ADD.W   #PLAYERSPEED,(PLAYERPOSY)
00002A92                          1896  .NOUP       
00002A92  0839 0002 00003006      1897              BTST #2, KBDVAL         ; SI NO VA HACIA LA DERECHA
00002A9A  6700 001E               1898              BEQ .NORIGHT
00002A9E  5879 0000300E           1899              ADD.W   #PLAYERSPEED,(PLAYERPOSX)
00002AA4  4A81                    1900              TST.L   D1              ; SI HAY COLISIONES CON D1
00002AA6  6600 000C               1901              BNE .RIGHT             
00002AAA  4A82                    1902              TST.L   D2              ; SI HAY COLISIONES CON D2
00002AAC  6600 0006               1903              BNE .RIGHT
00002AB0  6000 0008               1904              BRA .NORIGHT
00002AB4  5979 0000300E           1905  .RIGHT      SUB.W   #PLAYERSPEED,(PLAYERPOSX)
00002ABA                          1906  .NORIGHT    
00002ABA  0839 0003 00003006      1907              BTST #3, KBDVAL         ; SI NO VA ABAJO
00002AC2  6700 001E               1908              BEQ .NODOWN             
00002AC6  5879 00003010           1909              ADD.W   #PLAYERSPEED,(PLAYERPOSY)
00002ACC  4A82                    1910              TST.L   D2              ; SI HAY COLISIONES CON D2
00002ACE  6600 000C               1911              BNE .DOWN             
00002AD2  4A83                    1912              TST.L   D3              ; SI HAY COLISIONES CON D3
00002AD4  6600 0006               1913              BNE .DOWN             
00002AD8  6000 0008               1914              BRA .NODOWN             
00002ADC  5979 00003010           1915  .DOWN       SUB.W   #PLAYERSPEED,(PLAYERPOSY)
00002AE2                          1916  .NODOWN     
00002AE2  4CDF 000F               1917              MOVEM.L (A7)+,D0-D3
00002AE6  4E75                    1918              RTS
00002AE8                          1919          
00002AE8                          1920  ; ------------------------------------------------------------------------------
00002AE8                          1921  PLAYERPLOT
00002AE8                          1922  ; PLOT THE PLAYER.
00002AE8                          1923  ; INPUT    : NONE 
00002AE8                          1924  ; OUTPUT   : NONE
00002AE8                          1925  ; MODIFIES : NONE
00002AE8                          1926  ; ------------------------------------------------------------------------------
00002AE8                          1927              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
00002AE8  1F00                    1928              MOVE.B  D0,-(A7)
00002AEA  2F01                    1929              MOVE.L  D1,-(A7)
00002AEC  48A7 3800               1930        MOVEM.W D2-D4, -(A7)
00002AF0                          1931        
00002AF0  223C 00CC954E           1932        MOVE.L #$00CC954E,D1 ;PEN COLOR
00002AF6  103C 0050               1933        MOVE.B #80,D0
00002AFA  4E4F                    1934        TRAP #15
00002AFC  223C 00B53866           1935        MOVE.L #$00B53866,D1 ;FILL COLOR
00002B02  103C 0051               1936        MOVE.B #81,D0
00002B06  4E4F                    1937        TRAP #15
00002B08                          1938        ; SE DIBUJA EL CUADRADO
00002B08  3239 0000300E           1939        MOVE.W (PLAYERPOSX),D1    
00002B0E  3439 00003010           1940        MOVE.W (PLAYERPOSY),D2      
00002B14  3601                    1941        MOVE.W D1,D3
00002B16  0643 0020               1942              ADD.W  #PLAYERWIDTH,D3  
00002B1A  3802                    1943        MOVE.W D2,D4
00002B1C  0644 0020               1944              ADD.W  #PLAYERHEIGHT,D4
00002B20  103C 0057               1945        MOVE.B #87,D0
00002B24  4E4F                    1946        TRAP #15
00002B26                          1947        
00002B26  4C9F 001C               1948              MOVEM.W (A7)+,D2-D4
00002B2A  221F                    1949              MOVE.L  (A7)+,D1      
00002B2C  101F                    1950              MOVE.B  (A7)+,D0
00002B2E                          1951    
00002B2E  4E75                    1952        RTS
00002B30                          1953  
00002B30                          1954  
00002B30                          1955  
00002B30                          1956  
00002B30                          1957  
00002B30                          1958  -------------------- end include --------------------
00002B30                          1959              INCLUDE "PROJECTILE.X68"
00002B30                          1960  ; ==============================================================================
00002B30                          1961  ; PROJECTILE MANAGEMENT (AGENT)
00002B30                          1962  ; PROJPOSX (W)  (A0)
00002B30                          1963  ; PROJPOSY (W) 2(A0)
00002B30                          1964  ; PROJVELX (W) 4(A0)
00002B30                          1965  ; PROJVELY (W) 6(A0)
00002B30                          1966  ; ==============================================================================
00002B30                          1967  
00002B30                          1968  ; ------------------------------------------------------------------------------
00002B30                          1969  PROJINIT 
00002B30                          1970  ; INITIALIZES THE PROJECTILE.
00002B30                          1971  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00002B30                          1972  ; OUTPUT   : NONE
00002B30                          1973  ; MODIFIES : NONE
00002B30                          1974  ; ------------------------------------------------------------------------------
00002B30  2F00                    1975             MOVE.L  D0,-(A7)
00002B32                          1976             
00002B32  4280                    1977              CLR.L   D0
00002B34  0839 0004 00003007      1978              BTST #4, (KBDEDGE)    
00002B3C  6700 0008               1979              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
00002B40  0680 FFF80000           1980              ADD.L   #-PROJSPEEDX<<16,D0
00002B46  0839 0005 00003007      1981  .FUP        BTST #5, (KBDEDGE)      
00002B4E  6700 0006               1982              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
00002B52  0640 FFF8               1983              ADD.W   #-PROJSPEEDY,D0 
00002B56  0839 0006 00003007      1984  .FRIGHT     BTST #6, (KBDEDGE)
00002B5E  6700 0008               1985              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
00002B62  0680 00080000           1986              ADD.L   #PROJSPEEDX<<16,D0
00002B68  0839 0007 00003007      1987  .FDOWN      BTST #7, (KBDEDGE)
00002B70  6700 0004               1988              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
00002B74  5040                    1989              ADD.W   #PROJSPEEDY,D0
00002B76  4A80                    1990  .NOTFDOWN   TST.L   D0
00002B78  6600 0006               1991              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
00002B7C  303C 0008               1992              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
00002B80  20B9 0000300E           1993  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
00002B86  2140 0004               1994              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
00002B8A  5279 00003012           1995              ADD.W   #1,(NPROJ)
00002B90  201F                    1996              MOVE.L  (A7)+,D0
00002B92  4E75                    1997              RTS
00002B94                          1998    
00002B94                          1999  ; ------------------------------------------------------------------------------
00002B94                          2000  PROJUPD 
00002B94                          2001  ; UPDATES THE PROJECTILE.
00002B94                          2002  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00002B94                          2003  ; OUTPUT   : NONE
00002B94                          2004  ; MODIFIES : NONE
00002B94                          2005  ; ------------------------------------------------------------------------------
00002B94  48E7 F000               2006              MOVEM.L  D0-D3,-(A7)
00002B98  2028 0004               2007              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
00002B9C  D168 0002               2008              ADD.W   D0,2(A0)
00002BA0  E088                    2009              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
00002BA2  E088                    2010              LSR.L   #8,D0
00002BA4  D150                    2011              ADD.W   D0,(A0) 
00002BA6                          2012              
00002BA6                          2013              ; CHECK COLLISIONS
00002BA6                          2014              ; TOP LEFT CORNER
00002BA6  3010                    2015              MOVE.W  (A0),D0
00002BA8  E188                    2016              LSL.L   #8,D0
00002BAA  E188                    2017              LSL.L   #8,D0
00002BAC  3028 0002               2018              MOVE.W  2(A0),D0
00002BB0                          2019              
00002BB0  3210                    2020              MOVE.W  (A0),D1
00002BB2  0641 0010               2021              ADD.W   #PROJWIDTH,D1
00002BB6  E189                    2022              LSL.L   #8,D1
00002BB8  E189                    2023              LSL.L   #8,D1
00002BBA  3228 0002               2024              MOVE.W  2(A0),D1
00002BBE  0641 0010               2025              ADD.W   #PROJHEIGHT,D1
00002BC2                          2026  
00002BC2  4EB8 14A6               2027              JSR BLKCOLL
00002BC6  4A80                    2028              TST.L   D0
00002BC8  6600 001A               2029              BNE.L   .PROJCOLL
00002BCC  4A81                    2030              TST.L   D1
00002BCE  6600 0014               2031              BNE.L   .PROJCOLL
00002BD2  4A82                    2032              TST.L   D2
00002BD4  6600 000E               2033              BNE.L   .PROJCOLL
00002BD8  4A83                    2034              TST.L   D3
00002BDA  6600 0008               2035              BNE.L   .PROJCOLL
00002BDE                          2036  .PROJNOCOLL             
00002BDE  4CDF 000F               2037              MOVEM.L  (A7)+,D0-D3
00002BE2  4E75                    2038              RTS
00002BE4                          2039              
00002BE4  4EB8 10F4               2040  .PROJCOLL   JSR AGLKILL
00002BE8  5379 00003012           2041              SUB.W   #1,(NPROJ)
00002BEE  60EE                    2042              BRA     .PROJNOCOLL
00002BF0                          2043  ; ------------------------------------------------------------------------------
00002BF0                          2044  PROJPLOT 
00002BF0                          2045  ; PLOTS THE PROJECTILE.
00002BF0                          2046  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
00002BF0                          2047  ; OUTPUT   : NONE
00002BF0                          2048  ; MODIFIES : NONE
00002BF0                          2049  ; ------------------------------------------------------------------------------
00002BF0  1F00                    2050              MOVE.B  D0,-(A7)
00002BF2  2F01                    2051              MOVE.L  D1,-(A7)
00002BF4  48A7 3800               2052        MOVEM.W D2-D4, -(A7)
00002BF8                          2053        
00002BF8  223C 00C00FFE           2054        MOVE.L #$00C00FFE,D1 ;PEN COLOR
00002BFE  103C 0050               2055        MOVE.B #80,D0
00002C02  4E4F                    2056        TRAP #15
00002C04  223C 00BFF006           2057        MOVE.L #$00BFF006,D1 ;FILL COLOR
00002C0A  103C 0051               2058        MOVE.B #81,D0
00002C0E  4E4F                    2059        TRAP #15
00002C10                          2060        ; SE DIBUJA EL CUADRADO
00002C10  3210                    2061        MOVE.W (A0),D1    
00002C12  3428 0002               2062        MOVE.W 2(A0),D2     
00002C16  3601                    2063        MOVE.W D1,D3
00002C18  0643 0010               2064              ADD.W  #PROJWIDTH,D3    
00002C1C  3802                    2065        MOVE.W D2,D4
00002C1E  0644 0010               2066              ADD.W  #PROJHEIGHT,D4
00002C22  103C 0057               2067        MOVE.B #87,D0
00002C26  4E4F                    2068        TRAP #15
00002C28                          2069        
00002C28  4C9F 001C               2070              MOVEM.W (A7)+,D2-D4
00002C2C  221F                    2071              MOVE.L  (A7)+,D1      
00002C2E  101F                    2072              MOVE.B  (A7)+,D0
00002C30  4E75                    2073              RTS
00002C32                          2074  
00002C32                          2075  
00002C32                          2076  
00002C32                          2077  
00002C32                          2078  -------------------- end include --------------------
00002C32                          2079              INCLUDE "AUDIO.X68"
00002C32                          2080     
00002C32                          2081  ; =============================================================================
00002C32                          2082  ; AUDIO MANAGEMENT
00002C32                          2083  ; =============================================================================
00002C32                          2084  
00002C32                          2085  
00002C32                          2086  ; -----------------------------------------------------------------------------
00002C32                          2087  AUDINIT
00002C32                          2088  ; CHANGES AUDIO TO PLAY
00002C32                          2089  ; INPUT    - NONE
00002C32                          2090  ; OUTPUT   - NONE
00002C32                          2091  ; MODIFIES - NONE
00002C32                          2092  ; -----------------------------------------------------------------------------
00002C32                          2093      
00002C32  48A7 E000               2094      MOVEM.W D0-D2, -(A7)
00002C36  48A7 00C0               2095      MOVEM.W A0-A1, -(A7)
00002C3A                          2096  ;LOAD ELEVATOR MUSIC IN POS 0 
00002C3A  103C 0047               2097      MOVE.B #71, D0
00002C3E  43F8 100F               2098      LEA ELEVATOR_MUSIC, A1
00002C42  123C 0000               2099      MOVE.B #0, D1
00002C46  4E4F                    2100      TRAP #15
00002C48                          2101  ;LOAD HEAVEN MUSIC IN POS 1
00002C48  43F8 1000               2102      LEA HEAVENSOUND, A1
00002C4C  123C 0001               2103      MOVE.B #1, D1
00002C50  4E4F                    2104      TRAP #15
00002C52                          2105  ;LOAD HELL MUSIC IN POS 2
00002C52  43F8 1026               2106      LEA HELLSOUND, A1
00002C56  123C 0002               2107      MOVE.B #2, D1
00002C5A  4E4F                    2108      TRAP #15
00002C5C  4C9F 0300               2109      MOVEM.W (A7)+, A0-A1
00002C60  4C9F 0007               2110      MOVEM.W (A7)+, D0-D2
00002C64                          2111  
00002C64  4E75                    2112      RTS
00002C66                          2113  
00002C66                          2114  
00002C66                          2115  ; -----------------------------------------------------------------------------
00002C66                          2116  AUDPLAY
00002C66                          2117  ; CHANGES AUDIO TO PLAY
00002C66                          2118  ; INPUT    - NONE
00002C66                          2119  ; OUTPUT   - NONE
00002C66                          2120  ; MODIFIES - NONE
00002C66                          2121  ; -----------------------------------------------------------------------------
00002C66                          2122      
00002C66  48E7 E000               2123      MOVEM.L D0-D2, -(A7)
00002C6A  48A7 00C0               2124      MOVEM.W A0-A1, -(A7)    
00002C6E                          2125      
00002C6E  3239 00003020           2126      MOVE.W LOADEDMAP, D1
00002C74  C2FC 0006               2127             MULU #6, D1
00002C78  3241                    2128             MOVEA.W D1, A1
00002C7A  4EE9 2C7E               2129             JMP MSCSEL(A1)
00002C7E                          2130  MSCSEL:
00002C7E                          2131             
00002C7E  4EF9 00002CCC           2132             JMP HEAVENMUSIC
00002C84                          2133             
00002C84  4EF9 00002CCC           2134             JMP HEAVENMUSIC
00002C8A                          2135             
00002C8A  4EF9 00002CCC           2136             JMP HEAVENMUSIC
00002C90                          2137             
00002C90  4EF9 00002CCC           2138             JMP HEAVENMUSIC
00002C96                          2139             
00002C96  4EF9 00002CEE           2140             JMP HELLMUSIC
00002C9C                          2141             
00002C9C  4EF9 00002CEE           2142             JMP HELLMUSIC
00002CA2                          2143             
00002CA2  4EF9 00002CEE           2144             JMP HELLMUSIC
00002CA8                          2145             
00002CA8  4EF9 00002CEE           2146             JMP HELLMUSIC
00002CAE                          2147             
00002CAE                          2148  
00002CAE                          2149  ELEVATORMUSIC
00002CAE  48A7 E000               2150      MOVEM.W D0-D2 ,-(A7)
00002CB2  103C 004C               2151      MOVE.B #76, D0
00002CB6  123C 0000               2152      MOVE.B #0, D1
00002CBA  7400                    2153      MOVE.L #0, D2
00002CBC  4E4F                    2154      TRAP #15
00002CBE  4C9F 0007               2155      MOVEM.W (A7)+, D0-D2 
00002CC2  13FC 0001 00003066      2156      MOVE.B #1, MUSICPLAYED
00002CCA  4E75                    2157      RTS
00002CCC                          2158  
00002CCC                          2159  HEAVENMUSIC 
00002CCC  103C 004C               2160      MOVE.B #76, D0
00002CD0  123C 0000               2161      MOVE.B #0, D1
00002CD4  7402                    2162      MOVE.L #2, D2
00002CD6  4E4F                    2163      TRAP #15
00002CD8  103C 004C               2164      MOVE.B #76, D0
00002CDC  123C 0001               2165      MOVE.B #1, D1
00002CE0  7400                    2166      MOVE.L #0, D2
00002CE2  4E4F                    2167      TRAP #15
00002CE4  4C9F 0300               2168      MOVEM.W (A7)+, A0-A1
00002CE8  4CDF 0007               2169      MOVEM.L (A7)+, D0-D2
00002CEC  4E75                    2170      RTS
00002CEE                          2171  HELLMUSIC
00002CEE  103C 004C               2172      MOVE.B #76, D0
00002CF2  123C 0000               2173      MOVE.B #0, D1
00002CF6  7402                    2174      MOVE.L #2, D2
00002CF8  4E4F                    2175      TRAP #15
00002CFA  103C 004C               2176      MOVE.B #76, D0
00002CFE  123C 0002               2177      MOVE.B #2, D1
00002D02  7400                    2178      MOVE.L #0,  D2
00002D04  4E4F                    2179      TRAP #15
00002D06  4C9F 0300               2180      MOVEM.W (A7)+, A0-A1
00002D0A  4CDF 0007               2181      MOVEM.L (A7)+, D0-D2
00002D0E  4E75                    2182      RTS
00002D10                          2183  
00002D10                          2184  FIREDSOUND
00002D10  48A7 E000               2185      MOVEM.W D0-D2, -(A7)
00002D14  48A7 00C0               2186      MOVEM.W A0-A1, -(A7)
00002D18  103C 0049               2187      MOVE.B #73, D0
00002D1C  43F8 1035               2188      LEA PROJ_SOUND, A1
00002D20  4E4F                    2189      TRAP #15
00002D22  4C9F 0300               2190      MOVEM.W (A7)+, A0-A1
00002D26  4C9F 0007               2191      MOVEM.W (A7)+, D0-D2
00002D2A  4E75                    2192      RTS
00002D2C                          2193  
00002D2C                          2194  -------------------- end include --------------------
00002D2C                          2195              INCLUDE "STATES.X68"
00002D2C                          2196  ; =============================================================================
00002D2C                          2197  ; GAME STATE MANAGEMENT
00002D2C                          2198  ; =============================================================================
00002D2C                          2199  
00002D2C                          2200  ; -----------------------------------------------------------------------------
00002D2C                          2201  STAINIT
00002D2C                          2202  ; INITALIZES THE STATE MANAGER
00002D2C                          2203  ; INPUT    - NONE
00002D2C                          2204  ; OUTPUT   - NONE
00002D2C                          2205  ; MODIFIES - NONE
00002D2C                          2206  ; -----------------------------------------------------------------------------
00002D2C  33FC FFFF 00003084      2207              MOVE.W  #STANONE,(STACUR)
00002D34  4279 00003086           2208              CLR.W   (STANEXT)
00002D3A  4E75                    2209              RTS
00002D3C                          2210  
00002D3C                          2211  ; -----------------------------------------------------------------------------
00002D3C                          2212  STAUPD
00002D3C                          2213  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00002D3C                          2214  ; INPUT    - NONE
00002D3C                          2215  ; OUTPUT   - NONE
00002D3C                          2216  ; MODIFIES - NONE
00002D3C                          2217  ; -----------------------------------------------------------------------------
00002D3C  48E7 8080               2218              MOVEM.L D0/A0,-(A7)
00002D40  4280                    2219              CLR.L   D0
00002D42  3039 00003086           2220              MOVE.W  (STANEXT),D0
00002D48  B079 00003084           2221              CMP.W   (STACUR),D0
00002D4E  6700 0012               2222              BEQ     .DOUPD
00002D52  33C0 00003084           2223              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00002D58  E588                    2224              LSL.L   #2,D0
00002D5A  2040                    2225              MOVE.L  D0,A0
00002D5C  2068 2D7A               2226              MOVE.L  .INITBL(A0),A0
00002D60  4E90                    2227              JSR     (A0)
00002D62  4280                    2228  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00002D64  3039 00003084           2229              MOVE.W  (STACUR),D0
00002D6A  E588                    2230              LSL.L   #2,D0
00002D6C  2040                    2231              MOVE.L  D0,A0
00002D6E  2068 2D8A               2232              MOVE.L  .UPDTBL(A0),A0
00002D72  4E90                    2233              JSR     (A0)
00002D74  4CDF 0101               2234              MOVEM.L (A7)+,D0/A0
00002D78  4E75                    2235              RTS
00002D7A= 00002DC6 000027A2 ...   2236  .INITBL     DC.L    STAEMPTY,ELEVATORINIT,STAEMPTY,ENDGINIT
00002D8A= 00002E34 000029BE ...   2237  .UPDTBL     DC.L    ISCUPD,ELEVATORUPDATE,GAMUPD,ENDGUPD
00002D9A                          2238  
00002D9A                          2239  ; -----------------------------------------------------------------------------
00002D9A                          2240  STAPLOT
00002D9A                          2241  ; PERFORMS STATE PLOT
00002D9A                          2242  ; INPUT    - NONE
00002D9A                          2243  ; OUTPUT   - NONE
00002D9A                          2244  ; MODIFIES - NONE
00002D9A                          2245  ; -----------------------------------------------------------------------------
00002D9A  48E7 8080               2246              MOVEM.L D0/A0,-(A7)
00002D9E  4280                    2247              CLR.L   D0
00002DA0  3039 00003084           2248              MOVE.W  (STACUR),D0
00002DA6  E588                    2249              LSL.L   #2,D0
00002DA8  2040                    2250              MOVE.L  D0,A0
00002DAA  2068 2DB6               2251              MOVE.L  .PLTTBL(A0),A0
00002DAE  4E90                    2252              JSR     (A0)
00002DB0  4CDF 0101               2253              MOVEM.L (A7)+,D0/A0
00002DB4  4E75                    2254              RTS
00002DB6= 00002E88 000027A6 ...   2255  .PLTTBL     DC.L    ISCPLOT,ELEVATORPLOT,GAMPLOT,ENDGPLOT
00002DC6                          2256  
00002DC6                          2257  ; -----------------------------------------------------------------------------
00002DC6                          2258  STAEMPTY
00002DC6                          2259  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00002DC6                          2260  ; INPUT    - NONE
00002DC6                          2261  ; OUTPUT   - NONE
00002DC6                          2262  ; MODIFIES - NONE
00002DC6                          2263  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00002DC6                          2264  ; -----------------------------------------------------------------------------
00002DC6  4E75                    2265              RTS
00002DC8                          2266  
00002DC8                          2267  
00002DC8                          2268  
00002DC8                          2269  
00002DC8                          2270  
00002DC8                          2271  
00002DC8                          2272  
00002DC8                          2273  
00002DC8                          2274  
00002DC8                          2275  
00002DC8                          2276  
00002DC8                          2277  
00002DC8                          2278  -------------------- end include --------------------
00002DC8                          2279              INCLUDE "GAME.X68"
00002DC8                          2280  ; ==============================================================================
00002DC8                          2281  ; GAME MANAGEMENT
00002DC8                          2282  ; ==============================================================================
00002DC8                          2283  
00002DC8                          2284  ; ------------------------------------------------------------------------------
00002DC8                          2285  GAMUPD
00002DC8                          2286  ; UPDATES THE GAME
00002DC8                          2287  ; INPUT    : NONE
00002DC8                          2288  ; OUTPUT   : NONE
00002DC8                          2289  ; MODIFIES : NONE
00002DC8                          2290  ; ------------------------------------------------------------------------------
00002DC8  48E7 8070               2291              MOVEM.L D0/A1-A3,-(A7)
00002DCC                          2292              
00002DCC                          2293              ; CHECK IF MUSIC IS ALREADY PLAYING 
00002DCC  1039 00003066           2294              MOVE.B MUSICPLAYED, D0
00002DD2  B07C 0001               2295              CMP #1, D0
00002DD6  6700 0006               2296              BEQ .NOMUSIC
00002DDA  4EB8 2C66               2297              JSR AUDPLAY
00002DDE                          2298  ; GENERAL UPDATES
00002DDE  4EB8 2A12               2299  .NOMUSIC    JSR PLAYERUPD   
00002DE2  4EB8 15B0               2300              JSR MAPUPD
00002DE6                          2301  ; SHOTS LOGIC         
00002DE6  1039 00003007           2302              MOVE.B  (KBDEDGE),D0
00002DEC  C03C 00F0               2303              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
00002DF0  6718                    2304              BEQ.B .NOTFIRED
00002DF2  4EB8 2D10               2305              JSR FIREDSOUND
00002DF6  43F8 2B30               2306              LEA     PROJINIT,A1
00002DFA  45F8 2B94               2307              LEA     PROJUPD,A2
00002DFE  47F8 2BF0               2308              LEA     PROJPLOT,A3
00002E02  303C 0001               2309              MOVE.W  #1,D0
00002E06  4EB8 12BC               2310              JSR     AGLADD
00002E0A                          2311  .NOTFIRED
00002E0A  4A79 00003012           2312              TST.W   (NPROJ)
00002E10  6700 0006               2313              BEQ     .NOPROJ1
00002E14  4EB8 12D6               2314              JSR     AGLUPD
00002E18                          2315  .NOPROJ1
00002E18  4CDF 0E01               2316              MOVEM.L (A7)+,D0/A1-A3
00002E1C  4E75                    2317              RTS
00002E1E                          2318  
00002E1E                          2319  ; ------------------------------------------------------------------------------
00002E1E                          2320  GAMPLOT
00002E1E                          2321  ; PLOTS THE GAME
00002E1E                          2322  ; INPUT    : NONE
00002E1E                          2323  ; OUTPUT   : NONE
00002E1E                          2324  ; MODIFIES : NONE
00002E1E                          2325  ; ------------------------------------------------------------------------------
00002E1E  4EB8 1538               2326              JSR MAPPLOT     
00002E22  4A79 00003012           2327              TST.W   (NPROJ)
00002E28  6700 0006               2328              BEQ     .NOPROJ2
00002E2C  4EB8 12FA               2329              JSR     AGLPLOT
00002E30  6000 FCB6               2330  .NOPROJ2    BRA     PLAYERPLOT
00002E34                          2331  
00002E34                          2332  
00002E34                          2333  
00002E34                          2334  
00002E34                          2335  
00002E34                          2336  
00002E34                          2337  
00002E34                          2338  
00002E34                          2339  -------------------- end include --------------------
00002E34                          2340              INCLUDE "INTRO.X68"
00002E34                          2341  ; ==============================================================================
00002E34                          2342  ; INTRO SCREEN
00002E34                          2343  ; ==============================================================================
00002E34                          2344  
00002E34                          2345  ; ------------------------------------------------------------------------------
00002E34                          2346  ISCUPD
00002E34                          2347  ; INTRO SCREEN UPDATE
00002E34                          2348  ; INPUT    : NONE
00002E34                          2349  ; OUTPUT   : NONE
00002E34                          2350  ; MODIFIES : NONE
00002E34                          2351  ; ------------------------------------------------------------------------------
00002E34  48E7 E000               2352              MOVEM.L D0-D2,-(A7)
00002E38                          2353              
00002E38  103C 000B               2354              MOVE.B  #11,D0          ; SET POINTER
00002E3C  223C 00D50170           2355              MOVE.L  #BTONPOSX<<16|BTONPOSY,D1
00002E42  4E4F                    2356              TRAP    #15
00002E44                          2357              
00002E44  103C 003D               2358              MOVE.B  #61,D0          ; READ MOUSE
00002E48  123C 0002               2359              MOVE.B  #2,D1           ; MOUSE DOWN STATE
00002E4C  4E4F                    2360              TRAP    #15
00002E4E  0200 000F               2361              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002E52  672E                    2362              BEQ.B   .DONE           ; IF NO CLICK
00002E54                          2363              
00002E54  4282                    2364              CLR.L       D2
00002E56  3401                    2365              MOVE.W      D1,D2       ; D2 IS MOUSE X
00002E58  0442 00D5               2366              SUB.W   #BTONPOSX,D2
00002E5C  6D00 0024               2367              BLT     .DONE
00002E60                          2368              
00002E60  4841                    2369              SWAP        D1          ; D1 IS MOUSE Y
00002E62  0441 0170               2370              SUB.W   #BTONPOSY,D1
00002E66  6D00 001A               2371              BLT     .DONE
00002E6A                          2372              
00002E6A  0C42 00DA               2373              CMPI.W  #BTONWIDTH,D2
00002E6E  6E00 0012               2374              BGT     .DONE
00002E72  0C41 0020               2375              CMPI.W  #BTONHEIGHT,D1
00002E76  6E00 000A               2376              BGT     .DONE           ; IF CLICKED OUTSIDE THE AREA
00002E7A                          2377              
00002E7A                          2378              
00002E7A  33FC 0001 00003086      2379              MOVE.W  #1,(STANEXT)
00002E82                          2380  .DONE
00002E82  4CDF 0007               2381              MOVEM.L (A7)+,D0-D2
00002E86  4E75                    2382              RTS
00002E88                          2383  ; ------------------------------------------------------------------------------
00002E88                          2384  ISCPLOT
00002E88                          2385  ; INTRO SCREEN PLOT
00002E88                          2386  ; INPUT    : NONE
00002E88                          2387  ; OUTPUT   : NONE
00002E88                          2388  ; MODIFIES : NONE
00002E88                          2389  ; ------------------------------------------------------------------------------
00002E88  48E7 F880               2390              MOVEM.L D0-D4/A0,-(A7)
00002E8C                          2391              
00002E8C  303C 0050               2392              MOVE.W  #80, D0
00002E90  223C 00FFFFFF           2393              MOVE.L  #$00FFFFFF, D1 ; PEN COLOR
00002E96  4E4F                    2394              TRAP    #15
00002E98                          2395              
00002E98  303C 0057               2396              MOVE.W  #87, D0
00002E9C  323C 00D5               2397              MOVE.W  #BTONPOSX, D1 ; DRAW BUTTON
00002EA0  343C 0170               2398              MOVE.W  #BTONPOSY, D2
00002EA4  363C 01AF               2399              MOVE.W  #BTONPOSX+BTONWIDTH, D3
00002EA8  383C 0190               2400              MOVE.W  #BTONPOSY+BTONHEIGHT, D4
00002EAC  4E4F                    2401              TRAP    #15
00002EAE                          2402              
00002EAE  4281                    2403              CLR.L   D1
00002EB0  103C 0051               2404              MOVE.B  #81,D0
00002EB4  4E4F                    2405              TRAP    #15
00002EB6                          2406              
00002EB6  41F9 00002EE4           2407              LEA     .TITLE,A0
00002EBC  103C 000A               2408              MOVE.B  #10,D0
00002EC0  4EB8 1336               2409              JSR     UTLPRINT
00002EC4                          2410              
00002EC4  0839 0004 00003009      2411              BTST.B  #4,(SCRCYCCT)
00002ECC  6700 0010               2412              BEQ     .DONE
00002ED0                          2413              
00002ED0  41F9 00002F10           2414              LEA     .HINT,A0
00002ED6  103C 0019               2415              MOVE.B  #25,D0
00002EDA  4EB8 1336               2416              JSR     UTLPRINT
00002EDE                          2417              
00002EDE  4CDF 011F               2418  .DONE       MOVEM.L (A7)+,D0-D4/A0
00002EE2                          2419  
00002EE2  4E75                    2420              RTS
00002EE4= 50 41 54 45 52 4E ...   2421  .TITLE      DC.B    'PATERNOSTER: Beyond the pillars of Hercules',0
00002F10= 43 4C 49 43 4B 20 ...   2422  .HINT       DC.B    'CLICK HERE TO START',0
00002F24                          2423              DS.W    0
00002F24                          2424  
00002F24                          2425  
00002F24                          2426  
00002F24                          2427  
00002F24                          2428  
00002F24                          2429  
00002F24                          2430  
00002F24                          2431  
00002F24                          2432  
00002F24                          2433  
00002F24                          2434  -------------------- end include --------------------
00002F24                          2435              INCLUDE "ENDGAME.X68"
00002F24                          2436  ; ==============================================================================
00002F24                          2437  ; VICTORY SCREEN
00002F24                          2438  ; ==============================================================================
00002F24                          2439  
00002F24                          2440  ; ------------------------------------------------------------------------------
00002F24                          2441  ENDGINIT
00002F24                          2442  ; END GAME SCREEN INIT
00002F24                          2443  ; INPUT    : NONE
00002F24                          2444  ; OUTPUT   : NONE
00002F24                          2445  ; MODIFIES : NONE
00002F24                          2446  ; ------------------------------------------------------------------------------
00002F24                          2447  
00002F24                          2448              ; GUARDAR SU RECORD EN UN FICHERO
00002F24                          2449              ; LEER FICHERO QUE GUARDE LOS RECORDS Y GUARDAR EN MEMORIA
00002F24  4E75                    2450              RTS
00002F26                          2451  ; ------------------------------------------------------------------------------
00002F26                          2452  ENDGUPD
00002F26                          2453  ; END GAME SCREEN UPDATE
00002F26                          2454  ; INPUT    : NONE
00002F26                          2455  ; OUTPUT   : NONE
00002F26                          2456  ; MODIFIES : NONE
00002F26                          2457  ; ------------------------------------------------------------------------------
00002F26  103C 003D               2458              MOVE.B  #61,D0          ; READ MOUSE
00002F2A  123C 0002               2459              MOVE.B  #2,D1           ; MOUSE DOWN STATE
00002F2E  4E4F                    2460              TRAP    #15
00002F30  0200 000F               2461              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002F34  6708                    2462              BEQ.B   .DONE           ; IF NO CLICK
00002F36  33FC 0001 00003086      2463              MOVE.W  #1,(STANEXT)
00002F3E                          2464  .DONE
00002F3E  4E75                    2465              RTS
00002F40                          2466  
00002F40                          2467  ; ------------------------------------------------------------------------------
00002F40                          2468  ENDGPLOT
00002F40                          2469  ; END GAME SCREEN PLOT
00002F40                          2470  ; INPUT    : NONE
00002F40                          2471  ; OUTPUT   : NONE
00002F40                          2472  ; MODIFIES : NONE
00002F40                          2473  ; ------------------------------------------------------------------------------
00002F40  48E7 C080               2474              MOVEM.L D0-D1/A0,-(A7)
00002F44                          2475              
00002F44  4281                    2476              CLR.L   D1
00002F46  103C 0051               2477              MOVE.B  #81,D0
00002F4A  4E4F                    2478              TRAP    #15
00002F4C                          2479              
00002F4C  41F9 00002F88           2480              LEA     .TXT1,A0
00002F52  103C 000A               2481              MOVE.B  #10,D0
00002F56  4EB8 1336               2482              JSR     UTLPRINT
00002F5A                          2483              
00002F5A  0839 0008 00003009      2484              BTST.B  #8,(SCRCYCCT)
00002F62  6700 0010               2485              BEQ     .NOTPRINT
00002F66                          2486              
00002F66  41F9 00002FA2           2487              LEA     .TXT2,A0
00002F6C  103C 0019               2488              MOVE.B  #25,D0
00002F70  4EB8 1336               2489              JSR     UTLPRINT
00002F74                          2490              
00002F74                          2491  .NOTPRINT
00002F74  41F9 00002FBA           2492              LEA     .TXT3,A0
00002F7A  103C 0019               2493              MOVE.B  #25,D0
00002F7E  4EB8 1336               2494              JSR     UTLPRINT
00002F82                          2495              
00002F82                          2496              ; MOSTRAR FICHERO QUE GUARDE LOS RECORDS
00002F82                          2497              
00002F82  4CDF 0103               2498              MOVEM.L (A7)+,D0-D1/A0
00002F86                          2499  
00002F86  4E75                    2500              RTS
00002F88= 59 4F 55 52 20 52 ...   2501  .TXT1       DC.B    'YOUR RECORD THIS TIME WAS',0
00002FA2= 43 4C 49 43 4B 20 ...   2502  .TXT2       DC.B    'CLICK ANYWHERE TO START',0
00002FBA= 48 45 52 45 20 41 ...   2503  .TXT3       DC.B    'HERE ARE THE BEST RECORDS',0
00002FD4                          2504              DS.W    0
00002FD4                          2505  
00002FD4                          2506  
00002FD4                          2507  
00002FD4                          2508  
00002FD4                          2509  
00002FD4                          2510  -------------------- end include --------------------
00002FD4                          2511  START
00002FD4                          2512  
00002FD4                          2513  ; --- INITIALIZATION -----------------------------------------------------------
00002FD4                          2514  
00002FD4  007C 0700               2515              ORI.W   #$0700,SR
00002FD8  4EB8 110A               2516              JSR     SYSINIT
00002FDC  4EB8 2D2C               2517              JSR     STAINIT
00002FE0                          2518  
00002FE0                          2519  .LOOP
00002FE0                          2520  
00002FE0                          2521  ; --- UPDATE -------------------------------------------------------------------
00002FE0                          2522  
00002FE0                          2523  ; READ INPUT DEVICES
00002FE0                          2524  
00002FE0  4E41                    2525              TRAP    #KBDUPTN
00002FE2                          2526  
00002FE2                          2527  ; UPDATE GAME LOGIC
00002FE2                          2528  
00002FE2  4EB8 2D3C               2529              JSR     STAUPD
00002FE6                          2530  
00002FE6                          2531  ; --- SYNC ---------------------------------------------------------------------
00002FE6                          2532  
00002FE6  4A39 00003008           2533  .WINT       TST.B   (SCRINTCT)
00002FEC  67F8                    2534              BEQ     .WINT
00002FEE  4239 00003008           2535              CLR.B   (SCRINTCT)
00002FF4  5239 0000300A           2536              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
00002FFA                          2537  
00002FFA                          2538  ; --- PLOT ---------------------------------------------------------------------
00002FFA                          2539              
00002FFA  4EB8 2D9A               2540              JSR     STAPLOT
00002FFE                          2541              
00002FFE  4E40                    2542              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
00003000                          2543  
00003000  60DE                    2544              BRA     .LOOP
00003002                          2545              
00003002  FFFF FFFF               2546              SIMHALT
00003006                          2547              
00003006                          2548              INCLUDE "VARS.X68"
00003006                          2549  ; ==============================================================================
00003006                          2550  ; VARIABLES
00003006                          2551  ; ==============================================================================
00003006                          2552              
00003006                          2553  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
00003006                          2554              
00003006                          2555  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
00003007                          2556  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
00003008                          2557  
00003008                          2558  
00003008                          2559  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
00003008                          2560  
00003008                          2561  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00003009                          2562  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
0000300A                          2563  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
0000300C                          2564              DS.W    0
0000300C                          2565  
0000300C                          2566  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
0000300C                          2567  
0000300C= 0064                    2568  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
0000300E= 0140                    2569  PLAYERPOSX      DC.W    SCRWIDTH/2
00003010= 00F0                    2570  PLAYERPOSY      DC.W    SCRHEIGH/2
00003012                          2571  
00003012                          2572  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
00003012                          2573  
00003012= 0000                    2574  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
00003014                          2575  
00003014                          2576  ; --- BLOCKS RELATED VARIABLES -------------------------------------------------
00003014                          2577  
00003014= 0000                    2578  BPOSX1      DC.W    0
00003016= 0000                    2579  BPOSY1      DC.W    0
00003018= 0020                    2580  BPOSX2      DC.W    32
0000301A= 0020                    2581  BPOSY2      DC.W    32
0000301C= 02 03 00                2582  BLWHICHCOLL DC.B    2,3,0 ; BLOCKS WHICH PRODUCES COLLISIONS, ENDS WITH NULL
0000301F                          2583  
0000301F                          2584  ; --- MAP RELATED VARIABLES ----------------------------------------------------
0000301F                          2585  
00003020= 0000                    2586  LOADEDMAP   DC.W    0                       ; CURRENT MAP
00003022= 000019EC 00001A34 ...   2587  MAPUPDLIST  DC.L    MAPA1,MAPA2,MAPA3,MAPA4,MAPA5,MAPA6,MAPA7,MAPA8
00003042= 00001DB2 00001F02 ...   2588  MAPLIST     DC.L    HEAVEN_0,HEAVEN_1,HEAVEN_END,HEAVEN_ROOM,HELL_0,HELL_1,HELL_END,HELL_ROOM,0 
00003066                          2589  
00003066                          2590  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
00003066                          2591  
00003066= 00                      2592  MUSICPLAYED DC.B    0
00003068                          2593              DS.W    0
00003068                          2594  
00003068                          2595  ; --- FPS RELATED VARIABLES ----------------------------------------------------
00003068                          2596  
00003068                          2597  REALFPS     DS.W    1
0000306A= 47 4F 41 4C 3A 20 00    2598  STRFPS1     DC.B    'GOAL: ',0   ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
00003071= 46 50 53 20 2D 20 ...   2599  STRFPS2     DC.B    'FPS - ACTUAL: ',0
00003080= 46 50 53 00             2600  STRFPS3     DC.B    'FPS',0
00003084                          2601  
00003084                          2602  ; --- STATE RELATED VARIABLES --------------------------------------------------
00003084                          2603  
00003084                          2604  STACUR      DS.W    1                       ; CURRENT STATE
00003086                          2605  STANEXT     DS.W    1                       ; NEXT STATE
00003088                          2606  
00003088                          2607  
00003088                          2608  
00003088                          2609  
00003088                          2610  
00003088                          2611  
00003088                          2612  
00003088                          2613  
00003088                          2614  
00003088                          2615  
00003088                          2616  
00003088                          2617  
00003088                          2618  
00003088                          2619  -------------------- end include --------------------
00003088                          2620              INCLUDE "LIB/UTLVARS.X68"
00003088                          2621  ; =============================================================================
00003088                          2622  ; UTILITY VARIABLES
00003088                          2623  ; =============================================================================
00003088                          2624  
00003088                          2625  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000308A                          2626              DS.W    0
0000308A                          2627  -------------------- end include --------------------
0000308A                          2628              INCLUDE "LIB/DMMVARS.X68"
0000308A                          2629  ; =============================================================================
0000308A                          2630  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
0000308A                          2631  ; =============================================================================
0000308A                          2632  
000030C0                          2633              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
000030C0                          2634  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00003D40                          2635              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00003D40                          2636  -------------------- end include --------------------
00003D40                          2637  
00003D40                          2638              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12BC
AGLADD:END          12D2
AGLKILL             10F4
AGLPLOT             12FA
AGLPLOT:END         131A
AGLPLOT:LOOP        1302
AGLUPD              12D6
AGLUPD:END          12F4
AGLUPD:LOOP         12DE
AUDINIT             2C32
AUDPLAY             2C66
BLKCOLL             14A6
BLOCKSCOL           F
BLOCKSIZE           20
BLOCKSROW           14
BLWHICHCOLL         301C
BPOSX1              3014
BPOSX2              3018
BPOSY1              3016
BPOSY2              301A
BTONHEIGHT          20
BTONPOSX            D5
BTONPOSY            170
BTONWIDTH           DA
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                16F6
DBHV                176A
DDHL                1620
DDHV                1640
DF1HL               1894
DF1HV               1874
DF2HL               1906
DF2HV               18B4
DGHE                1660
DGHL                17DE
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             30C0
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           1958
ELEVATORINIT        27A2
ELEVATORMUSIC       2CAE
ELEVATORPLOT        27A6
ELEVATORUPDATE      29BE
ELEVATORUPDATE:HLSEL  29F8
ELEVATORUPDATE:HVSEL  29DE
ELEVATOR_MUSIC      100F
ENDBLOCK            19B0
ENDGINIT            2F24
ENDGPLOT            2F40
ENDGPLOT:NOTPRINT   2F74
ENDGPLOT:TXT1       2F88
ENDGPLOT:TXT2       2FA2
ENDGPLOT:TXT3       2FBA
ENDGUPD             2F26
ENDGUPD:DONE        2F3E
ENDMAP              19C2
FIREDSOUND          2D10
FPSTEXTPOS          2D01
FRAMES_PER_SECOND   32
GAMPLOT             2E1E
GAMPLOT:NOPROJ2     2E30
GAMUPD              2DC8
GAMUPD:NOMUSIC      2DDE
GAMUPD:NOPROJ1      2E18
GAMUPD:NOTFIRED     2E0A
HEAVENMUSIC         2CCC
HEAVENSOUND         1000
HEAVEN_0            1DB2
HEAVEN_1            1F02
HEAVEN_END          203D
HEAVEN_ROOM         2178
HELLMUSIC           2CEE
HELLSOUND           1026
HELL_0              22B3
HELL_1              23EE
HELL_END            2529
HELL_ROOM           2664
ISBLWHICHCOLL       1486
ISBLWHICHCOLL:BCOLL  1498
ISBLWHICHCOLL:BEND  14A4
ISBLWHICHCOLL:BNEXTCHCK  148C
ISBLWHICHCOLL:BNOCOLL  14A2
ISCPLOT             2E88
ISCPLOT:DONE        2EDE
ISCPLOT:HINT        2F10
ISCPLOT:TITLE       2EE4
ISCUPD              2E34
ISCUPD:DONE         2E82
JMPLIST             15D8
KBDDOWN             53
KBDEDGE             3007
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             1260
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              126E
KBDUPD:LOOP         12B2
KBDUPD:PACK         12AE
KBDUPTN             1
KBDVAL              3006
LOADEDMAP           3020
MAP1NODOOR          1A2E
MAP2NODOOR1         1A7C
MAP2NODOOR2         1AB2
MAP2NODOOR3         1AF0
MAP2NODOOR4         1B2E
MAP3NODOOR          1B7C
MAP4NODOOR          1BC4
MAP5NODOOR          1C0C
MAP6NODOOR1         1C5A
MAP6NODOOR2         1C90
MAP6NODOOR3         1CCE
MAP6NODOOR4         1D0C
MAP7NODOOR          1D5C
MAP8NODOOR1         1DAC
MAPA1               19EC
MAPA2               1A34
MAPA3               1B34
MAPA4               1B82
MAPA5               1BCA
MAPA6               1C12
MAPA7               1D12
MAPA8               1D62
MAPLIST             3042
MAPPLOT             1538
MAPSEL              1550
MAPUPD              15B0
MAPUPDLIST          3022
MSCSEL              2C7E
MUSICPLAYED         3066
NEWLINE             198C
NEXT                15CA
NPROJ               3012
PLAYERHEALTH        300C
PLAYERHEIGHT        20
PLAYERPLOT          2AE8
PLAYERPOSX          300E
PLAYERPOSY          3010
PLAYERSPEED         4
PLAYERUPD           2A12
PLAYERUPD:DOWN      2ADC
PLAYERUPD:LEFT      2A64
PLAYERUPD:NODOWN    2AE2
PLAYERUPD:NOLEFT    2A6A
PLAYERUPD:NORIGHT   2ABA
PLAYERUPD:NOUP      2A92
PLAYERUPD:RIGHT     2AB4
PLAYERUPD:UP        2A8C
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            2B30
PROJINIT:FDOWN      2B68
PROJINIT:FRIGHT     2B56
PROJINIT:FUP        2B46
PROJINIT:NOTFDOWN   2B76
PROJINIT:SHOOT      2B80
PROJPLOT            2BF0
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             2B94
PROJUPD:PROJCOLL    2BE4
PROJUPD:PROJNOCOLL  2BDE
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             3068
SCRCYCCT            3009
SCRHEIGH            1E0
SCRINIT             1142
SCRINTCT            3008
SCRINTFPS           300A
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             1198
SCRTIM              1240
SCRTIM1S            124E
SCRUPTN             0
SCRWIDTH            280
STACUR              3084
STAEMPTY            2DC6
STAINIT             2D2C
STANEXT             3086
STANONE             FFFFFFFF
STAPLOT             2D9A
STAPLOT:PLTTBL      2DB6
START               2FD4
START:LOOP          2FE0
START:WINT          2FE6
STAUPD              2D3C
STAUPD:DOUPD        2D62
STAUPD:INITBL       2D7A
STAUPD:UPDTBL       2D8A
STRFPS1             306A
STRFPS2             3071
STRFPS3             3080
SYSINIT             110A
TRIANGLE            2966
TRIANGLE:ISPOSITIVE  29B4
TRIANGLE:UPWARDS    2982
UTLCHRWD            8
UTLINIT             1320
UTLPRINT            1336
UTLPRINT:ENDLOOP    1348
UTLPRINT:LOOP       133E
UTLRAND             1368
UTLRAND:RANDVEC     1386
UTLRNDIX            3088
