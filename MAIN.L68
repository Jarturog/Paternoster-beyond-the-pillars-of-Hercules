000036D2 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 14/01/2023 19:19:18

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7      
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002A01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/15)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000  =00000002                 37  SNDPLTN     EQU     2                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000  =00000004                 45  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 46  PLAYERWIDTH     EQU     32
00001000  =00000020                 47  PLAYERHEIGHT    EQU     32
00001000                            48  
00001000                            49  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            50  
00001000  =00000010                 51  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 52  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 53  PROJSPEEDX      EQU     8
00001000  =00000008                 54  PROJSPEEDY      EQU     8
00001000                            55  
00001000                            56  ; --- MUSIC RELATED CONSTANTS ---------------------------------------------------
00001000= 53 4E 44 2F 4D 55 ...     57  HEAVENSOUND DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     58  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     59  HELLSOUND   DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     60  PROJ_SOUND  DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            61  
00001048                            62  
00001048                            63  
00001048                            64  
00001048                            65  
00001048                            66  
00001048                            67  
00001048                            68  
00001048                            69  -------------------- end include --------------------
00001048                            70              INCLUDE "BLOCKS.X68"
00001048                            71      
00001048                            72  MAPPLOT
00001048  48E7 FF00                 73          MOVEM.L D0-D7, -(A7)
0000104C  48E7 00FE                 74          MOVEM.L A0-A6, -(A7)
00001050  3239 00003782             75             MOVE.W LOADEDMAP, D1
00001056  C2FC 000C                 76             MULU #12, D1
0000105A  3241                      77             MOVEA.W D1, A1
0000105C  4EE9 1060                 78             JMP MAPSEL(A1)
00001060                            79  MAPSEL:
00001060  4EF9 000022EE             80             JMP ELEVATORPLOT
00001066  4EF9 00001118             81             JMP NEXT
0000106C  41F9 00001900             82             LEA HEAVEN_0, A0
00001072  4EF9 00001118             83             JMP NEXT
00001078  41F9 00001A50             84             LEA HEAVEN_1, A0
0000107E  4EF9 00001118             85             JMP NEXT
00001084  41F9 00001B8B             86             LEA HEAVEN_END, A0
0000108A  4EF9 00001118             87             JMP NEXT
00001090  41F9 00001CC6             88             LEA HEAVEN_ROOM, A0
00001096  4EF9 00001118             89             JMP NEXT
0000109C  41F9 00001E01             90             LEA HELL_0, A0
000010A2  4EF9 00001118             91             JMP NEXT
000010A8  41F9 00001F3C             92             LEA HELL_1, A0
000010AE  4EF9 00001118             93             JMP NEXT
000010B4  41F9 00002077             94             LEA HELL_END, A0
000010BA  4EF9 00001118             95             JMP NEXT
000010C0  41F9 000021B2             96             LEA HELL_ROOM, A0
000010C6  4EF9 00001118             97             JMP NEXT
000010CC                            98  MAPUPD
000010CC                            99              
000010CC  3F00                     100              MOVE.W D0, -(A7)
000010CE  3039 00003782            101              MOVE.W LOADEDMAP, D0
000010D4  B07C 0001                102              CMP #1, D0
000010D8  6700 0460                103              BEQ MAPA1
000010DC  B07C 0002                104              CMP #2, D0
000010E0  6700 04A0                105              BEQ MAPA2
000010E4  B07C 0003                106              CMP #3, D0
000010E8  6700 0598                107              BEQ MAPA3
000010EC  B07C 0004                108              CMP #4, D0
000010F0  6700 05DE                109              BEQ MAPA4
000010F4  B07C 0005                110              CMP #5, D0
000010F8  6700 061E                111              BEQ MAPA5
000010FC  B07C 0006                112              CMP #6, D0
00001100  6700 065E                113              BEQ MAPA6
00001104  B07C 0007                114              CMP #7, D0
00001108  6700 0756                115              BEQ MAPA7
0000110C  B07C 0008                116              CMP #8, D0
00001110  6700 079E                117              BEQ MAPA8
00001114  301F                     118              MOVE.W (A7)+, D0
00001116  4E75                     119              RTS
00001118                           120  
00001118                           121      
00001118                           122              
00001118                           123  NEXT
00001118  4281                     124             CLR.L D1
0000111A  1218                     125             MOVE.B (A0)+,D1
0000111C  C2FC 0006                126             MULU #6, D1
00001120  2241                     127             MOVEA.L D1, A1
00001122  4EE9 1126                128             JMP JMPLIST(A1)
00001126                           129             
00001126                           130  JMPLIST: 
00001126  4EF9 000014DA            131              JMP NEWLINE ; 0 = END OF ROW
0000112C  4EF9 000011AE            132              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
00001132  4EF9 00001244            133              JMP DBHL    ; 2 = DRAW BRICK HELL
00001138  4EF9 000012B8            134              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
0000113E  4EF9 0000132C            135              JMP DGHL    ; 4 = DRAW GRASS HELL
00001144  4EF9 000013C2            136              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
0000114A  4EF9 000013E2            137              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
00001150  4EF9 00001402            138              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
00001156  4EF9 0000116E            139              JMP DDHL    ; 8 = DRAW DOOR HELL
0000115C  4EF9 0000118E            140              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
00001162  4EF9 00001454            141              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
00001168  4EF9 00001510            142              JMP ENDMAP  ; 11 = END OF THE MAP
0000116E                           143              
0000116E                           144  DDHL
0000116E  2F3C 00111111            145      MOVE.L #$00111111, -(A7)
00001174  2F3C 00111111            146      MOVE.L #$00111111, -(A7)
0000117A  4EB9 000014A6            147      JSR DRAWBLOCK
00001180  2C1F                     148      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001182  2C1F                     149      MOVE.L (A7)+, D6    
00001184  4EB9 000014FE            150      JSR ENDBLOCK
0000118A  4EF8 1118                151      JMP NEXT
0000118E                           152  DDHV
0000118E  2F3C 00FFFFFF            153      MOVE.L #$00FFFFFF, -(A7)
00001194  2F3C 00FFFFFF            154      MOVE.L #$00FFFFFF, -(A7)
0000119A  4EB9 000014A6            155      JSR DRAWBLOCK
000011A0  2C1F                     156      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000011A2  2C1F                     157      MOVE.L (A7)+, D6
000011A4  4EB9 000014FE            158      JSR ENDBLOCK
000011AA  4EF8 1118                159      JMP NEXT
000011AE                           160  DGHE ;DRAW-GRASS-HEAVEN vvvR
000011AE  2F3C 0099FF99            161      MOVE.L #$0099FF99, -(A7)
000011B4  2F3C 0099FF99            162      MOVE.L #$0099FF99, -(A7)
000011BA  4EB9 000014A6            163      JSR DRAWBLOCK
000011C0  2C1F                     164      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000011C2  2C1F                     165      MOVE.L (A7)+, D6
000011C4                           166      ; SET PEN COLOR 
000011C4  103C 0050                167      MOVE.B #80, D0
000011C8  223C 0000CC00            168      MOVE.L #$0000CC00, D1
000011CE  4E4F                     169      TRAP #15
000011D0                           170      ;DRAW LINES   
000011D0  103C 0054                171      MOVE.B #84, D0 
000011D4                           172      ;LINEA 11 
000011D4  3239 0000377A            173      MOVE.W BPOSX1,D1
000011DA  5C41                     174      ADD.W #6, D1
000011DC  3439 0000377C            175      MOVE.W BPOSY1, D2
000011E2  5A42                     176      ADD.W #5, D2
000011E4  3639 0000377A            177      MOVE.W BPOSX1, D3
000011EA  0643 0009                178      ADD.W #9, D3
000011EE  3839 0000377C            179      MOVE.W BPOSY1, D4
000011F4  0644 000A                180      ADD.W #10, D4
000011F8  4E4F                     181      TRAP #15
000011FA                           182      ;LINEA 12
000011FA  5041                     183      ADD.W #8, D1    
000011FC  5043                     184      ADD.W #8, D3
000011FE  4E4F                     185      TRAP #15
00001200                           186      ;LINEA 13
00001200  5041                     187      ADD.W #8, D1    
00001202  5043                     188      ADD.W #8, D3
00001204  4E4F                     189      TRAP #15
00001206                           190      ;LINEA 21
00001206  3239 0000377A            191      MOVE.W BPOSX1,D1
0000120C  5C41                     192      ADD.W #6, D1
0000120E  3439 0000377C            193      MOVE.W BPOSY1, D2
00001214  0642 0014                194      ADD.W #20, D2
00001218  3639 0000377A            195      MOVE.W BPOSX1, D3
0000121E  0643 0009                196      ADD.W #9, D3
00001222  3839 0000377C            197      MOVE.W BPOSY1, D4
00001228  0644 0019                198      ADD.W #25, D4
0000122C  4E4F                     199      TRAP #15
0000122E                           200      ;LINEA 22
0000122E  5041                     201      ADD.W #8, D1    
00001230  5043                     202      ADD.W #8, D3
00001232  4E4F                     203      TRAP #15
00001234                           204      ;LINEA 23
00001234  5041                     205      ADD.W #8, D1    
00001236  5043                     206      ADD.W #8, D3
00001238  4E4F                     207      TRAP #15
0000123A  4EB9 000014FE            208      JSR ENDBLOCK
00001240  4EF8 1118                209      JMP NEXT
00001244                           210  DBHL ;DRAW BRICK-HELL vvvR
00001244                           211      
00001244  2F3C 00010101            212      MOVE.L #$00010101, -(A7)
0000124A  2F3C 00666666            213      MOVE.L #$00666666, -(A7)
00001250  4EB9 000014A6            214      JSR DRAWBLOCK
00001256  2C1F                     215      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001258  2C1F                     216      MOVE.L (A7)+, D6
0000125A                           217      ;DRAW HORIZONTAL LINE
0000125A  103C 0054                218      MOVE.B #84, D0 
0000125E  3239 0000377A            219      MOVE.W BPOSX1, D1
00001264  3439 0000377C            220      MOVE.W BPOSY1, D2
0000126A  0642 0010                221      ADD.W #16, D2
0000126E  3639 0000377A            222      MOVE.W BPOSX1, D3
00001274  0643 0020                223      ADD.W #32, D3
00001278  3839 0000377C            224      MOVE.W BPOSY1, D4
0000127E  0644 0010                225      ADD.W #16, D4
00001282  4E4F                     226      TRAP #15
00001284                           227      ;DRAW VERTICAL LINE 
00001284  3239 0000377A            228      MOVE.W BPOSX1, D1
0000128A  0641 0010                229      ADD.W #16, D1
0000128E  3439 0000377C            230      MOVE.W BPOSY1, D2
00001294  0642 0010                231      ADD.W #16, D2
00001298  3639 0000377A            232      MOVE.W BPOSX1, D3
0000129E  0643 0010                233      ADD.W #16, D3
000012A2  3839 0000377C            234      MOVE.W BPOSY1, D4
000012A8  0644 0020                235      ADD.W #32, D4
000012AC  4E4F                     236      TRAP #15
000012AE  4EB9 000014FE            237      JSR ENDBLOCK    
000012B4  4EF8 1118                238      JMP NEXT
000012B8                           239  DBHV ;DRAW BRICK-HEAVEN vvvR
000012B8                           240      
000012B8  2F3C 00CCCCCC            241      MOVE.L #$00CCCCCC, -(A7)
000012BE  2F3C 00D7EBFA            242      MOVE.L #$00D7EBFA, -(A7)
000012C4  4EB9 000014A6            243      JSR DRAWBLOCK
000012CA  2C1F                     244      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000012CC  2C1F                     245      MOVE.L (A7)+, D6
000012CE                           246      ;DRAW HORIZONTAL LINE
000012CE  103C 0054                247      MOVE.B #84, D0 
000012D2  3239 0000377A            248      MOVE.W BPOSX1, D1
000012D8  3439 0000377C            249      MOVE.W BPOSY1, D2
000012DE  0642 0010                250      ADD.W #16, D2
000012E2  3639 0000377A            251      MOVE.W BPOSX1, D3
000012E8  0643 0020                252      ADD.W #32, D3
000012EC  3839 0000377C            253      MOVE.W BPOSY1, D4
000012F2  0644 0010                254      ADD.W #16, D4
000012F6  4E4F                     255      TRAP #15
000012F8                           256      ;DRAW VERTICAL LINE 
000012F8  3239 0000377A            257      MOVE.W BPOSX1, D1
000012FE  0641 0010                258      ADD.W #16, D1
00001302  3439 0000377C            259      MOVE.W BPOSY1, D2
00001308  0642 0010                260      ADD.W #16, D2
0000130C  3639 0000377A            261      MOVE.W BPOSX1, D3
00001312  0643 0010                262      ADD.W #16, D3
00001316  3839 0000377C            263      MOVE.W BPOSY1, D4
0000131C  0644 0020                264      ADD.W #32, D4
00001320  4E4F                     265      TRAP #15 
00001322  4EB9 000014FE            266      JSR ENDBLOCK
00001328  4EF8 1118                267      JMP NEXT
0000132C                           268  DGHL ;DRAW GRASS HELL vvvR
0000132C                           269  
0000132C  2F3C 002255EE            270      MOVE.L #$002255EE, -(A7)
00001332  2F3C 002255EE            271      MOVE.L #$002255EE, -(A7)
00001338  4EB9 000014A6            272      JSR DRAWBLOCK
0000133E  2C1F                     273      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001340  2C1F                     274      MOVE.L (A7)+, D6
00001342                           275      ; SET PEN COLOR 
00001342  103C 0050                276      MOVE.B #80, D0
00001346  223C 000000CC            277      MOVE.L #$000000CC, D1
0000134C  4E4F                     278      TRAP #15
0000134E                           279      ;DRAW LINES   
0000134E  103C 0054                280      MOVE.B #84, D0 
00001352                           281      ;LINEA 11 
00001352  3239 0000377A            282      MOVE.W BPOSX1,D1
00001358  5C41                     283      ADD.W #6, D1
0000135A  3439 0000377C            284      MOVE.W BPOSY1, D2
00001360  5A42                     285      ADD.W #5, D2
00001362  3639 0000377A            286      MOVE.W BPOSX1, D3
00001368  0643 0009                287      ADD.W #9, D3
0000136C  3839 0000377C            288      MOVE.W BPOSY1, D4
00001372  0644 000A                289      ADD.W #10, D4
00001376  4E4F                     290      TRAP #15
00001378                           291      ;LINEA 12
00001378  5041                     292      ADD.W #8, D1    
0000137A  5043                     293      ADD.W #8, D3
0000137C  4E4F                     294      TRAP #15
0000137E                           295      ;LINEA 13
0000137E  5041                     296      ADD.W #8, D1    
00001380  5043                     297      ADD.W #8, D3
00001382  4E4F                     298      TRAP #15
00001384                           299      ;LINEA 21
00001384  3239 0000377A            300      MOVE.W BPOSX1,D1
0000138A  5C41                     301      ADD.W #6, D1
0000138C  3439 0000377C            302      MOVE.W BPOSY1, D2
00001392  0642 0014                303      ADD.W #20, D2
00001396  3639 0000377A            304      MOVE.W BPOSX1, D3
0000139C  0643 0009                305      ADD.W #9, D3
000013A0  3839 0000377C            306      MOVE.W BPOSY1, D4
000013A6  0644 0019                307      ADD.W #25, D4
000013AA  4E4F                     308      TRAP #15
000013AC                           309      ;LINEA 22
000013AC  5041                     310      ADD.W #8, D1    
000013AE  5043                     311      ADD.W #8, D3
000013B0  4E4F                     312      TRAP #15
000013B2                           313      ;LINEA 23
000013B2  5041                     314      ADD.W #8, D1    
000013B4  5043                     315      ADD.W #8, D3
000013B6  4E4F                     316      TRAP #15
000013B8  4EB9 000014FE            317      JSR ENDBLOCK
000013BE  4EF8 1118                318      JMP NEXT
000013C2                           319  
000013C2                           320  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
000013C2  2F3C 00CCCCCC            321      MOVE.L #$00CCCCCC, -(A7)
000013C8  2F3C 00C6DAE9            322      MOVE.L #$00C6DAE9, -(A7)
000013CE  4EB9 000014A6            323      JSR DRAWBLOCK
000013D4  2C1F                     324      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000013D6  2C1F                     325      MOVE.L (A7)+, D6
000013D8  4EB9 000014FE            326      JSR ENDBLOCK
000013DE  4EF8 1118                327      JMP NEXT
000013E2                           328  DF1HL ; DRAW FLOOR_1 HELL vvvR 
000013E2  2F3C 00010101            329      MOVE.L #$00010101, -(A7)
000013E8  2F3C 00777777            330      MOVE.L #$00777777, -(A7)
000013EE  4EB9 000014A6            331      JSR DRAWBLOCK
000013F4  2C1F                     332      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000013F6  2C1F                     333      MOVE.L (A7)+, D6
000013F8                           334  
000013F8  4EB9 000014FE            335      JSR ENDBLOCK
000013FE  4EF8 1118                336      JMP NEXT
00001402                           337      
00001402                           338  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
00001402  2F3C 00CCCCCC            339      MOVE.L #$00CCCCCC, -(A7)
00001408  2F3C 00C6DAE9            340      MOVE.L #$00C6DAE9, -(A7)
0000140E  4EB9 000014A6            341      JSR DRAWBLOCK
00001414  2C1F                     342      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001416  2C1F                     343      MOVE.L (A7)+, D6
00001418                           344      ;SET NEW FILL COLOR  
00001418  103C 0051                345      MOVE.B #81, D0
0000141C  223C 00D7EBFA            346      MOVE.L #$00D7EBFA, D1
00001422  4E4F                     347      TRAP #15 
00001424                           348      ;DRAW INSIDE SQUARE 
00001424  103C 0057                349      MOVE.B #87, D0
00001428  3239 0000377A            350      MOVE.W BPOSX1, D1
0000142E  5041                     351      ADD.W #8, D1
00001430  3439 0000377C            352      MOVE.W BPOSY1, D2
00001436  5042                     353      ADD.W #8, D2
00001438  3639 0000377E            354      MOVE.W BPOSX2, D3
0000143E  5143                     355      SUB.W #8, D3
00001440  3839 00003780            356      MOVE.W BPOSY2, D4
00001446  5144                     357      SUB.W #8, D4
00001448  4E4F                     358      TRAP #15
0000144A  4EB9 000014FE            359      JSR ENDBLOCK
00001450  4EF8 1118                360      JMP NEXT
00001454                           361  DF2HL ; DRAW FLOOR_2 HELL vvvR
00001454  2F3C 00010101            362      MOVE.L #$00010101, -(A7)
0000145A  2F3C 00777777            363      MOVE.L #$00777777, -(A7)
00001460  4EB9 000014A6            364      JSR DRAWBLOCK
00001466  2C1F                     365      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001468  2C1F                     366      MOVE.L (A7)+, D6
0000146A                           367      ;SET NEW FILL COLOR  
0000146A  103C 0051                368      MOVE.B #81, D0
0000146E  223C 00666666            369      MOVE.L #$00666666, D1
00001474  4E4F                     370      TRAP #15 
00001476                           371  ;DRAW INSIDE SQUARE 
00001476  103C 0057                372      MOVE.B #87, D0
0000147A  3239 0000377A            373      MOVE.W BPOSX1, D1
00001480  5041                     374      ADD.W #8, D1
00001482  3439 0000377C            375      MOVE.W BPOSY1, D2
00001488  5042                     376      ADD.W #8, D2
0000148A  3639 0000377E            377      MOVE.W BPOSX2, D3
00001490  5143                     378      SUB.W #8, D3
00001492  3839 00003780            379      MOVE.W BPOSY2, D4
00001498  5144                     380      SUB.W #8, D4
0000149A  4E4F                     381      TRAP #15
0000149C  4EB9 000014FE            382      JSR ENDBLOCK
000014A2  4EF8 1118                383      JMP NEXT    
000014A6                           384      
000014A6                           385  DRAWBLOCK 
000014A6                           386  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPUÉS COMO LONGS. 
000014A6                           387      
000014A6                           388      ;SET FILL COLOR  
000014A6  103C 0051                389      MOVE.B #81, D0
000014AA  222F 0004                390      MOVE.L 4(A7), D1
000014AE  4E4F                     391      TRAP #15 
000014B0                           392      
000014B0                           393      ; SET PEN COLOR 
000014B0  103C 0050                394      MOVE.B #80, D0
000014B4  222F 0008                395      MOVE.L 8(A7), D1
000014B8  4E4F                     396      TRAP #15 
000014BA                           397  
000014BA                           398      ;DRAW BLOCK 
000014BA  103C 0057                399      MOVE.B #87, D0
000014BE  3239 0000377A            400      MOVE.W BPOSX1, D1
000014C4  3439 0000377C            401      MOVE.W BPOSY1, D2
000014CA  3639 0000377E            402      MOVE.W BPOSX2, D3
000014D0  3839 00003780            403      MOVE.W BPOSY2, D4
000014D6  4E4F                     404      TRAP #15
000014D8  4E75                     405      RTS
000014DA                           406  
000014DA                           407  NEWLINE
000014DA                           408      ;RESET X POSITION
000014DA  33FC 0000 0000377A       409      MOVE.W #0, BPOSX1
000014E2  33FC 0020 0000377E       410      MOVE.W #32, BPOSX2
000014EA                           411      ;ADD 33 TO Y POSITION
000014EA  0679 0020 0000377C       412      ADD.W #32, BPOSY1
000014F2  0679 0020 00003780       413      ADD.W #32, BPOSY2
000014FA  4EF8 1118                414      JMP NEXT
000014FE                           415     
000014FE                           416  ENDBLOCK
000014FE                           417      ;SET NEW BLOCK POSITION
000014FE  0679 0020 0000377A       418      ADD.W #32, BPOSX1
00001506  0679 0020 0000377E       419      ADD.W #32, BPOSX2
0000150E  4E75                     420      RTS
00001510                           421  ENDMAP
00001510                           422      ;SET DEFAULT BLOCK POSITION
00001510  33FC 0000 0000377A       423      MOVE.W #0, BPOSX1
00001518  33FC 0000 0000377C       424      MOVE.W #0, BPOSY1
00001520  33FC 0020 0000377E       425      MOVE.W #32, BPOSX2
00001528  33FC 0020 00003780       426      MOVE.W #32, BPOSY2
00001530  4CDF 7F00                427      MOVEM.L (A7)+, A0-A6
00001534  4CDF 00FF                428      MOVEM.L (A7)+, D0-D7
00001538  4E75                     429      RTS
0000153A                           430      
0000153A                           431  
0000153A                           432  
0000153A                           433  MAPA1
0000153A  301F                     434      MOVE.W (A7)+, D0
0000153C  48A7 F800                435      MOVEM.W D0-D4, -(A7)
00001540  3039 00003774            436      MOVE.W PLAYERPOSX, D0
00001546  3239 00003776            437      MOVE.W PLAYERPOSY, D1
0000154C                           438      ;GO TO THE NEXT ROOM DOOR
0000154C                           439      ;FIRST LETS CHECH POS X
0000154C  B07C 0160                440      CMP #352, D0  ; BGT = 352 > D0
00001550  6E00 002A                441      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001554  B07C 0120                442      CMP #288, D0
00001558  6D00 0022                443      BLT MAP1NODOOR
0000155C                           444      ;NOW WE CHECK POS Y 
0000155C  B27C 01E0                445      CMP #480, D1  ; 
00001560  6E00 001A                446      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001564  B27C 01C0                447      CMP #448, D1
00001568  6D00 0012                448      BLT MAP1NODOOR
0000156C  33FC 0020 00003776       449      MOVE.W #32, PLAYERPOSY
00001574  33FC 0002 00003782       450      MOVE.W #2, LOADEDMAP
0000157C                           451  MAP1NODOOR
0000157C  4C9F 001F                452      MOVEM.W (A7)+, D0-D4
00001580  4E75                     453      RTS
00001582                           454      
00001582                           455  MAPA2
00001582  301F                     456      MOVE.W (A7)+, D0
00001584  48A7 F800                457      MOVEM.W D0-D4, -(A7)
00001588  3039 00003774            458      MOVE.W PLAYERPOSX, D0
0000158E  3239 00003776            459      MOVE.W PLAYERPOSY, D1
00001594                           460      ;GO TO THE NEXT ROOM DOOR
00001594                           461      ;FIRST LETS CHECK POS X
00001594  B07C 0160                462      CMP #352, D0  ; BGT = 352 > D0
00001598  6E00 0030                463      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
0000159C  B07C 0120                464      CMP #288, D0
000015A0  6D00 0028                465      BLT MAP2NODOOR1
000015A4                           466      ;NOW WE CHECK POS Y 
000015A4  B27C 01E0                467      CMP #480, D1  ; 
000015A8  6E00 0020                468      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000015AC  B27C 01C0                469      CMP #448, D1
000015B0  6D00 0018                470      BLT MAP2NODOOR1
000015B4  33FC 0020 00003776       471      MOVE.W #32, PLAYERPOSY
000015BC  33FC 0003 00003782       472      MOVE.W #3, LOADEDMAP
000015C4  4C9F 001F                473      MOVEM.W (A7)+, D0-D4
000015C8  4E75                     474      RTS
000015CA                           475  MAP2NODOOR1
000015CA                           476      ;GO TO THE PREVIOUS ROOM DOOR
000015CA                           477      ;FIRST LETS CHECK POS X
000015CA  B07C 0160                478      CMP #352, D0  ; BGT = 352 > D0
000015CE  6E00 0030                479      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000015D2  B07C 0120                480      CMP #288, D0
000015D6  6D00 0028                481      BLT MAP2NODOOR2
000015DA                           482      ;NOW WE CHECK POS Y 
000015DA  B27C 0020                483      CMP #32, D1  ; 
000015DE  6E00 0020                484      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000015E2  B27C 0000                485      CMP #0, D1
000015E6  6D00 0018                486      BLT MAP2NODOOR2
000015EA  33FC 01A0 00003776       487      MOVE.W  #416, PLAYERPOSY
000015F2  33FC 0001 00003782       488      MOVE.W #1, LOADEDMAP
000015FA  4C9F 001F                489      MOVEM.W (A7)+, D0-D4
000015FE  4E75                     490      RTS
00001600                           491  
00001600                           492  MAP2NODOOR2
00001600                           493      ;GO TO THE LEFT HEAVEN'S ROOM
00001600  B07C 00A0                494      CMP #160, D0  ; BGT = 352 > D0
00001604  6E00 0038                495      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001608  B07C 0080                496      CMP #128, D0
0000160C  6D00 0030                497      BLT MAP2NODOOR3
00001610                           498      ;NOW WE CHECK POS Y 
00001610  B27C 00AA                499      CMP #170, D1  ; 
00001614  6E00 0028                500      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001618  B27C 0078                501      CMP #120, D1
0000161C  6D00 0020                502      BLT MAP2NODOOR3
00001620  33FC 0130 00003774       503      MOVE.W #$130, PLAYERPOSX
00001628  33FC 00B0 00003776       504      MOVE.W #$0B0, PLAYERPOSY
00001630  33FC 0004 00003782       505      MOVE.W #4, LOADEDMAP
00001638  4C9F 001F                506      MOVEM.W (A7)+, D0-D4
0000163C  4E75                     507      RTS
0000163E                           508  MAP2NODOOR3
0000163E                           509      ;GO TO THE RIGHT HEAVEN'S ROOM
0000163E  B07C 01E0                510      CMP #480, D0  ; BGT = 352 > D0
00001642  6E00 0038                511      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001646  B07C 01C0                512      CMP #448, D0
0000164A  6D00 0030                513      BLT MAP2NODOOR4
0000164E                           514      ;NOW WE CHECK POS Y 
0000164E  B27C 00AA                515      CMP #170, D1  ; 
00001652  6E00 0028                516      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001656  B27C 0078                517      CMP #120, D1
0000165A  6D00 0020                518      BLT MAP2NODOOR4
0000165E  33FC 0130 00003774       519      MOVE.W #$130, PLAYERPOSX
00001666  33FC 00B0 00003776       520      MOVE.W #$0B0, PLAYERPOSY
0000166E  33FC 0004 00003782       521      MOVE.W #4, LOADEDMAP
00001676  4C9F 001F                522      MOVEM.W (A7)+, D0-D4
0000167A  4E75                     523      RTS
0000167C                           524  MAP2NODOOR4
0000167C  4C9F 001F                525      MOVEM.W (A7)+, D0-D4
00001680  4E75                     526      RTS
00001682                           527  MAPA3 
00001682  301F                     528      MOVE.W (A7)+, D0
00001684  48A7 F800                529      MOVEM.W D0-D4, -(A7)
00001688  3039 00003774            530      MOVE.W PLAYERPOSX, D0
0000168E  3239 00003776            531      MOVE.W PLAYERPOSY, D1
00001694                           532      ;GO TO THE PREVIOUS ROOM DOOR
00001694                           533      ;FIRST LETS CHECK POS X
00001694  B07C 0160                534      CMP #352, D0  ; BGT = 352 > D0
00001698  6E00 0030                535      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
0000169C  B07C 0120                536      CMP #288, D0
000016A0  6D00 0028                537      BLT MAP3NODOOR
000016A4                           538      ;NOW WE CHECK POS Y 
000016A4  B27C 0020                539      CMP #32, D1  ; 
000016A8  6E00 0020                540      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000016AC  B27C 0000                541      CMP #0, D1
000016B0  6D00 0018                542      BLT MAP3NODOOR
000016B4  33FC 01A0 00003776       543      MOVE.W  #416, PLAYERPOSY
000016BC  33FC 0002 00003782       544      MOVE.W #2, LOADEDMAP
000016C4  4C9F 001F                545      MOVEM.W (A7)+, D0-D4
000016C8  4E75                     546      RTS
000016CA                           547  MAP3NODOOR
000016CA  4C9F 001F                548      MOVEM.W (A7)+, D0-D4
000016CE  4E75                     549      RTS
000016D0                           550  MAPA4
000016D0  301F                     551      MOVE.W (A7)+, D0
000016D2  48A7 F800                552      MOVEM.W D0-D4, -(A7)
000016D6  3039 00003774            553      MOVE.W PLAYERPOSX, D0
000016DC  3239 00003776            554      MOVE.W PLAYERPOSY, D1
000016E2                           555      ;GO BACK TO 2ND HEAVEN'S ROOM
000016E2  B07C 0180                556      CMP #384, D0  ; BGT = 352 > D0
000016E6  6E00 002A                557      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000016EA  B07C 0104                558      CMP #260, D0
000016EE  6D00 0022                559      BLT MAP4NODOOR
000016F2                           560      ;NOW WE CHECK POS Y 
000016F2  B27C 0080                561      CMP #128, D1  ; 
000016F6  6E00 001A                562      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000016FA  B27C 0060                563      CMP #96, D1
000016FE  6D00 0012                564      BLT MAP4NODOOR
00001702  33FC 00E0 00003774       565      MOVE.W  #224, PLAYERPOSX
0000170A  33FC 0002 00003782       566      MOVE.W #2, LOADEDMAP
00001712                           567  MAP4NODOOR
00001712  4C9F 001F                568      MOVEM.W (A7)+, D0-D4
00001716  4E75                     569      RTS
00001718                           570  ;;;;;;;;;;HELL
00001718                           571  MAPA5
00001718  301F                     572      MOVE.W (A7)+, D0
0000171A  48A7 F800                573      MOVEM.W D0-D4, -(A7)
0000171E  3039 00003774            574      MOVE.W PLAYERPOSX, D0
00001724  3239 00003776            575      MOVE.W PLAYERPOSY, D1
0000172A                           576      ;GO TO THE NEXT ROOM DOOR
0000172A                           577      ;FIRST LETS CHECH POS X
0000172A  B07C 0160                578      CMP #352, D0  ; BGT = 352 > D0
0000172E  6E00 002A                579      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001732  B07C 0120                580      CMP #288, D0
00001736  6D00 0022                581      BLT MAP5NODOOR
0000173A                           582      ;NOW WE CHECK POS Y 
0000173A  B27C 01E0                583      CMP #480, D1  ; 
0000173E  6E00 001A                584      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001742  B27C 01C0                585      CMP #448, D1
00001746  6D00 0012                586      BLT MAP5NODOOR
0000174A  33FC 0020 00003776       587      MOVE.W #32, PLAYERPOSY
00001752  33FC 0006 00003782       588      MOVE.W #6, LOADEDMAP
0000175A                           589  MAP5NODOOR
0000175A  4C9F 001F                590      MOVEM.W (A7)+, D0-D4
0000175E  4E75                     591      RTS
00001760                           592      
00001760                           593  MAPA6
00001760  301F                     594      MOVE.W (A7)+, D0
00001762  48A7 F800                595      MOVEM.W D0-D4, -(A7)
00001766  3039 00003774            596      MOVE.W PLAYERPOSX, D0
0000176C  3239 00003776            597      MOVE.W PLAYERPOSY, D1
00001772                           598      ;GO TO THE NEXT ROOM DOOR
00001772                           599      ;FIRST LETS CHECK POS X
00001772  B07C 0160                600      CMP #352, D0  ; BGT = 352 > D0
00001776  6E00 0030                601      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
0000177A  B07C 0120                602      CMP #288, D0
0000177E  6D00 0028                603      BLT MAP6NODOOR1
00001782                           604      ;NOW WE CHECK POS Y 
00001782  B27C 01E0                605      CMP #480, D1  ; 
00001786  6E00 0020                606      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
0000178A  B27C 01C0                607      CMP #448, D1
0000178E  6D00 0018                608      BLT MAP6NODOOR1
00001792  33FC 0020 00003776       609      MOVE.W #32, PLAYERPOSY
0000179A  33FC 0007 00003782       610      MOVE.W #7, LOADEDMAP
000017A2  4C9F 001F                611      MOVEM.W (A7)+, D0-D4
000017A6  4E75                     612      RTS
000017A8                           613  MAP6NODOOR1
000017A8                           614      ;GO TO THE PREVIOUS ROOM DOOR
000017A8                           615      ;FIRST LETS CHECK POS X
000017A8  B07C 0160                616      CMP #352, D0  ; BGT = 352 > D0
000017AC  6E00 0030                617      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000017B0  B07C 0120                618      CMP #288, D0
000017B4  6D00 0028                619      BLT MAP6NODOOR2
000017B8                           620      ;NOW WE CHECK POS Y 
000017B8  B27C 0020                621      CMP #32, D1  ; 
000017BC  6E00 0020                622      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000017C0  B27C 0000                623      CMP #0, D1
000017C4  6D00 0018                624      BLT MAP6NODOOR2
000017C8  33FC 01A0 00003776       625      MOVE.W  #416, PLAYERPOSY
000017D0  33FC 0005 00003782       626      MOVE.W #5, LOADEDMAP
000017D8  4C9F 001F                627      MOVEM.W (A7)+, D0-D4
000017DC  4E75                     628      RTS
000017DE                           629  MAP6NODOOR2
000017DE                           630      ;CHECK FOR LEFT HELL ROOM
000017DE  B07C 0060                631      CMP #96, D0  ; BGT = 352 > D0
000017E2  6E00 0038                632      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000017E6  B07C 0040                633      CMP #64, D0
000017EA  6D00 0030                634      BLT MAP6NODOOR3
000017EE                           635      ;NOW WE CHECK POS Y 
000017EE  B27C 0180                636      CMP #384, D1  ; 
000017F2  6E00 0028                637      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000017F6  B27C 0140                638      CMP #320, D1
000017FA  6D00 0020                639      BLT MAP6NODOOR3
000017FE  33FC 0130 00003774       640      MOVE.W #$130, PLAYERPOSX
00001806  33FC 00B0 00003776       641      MOVE.W #$0B0, PLAYERPOSY
0000180E  33FC 0008 00003782       642      MOVE.W #8, LOADEDMAP
00001816  4C9F 001F                643      MOVEM.W (A7)+, D0-D4
0000181A  4E75                     644      RTS
0000181C                           645  MAP6NODOOR3
0000181C                           646      ;CHECK FOR THE RIGHT HELL ROOM
0000181C  B07C 0240                647      CMP #576, D0  ; BGT = 352 > D0
00001820  6E00 0038                648      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001824  B07C 021C                649      CMP #540, D0
00001828  6D00 0030                650      BLT MAP6NODOOR4
0000182C                           651      ;NOW WE CHECK POS Y 
0000182C  B27C 0180                652      CMP #384, D1  ; 
00001830  6E00 0028                653      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001834  B27C 0140                654      CMP #320, D1
00001838  6D00 0020                655      BLT MAP6NODOOR4
0000183C  33FC 0130 00003774       656      MOVE.W #$130, PLAYERPOSX
00001844  33FC 00B0 00003776       657      MOVE.W #$0B0, PLAYERPOSY
0000184C  33FC 0008 00003782       658      MOVE.W #8, LOADEDMAP
00001854  4C9F 001F                659      MOVEM.W (A7)+, D0-D4
00001858  4E75                     660      RTS
0000185A                           661  MAP6NODOOR4
0000185A  4C9F 001F                662      MOVEM.W (A7)+, D0-D4
0000185E  4E75                     663      RTS
00001860                           664  MAPA7 
00001860  301F                     665      MOVE.W (A7)+, D0
00001862  48A7 F800                666      MOVEM.W D0-D4, -(A7)
00001866  3039 00003774            667      MOVE.W PLAYERPOSX, D0
0000186C  3239 00003776            668      MOVE.W PLAYERPOSY, D1
00001872                           669      ;GO BACK TO PREVIOUS HELL'S ROOM
00001872  B07C 0180                670      CMP #384, D0  ; BGT = 352 > D0
00001876  6E00 0032                671      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
0000187A  B07C 0104                672      CMP #260, D0
0000187E  6D00 002A                673      BLT MAP7NODOOR
00001882                           674      ;NOW WE CHECK POS Y 
00001882  B27C 0020                675      CMP #32, D1  ; 
00001886  6E00 0022                676      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
0000188A  B27C 0000                677      CMP #0, D1
0000188E  6D00 001A                678      BLT MAP7NODOOR
00001892  33FC 0140 00003774       679      MOVE.W  #320, PLAYERPOSX
0000189A  33FC 01A0 00003776       680      MOVE.W #416, PLAYERPOSY
000018A2  33FC 0006 00003782       681      MOVE.W #6, LOADEDMAP
000018AA                           682  MAP7NODOOR
000018AA  4C9F 001F                683      MOVEM.W (A7)+, D0-D4
000018AE  4E75                     684      RTS
000018B0                           685  MAPA8
000018B0                           686       ;HELLS ROOM
000018B0  301F                     687      MOVE.W (A7)+, D0
000018B2  48A7 F800                688      MOVEM.W D0-D4, -(A7)
000018B6  3039 00003774            689      MOVE.W PLAYERPOSX, D0
000018BC  3239 00003776            690      MOVE.W PLAYERPOSY, D1
000018C2                           691      ;GO BACK TO PREVIOUS HELL'S ROOM
000018C2  B07C 0180                692      CMP #384, D0  ; BGT = 352 > D0
000018C6  6E00 0032                693      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000018CA  B07C 0104                694      CMP #260, D0
000018CE  6D00 002A                695      BLT MAP8NODOOR1
000018D2                           696      ;NOW WE CHECK POS Y 
000018D2  B27C 0080                697      CMP #128, D1  ; 
000018D6  6E00 0022                698      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000018DA  B27C 0060                699      CMP #96, D1
000018DE  6D00 001A                700      BLT MAP8NODOOR1
000018E2  33FC 0140 00003774       701      MOVE.W  #320, PLAYERPOSX
000018EA  33FC 0080 00003776       702      MOVE.W #128, PLAYERPOSY
000018F2  33FC 0006 00003782       703      MOVE.W #6, LOADEDMAP
000018FA                           704  MAP8NODOOR1
000018FA  4C9F 001F                705      MOVEM.W (A7)+, D0-D4
000018FE  4E75                     706      RTS
00001900                           707  
00001900                           708  
00001900                           709  
00001900                           710  
00001900                           711  
00001900                           712  
00001900                           713  
00001900                           714  
00001900                           715  
00001900                           716  
00001900                           717  
00001900                           718  
00001900                           719  
00001900                           720  -------------------- end include --------------------
00001900                           721              INCLUDE "MAP.X68"
00001900                           722  
00001900                           723  ;MAP 0 INDICATES THAT WE ARE IN THE ELEVATOR MENU. 
00001900                           724  
00001900                           725  HEAVEN_0    ;MAP 1
00001900= 03 03 03 03 03 03 ...    726      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00001915= 03 01 01 01 01 01 ...    727      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
0000192A= 03 01 03 03 03 03 ...    728      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
0000193F= 03 01 03 05 05 05 ...    729      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00001954= 03 01 03 05 05 05 ...    730      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001969= 03 01 03 05 05 05 ...    731      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
0000197E= 03 01 03 05 05 05 ...    732      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001993= 03 01 03 05 05 05 ...    733      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
000019A8= 03 01 03 05 05 05 ...    734      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000019BD= 03 01 03 05 05 05 ...    735      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000019D2= 03 01 03 05 05 05 ...    736      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000019E7= 03 01 03 05 05 05 ...    737      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000019FC= 03 01 03 05 05 05 ...    738      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001A11= 03 01 03 03 03 03 ...    739      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00001A26= 03 01 01 01 01 01 ...    740      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001A3B= 03 03 03 03 03 03 ...    741      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001A50                           742          
00001A50                           743  HEAVEN_1    ;MAP 2
00001A50= 03 03 03 03 03 03 ...    744      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001A65= 03 03 01 01 01 01 ...    745      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
00001A7A= 03 03 03 03 03 03 ...    746      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
00001A8F= 03 07 07 07 07 03 ...    747      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001AA4= 03 07 07 07 07 03 ...    748      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001AB9= 03 07 07 07 07 09 ...    749      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
00001ACE= 03 07 07 07 07 03 ...    750      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00001AE3= 03 07 07 07 07 03 ...    751      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001AF8= 03 03 03 03 03 03 ...    752      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
00001B0D= 03 01 01 01 01 03 ...    753      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00001B22= 03 01 01 01 01 01 ...    754      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00001B37= 03 01 01 01 01 01 ...    755      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001B4C= 03 01 01 01 01 01 ...    756      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001B61= 03 01 01 01 01 01 ...    757      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001B76= 03 03 03 03 03 03 ...    758      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001B8B                           759      
00001B8B                           760  HEAVEN_END  ;MAP 3
00001B8B= 03 03 03 03 03 03 ...    761      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001BA0= 03 05 05 05 05 05 ...    762      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00001BB5= 03 05 05 07 05 05 ...    763      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00001BCA= 03 05 07 07 07 05 ...    764      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00001BDF= 03 05 05 07 05 05 ...    765      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00001BF4= 03 05 05 07 05 05 ...    766      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00001C09= 03 05 05 05 05 05 ...    767      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00001C1E= 03 05 05 05 05 05 ...    768      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00001C33= 03 05 05 05 05 05 ...    769      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00001C48= 03 05 05 07 05 05 ...    770      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00001C5D= 03 05 07 07 07 05 ...    771      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00001C72= 03 05 05 07 05 05 ...    772      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00001C87= 03 05 05 07 05 05 ...    773      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00001C9C= 03 05 05 05 05 05 ...    774      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
00001CB1= 03 03 03 03 03 03 ...    775      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
00001CC6                           776      
00001CC6                           777  HEAVEN_ROOM ;MAP 4
00001CC6= 09 09 09 09 09 09 ...    778      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00001CDB= 09 09 09 09 09 09 ...    779      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00001CF0= 09 09 09 09 09 09 ...    780      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00001D05= 09 09 09 09 09 09 ...    781      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00001D1A= 09 09 09 09 09 03 ...    782      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
00001D2F= 09 09 09 09 09 03 ...    783      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00001D44= 09 09 09 09 09 03 ...    784      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00001D59= 09 09 09 09 09 03 ...    785      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00001D6E= 09 09 09 09 09 03 ...    786      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00001D83= 09 09 09 09 09 03 ...    787      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00001D98= 09 09 09 09 09 03 ...    788      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
00001DAD= 09 09 09 09 09 09 ...    789      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00001DC2= 09 09 09 09 09 09 ...    790      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00001DD7= 09 09 09 09 09 09 ...    791      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00001DEC= 09 09 09 09 09 09 ...    792      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
00001E01                           793      
00001E01                           794  HELL_0  ;MAP 5
00001E01= 02 02 02 02 02 02 ...    795      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
00001E16= 02 06 06 06 06 06 ...    796      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001E2B= 02 06 06 04 06 06 ...    797      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00001E40= 02 06 06 04 06 06 ...    798      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00001E55= 02 06 04 04 04 06 ...    799      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
00001E6A= 02 06 06 04 06 06 ...    800      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00001E7F= 02 06 06 06 06 06 ...    801      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001E94= 02 02 02 02 02 02 ...    802      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
00001EA9= 02 06 06 06 06 06 ...    803      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001EBE= 02 06 06 06 06 06 ...    804      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001ED3= 02 06 06 06 06 06 ...    805      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001EE8= 02 06 06 06 06 06 ...    806      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001EFD= 02 06 06 06 06 06 ...    807      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001F12= 02 06 06 06 06 06 ...    808      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001F27= 02 02 02 02 02 02 ...    809      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00001F3C                           810          
00001F3C                           811  HELL_1      ;MAP 6
00001F3C= 02 02 02 02 02 02 ...    812      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00001F51= 02 06 06 06 06 06 ...    813      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001F66= 02 06 06 06 06 06 ...    814      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001F7B= 02 06 06 06 06 06 ...    815      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00001F90= 02 06 06 06 06 06 ...    816      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00001FA5= 02 06 06 06 06 06 ...    817      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00001FBA= 02 06 06 06 06 06 ...    818      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00001FCF= 02 06 06 06 06 06 ...    819      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00001FE4= 02 06 06 06 06 06 ...    820      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00001FF9= 02 06 06 06 06 06 ...    821      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000200E= 02 02 08 02 02 02 ...    822      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
00002023= 02 06 06 06 02 02 ...    823      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002038= 02 06 06 06 02 02 ...    824      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
0000204D= 02 06 06 06 02 02 ...    825      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002062= 02 02 02 02 02 02 ...    826      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002077                           827          
00002077                           828  HELL_END    ;MAP 7
00002077= 02 02 02 02 02 02 ...    829      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
0000208C= 02 06 06 06 06 06 ...    830      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000020A1= 02 06 06 06 06 06 ...    831      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000020B6= 02 06 06 06 06 06 ...    832      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000020CB= 02 06 06 06 06 06 ...    833      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000020E0= 02 06 06 06 06 06 ...    834      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000020F5= 02 06 06 06 06 06 ...    835      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000210A= 02 06 06 06 06 06 ...    836      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000211F= 02 06 06 06 06 06 ...    837      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002134= 02 06 06 06 06 06 ...    838      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002149= 02 06 06 06 06 06 ...    839      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000215E= 02 06 06 06 06 06 ...    840      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002173= 02 06 06 06 06 06 ...    841      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002188= 02 06 06 06 06 06 ...    842      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000219D= 02 02 02 02 02 02 ...    843      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
000021B2                           844      
000021B2                           845  HELL_ROOM   ;MAP 8
000021B2= 08 08 08 08 08 08 ...    846      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000021C7= 08 08 08 08 08 08 ...    847      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000021DC= 08 08 08 08 08 08 ...    848      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000021F1= 08 08 08 08 08 08 ...    849      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002206= 08 08 08 08 08 02 ...    850      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
0000221B= 08 08 08 08 08 02 ...    851      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002230= 08 08 08 08 08 02 ...    852      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002245= 08 08 08 08 08 02 ...    853      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000225A= 08 08 08 08 08 02 ...    854      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000226F= 08 08 08 08 08 02 ...    855      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00002284= 08 08 08 08 08 02 ...    856      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
00002299= 08 08 08 08 08 08 ...    857      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000022AE= 08 08 08 08 08 08 ...    858      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000022C3= 08 08 08 08 08 08 ...    859      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
000022D8= 08 08 08 08 08 08 ...    860      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
000022ED                           861  
000022ED                           862  
000022ED                           863  
000022ED                           864  
000022ED                           865  
000022ED                           866  
000022ED                           867  
000022ED                           868  -------------------- end include --------------------
000022ED                           869              INCLUDE "ELEVATOR_MENU.X68"
000022ED  =000000CC                870  COLBUTHL    EQU $000000CC
000022ED  =00EEEEEE                871  COLBUTHV    EQU $00EEEEEE
000022ED                           872  
000022ED= 01                       873      DC.B 1
000022EE                           874  ELEVATORPLOT
000022EE                           875      
000022EE  4CDF 7F00                876      MOVEM.L (A7)+, A0-A6
000022F2  4CDF 00FF                877      MOVEM.L (A7)+, D0-D7
000022F6                           878  
000022F6                           879  
000022F6                           880  ;SET PEN COLOR  
000022F6  103C 0050                881      MOVE.B #80, D0
000022FA  223C 00010101            882      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
00002300  4E4F                     883      TRAP #15
00002302                           884      
00002302                           885  ;END SET PEN COLOR 
00002302                           886  
00002302                           887      ;DRAW LINES
00002302                           888  ;DRAW LINE 1 
00002302  103C 0054                889      MOVE.B #84, D0
00002306  323C 0000                890      MOVE.W #0, D1
0000230A  343C 0000                891      MOVE.W #0, D2
0000230E  363C 00A0                892      MOVE.W #160, D3
00002312  383C 0078                893      MOVE.W #120, D4
00002316  4E4F                     894      TRAP #15
00002318                           895  
00002318                           896  ;DRAW LINE 2
00002318  103C 0054                897      MOVE.B #84, D0
0000231C  323C 00A0                898      MOVE.W #160, D1
00002320  343C 0078                899      MOVE.W #120, D2
00002324  363C 00A0                900      MOVE.W #160, D3
00002328  383C 01E0                901      MOVE.W #480, D4
0000232C  4E4F                     902      TRAP #15
0000232E                           903      
0000232E                           904  ;DRAW LINE 3
0000232E  103C 0054                905      MOVE.B #84, D0
00002332  323C 00A0                906      MOVE.W #160, D1
00002336  343C 0078                907      MOVE.W #120, D2
0000233A  363C 01E0                908      MOVE.W #480, D3
0000233E  383C 0078                909      MOVE.W #120, D4
00002342  4E4F                     910      TRAP #15
00002344                           911      
00002344                           912  ;DRAW LINE 4
00002344  103C 0054                913      MOVE.B #84, D0
00002348  323C 01E0                914      MOVE.W #480, D1
0000234C  343C 0078                915      MOVE.W #120, D2
00002350  363C 0280                916      MOVE.W #640, D3
00002354  383C 0000                917      MOVE.W #0, D4
00002358  4E4F                     918      TRAP #15
0000235A                           919      
0000235A                           920  ;DRAW LINE 5
0000235A  103C 0054                921      MOVE.B #84, D0
0000235E  323C 01E0                922      MOVE.W #480, D1
00002362  343C 0078                923      MOVE.W #120, D2
00002366  363C 01E0                924      MOVE.W #480, D3
0000236A  383C 01E0                925      MOVE.W #480, D4
0000236E  4E4F                     926      TRAP #15
00002370                           927  
00002370                           928  ;DRAW LINE 6 (TO GIVE SHADE) 
00002370  103C 0054                929      MOVE.B #84, D0
00002374  323C 0119                930      MOVE.W #281, D1
00002378  343C 015A                931      MOVE.W #346, D2
0000237C  363C 0167                932      MOVE.W #359, D3
00002380  383C 015A                933      MOVE.W #346, D4
00002384  4E4F                     934      TRAP #15
00002386                           935      
00002386                           936  ;DRAW LINE 7 (TO GIVE SHADE) 
00002386  103C 0054                937      MOVE.B #84, D0
0000238A  323C 011A                938      MOVE.W #282, D1
0000238E  343C 015B                939      MOVE.W #347, D2
00002392  363C 0166                940      MOVE.W #358, D3
00002396  383C 015B                941      MOVE.W #347, D4
0000239A  4E4F                     942      TRAP #15
0000239C                           943      
0000239C                           944      ;END DRAW LINES
0000239C                           945      
0000239C                           946  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
0000239C  103C 0057                947      MOVE.B #87, D0
000023A0  323C 0118                948      MOVE.W #280, D1
000023A4  343C 00D2                949      MOVE.W #210, D2
000023A8  363C 0168                950      MOVE.W #360, D3
000023AC  383C 0159                951      MOVE.W #345, D4
000023B0  4E4F                     952      TRAP #15
000023B2                           953      
000023B2                           954  ;DRAW ELLIPSE FOR THE LIGHT
000023B2  103C 005B                955      MOVE.B #91, D0
000023B6  323C 00FA                956      MOVE.W #250, D1
000023BA  343C 0028                957      MOVE.W #40, D2
000023BE  363C 0186                958      MOVE.W #390, D3
000023C2  383C 0050                959      MOVE.W #80, D4
000023C6  4E4F                     960      TRAP #15
000023C8                           961      ;FILL SEGMENTS
000023C8                           962  ;FILL SEGMENT 1 LEFT WALL
000023C8                           963    ;SET FILL COLOR TO DARKER GREY, FOR W
000023C8  103C 0051                964      MOVE.B #81, D0
000023CC                           965      ;MOVE.L #$00969696, D1
000023CC  223C 0020202F            966      MOVE.L #$0020202F, D1
000023D2  4E4F                     967      TRAP #15
000023D4                           968      ;END SET FILL COLOR
000023D4  103C 0059                969      MOVE.B #89, D0
000023D8  323C 0064                970      MOVE.W #100, D1
000023DC  343C 0064                971      MOVE.W #100, D2
000023E0  4E4F                     972      TRAP #15
000023E2                           973      
000023E2                           974  ;FILL SEGMENT 2 CEILING
000023E2                           975    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
000023E2  103C 0051                976      MOVE.B #81, D0
000023E6                           977      ;MOVE.L #$00C0C0C0, D1
000023E6  223C 00141424            978      MOVE.L #$00141424,D1
000023EC  4E4F                     979      TRAP #15
000023EE                           980      ;END SET FILL COLOR
000023EE  103C 0059                981      MOVE.B #89, D0
000023F2  323C 0064                982      MOVE.W #100, D1
000023F6  343C 0032                983      MOVE.W #50, D2
000023FA  4E4F                     984      TRAP #15
000023FC                           985      
000023FC                           986  ;FILL SEGMENT 3 RIGHT WALL
000023FC                           987    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
000023FC  103C 0051                988      MOVE.B #81, D0
00002400                           989      ;MOVE.L #$00969696, D1
00002400  223C 0020202F            990      MOVE.L #$0020202F,D1
00002406  4E4F                     991      TRAP #15
00002408                           992      ;END SET FILL COLOR
00002408  103C 0059                993      MOVE.B #89, D0
0000240C  323C 0276                994      MOVE.W #630, D1
00002410  343C 01D6                995      MOVE.W #470, D2
00002414  4E4F                     996      TRAP #15
00002416                           997      
00002416                           998  ;FILL SEGMENT 4 BACKGROUND WALL
00002416                           999    ;SET FILL COLOR TO 
00002416  103C 0051               1000      MOVE.B #81, D0
0000241A                          1001      ;MOVE.L #$00ABABAB, D1
0000241A  223C 001A1A2A           1002      MOVE.L #$001A1A2A, D1
00002420  4E4F                    1003      TRAP #15
00002422                          1004      ;END SET FILL COLOR
00002422  103C 0059               1005      MOVE.B #89, D0
00002426  323C 00F0               1006      MOVE.W #240, D1
0000242A  343C 0140               1007      MOVE.W #320, D2
0000242E  4E4F                    1008      TRAP #15
00002430                          1009      
00002430                          1010  ;FILL SEGMENT 5 PANEL 
00002430                          1011    ;SET FILL COLOR TO 
00002430  103C 0051               1012      MOVE.B #81, D0
00002434                          1013      ;MOVE.L #$00AFAFAF, D1
00002434  223C 001F1F2F           1014      MOVE.L #$001F1F2F, D1
0000243A  4E4F                    1015      TRAP #15
0000243C                          1016      ;END SET FILL COLOR
0000243C  103C 0059               1017      MOVE.B #89, D0
00002440  323C 011D               1018      MOVE.W #285, D1
00002444  343C 00D7               1019      MOVE.W #215, D2
00002448  4E4F                    1020      TRAP #15
0000244A                          1021      
0000244A                          1022  ;FILL ELLIPSE LIGHT 
0000244A                          1023    ;SET FILL COLOR TO 
0000244A  103C 0051               1024      MOVE.B #81, D0
0000244E                          1025      ;MOVE.L #$00A1E9E9, D1
0000244E  223C 000000FF           1026      MOVE.L #$000000FF, D1
00002454  4E4F                    1027      TRAP #15
00002456                          1028      ;END SET FILL COLOR
00002456  103C 0059               1029      MOVE.B #89, D0
0000245A  323C 0140               1030      MOVE.W #320, D1
0000245E  343C 003C               1031      MOVE.W #60, D2
00002462  4E4F                    1032      TRAP #15
00002464                          1033  
00002464                          1034  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
00002464                          1035      ;SET FILL COLOR 
00002464  103C 0051               1036      MOVE.B #81, D0
00002468  223C 000000CC           1037      MOVE.L #COLBUTHL, D1
0000246E  4E4F                    1038      TRAP #15
00002470                          1039      ;END SET FILL COLOR
00002470  3F3C 0135               1040      MOVE.W #309, -(A7) ;COORDENADA Y 
00002474  3F3C 0136               1041      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00002478  3F3C 0016               1042      MOVE.W #22, -(A7)
0000247C  4EB9 000024B6           1043      JSR TRIANGLE
00002482  3C1F                    1044      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
00002484  3C1F                    1045      MOVE.W (A7)+, D6
00002486  3C1F                    1046      MOVE.W (A7)+, D6
00002488                          1047  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
00002488                          1048     ;SET FILL COLOR
00002488  48E7 FFFE               1049     MOVEM.L D0-D7/A0-A6, -(A7)
0000248C  103C 0051               1050     MOVE.B #81, D0
00002490  223C 00EEEEEE           1051     MOVE.L #COLBUTHV, D1
00002496  4E4F                    1052     TRAP #15
00002498  4CDF 7FFF               1053     MOVEM.L (A7)+, D0-D7/A0-A6
0000249C                          1054      ;END SET FILL COLOR
0000249C  3F3C 00F9               1055     MOVE.W #249, -(A7) ;COORDENADA Y 
000024A0  3F3C 0136               1056     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
000024A4  3F3C FFEA               1057     MOVE.W #-22, -(A7)
000024A8  4EB9 000024B6           1058     JSR TRIANGLE
000024AE  3C1F                    1059     MOVE.W (A7)+, D6
000024B0  3C1F                    1060     MOVE.W (A7)+, D6
000024B2  3C1F                    1061     MOVE.W (A7)+, D6
000024B4                          1062     ;MOVEM.L (A7)+, D0-D7/A0-A6
000024B4                          1063  
000024B4  4E75                    1064     RTS
000024B6                          1065  ; ------------------------------------------------------------------------------
000024B6                          1066  TRIANGLE
000024B6                          1067  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
000024B6                          1068  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
000024B6                          1069  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
000024B6                          1070  ;            SIDES LENGTH (WORD) IN THAT ORDER
000024B6                          1071  ; OUTPUT   : NONE
000024B6                          1072  ; MODIFIES : NONE
000024B6                          1073  ; ------------------------------------------------------------------------------
000024B6  48A7 F800               1074      MOVEM.W D0-D4, -(A7)
000024BA                          1075      ; LINE FROM LEFT TO RIGHT
000024BA  103C 0054               1076      MOVE.B  #84,D0      ; TASK NUMBER
000024BE  322F 0010               1077      MOVE.W  16(A7),D1   ; X POSITION FROM
000024C2  342F 0012               1078      MOVE.W  18(A7),D2   ; Y POSITION FROM
000024C6  3802                    1079      MOVE.W  D2,D4       ; Y POSITION TO
000024C8  362F 000E               1080      MOVE.W  14(A7),D3   ; LENGTH
000024CC                          1081      
000024CC  6A00 0004               1082      BPL.W   .UPWARDS
000024D0  4443                    1083      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
000024D2                          1084  .UPWARDS
000024D2  D641                    1085      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
000024D4  4E4F                    1086      TRAP    #15         ; HORIZONTAL LINE DRAWN
000024D6                          1087      ; LINE FROM RIGHT TO UP/DOWN
000024D6  9641                    1088      SUB.W   D1,D3       ; I GET LENGTH IN D3
000024D8  3001                    1089      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
000024DA  D243                    1090      ADD.W   D3,D1       ; X POSITION FROM
000024DC  E24B                    1091      LSR.W   #1,D3       ; LENGTH/2
000024DE  D640                    1092      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
000024E0                          1093      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
000024E0  D86F 000E               1094      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
000024E4  103C 0054               1095      MOVE.B  #84,D0
000024E8  4E4F                    1096      TRAP    #15
000024EA                          1097      ; LINE FROM LEFT TO UP/DOWN
000024EA  322F 0010               1098      MOVE.W  16(A7),D1   ; X POSITION FROM
000024EE  4E4F                    1099      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
000024F0                          1100      
000024F0                          1101      ; FILLING TRIANGLE
000024F0  103C 0059               1102      MOVE.B  #89,D0
000024F4  5241                    1103      ADDQ.W  #1,D1
000024F6  363C 0001               1104      MOVE.W  #1,D3
000024FA  4A6F 000E               1105      TST.W   14(A7)
000024FE  6A00 0004               1106      BPL.W   .ISPOSITIVE
00002502  4443                    1107      NEG.W   D3
00002504                          1108  .ISPOSITIVE
00002504  D443                    1109      ADD.W   D3,D2
00002506  4E4F                    1110      TRAP    #15
00002508                          1111      
00002508  4C9F 001F               1112      MOVEM.W (A7)+,D0-D4
0000250C  4E75                    1113      RTS
0000250E                          1114      
0000250E                          1115      
0000250E                          1116  ELEVATORUPDATE ; 1 = up 3 = down
0000250E  3F00                    1117      MOVE.W D0, -(A7)
00002510  3039 00003782           1118      MOVE.W LOADEDMAP, D0
00002516  B07C 0000               1119      CMP #0, D0
0000251A  6700 0006               1120      BEQ ESMENU
0000251E  301F                    1121      MOVE.W (A7)+, D0
00002520  4E75                    1122      RTS
00002522                          1123  ESMENU
00002522  301F                    1124      MOVE.W (A7)+, D0
00002524  0839 0005 0000376C      1125      BTST #5, KBDVAL
0000252C  6600 0022               1126      BNE HLSEL
00002530  0839 0007 0000376C      1127      BTST #7, KBDVAL
00002538  6600 0004               1128      BNE HVSEL
0000253C  4E75                    1129      RTS
0000253E                          1130  HVSEL   ;LOAD 1ST HEAVEN MAP
0000253E  13FC 0000 00003784      1131      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
00002546  33FC 0001 00003782      1132      MOVE.W #1, LOADEDMAP    
0000254E  4E75                    1133      RTS
00002550                          1134  HLSEL   ;LOAD 1ST HELL MAP
00002550  13FC 0000 00003784      1135      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
00002558  33FC 0005 00003782      1136      MOVE.W #5, LOADEDMAP
00002560  4E75                    1137      RTS
00002562                          1138      
00002562                          1139          
00002562                          1140  
00002562                          1141  
00002562                          1142  
00002562                          1143  
00002562                          1144  -------------------- end include --------------------
00002562                          1145              INCLUDE "LIB/DMMCONST.X68"           
00002562                          1146  ; =============================================================================
00002562                          1147  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00002562                          1148  ; =============================================================================
00002562                          1149  
00002562  =00000040               1150  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00002562  =00000032               1151  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00002562  =00000000               1152  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00002562  =00000000               1153  -------------------- end include --------------------
00002562                          1154              INCLUDE "LIB/DMMCODE.X68"
00002562                          1155  ; =============================================================================
00002562                          1156  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00002562                          1157  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00002562                          1158  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00002562                          1159  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00002562                          1160  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00002562                          1161  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00002562                          1162  ; =============================================================================
00002562                          1163  
00002562                          1164  ; -----------------------------------------------------------------------------
00002562                          1165  DMMINIT
00002562                          1166  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00002562                          1167  ; INPUT    - NONE
00002562                          1168  ; OUTPUT   - NONE
00002562                          1169  ; MODIFIES - NONE
00002562                          1170  ; -----------------------------------------------------------------------------
00002562  48E7 8080               1171              MOVEM.L D0/A0,-(A7)
00002566  41F9 000037C0           1172              LEA     DMMDATA,A0
0000256C  303C 0031               1173              MOVE.W  #DMMBNUM-1,D0
00002570  30BC 0000               1174  .LOOP       MOVE.W  #DMMSYSID,(A0)
00002574  D1FC 00000040           1175              ADD.L   #DMMBSIZE,A0
0000257A  51C8 FFF4               1176              DBRA.W  D0,.LOOP
0000257E  4CDF 0101               1177              MOVEM.L (A7)+,D0/A0
00002582  4E75                    1178              RTS
00002584                          1179  
00002584                          1180  ; -----------------------------------------------------------------------------
00002584                          1181  DMMFIRST
00002584                          1182  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00002584                          1183  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00002584                          1184  ; INPUT    - NONE
00002584                          1185  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00002584                          1186  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00002584                          1187  ; -----------------------------------------------------------------------------
00002584  41F9 000037C0           1188              LEA     DMMDATA,A0
0000258A  4A58                    1189  DMMFRLOP    TST.W   (A0)+
0000258C  6600 0016               1190              BNE     DMMFRFND
00002590  D1FC 0000003E           1191              ADD.L   #DMMBSIZE-2,A0
00002596  B1FC 0000443F           1192  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000259C  6DEC                    1193              BLT     DMMFRLOP
0000259E  207C 00000000           1194              MOVE.L  #0,A0
000025A4  4E75                    1195  DMMFRFND    RTS
000025A6                          1196  
000025A6                          1197  ; -----------------------------------------------------------------------------
000025A6                          1198  DMMNEXT
000025A6                          1199  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
000025A6                          1200  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000025A6                          1201  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
000025A6                          1202  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000025A6                          1203  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000025A6                          1204  ; -----------------------------------------------------------------------------
000025A6  2F00                    1205              MOVE.L  D0,-(A7)
000025A8  2008                    1206              MOVE.L  A0,D0
000025AA  C0BC FFFFFFC0           1207              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000025B0  0680 00000040           1208              ADD.L   #DMMBSIZE,D0
000025B6  2040                    1209              MOVE.L  D0,A0
000025B8  201F                    1210              MOVE.L  (A7)+,D0
000025BA  60DA                    1211              BRA     DMMFRCOM
000025BC                          1212  
000025BC                          1213  ; -----------------------------------------------------------------------------
000025BC                          1214  DMMFRSTO
000025BC                          1215  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000025BC                          1216  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000025BC                          1217  ; INPUT    - D0.W : ID TO SEARCH
000025BC                          1218  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000025BC                          1219  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000025BC                          1220  ; -----------------------------------------------------------------------------
000025BC  41F9 000037C0           1221              LEA     DMMDATA,A0
000025C2  B058                    1222  DMMFLOOP    CMP.W   (A0)+,D0
000025C4  6700 0016               1223              BEQ     DMMFFND
000025C8  D1FC 0000003E           1224              ADD.L   #DMMBSIZE-2,A0
000025CE  B1FC 0000443F           1225  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000025D4  6DEC                    1226              BLT     DMMFLOOP
000025D6  207C 00000000           1227              MOVE.L  #0,A0
000025DC  4E75                    1228  DMMFFND     RTS
000025DE                          1229  
000025DE                          1230  ; -----------------------------------------------------------------------------
000025DE                          1231  DMMNEXTO
000025DE                          1232  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000025DE                          1233  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000025DE                          1234  ; INPUT    - D0.W : ID TO SEARCH
000025DE                          1235  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000025DE                          1236  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000025DE                          1237  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000025DE                          1238  ; -----------------------------------------------------------------------------
000025DE  2F00                    1239              MOVE.L  D0,-(A7)
000025E0  2008                    1240              MOVE.L  A0,D0
000025E2  C0BC FFFFFFC0           1241              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000025E8  0680 00000040           1242              ADD.L   #DMMBSIZE,D0
000025EE  2040                    1243              MOVE.L  D0,A0
000025F0  201F                    1244              MOVE.L  (A7)+,D0
000025F2  60DA                    1245              BRA     DMMFCOM
000025F4                          1246  
000025F4                          1247  ; -----------------------------------------------------------------------------
000025F4                          1248  DMMALLOC
000025F4                          1249  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000025F4                          1250  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000025F4                          1251  ; INPUT    - D0.W : ID TO ASSIGN
000025F4                          1252  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000025F4                          1253  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000025F4                          1254  ; -----------------------------------------------------------------------------
000025F4  3F00                    1255              MOVE.W  D0,-(A7)
000025F6  4240                    1256              CLR.W   D0
000025F8  4EB8 25BC               1257              JSR     DMMFRSTO
000025FC  301F                    1258              MOVE.W  (A7)+,D0
000025FE  B1FC 00000000           1259              CMP.L   #0,A0
00002604  6700 0006               1260              BEQ     .END
00002608  3140 FFFE               1261              MOVE.W  D0,-2(A0)
0000260C  4E75                    1262  .END        RTS
0000260E                          1263  
0000260E                          1264  ; -----------------------------------------------------------------------------
0000260E                          1265  DMMFREE
0000260E                          1266  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
0000260E                          1267  ; SYSTEM (0)
0000260E                          1268  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
0000260E                          1269  ; OUTPUT   - NONE
0000260E                          1270  ; MODIFIES - NONE
0000260E                          1271  ; -----------------------------------------------------------------------------
0000260E  48E7 8080               1272              MOVEM.L D0/A0,-(A7)
00002612  2008                    1273              MOVE.L  A0,D0
00002614  C0BC FFFFFFC0           1274              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000261A  2040                    1275              MOVE.L  D0,A0
0000261C  4250                    1276              CLR.W   (A0)
0000261E  4CDF 0101               1277              MOVEM.L (A7)+,D0/A0
00002622  4E75                    1278              RTS
00002622  4E75                    1279  -------------------- end include --------------------
00002624                          1280              INCLUDE "SYSTEM.X68"
00002624                          1281  ; ==============================================================================
00002624                          1282  ; SYSTEM
00002624                          1283  ; ==============================================================================
00002624                          1284              
00002624                          1285  ; ------------------------------------------------------------------------------
00002624                          1286  SYSINIT
00002624                          1287  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
00002624                          1288  ; INPUT    : NONE
00002624                          1289  ; OUTPUT   : NONE
00002624                          1290  ; MODIFIES : NONE
00002624                          1291  ; ------------------------------------------------------------------------------
00002624                          1292  
00002624  21FC 000026B2 0080      1293              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
0000262C  21FC 00002788 0084      1294              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
00002634  21FC 0000275A 0064      1295              MOVE.L  #SCRTIM,($60+SCRINTN*4)
0000263C  21FC 00002768 0068      1296              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
00002644                          1297              
00002644  4EB8 2562               1298              JSR     DMMINIT
00002648  4EB9 0000265C           1299              JSR     SCRINIT
0000264E  4EB9 0000277A           1300              JSR     KBDINIT
00002654                          1301              
00002654  40E7                    1302              MOVE.W  SR,-(A7)
00002656  0257 D8FF               1303              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
0000265A  4E73                    1304              RTE
0000265C                          1305              
0000265C                          1306  ; ------------------------------------------------------------------------------
0000265C                          1307  SCRINIT
0000265C                          1308  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
0000265C                          1309  ; ENABLE DOUBLE BUFFER.
0000265C                          1310  ; INPUT    : NONE
0000265C                          1311  ; OUTPUT   : NONE
0000265C                          1312  ; MODIFIES : NONE
0000265C                          1313  ; ------------------------------------------------------------------------------
0000265C                          1314  
0000265C  48E7 F000               1315              MOVEM.L D0-D3,-(A7)
00002660                          1316  
00002660                          1317              ; SET SCREEN RESOLUTION
00002660  103C 0021               1318              MOVE.B  #33,D0
00002664  223C 028001E0           1319              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
0000266A  4E4F                    1320              TRAP    #15
0000266C                          1321              
0000266C                          1322              ; SET WINDOWED MODE
0000266C  7201                    1323              MOVE.L  #1,D1
0000266E  4E4F                    1324              TRAP    #15
00002670                          1325              
00002670                          1326              ; CLEAR SCREEN
00002670  103C 000B               1327              MOVE.B  #11,D0
00002674  323C FF00               1328              MOVE.W  #$FF00,D1
00002678  4E4F                    1329              TRAP    #15
0000267A                          1330  
0000267A                          1331              ; ENABLE DOUBLE BUFFER
0000267A  103C 005C               1332              MOVE.B  #92,D0
0000267E  123C 0011               1333              MOVE.B  #17,D1
00002682  4E4F                    1334              TRAP    #15
00002684                          1335              
00002684                          1336              ; ENABLE BOTH TIMED INTERRUPT
00002684  103C 0020               1337              MOVE.B  #32,D0
00002688  123C 0006               1338              MOVE.B  #6,D1
0000268C  143C 0081               1339              MOVE.B  #$80|SCRINTN,D2
00002690  7614                    1340              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00002692  4E4F                    1341              TRAP    #15
00002694  143C 0082               1342              MOVE.B  #$80|SCRINTFPSN,D2
00002698  263C 000003E8           1343              MOVE.L  #1000,D3
0000269E  4E4F                    1344              TRAP    #15
000026A0                          1345              
000026A0                          1346              ; CLEAR INTERRUPT COUNTER
000026A0  4279 0000376E           1347              CLR.W   (SCRINTCT)
000026A6  4239 00003770           1348              CLR.B   (SCRINTFPS) 
000026AC                          1349              
000026AC  4CDF 000F               1350              MOVEM.L (A7)+,D0-D3
000026B0                          1351              
000026B0  4E75                    1352              RTS
000026B2                          1353  
000026B2                          1354  ; ------------------------------------------------------------------------------
000026B2                          1355  SCRPLOT
000026B2                          1356  ; UPDATES DOUBLE BUFFER
000026B2                          1357  ; INPUT    : NONE
000026B2                          1358  ; OUTPUT   : NONE
000026B2                          1359  ; MODIFIES : NONE
000026B2                          1360  ; ------------------------------------------------------------------------------
000026B2  48E7 E000               1361              MOVEM.L D0-D2,-(A7)
000026B6  2F09                    1362              MOVE.L  A1,-(A7)
000026B8                          1363              
000026B8                          1364              ; PLOT ACTUAL FPS AND GOAL FPS
000026B8                          1365              
000026B8  103C 0051               1366              MOVE.B  #81,D0
000026BC  7200                    1367              MOVE.L  #$00000000,D1 ; FILL COLOR
000026BE  4E4F                    1368              TRAP    #15
000026C0                          1369              
000026C0  103C 0050               1370              MOVE.B  #80,D0
000026C4  223C 00FFFFFF           1371              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000026CA  4E4F                    1372              TRAP    #15
000026CC                          1373              
000026CC  103C 000B               1374              MOVE.B  #11,D0
000026D0  223C 00002A01           1375              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000026D6  4E4F                    1376              TRAP    #15
000026D8                          1377              
000026D8  43F9 00003788           1378              LEA.L   STRFPS1,A1 
000026DE  103C 000E               1379              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000026E2  4E4F                    1380              TRAP    #15
000026E4                          1381              
000026E4  103C 000B               1382              MOVE.B  #11,D0
000026E8  323C 3301               1383              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000026EC  4E4F                    1384              TRAP    #15
000026EE                          1385              
000026EE  5E89                    1386              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000026F0  103C 000E               1387              MOVE.B  #14,D0  
000026F4  4E4F                    1388              TRAP    #15 
000026F6                          1389              
000026F6  103C 000B               1390              MOVE.B  #11,D0
000026FA  323C 4401               1391              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000026FE  4E4F                    1392              TRAP    #15
00002700                          1393              
00002700  D3FC 0000000F           1394              ADDA.L  #15,A1 ; PLOT 'FPS'
00002706  103C 000E               1395              MOVE.B  #14,D0 
0000270A  4E4F                    1396              TRAP    #15
0000270C                          1397              
0000270C  0643 0014               1398              ADD.W   #20,D3
00002710  103C 000B               1399              MOVE.B  #11,D0
00002714  323C 3001               1400              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
00002718  4E4F                    1401              TRAP    #15
0000271A                          1402              
0000271A  7232                    1403              MOVE.L  #FRAMES_PER_SECOND,D1
0000271C  740A                    1404              MOVE.L  #10,D2
0000271E  103C 000F               1405              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00002722  4E4F                    1406              TRAP    #15
00002724                          1407              
00002724  0643 0014               1408              ADD.W   #20,D3
00002728  103C 000B               1409              MOVE.B  #11,D0
0000272C  323C 4101               1410              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00002730  4E4F                    1411              TRAP    #15
00002732                          1412              
00002732  4281                    1413              CLR.L   D1
00002734  1239 00003786           1414              MOVE.B  (REALFPS),D1
0000273A  740A                    1415              MOVE.L  #10,D2
0000273C  103C 000F               1416              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00002740  4E4F                    1417              TRAP    #15
00002742                          1418              
00002742                          1419              ; SWITCH BUFFERS
00002742  103C 005E               1420              MOVE.B  #94,D0
00002746  4E4F                    1421              TRAP    #15
00002748                          1422              
00002748                          1423              ; CLEAR HIDDEN BUFFER
00002748  103C 000B               1424              MOVE.B  #11,D0
0000274C  323C FF00               1425              MOVE.W  #$FF00,D1
00002750  4E4F                    1426              TRAP    #15
00002752                          1427              
00002752  225F                    1428              MOVE.L  (A7)+,A1
00002754  4CDF 0007               1429              MOVEM.L (A7)+,D0-D2
00002758  4E73                    1430              RTE
0000275A                          1431              
0000275A                          1432  ; ------------------------------------------------------------------------------
0000275A                          1433  SCRTIM
0000275A                          1434  ; TIMED INTERRUPT SERVICE ROUTINE
0000275A                          1435  ; INPUT    : NONE
0000275A                          1436  ; OUTPUT   : NONE
0000275A                          1437  ; MODIFIES : NONE
0000275A                          1438  ; ------------------------------------------------------------------------------
0000275A  5239 0000376E           1439              ADDQ.B  #1,(SCRINTCT)
00002760  5239 0000376F           1440              ADDQ.B  #1,(SCRCYCCT)
00002766  4E73                    1441              RTE
00002768                          1442              
00002768                          1443  ; ------------------------------------------------------------------------------
00002768                          1444  SCRTIM1S
00002768                          1445  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
00002768                          1446  ; INPUT    : NONE
00002768                          1447  ; OUTPUT   : NONE
00002768                          1448  ; MODIFIES : NONE
00002768                          1449  ; ------------------------------------------------------------------------------
00002768  13F9 00003770 00003786  1450              MOVE.B  (SCRINTFPS),REALFPS
00002772  4239 00003770           1451              CLR.B   SCRINTFPS
00002778  4E73                    1452              RTE
0000277A                          1453  
0000277A                          1454  ; ------------------------------------------------------------------------------
0000277A                          1455  KBDINIT
0000277A                          1456  ; INIT KEYBOARD
0000277A                          1457  ; INPUT    : NONE
0000277A                          1458  ; OUTPUT   : NONE
0000277A                          1459  ; MODIFIES : NONE
0000277A                          1460  ; ------------------------------------------------------------------------------
0000277A  4239 0000376C           1461              CLR.B   (KBDVAL)
00002780  4239 0000376D           1462              CLR.B   (KBDEDGE)
00002786  4E75                    1463              RTS
00002788                          1464  
00002788                          1465  ; ------------------------------------------------------------------------------
00002788                          1466  KBDUPD
00002788                          1467  ; UPDATE KEYBOARD INFO.  
00002788                          1468  ; 7 -> FIRE DOWN
00002788                          1469  ; 6 -> FIRE RIGHT
00002788                          1470  ; 5 -> FIRE UP
00002788                          1471  ; 4 -> FIRE LEFT
00002788                          1472  ; 3 -> DOWN
00002788                          1473  ; 2 -> RIGHT
00002788                          1474  ; 1 -> UP
00002788                          1475  ; 0 -> LEFT
00002788                          1476  ; INPUT    : NONE
00002788                          1477  ; OUTPUT   : NONE
00002788                          1478  ; MODIFIES : NONE
00002788                          1479  ; ------------------------------------------------------------------------------
00002788                          1480  
00002788  48E7 F000               1481              MOVEM.L D0-D3,-(A7)
0000278C                          1482  
0000278C                          1483              ; READ FIRST PART
0000278C  103C 0013               1484              MOVE.B  #19,D0
00002790  223C 28272625           1485              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃÂ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
00002796  4E4F                    1486              TRAP    #15
00002798                          1487              
00002798                          1488              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
00002798  4EB9 000027C8           1489              JSR     .PACK
0000279E                          1490  
0000279E                          1491              ; READ SECOND PART
0000279E  223C 53445741           1492              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
000027A4  4E4F                    1493              TRAP    #15
000027A6                          1494  
000027A6                          1495              ; CONVERT TO DESIRED FORMAT
000027A6  4EB9 000027C8           1496              JSR     .PACK
000027AC                          1497              
000027AC                          1498              ; COMPUTE KBDEDGE
000027AC  1039 0000376C           1499              MOVE.B  (KBDVAL),D0
000027B2  4600                    1500              NOT.B   D0
000027B4  C002                    1501              AND.B   D2,D0
000027B6  13C0 0000376D           1502              MOVE.B  D0,(KBDEDGE)
000027BC                          1503              
000027BC                          1504              ; STORE KBDVAL
000027BC  13C2 0000376C           1505              MOVE.B  D2,(KBDVAL)
000027C2                          1506              
000027C2  4CDF 000F               1507              MOVEM.L (A7)+,D0-D3
000027C6                          1508  
000027C6  4E73                    1509              RTE
000027C8                          1510              
000027C8  363C 0003               1511  .PACK       MOVE.W  #3,D3
000027CC  E189                    1512  .LOOP       LSL.L   #8,D1
000027CE  E312                    1513              ROXL.B  #1,D2
000027D0  51CB FFFA               1514              DBRA.W  D3,.LOOP
000027D4  4E75                    1515              RTS
000027D6                          1516  
000027D6                          1517  
000027D6                          1518  
000027D6                          1519  -------------------- end include --------------------
000027D6                          1520              INCLUDE "LIB/AGLCODE.X68"
000027D6                          1521  ; =============================================================================
000027D6                          1522  ; AGENT MANAGEMENT
000027D6                          1523  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000027D6                          1524  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000027D6                          1525  ; +4 - LONG : PLOT SUBROUTINE POINTER
000027D6                          1526  ; +8:END    : DATA (AGENT SPECIFIC)
000027D6                          1527  ; =============================================================================
000027D6                          1528  
000027D6                          1529  ; -----------------------------------------------------------------------------
000027D6                          1530  AGLADD
000027D6                          1531  ; CREATES A NEW AGENT
000027D6                          1532  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000027D6                          1533  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000027D6                          1534  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000027D6                          1535  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000027D6                          1536  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000027D6                          1537  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000027D6                          1538  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000027D6                          1539  ; OUTPUT   - NONE
000027D6                          1540  ; MODIFIES - NONE
000027D6                          1541  ; -----------------------------------------------------------------------------
000027D6  2F08                    1542              MOVE.L  A0,-(A7)
000027D8  4EB8 25F4               1543              JSR     DMMALLOC
000027DC  B1FC 00000000           1544              CMP.L   #0,A0
000027E2  6700 0008               1545              BEQ     .END
000027E6  20CA                    1546              MOVE.L  A2,(A0)+
000027E8  20CB                    1547              MOVE.L  A3,(A0)+
000027EA  4E91                    1548              JSR     (A1)
000027EC  205F                    1549  .END        MOVE.L  (A7)+,A0
000027EE  4E75                    1550              RTS
000027F0                          1551  
000027F0                          1552  ; -----------------------------------------------------------------------------
000027F0                          1553  AGLUPD
000027F0                          1554  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000027F0                          1555  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000027F0                          1556  ; INPUT    - NONE
000027F0                          1557  ; OUTPUT   - NONE
000027F0                          1558  ; MODIFIES - NONE
000027F0                          1559  ; -----------------------------------------------------------------------------
000027F0  48E7 00C0               1560              MOVEM.L A0-A1,-(A7)
000027F4  4EB8 2584               1561              JSR     DMMFIRST
000027F8  B1FC 00000000           1562  .LOOP       CMP.L   #0,A0
000027FE  6700 000E               1563              BEQ     .END
00002802  2250                    1564              MOVE.L  (A0),A1
00002804  5088                    1565              ADD.L   #8,A0
00002806  4E91                    1566              JSR     (A1)
00002808  4EB8 25A6               1567              JSR     DMMNEXT
0000280C  60EA                    1568              BRA     .LOOP
0000280E  4CDF 0300               1569  .END        MOVEM.L (A7)+,A0-A1
00002812  4E75                    1570              RTS
00002814                          1571  
00002814                          1572  ; -----------------------------------------------------------------------------
00002814                          1573  AGLPLOT
00002814                          1574  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00002814                          1575  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00002814                          1576  ; INPUT    - NONE
00002814                          1577  ; OUTPUT   - NONE
00002814                          1578  ; MODIFIES - NONE
00002814                          1579  ; -----------------------------------------------------------------------------
00002814  48E7 00C0               1580              MOVEM.L A0-A1,-(A7)
00002818  4EB8 2584               1581              JSR     DMMFIRST
0000281C  B1FC 00000000           1582  .LOOP       CMP.L   #0,A0
00002822  6700 0010               1583              BEQ     .END
00002826  2268 0004               1584              MOVE.L  4(A0),A1
0000282A  5088                    1585              ADD.L   #8,A0
0000282C  4E91                    1586              JSR     (A1)
0000282E  4EB8 25A6               1587              JSR     DMMNEXT
00002832  60E8                    1588              BRA     .LOOP
00002834  4CDF 0300               1589  .END        MOVEM.L (A7)+,A0-A1
00002838  4E75                    1590              RTS
0000283A                          1591  
0000283A                          1592  ; -----------------------------------------------------------------------------
0000283A  =0000260E               1593  AGLKILL     EQU     DMMFREE
0000283A                          1594  ; KILLS THE AGENT BY RELEASING ITS MEMORY
0000283A                          1595  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
0000283A                          1596  ; OUTPUT   - NONE
0000283A                          1597  ; MODIFIES - NONE
0000283A                          1598  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
0000283A                          1599  ; -----------------------------------------------------------------------------
0000283A                          1600  -------------------- end include --------------------
0000283A                          1601              INCLUDE "LIB/UTLCODE.X68"           
0000283A                          1602  ; =============================================================================
0000283A                          1603  ; UTILITY CODE
0000283A                          1604  ; =============================================================================
0000283A                          1605  
0000283A                          1606  ; -----------------------------------------------------------------------------
0000283A                          1607  UTLINIT
0000283A                          1608  ; INITIALIZES UTILITY CODE
0000283A                          1609  ; INPUT    - NONE
0000283A                          1610  ; OUTPUT   - NONE
0000283A                          1611  ; MODIFIES - NONE
0000283A                          1612  ; -----------------------------------------------------------------------------
0000283A  48E7 C000               1613              MOVEM.L D0-D1,-(A7)
0000283E  103C 0008               1614              MOVE.B  #8,D0
00002842  4E4F                    1615              TRAP    #15
00002844  13C1 000037A2           1616              MOVE.B  D1,(UTLRNDIX)
0000284A  4CDF 0003               1617              MOVEM.L (A7)+,D0-D1
0000284E  4E75                    1618              RTS
00002850                          1619  
00002850                          1620  ; -----------------------------------------------------------------------------
00002850                          1621  UTLRAND
00002850                          1622  ; PROVIDES A PSEUDO-RANDOM BYTE
00002850                          1623  ; INPUT    - NONE
00002850                          1624  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00002850                          1625  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00002850                          1626  ; -----------------------------------------------------------------------------
00002850  2F08                    1627              MOVE.L  A0,-(A7)
00002852  41F9 0000286E           1628              LEA     .RANDVEC,A0
00002858  4280                    1629              CLR.L   D0
0000285A  1039 000037A2           1630              MOVE.B  (UTLRNDIX),D0
00002860  1030 0800               1631              MOVE.B  (A0,D0.L),D0
00002864  5239 000037A2           1632              ADDQ.B  #1,(UTLRNDIX)
0000286A  205F                    1633              MOVE.L  (A7)+,A0
0000286C  4E75                    1634              RTS
0000286E                          1635  
0000286E                          1636  
0000286E= A2 EE 9A 0C F5 24 ...   1637  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00002876= 2A A3 51 26 E0 AC ...   1638              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
0000287E= 75 51 CA FD 33 EB ...   1639              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00002886= 60 CC E7 B8 9A EB ...   1640              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
0000288E= 1D 76 B5 95 B0 89 ...   1641              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00002896= 39 15 48 C9 6E CA ...   1642              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
0000289E= 43 E7 E2 7C 37 25 ...   1643              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000028A6= E9 94 CE E9 E4 52 ...   1644              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000028AE= 37 6D 9A 84 A2 28 ...   1645              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000028B6= 19 E2 C6 77 80 D4 ...   1646              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000028BE= 0A 5A 32 67 33 C2 ...   1647              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000028C6= 59 80 DC 0E 57 FC ...   1648              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000028CE= 8A AB BC F7 07 4D ...   1649              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000028D6= EF D5 77 6E 1E BB ...   1650              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000028DE= D6 E0 2A 8F BD 28 ...   1651              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000028E6= 13 4F 66 EC 0A 64 ...   1652              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000028EE= 56 52 9A 16 9B 90 ...   1653              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000028F6= 06 8A A4 F7 01 DA ...   1654              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000028FE= F2 E7 77 28 B1 76 ...   1655              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00002906= A4 42 E3 81 B1 67 ...   1656              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000290E= BF CE FA 16 BF 38 ...   1657              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00002916= D1 8B 50 0C 5F 49 ...   1658              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000291E= DE 4C 14 A2 40 DC ...   1659              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00002926= B6 9B 0A 38 5D AB ...   1660              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000292E= E2 1B DD 75 15 82 ...   1661              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00002936= 8A 26 51 30 9F 47 ...   1662              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
0000293E= 1E 8A BB 71 C6 6E ...   1663              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00002946= 9F 47 E5 34 94 27 ...   1664              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000294E= 7D 06 D6 BA 30 0F ...   1665              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00002956= EC 7F 7E 03 CF 2D ...   1666              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
0000295E= 94 5B 23 F2 8B CD ...   1667              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00002966= 74 33 EC B9 0F D5 ...   1668              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00002966= 74 33 EC B9 0F D5 ...   1669  -------------------- end include --------------------
0000296E                          1670              INCLUDE "PLAYER.X68"    
0000296E                          1671  ; ==============================================================================
0000296E                          1672  ; PLAYER MANAGEMENT
0000296E                          1673  ; ==============================================================================
0000296E                          1674              
0000296E                          1675  ; ------------------------------------------------------------------------------
0000296E                          1676  PLAYERINIT
0000296E                          1677  ; INITIALIZE PLAYER.
0000296E                          1678  ; INPUT    : NONE 
0000296E                          1679  ; OUTPUT   : NONE
0000296E                          1680  ; MODIFIES : NONE
0000296E                          1681  ; ------------------------------------------------------------------------------
0000296E  4E75                    1682              RTS
00002970                          1683              
00002970                          1684  ; ------------------------------------------------------------------------------
00002970                          1685  PLAYERUPD
00002970                          1686  ; UPDATES THE PLAYER.
00002970                          1687  ; INPUT    : NONE 
00002970                          1688  ; OUTPUT   : NONE
00002970                          1689  ; MODIFIES : NONE
00002970                          1690  ; ------------------------------------------------------------------------------
00002970                          1691              ;;CHECK LIMITS IN MAPS
00002970  3F00                    1692                  MOVE.W D0, -(A7)
00002972  3039 00003782           1693              MOVE.W LOADEDMAP, D0
00002978  B07C 0000               1694              CMP #0, D0
0000297C  6700 0046               1695              BEQ NOLIMITMENU
00002980  B07C 0001               1696              CMP #1, D0
00002984  6700 0056               1697              BEQ LIMAPA1
00002988  B07C 0002               1698              CMP #2, D0
0000298C  6700 014C               1699              BEQ LIMAPA2
00002990  B07C 0003               1700              CMP #3, D0
00002994  6700 0354               1701              BEQ LIMAPA3
00002998  B07C 0004               1702              CMP #4, D0
0000299C  6700 0444               1703              BEQ LIMAPA4
000029A0  B07C 0005               1704              CMP #5, D0
000029A4  6700 0534               1705              BEQ LIMAPA5
000029A8  B07C 0006               1706              CMP #6, D0
000029AC  6700 06D4               1707              BEQ LIMAPA6
000029B0  B07C 0007               1708              CMP #7, D0
000029B4  6700 0880               1709              BEQ LIMAPA7
000029B8  B07C 0008               1710              CMP #8, D0
000029BC  6700 0970               1711              BEQ LIMAPA8
000029C0  301F                    1712              MOVE.W (A7)+, D0
000029C2                          1713  
000029C2  4E75                    1714              RTS
000029C4                          1715  NOLIMITMENU
000029C4  33FC 0080 00003774      1716      MOVE.W #128, PLAYERPOSX
000029CC  33FC 0080 00003776      1717      MOVE.W #128, PLAYERPOSY
000029D4  301F                    1718      MOVE.W (A7)+, D0
000029D6  4EF9 00003426           1719      JMP NOLIMIT
000029DC                          1720  LIMAPA1
000029DC  301F                    1721      MOVE.W (A7)+, D0
000029DE  48A7 F800               1722      MOVEM.W D0-D4, -(A7)
000029E2  3039 00003774           1723      MOVE.W PLAYERPOSX, D0
000029E8  3239 00003776           1724      MOVE.W PLAYERPOSY, D1
000029EE                          1725      ;CHECK FOR WALLS IN MAP 1
000029EE                          1726      ;CHECK UPPER WALL 
000029EE  B07C 0280               1727      CMP #640, D0  ; BGT = 352 > D0
000029F2  6E00 0026               1728      BGT MAP1NOLIMIT1   
000029F6  B07C 0000               1729      CMP #0, D0
000029FA  6D00 001E               1730      BLT MAP1NOLIMIT1
000029FE                          1731      ;NOW WE CHECK POS Y 
000029FE  B27C 0060               1732      CMP #96, D1  ; 
00002A02  6E00 0016               1733      BGT MAP1NOLIMIT1    
00002A06  B27C 0000               1734      CMP #0, D1
00002A0A  6D00 000E               1735      BLT MAP1NOLIMIT1
00002A0E                          1736      ;;;; AQUI PISA EL LIMITE
00002A0E  4C9F 001F               1737      MOVEM.W (A7)+, D0-D4
00002A12  5279 00003776           1738      ADD.W #1, PLAYERPOSY
00002A18  4E75                    1739      RTS
00002A1A                          1740  MAP1NOLIMIT1
00002A1A                          1741      ;CHECK FOR RIGHT WALL   
00002A1A  B07C 0220               1742      CMP #544, D0  ; BGT = 352 > D0
00002A1E  6E00 0026               1743      BGT MAP1NOLIMIT2    
00002A22  B07C 0200               1744      CMP #512, D0
00002A26  6D00 001E               1745      BLT MAP1NOLIMIT2
00002A2A                          1746      ;NOW WE CHECK POS Y 
00002A2A  B27C 0280               1747      CMP #640, D1  ; 
00002A2E  6E00 0016               1748      BGT MAP1NOLIMIT2    
00002A32  B27C 0000               1749      CMP #0, D1
00002A36  6D00 000E               1750      BLT MAP1NOLIMIT2
00002A3A                          1751      ;;;; AQUI PISA EL LIMITE
00002A3A  4C9F 001F               1752      MOVEM.W (A7)+, D0-D4
00002A3E  5379 00003774           1753      SUB.W #1, PLAYERPOSX
00002A44  4E75                    1754      RTS
00002A46                          1755  MAP1NOLIMIT2 
00002A46                          1756      ;CHECK FOR BOTTOM-RIGHT WALL
00002A46  B07C 0280               1757      CMP #640, D0  ; BGT = 352 > D0
00002A4A  6E00 002C               1758      BGT MAP1NOLIMIT3    
00002A4E  B07C 0140               1759      CMP #320, D0
00002A52  6D00 0024               1760      BLT MAP1NOLIMIT3
00002A56                          1761      ;NOW WE CHECK POS Y 
00002A56  B27C 01E0               1762      CMP #480, D1  ; 
00002A5A  6E00 001C               1763      BGT MAP1NOLIMIT3    
00002A5E  B27C 0180               1764      CMP #384, D1
00002A62  6D00 0014               1765      BLT MAP1NOLIMIT3
00002A66                          1766      ;;;; AQUI PISA EL LIMITE
00002A66  4C9F 001F               1767      MOVEM.W (A7)+, D0-D4
00002A6A  5279 00003774           1768      ADD.W #1, PLAYERPOSX
00002A70  5379 00003776           1769      SUB.W #1, PLAYERPOSY
00002A76  4E75                    1770      RTS
00002A78                          1771  MAP1NOLIMIT3
00002A78                          1772      ;CHECK FOR BOTTOM-LEFT WALL 
00002A78  B07C 0120               1773      CMP #288, D0  ; BGT = 352 > D0
00002A7C  6E00 0026               1774      BGT MAP1NOLIMIT4    
00002A80  B07C 0000               1775      CMP #0, D0
00002A84  6D00 001E               1776      BLT MAP1NOLIMIT4
00002A88                          1777      ;NOW WE CHECK POS Y 
00002A88  B27C 01E0               1778      CMP #480, D1  ; 
00002A8C  6E00 0016               1779      BGT MAP1NOLIMIT4    
00002A90  B27C 0180               1780      CMP #384, D1
00002A94  6D00 000E               1781      BLT MAP1NOLIMIT4
00002A98                          1782      ;;;; AQUI PISA EL LIMITE
00002A98  4C9F 001F               1783      MOVEM.W (A7)+, D0-D4
00002A9C  5379 00003776           1784      SUB.W #1, PLAYERPOSY
00002AA2  4E75                    1785      RTS
00002AA4                          1786  MAP1NOLIMIT4 
00002AA4                          1787      ;CHECK FOR BOTTOM-LEFT WALL 
00002AA4  B07C 0060               1788      CMP #96, D0  ; BGT = 352 > D0
00002AA8  6E00 0026               1789      BGT MAP1NOLIMITEND    
00002AAC  B07C 0000               1790      CMP #0, D0
00002AB0  6D00 001E               1791      BLT MAP1NOLIMITEND
00002AB4                          1792      ;NOW WE CHECK POS Y 
00002AB4  B27C 0280               1793      CMP #640, D1  ; 
00002AB8  6E00 0016               1794      BGT MAP1NOLIMITEND    
00002ABC  B27C 0000               1795      CMP #0, D1
00002AC0  6D00 000E               1796      BLT MAP1NOLIMITEND
00002AC4                          1797      ;;;; AQUI PISA EL LIMITE
00002AC4  4C9F 001F               1798      MOVEM.W (A7)+, D0-D4
00002AC8  5279 00003774           1799      ADD.W #1, PLAYERPOSX
00002ACE  4E75                    1800      RTS
00002AD0                          1801  MAP1NOLIMITEND
00002AD0  4C9F 001F               1802      MOVEM.W (A7)+, D0-D4
00002AD4  4EF9 00003426           1803      JMP NOLIMIT
00002ADA                          1804      
00002ADA                          1805  LIMAPA2
00002ADA  301F                    1806      MOVE.W (A7)+, D0
00002ADC  48A7 F800               1807      MOVEM.W D0-D4, -(A7)
00002AE0  3039 00003774           1808      MOVE.W PLAYERPOSX, D0
00002AE6  3239 00003776           1809      MOVE.W PLAYERPOSY, D1
00002AEC                          1810      ;CHECK FOR TOP-LEFT WALL 
00002AEC  B07C 0120               1811      CMP #288, D0  ; BGT = 352 > D0
00002AF0  6E00 002C               1812      BGT MAP2NOLIMIT1    
00002AF4  B07C 0000               1813      CMP #0, D0
00002AF8  6D00 0024               1814      BLT MAP2NOLIMIT1
00002AFC                          1815      ;NOW WE CHECK POS Y 
00002AFC  B27C 0060               1816      CMP #96, D1  ; 
00002B00  6E00 001C               1817      BGT MAP2NOLIMIT1    
00002B04  B27C 0000               1818      CMP #0, D1
00002B08  6D00 0014               1819      BLT MAP2NOLIMIT1
00002B0C                          1820      ;;;; AQUI PISA EL LIMITE
00002B0C  4C9F 001F               1821      MOVEM.W (A7)+, D0-D4
00002B10  5279 00003776           1822      ADD.W #1, PLAYERPOSY
00002B16  5279 00003774           1823      ADD.W #1, PLAYERPOSX
00002B1C  4E75                    1824      RTS
00002B1E                          1825  MAP2NOLIMIT1
00002B1E                          1826      ;CHECK FOR LEFT-UPPER-DOOR WALL
00002B1E  B07C 00C0               1827      CMP #192, D0  ; BGT = 352 > D0
00002B22  6E00 002C               1828      BGT MAP2NOLIMIT2    
00002B26  B07C 0000               1829      CMP #0, D0
00002B2A  6D00 0024               1830      BLT MAP2NOLIMIT2
00002B2E                          1831      ;NOW WE CHECK POS Y 
00002B2E  B27C 009F               1832      CMP #159, D1  ; 
00002B32  6E00 001C               1833      BGT MAP2NOLIMIT2    
00002B36  B27C 0000               1834      CMP #0, D1
00002B3A  6D00 0014               1835      BLT MAP2NOLIMIT2
00002B3E                          1836      ;;;; AQUI PISA EL LIMITE
00002B3E  4C9F 001F               1837      MOVEM.W (A7)+, D0-D4
00002B42  5279 00003774           1838      ADD.W #1, PLAYERPOSX
00002B48  5279 00003776           1839      ADD.W #1, PLAYERPOSY
00002B4E  4E75                    1840      RTS
00002B50                          1841  MAP2NOLIMIT2
00002B50                          1842      ;CHECK FOR LEFT-BOTTOM-DOOR WALL
00002B50  B07C 00C0               1843      CMP #192, D0  ; BGT = 352 > D0
00002B54  6E00 002C               1844      BGT MAP2NOLIMIT3    
00002B58  B07C 0000               1845      CMP #0, D0
00002B5C  6D00 0024               1846      BLT MAP2NOLIMIT3
00002B60                          1847      ;NOW WE CHECK POS Y 
00002B60  B27C 01E0               1848      CMP #480, D1  ; 
00002B64  6E00 001C               1849      BGT MAP2NOLIMIT3    
00002B68  B27C 00A2               1850      CMP #162, D1
00002B6C  6D00 0014               1851      BLT MAP2NOLIMIT3
00002B70                          1852      ;;;; AQUI PISA EL LIMITE
00002B70  4C9F 001F               1853      MOVEM.W (A7)+, D0-D4
00002B74  5279 00003774           1854      ADD.W #1, PLAYERPOSX
00002B7A  5379 00003776           1855      SUB.W #1, PLAYERPOSY
00002B80  4E75                    1856      RTS
00002B82                          1857  MAP2NOLIMIT3
00002B82                          1858      ;CHECK FOR LEFT CORNER
00002B82  B07C 00E0               1859      CMP #224, D0  ; BGT = 352 > D0
00002B86  6E00 002C               1860      BGT MAP2NOLIMIT4    
00002B8A  B07C 0000               1861      CMP #0, D0
00002B8E  6D00 0024               1862      BLT MAP2NOLIMIT4
00002B92                          1863      ;NOW WE CHECK POS Y 
00002B92  B27C 01E0               1864      CMP #480, D1  ; 
00002B96  6E00 001C               1865      BGT MAP2NOLIMIT4    
00002B9A  B27C 0100               1866      CMP #256, D1
00002B9E  6D00 0014               1867      BLT MAP2NOLIMIT4
00002BA2                          1868      ;;;; AQUI PISA EL LIMITE
00002BA2  4C9F 001F               1869      MOVEM.W (A7)+, D0-D4
00002BA6  5279 00003774           1870      ADD.W #1, PLAYERPOSX
00002BAC  5379 00003776           1871      SUB.W #1, PLAYERPOSY
00002BB2  4E75                    1872      RTS
00002BB4                          1873  MAP2NOLIMIT4
00002BB4                          1874      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002BB4  B07C 0120               1875      CMP #288, D0  ; BGT = 352 > D0
00002BB8  6E00 002C               1876      BGT MAP2NOLIMIT5    
00002BBC  B07C 00E0               1877      CMP #224, D0
00002BC0  6D00 0024               1878      BLT MAP2NOLIMIT5
00002BC4                          1879      ;NOW WE CHECK POS Y 
00002BC4  B27C 01E0               1880      CMP #480, D1  ; 
00002BC8  6E00 001C               1881      BGT MAP2NOLIMIT5    
00002BCC  B27C 0120               1882      CMP #288, D1
00002BD0  6D00 0014               1883      BLT MAP2NOLIMIT5
00002BD4                          1884      ;;;; AQUI PISA EL LIMITE
00002BD4  4C9F 001F               1885      MOVEM.W (A7)+, D0-D4
00002BD8  5279 00003774           1886      ADD.W #1, PLAYERPOSX
00002BDE  5379 00003776           1887      SUB.W #1, PLAYERPOSY
00002BE4  4E75                    1888      RTS
00002BE6                          1889  MAP2NOLIMIT5
00002BE6                          1890      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002BE6  B07C 0280               1891      CMP #640, D0  ; BGT = 352 > D0
00002BEA  6E00 002C               1892      BGT MAP2NOLIMIT6    
00002BEE  B07C 0140               1893      CMP #320, D0
00002BF2  6D00 0024               1894      BLT MAP2NOLIMIT6
00002BF6                          1895      ;NOW WE CHECK POS Y 
00002BF6  B27C 01E0               1896      CMP #480, D1  ; 
00002BFA  6E00 001C               1897      BGT MAP2NOLIMIT6    
00002BFE  B27C 0120               1898      CMP #288, D1
00002C02  6D00 0014               1899      BLT MAP2NOLIMIT6
00002C06                          1900      ;;;; AQUI PISA EL LIMITE
00002C06  4C9F 001F               1901      MOVEM.W (A7)+, D0-D4
00002C0A  5379 00003774           1902      SUB.W #1, PLAYERPOSX
00002C10  5379 00003776           1903      SUB.W #1, PLAYERPOSY
00002C16  4E75                    1904      RTS
00002C18                          1905  MAP2NOLIMIT6
00002C18                          1906  ;CHECK FOR RIGHT CORNER
00002C18  B07C 0280               1907      CMP #640, D0  ; BGT = 352 > D0
00002C1C  6E00 002C               1908      BGT MAP2NOLIMIT7    
00002C20  B07C 0180               1909      CMP #384, D0
00002C24  6D00 0024               1910      BLT MAP2NOLIMIT7
00002C28                          1911      ;NOW WE CHECK POS Y 
00002C28  B27C 01E0               1912      CMP #480, D1  ; 
00002C2C  6E00 001C               1913      BGT MAP2NOLIMIT7    
00002C30  B27C 0100               1914      CMP #256, D1
00002C34  6D00 0014               1915      BLT MAP2NOLIMIT7
00002C38                          1916      ;;;; AQUI PISA EL LIMITE
00002C38  4C9F 001F               1917      MOVEM.W (A7)+, D0-D4
00002C3C  5379 00003774           1918      SUB.W #1, PLAYERPOSX
00002C42  5379 00003776           1919      SUB.W #1, PLAYERPOSY
00002C48  4E75                    1920      RTS
00002C4A                          1921  MAP2NOLIMIT7
00002C4A                          1922      ;CHECK FOR RIGHT-BOTTOM-DOOR WALL
00002C4A  B07C 0280               1923      CMP #640, D0  ; BGT = 352 > D0
00002C4E  6E00 002C               1924      BGT MAP2NOLIMIT8    
00002C52  B07C 01A0               1925      CMP #416, D0
00002C56  6D00 0024               1926      BLT MAP2NOLIMIT8
00002C5A                          1927      ;NOW WE CHECK POS Y 
00002C5A  B27C 01E0               1928      CMP #480, D1  ; 
00002C5E  6E00 001C               1929      BGT MAP2NOLIMIT8    
00002C62  B27C 00A2               1930      CMP #162, D1
00002C66  6D00 0014               1931      BLT MAP2NOLIMIT8
00002C6A                          1932      ;;;; AQUI PISA EL LIMITE
00002C6A  4C9F 001F               1933      MOVEM.W (A7)+, D0-D4
00002C6E  5379 00003774           1934      SUB.W #1, PLAYERPOSX
00002C74  5379 00003776           1935      SUB.W #1, PLAYERPOSY
00002C7A  4E75                    1936      RTS
00002C7C                          1937  MAP2NOLIMIT8
00002C7C                          1938  ;CHECK FOR RIGHT-TOP-DOOR WALL
00002C7C  B07C 0280               1939      CMP #640, D0  ; BGT = 352 > D0
00002C80  6E00 002C               1940      BGT MAP2NOLIMIT9    
00002C84  B07C 01A0               1941      CMP #416, D0
00002C88  6D00 0024               1942      BLT MAP2NOLIMIT9
00002C8C                          1943      ;NOW WE CHECK POS Y 
00002C8C  B27C 00A0               1944      CMP #160, D1  ; 
00002C90  6E00 001C               1945      BGT MAP2NOLIMIT9    
00002C94  B27C 0000               1946      CMP #0, D1
00002C98  6D00 0014               1947      BLT MAP2NOLIMIT9
00002C9C                          1948      ;;;; AQUI PISA EL LIMITE
00002C9C  4C9F 001F               1949      MOVEM.W (A7)+, D0-D4
00002CA0  5379 00003774           1950      SUB.W #1, PLAYERPOSX
00002CA6  5279 00003776           1951      ADD.W #1, PLAYERPOSY
00002CAC  4E75                    1952      RTS
00002CAE                          1953  MAP2NOLIMIT9
00002CAE                          1954      ;CHECK FOR TOP RIGHT CORNER
00002CAE  B07C 0280               1955      CMP #640, D0  ; BGT = 352 > D0
00002CB2  6E00 002C               1956      BGT MAP2NOLIMIT10    
00002CB6  B07C 0140               1957      CMP #320, D0
00002CBA  6D00 0024               1958      BLT MAP2NOLIMIT10
00002CBE                          1959      ;NOW WE CHECK POS Y 
00002CBE  B27C 0060               1960      CMP #96, D1  ; 
00002CC2  6E00 001C               1961      BGT MAP2NOLIMIT10   
00002CC6  B27C 0000               1962      CMP #0, D1
00002CCA  6D00 0014               1963      BLT MAP2NOLIMIT10
00002CCE                          1964      ;;;; AQUI PISA EL LIMITE
00002CCE  4C9F 001F               1965      MOVEM.W (A7)+, D0-D4
00002CD2  5379 00003774           1966      SUB.W #1, PLAYERPOSX
00002CD8  5279 00003776           1967      ADD.W #1, PLAYERPOSY
00002CDE  4E75                    1968      RTS
00002CE0                          1969  MAP2NOLIMIT10
00002CE0  4C9F 001F               1970      MOVEM.W (A7)+, D0-D4
00002CE4  4EF9 00003426           1971      JMP NOLIMIT
00002CEA                          1972  LIMAPA3
00002CEA  301F                    1973      MOVE.W (A7)+, D0
00002CEC  48A7 F800               1974      MOVEM.W D0-D4, -(A7)
00002CF0  3039 00003774           1975      MOVE.W PLAYERPOSX, D0
00002CF6  3239 00003776           1976      MOVE.W PLAYERPOSY, D1
00002CFC                          1977      ;CHECK FOR TOP-LEFT WALL 
00002CFC  B07C 0120               1978      CMP #288, D0  ; BGT = 352 > D0
00002D00  6E00 0026               1979      BGT MAP3NOLIMIT1    
00002D04  B07C 0000               1980      CMP #0, D0
00002D08  6D00 001E               1981      BLT MAP3NOLIMIT1
00002D0C                          1982      ;NOW WE CHECK POS Y 
00002D0C  B27C 0020               1983      CMP #32, D1  ; 
00002D10  6E00 0016               1984      BGT MAP3NOLIMIT1    
00002D14  B27C 0000               1985      CMP #0, D1
00002D18  6D00 000E               1986      BLT MAP3NOLIMIT1
00002D1C                          1987      ;;;; AQUI PISA EL LIMITE
00002D1C  5279 00003776           1988      ADD.W #1, PLAYERPOSY
00002D22  4C9F 001F               1989      MOVEM.W (A7)+, D0-D4
00002D26  4E75                    1990      RTS
00002D28                          1991  MAP3NOLIMIT1
00002D28                          1992      ;CHECK FOR LEFT WALL
00002D28  B07C 0020               1993      CMP #32, D0  ; BGT = 352 > D0
00002D2C  6E00 0026               1994      BGT MAP3NOLIMIT2    
00002D30  B07C 0000               1995      CMP #0, D0
00002D34  6D00 001E               1996      BLT MAP3NOLIMIT2
00002D38                          1997      ;NOW WE CHECK POS Y 
00002D38  B27C 01E0               1998      CMP #480, D1  ; 
00002D3C  6E00 0016               1999      BGT MAP3NOLIMIT2    
00002D40  B27C 0000               2000      CMP #0, D1
00002D44  6D00 000E               2001      BLT MAP3NOLIMIT2
00002D48                          2002      ;;;; AQUI PISA EL LIMITE
00002D48  5279 00003774           2003      ADD.W #1, PLAYERPOSX
00002D4E  4C9F 001F               2004      MOVEM.W (A7)+, D0-D4
00002D52  4E75                    2005      RTS
00002D54                          2006  MAP3NOLIMIT2
00002D54                          2007      ;CHECK FOR BOTTOM WALL
00002D54  B07C 0280               2008      CMP #640, D0  ; BGT = 352 > D0
00002D58  6E00 0026               2009      BGT MAP3NOLIMIT3    
00002D5C  B07C 0000               2010      CMP #0, D0
00002D60  6D00 001E               2011      BLT MAP3NOLIMIT3
00002D64                          2012      ;NOW WE CHECK POS Y 
00002D64  B27C 01E0               2013      CMP #480, D1  ; 
00002D68  6E00 0016               2014      BGT MAP3NOLIMIT3    
00002D6C  B27C 01A0               2015      CMP #416, D1
00002D70  6D00 000E               2016      BLT MAP3NOLIMIT3
00002D74                          2017      ;;;; AQUI PISA EL LIMITE
00002D74  5379 00003776           2018      SUB.W #1, PLAYERPOSY
00002D7A  4C9F 001F               2019      MOVEM.W (A7)+, D0-D4
00002D7E  4E75                    2020      RTS
00002D80                          2021  MAP3NOLIMIT3
00002D80                          2022      ;CHECK FOR RIGHT WALL
00002D80  B07C 0280               2023      CMP #640, D0  ; BGT = 352 > D0
00002D84  6E00 0026               2024      BGT MAP3NOLIMIT4    
00002D88  B07C 0240               2025      CMP #576, D0
00002D8C  6D00 001E               2026      BLT MAP3NOLIMIT4
00002D90                          2027      ;NOW WE CHECK POS Y 
00002D90  B27C 01E0               2028      CMP #480, D1  ; 
00002D94  6E00 0016               2029      BGT MAP3NOLIMIT4    
00002D98  B27C 0000               2030      CMP #0, D1
00002D9C  6D00 000E               2031      BLT MAP3NOLIMIT4
00002DA0                          2032      ;;;; AQUI PISA EL LIMITE
00002DA0  5379 00003774           2033      SUB.W #1, PLAYERPOSX
00002DA6  4C9F 001F               2034      MOVEM.W (A7)+, D0-D4
00002DAA  4E75                    2035      RTS
00002DAC                          2036  MAP3NOLIMIT4
00002DAC                          2037      ;CHECK TOP-RIGHT WALL
00002DAC  B07C 0280               2038      CMP #640, D0  ; BGT = 352 > D0
00002DB0  6E00 0026               2039      BGT MAP3NOLIMIT5    
00002DB4  B07C 0160               2040      CMP #352, D0
00002DB8  6D00 001E               2041      BLT MAP3NOLIMIT5
00002DBC                          2042      ;NOW WE CHECK POS Y 
00002DBC  B27C 0020               2043      CMP #32, D1  ; 
00002DC0  6E00 0016               2044      BGT MAP3NOLIMIT5    
00002DC4  B27C 0000               2045      CMP #0, D1
00002DC8  6D00 000E               2046      BLT MAP3NOLIMIT5
00002DCC                          2047      ;;;; AQUI PISA EL LIMITE
00002DCC  5279 00003776           2048      ADD.W #1, PLAYERPOSY
00002DD2  4C9F 001F               2049      MOVEM.W (A7)+, D0-D4
00002DD6  4E75                    2050      RTS
00002DD8                          2051  MAP3NOLIMIT5
00002DD8  4C9F 001F               2052      MOVEM.W (A7)+, D0-D4
00002DDC  4EF9 00003426           2053      JMP NOLIMIT
00002DE2                          2054      
00002DE2                          2055  LIMAPA4
00002DE2  301F                    2056      MOVE.W (A7)+, D0
00002DE4  48A7 F800               2057      MOVEM.W D0-D4, -(A7)
00002DE8  3039 00003774           2058      MOVE.W PLAYERPOSX, D0
00002DEE  3239 00003776           2059      MOVE.W PLAYERPOSY, D1
00002DF4                          2060      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00002DF4                          2061      ;CHECK UPPER LEFT WALL 
00002DF4  B07C 0120               2062      CMP #288, D0  ; BGT = 352 > D0
00002DF8  6E00 0026               2063      BGT MAP4NOLIMIT1   
00002DFC  B07C 0000               2064      CMP #0, D0
00002E00  6D00 001E               2065      BLT MAP4NOLIMIT1
00002E04                          2066      ;NOW WE CHECK POS Y 
00002E04  B27C 00A0               2067      CMP #160, D1  ; 
00002E08  6E00 0016               2068      BGT MAP4NOLIMIT1    
00002E0C  B27C 0000               2069      CMP #0, D1
00002E10  6D00 000E               2070      BLT MAP4NOLIMIT1
00002E14                          2071      ;;;; AQUI PISA EL LIMITE
00002E14  4C9F 001F               2072      MOVEM.W (A7)+, D0-D4
00002E18  5279 00003776           2073      ADD.W #1, PLAYERPOSY
00002E1E  4E75                    2074      RTS
00002E20                          2075  MAP4NOLIMIT1
00002E20                          2076      ;CHECK BOTTOM WALL
00002E20  B07C 0280               2077      CMP #640, D0  ; BGT = 352 > D0
00002E24  6E00 0026               2078      BGT MAP4NOLIMIT2   
00002E28  B07C 0000               2079      CMP #0, D0
00002E2C  6D00 001E               2080      BLT MAP4NOLIMIT2
00002E30                          2081      ;NOW WE CHECK POS Y 
00002E30  B27C 01E0               2082      CMP #480, D1  ; 
00002E34  6E00 0016               2083      BGT MAP4NOLIMIT2    
00002E38  B27C 0120               2084      CMP #288, D1
00002E3C  6D00 000E               2085      BLT MAP4NOLIMIT2
00002E40                          2086      ;;;; AQUI PISA EL LIMITE
00002E40  4C9F 001F               2087      MOVEM.W (A7)+, D0-D4
00002E44  5379 00003776           2088      SUB.W #1, PLAYERPOSY
00002E4A  4E75                    2089      RTS
00002E4C                          2090  MAP4NOLIMIT2
00002E4C                          2091      ;CHECK LEFT WALL
00002E4C  B07C 00C0               2092      CMP #192, D0  ; BGT = 352 > D0
00002E50  6E00 0026               2093      BGT MAP4NOLIMIT3   
00002E54  B07C 0000               2094      CMP #0, D0
00002E58  6D00 001E               2095      BLT MAP4NOLIMIT3
00002E5C                          2096      ;NOW WE CHECK POS Y 
00002E5C  B27C 01E0               2097      CMP #480, D1  ; 
00002E60  6E00 0016               2098      BGT MAP4NOLIMIT3    
00002E64  B27C 0000               2099      CMP #0, D1
00002E68  6D00 000E               2100      BLT MAP4NOLIMIT3
00002E6C                          2101      ;;;; AQUI PISA EL LIMITE
00002E6C  4C9F 001F               2102      MOVEM.W (A7)+, D0-D4
00002E70  5279 00003774           2103      ADD.W #1, PLAYERPOSX
00002E76  4E75                    2104      RTS
00002E78                          2105  MAP4NOLIMIT3
00002E78                          2106      ;CHECK RIGHT WALL
00002E78  B07C 0280               2107      CMP #640, D0  ; BGT = 352 > D0
00002E7C  6E00 0026               2108      BGT MAP4NOLIMIT4   
00002E80  B07C 01A0               2109      CMP #416, D0
00002E84  6D00 001E               2110      BLT MAP4NOLIMIT4
00002E88                          2111      ;NOW WE CHECK POS Y 
00002E88  B27C 01E0               2112      CMP #480, D1  ; 
00002E8C  6E00 0016               2113      BGT MAP4NOLIMIT4    
00002E90  B27C 0000               2114      CMP #0, D1
00002E94  6D00 000E               2115      BLT MAP4NOLIMIT4
00002E98                          2116      ;;;; AQUI PISA EL LIMITE
00002E98  4C9F 001F               2117      MOVEM.W (A7)+, D0-D4
00002E9C  5379 00003774           2118      SUB.W #1, PLAYERPOSX
00002EA2  4E75                    2119      RTS
00002EA4                          2120  MAP4NOLIMIT4
00002EA4                          2121  ;CHECK TOP RIGHT WALL
00002EA4  B07C 0280               2122      CMP #640, D0  ; BGT = 352 > D0
00002EA8  6E00 0026               2123      BGT MAP4NOLIMIT5   
00002EAC  B07C 0160               2124      CMP #352, D0
00002EB0  6D00 001E               2125      BLT MAP4NOLIMIT5
00002EB4                          2126      ;NOW WE CHECK POS Y 
00002EB4  B27C 00A0               2127      CMP #160, D1  ; 
00002EB8  6E00 0016               2128      BGT MAP4NOLIMIT5    
00002EBC  B27C 0000               2129      CMP #0, D1
00002EC0  6D00 000E               2130      BLT MAP4NOLIMIT5
00002EC4                          2131      ;;;; AQUI PISA EL LIMITE
00002EC4  4C9F 001F               2132      MOVEM.W (A7)+, D0-D4
00002EC8  5279 00003776           2133      ADD.W #1, PLAYERPOSY
00002ECE  4E75                    2134      RTS
00002ED0                          2135  MAP4NOLIMIT5
00002ED0  4C9F 001F               2136      MOVEM.W (A7)+, D0-D4
00002ED4  4EF9 00003426           2137      JMP NOLIMIT
00002EDA                          2138  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;END HEAVEN MAPS
00002EDA                          2139  LIMAPA5
00002EDA  301F                    2140      MOVE.W (A7)+, D0
00002EDC  48A7 F800               2141      MOVEM.W D0-D4, -(A7)
00002EE0  3039 00003774           2142      MOVE.W PLAYERPOSX, D0
00002EE6  3239 00003776           2143      MOVE.W PLAYERPOSY, D1
00002EEC                          2144      ;CHECK FOR WALLS IN MAP 5
00002EEC                          2145      ;CHECK UPPER WALL 
00002EEC  B07C 0280               2146      CMP #640, D0  ; BGT = 352 > D0
00002EF0  6E00 0026               2147      BGT MAP5NOLIMIT1   
00002EF4  B07C 0000               2148      CMP #0, D0
00002EF8  6D00 001E               2149      BLT MAP5NOLIMIT1
00002EFC                          2150      ;NOW WE CHECK POS Y 
00002EFC  B27C 0020               2151      CMP #32, D1  ; 
00002F00  6E00 0016               2152      BGT MAP5NOLIMIT1    
00002F04  B27C 0000               2153      CMP #0, D1
00002F08  6D00 000E               2154      BLT MAP5NOLIMIT1
00002F0C                          2155      ;;;; AQUI PISA EL LIMITE
00002F0C  4C9F 001F               2156      MOVEM.W (A7)+, D0-D4
00002F10  5279 00003776           2157      ADD.W #1, PLAYERPOSY
00002F16  4E75                    2158      RTS
00002F18                          2159  MAP5NOLIMIT1
00002F18                          2160      ;CHECK FOR RIGHT WALL 
00002F18  B07C 0280               2161      CMP #640, D0  ; BGT = 352 > D0
00002F1C  6E00 0026               2162      BGT MAP5NOLIMIT2    
00002F20  B07C 0240               2163      CMP #576, D0
00002F24  6D00 001E               2164      BLT MAP5NOLIMIT2
00002F28                          2165      ;NOW WE CHECK POS Y 
00002F28  B27C 01E0               2166      CMP #480, D1  ; 
00002F2C  6E00 0016               2167      BGT MAP5NOLIMIT2    
00002F30  B27C 0000               2168      CMP #0, D1
00002F34  6D00 000E               2169      BLT MAP5NOLIMIT2
00002F38                          2170      ;;;; AQUI PISA EL LIMITE
00002F38  5379 00003774           2171      SUB.W #1, PLAYERPOSX
00002F3E  4C9F 001F               2172      MOVEM.W (A7)+, D0-D4
00002F42  4E75                    2173      RTS
00002F44                          2174  MAP5NOLIMIT2
00002F44                          2175      ;CHECK LEFT WALL
00002F44  B07C 0020               2176          CMP #32, D0  ; BGT = 352 > D0
00002F48  6E00 0026               2177      BGT MAP5NOLIMIT3    
00002F4C  B07C 0000               2178      CMP #0, D0
00002F50  6D00 001E               2179      BLT MAP5NOLIMIT3
00002F54                          2180      ;NOW WE CHECK POS Y 
00002F54  B27C 01E0               2181      CMP #480, D1  ; 
00002F58  6E00 0016               2182      BGT MAP5NOLIMIT3    
00002F5C  B27C 0000               2183      CMP #0, D1
00002F60  6D00 000E               2184      BLT MAP5NOLIMIT3
00002F64                          2185      ;;;; AQUI PISA EL LIMITE
00002F64  5279 00003774           2186      ADD.W #1, PLAYERPOSX
00002F6A  4C9F 001F               2187      MOVEM.W (A7)+, D0-D4
00002F6E  4E75                    2188      RTS
00002F70                          2189  MAP5NOLIMIT3
00002F70                          2190      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002F70  B07C 0120               2191      CMP #288, D0  ; BGT = 352 > D0
00002F74  6E00 0026               2192      BGT MAP5NOLIMIT4    
00002F78  B07C 0000               2193      CMP #0, D0
00002F7C  6D00 001E               2194      BLT MAP5NOLIMIT4
00002F80                          2195      ;NOW WE CHECK POS Y 
00002F80  B27C 01E0               2196      CMP #480, D1  ; 
00002F84  6E00 0016               2197      BGT MAP5NOLIMIT4    
00002F88  B27C 01A0               2198      CMP #416, D1
00002F8C  6D00 000E               2199      BLT MAP5NOLIMIT4
00002F90                          2200      ;;;; AQUI PISA EL LIMITE
00002F90  4C9F 001F               2201      MOVEM.W (A7)+, D0-D4
00002F94  5379 00003776           2202      SUB.W #1, PLAYERPOSY
00002F9A  4E75                    2203      RTS
00002F9C                          2204  MAP5NOLIMIT4
00002F9C                          2205      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002F9C  B07C 0280               2206      CMP #640, D0  ; BGT = 352 > D0
00002FA0  6E00 0026               2207      BGT MAP5NOLIMIT5    
00002FA4  B07C 0140               2208      CMP #320, D0
00002FA8  6D00 001E               2209      BLT MAP5NOLIMIT5
00002FAC                          2210      ;NOW WE CHECK POS Y 
00002FAC  B27C 01E0               2211      CMP #480, D1  ; 
00002FB0  6E00 0016               2212      BGT MAP5NOLIMIT5    
00002FB4  B27C 01A0               2213      CMP #416, D1
00002FB8  6D00 000E               2214      BLT MAP5NOLIMIT5
00002FBC                          2215      ;;;; AQUI PISA EL LIMITE
00002FBC  4C9F 001F               2216      MOVEM.W (A7)+, D0-D4
00002FC0  5379 00003776           2217      SUB.W #1, PLAYERPOSY
00002FC6  4E75                    2218      RTS
00002FC8                          2219  MAP5NOLIMIT5
00002FC8                          2220      ;CHECK FOR MIDDLE-LEFT WALL 1
00002FC8  B07C 0120               2221      CMP #288, D0  ; BGT = 352 > D0
00002FCC  6E00 0026               2222      BGT MAP5NOLIMIT6    
00002FD0  B07C 0000               2223      CMP #0, D0
00002FD4  6D00 001E               2224      BLT MAP5NOLIMIT6
00002FD8                          2225      ;NOW WE CHECK POS Y 
00002FD8  B27C 00F0               2226      CMP #240, D1  ; 
00002FDC  6E00 0016               2227      BGT MAP5NOLIMIT6    
00002FE0  B27C 00C0               2228      CMP #192, D1 ;224
00002FE4  6D00 000E               2229      BLT MAP5NOLIMIT6
00002FE8                          2230      ;;;; AQUI PISA EL LIMITE
00002FE8  4C9F 001F               2231      MOVEM.W (A7)+, D0-D4
00002FEC  5379 00003776           2232      SUB.W #1, PLAYERPOSY
00002FF2  4E75                    2233      RTS
00002FF4                          2234  MAP5NOLIMIT6
00002FF4                          2235      ;CHECK FOR MIDDLE-RIGHT WALL 1
00002FF4  B07C 0280               2236      CMP #640, D0  ; BGT = 352 > D0
00002FF8  6E00 0026               2237      BGT MAP5NOLIMIT7    
00002FFC  B07C 0140               2238      CMP #320 , D0
00003000  6D00 001E               2239      BLT MAP5NOLIMIT7
00003004                          2240      ;NOW WE CHECK POS Y 
00003004  B27C 00F0               2241      CMP #240, D1  ; 
00003008  6E00 0016               2242      BGT MAP5NOLIMIT7    
0000300C  B27C 00C0               2243      CMP #192, D1 ;224
00003010  6D00 000E               2244      BLT MAP5NOLIMIT7
00003014                          2245      ;;;; AQUI PISA EL LIMITE
00003014  4C9F 001F               2246      MOVEM.W (A7)+, D0-D4
00003018  5379 00003776           2247      SUB.W #1, PLAYERPOSY
0000301E  4E75                    2248      RTS
00003020                          2249  MAP5NOLIMIT7
00003020                          2250      ;CHECK FOR MIDDLE-RIGHT WALL 2
00003020  B07C 0280               2251      CMP #640, D0  ; BGT = 352 > D0
00003024  6E00 0026               2252      BGT MAP5NOLIMIT8    
00003028  B07C 0140               2253      CMP #320 , D0
0000302C  6D00 001E               2254      BLT MAP5NOLIMIT8
00003030                          2255      ;NOW WE CHECK POS Y 
00003030  B27C 0100               2256      CMP #256, D1  ; 
00003034  6E00 0016               2257      BGT MAP5NOLIMIT8    
00003038  B27C 00F0               2258      CMP #240, D1 ;192
0000303C  6D00 000E               2259      BLT MAP5NOLIMIT8
00003040                          2260      ;;;; AQUI PISA EL LIMITE
00003040  4C9F 001F               2261      MOVEM.W (A7)+, D0-D4
00003044  5279 00003776           2262      ADD.W #1, PLAYERPOSY
0000304A  4E75                    2263      RTS
0000304C                          2264  MAP5NOLIMIT8
0000304C                          2265      ;CHECK FOR MIDDLE-LEFT WALL 2
0000304C  B07C 0120               2266      CMP #288, D0  ; BGT = 352 > D0
00003050  6E00 0026               2267      BGT MAP5NOLIMIT9    
00003054  B07C 0000               2268      CMP #0, D0
00003058  6D00 001E               2269      BLT MAP5NOLIMIT9
0000305C                          2270      ;NOW WE CHECK POS Y 
0000305C  B27C 0100               2271      CMP #256, D1  ; 
00003060  6E00 0016               2272      BGT MAP5NOLIMIT9    
00003064  B27C 00F0               2273      CMP #240, D1 ;224
00003068  6D00 000E               2274      BLT MAP5NOLIMIT9
0000306C                          2275      ;;;; AQUI PISA EL LIMITE
0000306C  4C9F 001F               2276      MOVEM.W (A7)+, D0-D4
00003070  5279 00003776           2277      ADD.W #1, PLAYERPOSY
00003076  4E75                    2278      RTS
00003078                          2279  MAP5NOLIMIT9
00003078  4C9F 001F               2280      MOVEM.W (A7)+, D0-D4
0000307C  4EF9 00003426           2281      JMP NOLIMIT
00003082                          2282  
00003082                          2283      
00003082                          2284  LIMAPA6
00003082  301F                    2285      MOVE.W (A7)+, D0
00003084  48A7 F800               2286      MOVEM.W D0-D4, -(A7)
00003088  3039 00003774           2287      MOVE.W PLAYERPOSX, D0
0000308E  3239 00003776           2288      MOVE.W PLAYERPOSY, D1
00003094                          2289      ;CHECK FOR WALLS IN MAP 5
00003094                          2290      ;CHECK LEFT UPPER WALL 
00003094  B07C 0120               2291      CMP #288, D0  ; BGT = 352 > D0
00003098  6E00 0026               2292      BGT MAP6NOLIMIT1   
0000309C  B07C 0000               2293      CMP #0, D0
000030A0  6D00 001E               2294      BLT MAP6NOLIMIT1
000030A4                          2295      ;NOW WE CHECK POS Y 
000030A4  B27C 0020               2296      CMP #32, D1  ; 
000030A8  6E00 0016               2297      BGT MAP6NOLIMIT1    
000030AC  B27C 0000               2298      CMP #0, D1
000030B0  6D00 000E               2299      BLT MAP6NOLIMIT1
000030B4                          2300      ;;;; AQUI PISA EL LIMITE
000030B4  4C9F 001F               2301      MOVEM.W (A7)+, D0-D4
000030B8  5279 00003776           2302      ADD.W #1, PLAYERPOSY
000030BE  4E75                    2303      RTS
000030C0                          2304  MAP6NOLIMIT1
000030C0                          2305      ;CHECK LEFT WALL
000030C0  B07C 0020               2306      CMP #32, D0  ; BGT = 352 > D0
000030C4  6E00 0026               2307      BGT MAP6NOLIMIT2    
000030C8  B07C 0000               2308      CMP #0, D0
000030CC  6D00 001E               2309      BLT MAP6NOLIMIT2
000030D0                          2310      ;NOW WE CHECK POS Y 
000030D0  B27C 01E0               2311      CMP #480, D1  ; 
000030D4  6E00 0016               2312      BGT MAP6NOLIMIT2    
000030D8  B27C 0000               2313      CMP #0, D1
000030DC  6D00 000E               2314      BLT MAP6NOLIMIT2
000030E0                          2315      ;;;; AQUI PISA EL LIMITE
000030E0  5279 00003774           2316      ADD.W #1, PLAYERPOSX
000030E6  4C9F 001F               2317      MOVEM.W (A7)+, D0-D4
000030EA  4E75                    2318      RTS
000030EC                          2319  MAP6NOLIMIT2
000030EC                          2320      ;CHECK FOR RIGHT WALL 
000030EC  B07C 0280               2321      CMP #640, D0  ; BGT = 352 > D0
000030F0  6E00 0026               2322      BGT MAP6NOLIMIT3    
000030F4  B07C 0240               2323      CMP #576, D0
000030F8  6D00 001E               2324      BLT MAP6NOLIMIT3
000030FC                          2325      ;NOW WE CHECK POS Y 
000030FC  B27C 01E0               2326      CMP #480, D1  ; 
00003100  6E00 0016               2327      BGT MAP6NOLIMIT3    
00003104  B27C 0000               2328      CMP #0, D1
00003108  6D00 000E               2329      BLT MAP6NOLIMIT3
0000310C                          2330      ;;;; AQUI PISA EL LIMITE
0000310C  5379 00003774           2331      SUB.W #1, PLAYERPOSX
00003112  4C9F 001F               2332      MOVEM.W (A7)+, D0-D4
00003116  4E75                    2333      RTS
00003118                          2334  MAP6NOLIMIT3
00003118                          2335      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00003118  B07C 0120               2336      CMP #288, D0  ; BGT = 352 > D0
0000311C  6E00 0026               2337      BGT MAP6NOLIMIT5   
00003120  B07C 0000               2338      CMP #0, D0
00003124  6D00 001E               2339      BLT MAP6NOLIMIT5
00003128                          2340      ;NOW WE CHECK POS Y 
00003128  B27C 01E0               2341      CMP #480, D1  ; 
0000312C  6E00 0016               2342      BGT MAP6NOLIMIT5    
00003130  B27C 01A0               2343      CMP #416, D1
00003134  6D00 000E               2344      BLT MAP6NOLIMIT5
00003138                          2345      ;;;; AQUI PISA EL LIMITE
00003138  4C9F 001F               2346      MOVEM.W (A7)+, D0-D4
0000313C  5379 00003776           2347      SUB.W #1, PLAYERPOSY
00003142  4E75                    2348      RTS
00003144                          2349  MAP6NOLIMIT5
00003144                          2350      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00003144  B07C 0280               2351      CMP #640, D0  ; BGT = 352 > D0
00003148  6E00 0026               2352      BGT MAP6NOLIMIT6    
0000314C  B07C 0140               2353      CMP #320, D0
00003150  6D00 001E               2354      BLT MAP6NOLIMIT6
00003154                          2355      ;NOW WE CHECK POS Y 
00003154  B27C 01E0               2356      CMP #480, D1  ; 
00003158  6E00 0016               2357      BGT MAP6NOLIMIT6    
0000315C  B27C 01A0               2358      CMP #416, D1
00003160  6D00 000E               2359      BLT MAP6NOLIMIT6
00003164                          2360      ;;;; AQUI PISA EL LIMITE
00003164  4C9F 001F               2361      MOVEM.W (A7)+, D0-D4
00003168  5379 00003776           2362      SUB.W #1, PLAYERPOSY
0000316E  4E75                    2363      RTS
00003170                          2364  MAP6NOLIMIT6
00003170                          2365      ;CHECK RIGHT-RIGHT ROOM WALL
00003170  B07C 0280               2366      CMP #640, D0  ; BGT = 352 > D0
00003174  6E00 0026               2367      BGT MAP6NOLIMIT7    
00003178  B07C 0222               2368      CMP #546, D0
0000317C  6D00 001E               2369      BLT MAP6NOLIMIT7
00003180                          2370      ;NOW WE CHECK POS Y 
00003180  B27C 01E0               2371      CMP #480, D1  ; 
00003184  6E00 0016               2372      BGT MAP6NOLIMIT7    
00003188  B27C 0120               2373      CMP #288, D1
0000318C  6D00 000E               2374      BLT MAP6NOLIMIT7
00003190                          2375      ;;;; AQUI PISA EL LIMITE
00003190  4C9F 001F               2376      MOVEM.W (A7)+, D0-D4
00003194  5379 00003776           2377      SUB.W #1, PLAYERPOSY
0000319A  4E75                    2378      RTS
0000319C                          2379  MAP6NOLIMIT7
0000319C                          2380      ;CHECK FOR LEFT-RIGHT ROOM WALL
0000319C  B07C 0218               2381      CMP #536, D0  ; BGT = 352 > D0
000031A0  6E00 002C               2382      BGT MAP6NOLIMIT8    
000031A4  B07C 0160               2383      CMP #352, D0
000031A8  6D00 0024               2384      BLT MAP6NOLIMIT8
000031AC                          2385      ;NOW WE CHECK POS Y 
000031AC  B27C 01E0               2386      CMP #480, D1  ; 
000031B0  6E00 001C               2387      BGT MAP6NOLIMIT8    
000031B4  B27C 0120               2388      CMP #288, D1
000031B8  6D00 0014               2389      BLT MAP6NOLIMIT8
000031BC                          2390      ;;;; AQUI PISA EL LIMITE
000031BC  4C9F 001F               2391      MOVEM.W (A7)+, D0-D4
000031C0  5379 00003774           2392      SUB.W #1, PLAYERPOSX
000031C6  5379 00003776           2393      SUB.W #1, PLAYERPOSY
000031CC  4E75                    2394      RTS
000031CE                          2395  MAP6NOLIMIT8
000031CE                          2396      ;CHECK LEFT-LEFT ROOM WALL
000031CE  B07C 003E               2397      CMP #62, D0  ; BGT = 352 > D0
000031D2  6E00 0026               2398      BGT MAP6NOLIMIT9    
000031D6  B07C 0000               2399      CMP #0, D0
000031DA  6D00 001E               2400      BLT MAP6NOLIMIT9
000031DE                          2401      ;NOW WE CHECK POS Y 
000031DE  B27C 01E0               2402      CMP #480, D1  ; 
000031E2  6E00 0016               2403      BGT MAP6NOLIMIT9    
000031E6  B27C 0120               2404      CMP #288, D1
000031EA  6D00 000E               2405      BLT MAP6NOLIMIT9
000031EE                          2406      ;;;; AQUI PISA EL LIMITE
000031EE  4C9F 001F               2407      MOVEM.W (A7)+, D0-D4
000031F2  5379 00003776           2408      SUB.W #1, PLAYERPOSY
000031F8  4E75                    2409      RTS
000031FA                          2410  MAP6NOLIMIT9
000031FA                          2411      ;CHECK FOR RIGHT-LEFT ROOM WALL
000031FA  B07C 0100               2412      CMP #256, D0  ; BGT = 352 > D0
000031FE  6E00 002C               2413      BGT MAP6NOLIMIT10   
00003202  B07C 0044               2414      CMP #68, D0
00003206  6D00 0024               2415      BLT MAP6NOLIMIT10
0000320A                          2416      ;NOW WE CHECK POS Y 
0000320A  B27C 01E0               2417      CMP #480, D1  ; 
0000320E  6E00 001C               2418      BGT MAP6NOLIMIT10   
00003212  B27C 0120               2419      CMP #288, D1
00003216  6D00 0014               2420      BLT MAP6NOLIMIT10
0000321A                          2421      ;;;; AQUI PISA EL LIMITE
0000321A  4C9F 001F               2422      MOVEM.W (A7)+, D0-D4
0000321E  5279 00003774           2423      ADD.W #1, PLAYERPOSX
00003224  5379 00003776           2424      SUB.W #1, PLAYERPOSY
0000322A  4E75                    2425      RTS
0000322C                          2426  MAP6NOLIMIT10
0000322C  4C9F 001F               2427      MOVEM.W (A7)+, D0-D4
00003230  4EF9 00003426           2428      JMP NOLIMIT
00003236                          2429  LIMAPA7
00003236  301F                    2430      MOVE.W (A7)+, D0
00003238  48A7 F800               2431      MOVEM.W D0-D4, -(A7)
0000323C  3039 00003774           2432      MOVE.W PLAYERPOSX, D0
00003242  3239 00003776           2433      MOVE.W PLAYERPOSY, D1
00003248                          2434      ;CHECK FOR TOP-LEFT WALL 
00003248  B07C 0120               2435      CMP #288, D0  ; BGT = 352 > D0
0000324C  6E00 0026               2436      BGT MAP7NOLIMIT1    
00003250  B07C 0000               2437      CMP #0, D0
00003254  6D00 001E               2438      BLT MAP7NOLIMIT1
00003258                          2439      ;NOW WE CHECK POS Y 
00003258  B27C 0020               2440      CMP #32, D1  ; 
0000325C  6E00 0016               2441      BGT MAP7NOLIMIT1    
00003260  B27C 0000               2442      CMP #0, D1
00003264  6D00 000E               2443      BLT MAP7NOLIMIT1
00003268                          2444      ;;;; AQUI PISA EL LIMITE
00003268  5279 00003776           2445      ADD.W #1, PLAYERPOSY
0000326E  4C9F 001F               2446      MOVEM.W (A7)+, D0-D4
00003272  4E75                    2447      RTS
00003274                          2448  MAP7NOLIMIT1
00003274                          2449      ;CHECK FOR LEFT WALL
00003274  B07C 0020               2450      CMP #32, D0  ; BGT = 352 > D0
00003278  6E00 0026               2451      BGT MAP7NOLIMIT2    
0000327C  B07C 0000               2452      CMP #0, D0
00003280  6D00 001E               2453      BLT MAP7NOLIMIT2
00003284                          2454      ;NOW WE CHECK POS Y 
00003284  B27C 01E0               2455      CMP #480, D1  ; 
00003288  6E00 0016               2456      BGT MAP7NOLIMIT2    
0000328C  B27C 0000               2457      CMP #0, D1
00003290  6D00 000E               2458      BLT MAP7NOLIMIT2
00003294                          2459      ;;;; AQUI PISA EL LIMITE
00003294  5279 00003774           2460      ADD.W #1, PLAYERPOSX
0000329A  4C9F 001F               2461      MOVEM.W (A7)+, D0-D4
0000329E  4E75                    2462      RTS
000032A0                          2463  MAP7NOLIMIT2
000032A0                          2464      ;CHECK FOR BOTTOM WALL
000032A0  B07C 0280               2465      CMP #640, D0  ; BGT = 352 > D0
000032A4  6E00 0026               2466      BGT MAP7NOLIMIT3    
000032A8  B07C 0000               2467      CMP #0, D0
000032AC  6D00 001E               2468      BLT MAP7NOLIMIT3
000032B0                          2469      ;NOW WE CHECK POS Y 
000032B0  B27C 01E0               2470      CMP #480, D1  ; 
000032B4  6E00 0016               2471      BGT MAP7NOLIMIT3    
000032B8  B27C 01A0               2472      CMP #416, D1
000032BC  6D00 000E               2473      BLT MAP7NOLIMIT3
000032C0                          2474      ;;;; AQUI PISA EL LIMITE
000032C0  5379 00003776           2475      SUB.W #1, PLAYERPOSY
000032C6  4C9F 001F               2476      MOVEM.W (A7)+, D0-D4
000032CA  4E75                    2477      RTS
000032CC                          2478  MAP7NOLIMIT3
000032CC                          2479      ;CHECK FOR RIGHT WALL
000032CC  B07C 0280               2480      CMP #640, D0  ; BGT = 352 > D0
000032D0  6E00 0026               2481      BGT MAP7NOLIMIT4    
000032D4  B07C 0240               2482      CMP #576, D0
000032D8  6D00 001E               2483      BLT MAP7NOLIMIT4
000032DC                          2484      ;NOW WE CHECK POS Y 
000032DC  B27C 01E0               2485      CMP #480, D1  ; 
000032E0  6E00 0016               2486      BGT MAP7NOLIMIT4    
000032E4  B27C 0000               2487      CMP #0, D1
000032E8  6D00 000E               2488      BLT MAP7NOLIMIT4
000032EC                          2489      ;;;; AQUI PISA EL LIMITE
000032EC  5379 00003774           2490      SUB.W #1, PLAYERPOSX
000032F2  4C9F 001F               2491      MOVEM.W (A7)+, D0-D4
000032F6  4E75                    2492      RTS
000032F8                          2493  MAP7NOLIMIT4
000032F8                          2494      ;CHECK TOP-RIGHT WALL
000032F8  B07C 0280               2495      CMP #640, D0  ; BGT = 352 > D0
000032FC  6E00 0026               2496      BGT MAP7NOLIMIT5    
00003300  B07C 0160               2497      CMP #352, D0
00003304  6D00 001E               2498      BLT MAP7NOLIMIT5
00003308                          2499      ;NOW WE CHECK POS Y 
00003308  B27C 0020               2500      CMP #32, D1  ; 
0000330C  6E00 0016               2501      BGT MAP7NOLIMIT5    
00003310  B27C 0000               2502      CMP #0, D1
00003314  6D00 000E               2503      BLT MAP7NOLIMIT5
00003318                          2504      ;;;; AQUI PISA EL LIMITE
00003318  5279 00003776           2505      ADD.W #1, PLAYERPOSY
0000331E  4C9F 001F               2506      MOVEM.W (A7)+, D0-D4
00003322  4E75                    2507      RTS
00003324                          2508  MAP7NOLIMIT5
00003324  4C9F 001F               2509      MOVEM.W (A7)+, D0-D4
00003328  4EF9 00003426           2510      JMP NOLIMIT
0000332E                          2511      
0000332E                          2512  LIMAPA8
0000332E  301F                    2513      MOVE.W (A7)+, D0
00003330  48A7 F800               2514      MOVEM.W D0-D4, -(A7)
00003334  3039 00003774           2515      MOVE.W PLAYERPOSX, D0
0000333A  3239 00003776           2516      MOVE.W PLAYERPOSY, D1
00003340                          2517      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00003340                          2518      ;CHECK UPPER LEFT WALL 
00003340  B07C 0120               2519      CMP #288, D0  ; BGT = 352 > D0
00003344  6E00 0026               2520      BGT MAP8NOLIMIT1   
00003348  B07C 0000               2521      CMP #0, D0
0000334C  6D00 001E               2522      BLT MAP8NOLIMIT1
00003350                          2523      ;NOW WE CHECK POS Y 
00003350  B27C 00A0               2524      CMP #160, D1  ; 
00003354  6E00 0016               2525      BGT MAP8NOLIMIT1    
00003358  B27C 0000               2526      CMP #0, D1
0000335C  6D00 000E               2527      BLT MAP8NOLIMIT1
00003360                          2528      ;;;; AQUI PISA EL LIMITE
00003360  4C9F 001F               2529      MOVEM.W (A7)+, D0-D4
00003364  5279 00003776           2530      ADD.W #1, PLAYERPOSY
0000336A  4E75                    2531      RTS
0000336C                          2532  MAP8NOLIMIT1
0000336C                          2533      ;CHECK BOTTOM WALL
0000336C  B07C 0280               2534      CMP #640, D0  ; BGT = 352 > D0
00003370  6E00 0026               2535      BGT MAP8NOLIMIT2   
00003374  B07C 0000               2536      CMP #0, D0
00003378  6D00 001E               2537      BLT MAP8NOLIMIT2
0000337C                          2538      ;NOW WE CHECK POS Y 
0000337C  B27C 01E0               2539      CMP #480, D1  ; 
00003380  6E00 0016               2540      BGT MAP8NOLIMIT2    
00003384  B27C 0120               2541      CMP #288, D1
00003388  6D00 000E               2542      BLT MAP8NOLIMIT2
0000338C                          2543      ;;;; AQUI PISA EL LIMITE
0000338C  4C9F 001F               2544      MOVEM.W (A7)+, D0-D4
00003390  5379 00003776           2545      SUB.W #1, PLAYERPOSY
00003396  4E75                    2546      RTS
00003398                          2547  MAP8NOLIMIT2
00003398                          2548      ;CHECK LEFT WALL
00003398  B07C 00C0               2549      CMP #192, D0  ; BGT = 352 > D0
0000339C  6E00 0026               2550      BGT MAP8NOLIMIT3   
000033A0  B07C 0000               2551      CMP #0, D0
000033A4  6D00 001E               2552      BLT MAP8NOLIMIT3
000033A8                          2553      ;NOW WE CHECK POS Y 
000033A8  B27C 01E0               2554      CMP #480, D1  ; 
000033AC  6E00 0016               2555      BGT MAP8NOLIMIT3    
000033B0  B27C 0000               2556      CMP #0, D1
000033B4  6D00 000E               2557      BLT MAP8NOLIMIT3
000033B8                          2558      ;;;; AQUI PISA EL LIMITE
000033B8  4C9F 001F               2559      MOVEM.W (A7)+, D0-D4
000033BC  5279 00003774           2560      ADD.W #1, PLAYERPOSX
000033C2  4E75                    2561      RTS
000033C4                          2562  MAP8NOLIMIT3
000033C4                          2563      ;CHECK RIGHT WALL
000033C4  B07C 0280               2564      CMP #640, D0  ; BGT = 352 > D0
000033C8  6E00 0026               2565      BGT MAP8NOLIMIT4   
000033CC  B07C 01A0               2566      CMP #416, D0
000033D0  6D00 001E               2567      BLT MAP8NOLIMIT4
000033D4                          2568      ;NOW WE CHECK POS Y 
000033D4  B27C 01E0               2569      CMP #480, D1  ; 
000033D8  6E00 0016               2570      BGT MAP8NOLIMIT4    
000033DC  B27C 0000               2571      CMP #0, D1
000033E0  6D00 000E               2572      BLT MAP8NOLIMIT4
000033E4                          2573      ;;;; AQUI PISA EL LIMITE
000033E4  4C9F 001F               2574      MOVEM.W (A7)+, D0-D4
000033E8  5379 00003774           2575      SUB.W #1, PLAYERPOSX
000033EE  4E75                    2576      RTS
000033F0                          2577  MAP8NOLIMIT4
000033F0                          2578  ;CHECK TOP RIGHT WALL
000033F0  B07C 0280               2579      CMP #640, D0  ; BGT = 352 > D0
000033F4  6E00 0026               2580      BGT MAP8NOLIMIT5   
000033F8  B07C 0160               2581      CMP #352, D0
000033FC  6D00 001E               2582      BLT MAP8NOLIMIT5
00003400                          2583      ;NOW WE CHECK POS Y 
00003400  B27C 00A0               2584      CMP #160, D1  ; 
00003404  6E00 0016               2585      BGT MAP8NOLIMIT5    
00003408  B27C 0000               2586      CMP #0, D1
0000340C  6D00 000E               2587      BLT MAP8NOLIMIT5
00003410                          2588      ;;;; AQUI PISA EL LIMITE
00003410  4C9F 001F               2589      MOVEM.W (A7)+, D0-D4
00003414  5279 00003776           2590      ADD.W #1, PLAYERPOSY
0000341A  4E75                    2591      RTS
0000341C                          2592  MAP8NOLIMIT5
0000341C  4C9F 001F               2593      MOVEM.W (A7)+, D0-D4
00003420  4EF9 00003426           2594      JMP NOLIMIT
00003426                          2595      
00003426                          2596  NOLIMIT
00003426  3F00                    2597              MOVE.W  D0,-(A7)
00003428  0839 0000 0000376C      2598        BTST #0, KBDVAL         
00003430  6700 000C               2599              BEQ .UP    
00003434  303C FFFC               2600              MOVE.W  #-PLAYERSPEED,D0     
00003438  4EB9 00003484           2601        JSR   MOVEHOR 
0000343E  0839 0001 0000376C      2602  .UP   BTST #1, KBDVAL           
00003446  6700 000C               2603        BEQ   .RIGHT  
0000344A  303C FFFC               2604              MOVE.W  #-PLAYERSPEED,D0      
0000344E  4EB9 000034AA           2605        JSR   MOVEVER
00003454  0839 0002 0000376C      2606  .RIGHT    BTST #2, KBDVAL
0000345C  6700 000C               2607        BEQ   .DOWN  
00003460  303C 0004               2608              MOVE.W  #PLAYERSPEED,D0     
00003464  4EB9 00003484           2609        JSR   MOVEHOR
0000346A  0839 0003 0000376C      2610  .DOWN     BTST #3, KBDVAL
00003472  6700 000C               2611        BEQ   .NOTMOVED  
00003476  303C 0004               2612              MOVE.W  #PLAYERSPEED,D0       
0000347A  4EB9 000034AA           2613        JSR   MOVEVER
00003480  301F                    2614  .NOTMOVED     MOVE.W  (A7)+,D0
00003482  4E75                    2615              RTS
00003484                          2616  
00003484  D179 00003774           2617  MOVEHOR     ADD.W   D0,(PLAYERPOSX)
0000348A  6A00 0008               2618              BPL.W   .NOTLEFTEDGE
0000348E  4279 00003774           2619              CLR.W   (PLAYERPOSX)
00003494                          2620  .NOTLEFTEDGE
00003494  0C79 0260 00003774      2621              CMP.W   #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
0000349C  6D00 000A               2622              BLT.W   .NORIGHTEDGE
000034A0  33FC 0260 00003774      2623              MOVE.W  #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
000034A8                          2624  .NORIGHTEDGE 
000034A8  4E75                    2625              RTS
000034AA                          2626              
000034AA  D179 00003776           2627  MOVEVER     ADD.W   D0,(PLAYERPOSY)
000034B0  6A00 0008               2628              BPL.W   .NOTUPPEREDGE
000034B4  4279 00003776           2629              CLR.W   (PLAYERPOSY)
000034BA                          2630  .NOTUPPEREDGE
000034BA  0C79 01C0 00003776      2631              CMP.W   #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
000034C2  6D00 000A               2632              BLT.W   .NOLOWEREDGE
000034C6  33FC 01C0 00003776      2633              MOVE.W  #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
000034CE                          2634  .NOLOWEREDGE 
000034CE  4E75                    2635              RTS
000034D0                          2636          
000034D0                          2637  ; ------------------------------------------------------------------------------
000034D0                          2638  PLAYERPLOT
000034D0                          2639  ; PLOT THE PLAYER.
000034D0                          2640  ; INPUT    : NONE 
000034D0                          2641  ; OUTPUT   : NONE
000034D0                          2642  ; MODIFIES : NONE
000034D0                          2643  ; ------------------------------------------------------------------------------
000034D0                          2644              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
000034D0  1F00                    2645              MOVE.B  D0,-(A7)
000034D2  2F01                    2646              MOVE.L  D1,-(A7)
000034D4  48A7 3800               2647        MOVEM.W D2-D4, -(A7)
000034D8                          2648        
000034D8  223C 00CC954E           2649        MOVE.L #$00CC954E,D1 ;PEN COLOR
000034DE  103C 0050               2650        MOVE.B #80,D0
000034E2  4E4F                    2651        TRAP #15
000034E4  223C 00B53866           2652        MOVE.L #$00B53866,D1 ;FILL COLOR
000034EA  103C 0051               2653        MOVE.B #81,D0
000034EE  4E4F                    2654        TRAP #15
000034F0                          2655        ; SE DIBUJA EL CUADRADO
000034F0  3239 00003774           2656        MOVE.W (PLAYERPOSX),D1    
000034F6  3439 00003776           2657        MOVE.W (PLAYERPOSY),D2      
000034FC  3601                    2658        MOVE.W D1,D3
000034FE  0643 0020               2659              ADD.W  #PLAYERWIDTH,D3  
00003502  3802                    2660        MOVE.W D2,D4
00003504  0644 0020               2661              ADD.W  #PLAYERHEIGHT,D4
00003508  103C 0057               2662        MOVE.B #87,D0
0000350C  4E4F                    2663        TRAP #15
0000350E                          2664        
0000350E  4C9F 001C               2665              MOVEM.W (A7)+,D2-D4
00003512  221F                    2666              MOVE.L  (A7)+,D1      
00003514  101F                    2667              MOVE.B  (A7)+,D0
00003516                          2668    
00003516  4E75                    2669        RTS
00003518                          2670  
00003518                          2671  
00003518                          2672  
00003518                          2673  
00003518                          2674  -------------------- end include --------------------
00003518                          2675              INCLUDE "PROJECTILE.X68"
00003518                          2676  ; ==============================================================================
00003518                          2677  ; PROJECTILE MANAGEMENT (AGENT)
00003518                          2678  ; PROJPOSX (W)  (A0)
00003518                          2679  ; PROJPOSY (W) 2(A0)
00003518                          2680  ; PROJVELX (W) 4(A0)
00003518                          2681  ; PROJVELY (W) 6(A0)
00003518                          2682  ; ==============================================================================
00003518                          2683  
00003518                          2684  ; ------------------------------------------------------------------------------
00003518                          2685  PROJINIT 
00003518                          2686  ; INITIALIZES THE PROJECTILE.
00003518                          2687  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00003518                          2688  ; OUTPUT   : NONE
00003518                          2689  ; MODIFIES : NONE
00003518                          2690  ; ------------------------------------------------------------------------------
00003518  2F00                    2691             MOVE.L  D0,-(A7)
0000351A                          2692             
0000351A  4280                    2693              CLR.L   D0
0000351C  0839 0004 0000376D      2694              BTST #4, (KBDEDGE)    
00003524  6700 0008               2695              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
00003528  0680 FFF80000           2696              ADD.L   #-PROJSPEEDX<<16,D0
0000352E  0839 0005 0000376D      2697  .FUP        BTST #5, (KBDEDGE)      
00003536  6700 0006               2698              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
0000353A  0640 FFF8               2699              ADD.W   #-PROJSPEEDY,D0 
0000353E  0839 0006 0000376D      2700  .FRIGHT     BTST #6, (KBDEDGE)
00003546  6700 0008               2701              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
0000354A  0680 00080000           2702              ADD.L   #PROJSPEEDX<<16,D0
00003550  0839 0007 0000376D      2703  .FDOWN      BTST #7, (KBDEDGE)
00003558  6700 0004               2704              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
0000355C  5040                    2705              ADD.W   #PROJSPEEDY,D0
0000355E  4A80                    2706  .NOTFDOWN   TST.L   D0
00003560  6600 0006               2707              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
00003564  303C 0008               2708              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
00003568  20B9 00003774           2709  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
0000356E  2140 0004               2710              MOVE.L  D0,4(A0) ; COMO X E Y ESTÁN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIÓN LONG WORD 
00003572  5279 00003778           2711              ADD.W   #1,(NPROJ)
00003578  201F                    2712              MOVE.L  (A7)+,D0
0000357A  4E75                    2713              RTS
0000357C                          2714              
0000357C                          2715  ; ------------------------------------------------------------------------------
0000357C                          2716  PROJUPD 
0000357C                          2717  ; UPDATES THE PROJECTILE.
0000357C                          2718  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
0000357C                          2719  ; OUTPUT   : NONE
0000357C                          2720  ; MODIFIES : NONE
0000357C                          2721  ; ------------------------------------------------------------------------------
0000357C  2F00                    2722              MOVE.L  D0,-(A7)
0000357E  2028 0004               2723              MOVE.L  4(A0),D0 ; COMO X E Y ESTÁN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIÓN LONG WORD
00003582  D168 0002               2724              ADD.W   D0,2(A0)
00003586  E088                    2725              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
00003588  E088                    2726              LSR.L   #8,D0
0000358A  D150                    2727              ADD.W   D0,(A0) 
0000358C  201F                    2728              MOVE.L  (A7)+,D0
0000358E  4E75                    2729              RTS
00003590                          2730      
00003590                          2731  ; ------------------------------------------------------------------------------
00003590                          2732  PROJPLOT 
00003590                          2733  ; PLOTS THE PROJECTILE.
00003590                          2734  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
00003590                          2735  ; OUTPUT   : NONE
00003590                          2736  ; MODIFIES : NONE
00003590                          2737  ; ------------------------------------------------------------------------------
00003590  1F00                    2738              MOVE.B  D0,-(A7)
00003592  2F01                    2739              MOVE.L  D1,-(A7)
00003594  48A7 3800               2740        MOVEM.W D2-D4, -(A7)
00003598                          2741        
00003598  223C 00C00FFE           2742        MOVE.L #$00C00FFE,D1 ;PEN COLOR
0000359E  103C 0050               2743        MOVE.B #80,D0
000035A2  4E4F                    2744        TRAP #15
000035A4  223C 00BFF006           2745        MOVE.L #$00BFF006,D1 ;FILL COLOR
000035AA  103C 0051               2746        MOVE.B #81,D0
000035AE  4E4F                    2747        TRAP #15
000035B0                          2748        ; SE DIBUJA EL CUADRADO
000035B0  3210                    2749        MOVE.W (A0),D1    
000035B2  3428 0002               2750        MOVE.W 2(A0),D2     
000035B6  3601                    2751        MOVE.W D1,D3
000035B8  0643 0010               2752              ADD.W  #PROJWIDTH,D3    
000035BC  3802                    2753        MOVE.W D2,D4
000035BE  0644 0010               2754              ADD.W  #PROJHEIGHT,D4
000035C2  103C 0057               2755        MOVE.B #87,D0
000035C6  4E4F                    2756        TRAP #15
000035C8                          2757        
000035C8  4C9F 001C               2758              MOVEM.W (A7)+,D2-D4
000035CC  221F                    2759              MOVE.L  (A7)+,D1      
000035CE  101F                    2760              MOVE.B  (A7)+,D0
000035D0  4E75                    2761              RTS
000035D2                          2762  
000035D2                          2763  
000035D2                          2764  -------------------- end include --------------------
000035D2                          2765              INCLUDE "AUDIO.X68"
000035D2                          2766     
000035D2                          2767  ; =============================================================================
000035D2                          2768  ; AUDIO MANAGEMENT
000035D2                          2769  ; =============================================================================
000035D2                          2770  
000035D2                          2771  
000035D2                          2772  ; -----------------------------------------------------------------------------
000035D2                          2773  AUDINIT
000035D2                          2774  ; CHANGES AUDIO TO PLAY
000035D2                          2775  ; INPUT    - NONE
000035D2                          2776  ; OUTPUT   - NONE
000035D2                          2777  ; MODIFIES - NONE
000035D2                          2778  ; -----------------------------------------------------------------------------
000035D2                          2779      
000035D2  48A7 E000               2780      MOVEM.W D0-D2, -(A7)
000035D6  48A7 00C0               2781      MOVEM.W A0-A1, -(A7)
000035DA                          2782  ;LOAD ELEVATOR MUSIC IN POS 0 
000035DA  103C 0047               2783      MOVE.B #71, D0
000035DE  43F8 100F               2784      LEA ELEVATOR_MUSIC, A1
000035E2  123C 0000               2785      MOVE.B #0, D1
000035E6  4E4F                    2786      TRAP #15
000035E8                          2787  ;LOAD HEAVEN MUSIC IN POS 1
000035E8  43F8 1000               2788      LEA HEAVENSOUND, A1
000035EC  123C 0001               2789      MOVE.B #1, D1
000035F0  4E4F                    2790      TRAP #15
000035F2                          2791  ;LOAD HELL MUSIC IN POS 2
000035F2  43F8 1026               2792      LEA HELLSOUND, A1
000035F6  123C 0002               2793      MOVE.B #2, D1
000035FA  4E4F                    2794      TRAP #15
000035FC  4C9F 0300               2795      MOVEM.W (A7)+, A0-A1
00003600  4C9F 0007               2796      MOVEM.W (A7)+, D0-D2
00003604                          2797  
00003604  4E75                    2798      RTS
00003606                          2799  
00003606                          2800  
00003606                          2801  ; -----------------------------------------------------------------------------
00003606                          2802  AUDPLAY
00003606                          2803  ; CHANGES AUDIO TO PLAY
00003606                          2804  ; INPUT    - NONE
00003606                          2805  ; OUTPUT   - NONE
00003606                          2806  ; MODIFIES - NONE
00003606                          2807  ; -----------------------------------------------------------------------------
00003606                          2808      
00003606  48E7 E000               2809      MOVEM.L D0-D2, -(A7)
0000360A  48A7 00C0               2810      MOVEM.W A0-A1, -(A7)    
0000360E                          2811      
0000360E  3239 00003782           2812      MOVE.W LOADEDMAP, D1
00003614  C2FC 0006               2813             MULU #6, D1
00003618  3241                    2814             MOVEA.W D1, A1
0000361A  4EE9 361E               2815             JMP MSCSEL(A1)
0000361E                          2816  MSCSEL:
0000361E  4EF9 00003654           2817             JMP ELEVATORMUSIC
00003624                          2818             
00003624  4EF9 00003672           2819             JMP HEAVENMUSIC
0000362A                          2820             
0000362A  4EF9 00003672           2821             JMP HEAVENMUSIC
00003630                          2822             
00003630  4EF9 00003672           2823             JMP HEAVENMUSIC
00003636                          2824             
00003636  4EF9 00003672           2825             JMP HEAVENMUSIC
0000363C                          2826             
0000363C  4EF9 00003694           2827             JMP HELLMUSIC
00003642                          2828             
00003642  4EF9 00003694           2829             JMP HELLMUSIC
00003648                          2830             
00003648  4EF9 00003694           2831             JMP HELLMUSIC
0000364E                          2832             
0000364E  4EF9 00003694           2833             JMP HELLMUSIC
00003654                          2834             
00003654                          2835  
00003654                          2836  ELEVATORMUSIC
00003654  103C 004C               2837      MOVE.B #76, D0
00003658  123C 0000               2838      MOVE.B #0, D1
0000365C  7400                    2839      MOVE.L #0, D2
0000365E  4E4F                    2840      TRAP #15
00003660  4C9F 0300               2841      MOVEM.W (A7)+, A0-A1
00003664  4CDF 0007               2842      MOVEM.L (A7)+, D0-D2
00003668  13FC 0001 00003784      2843      MOVE.B #1, MUSICPLAYED
00003670  4E75                    2844      RTS
00003672                          2845  
00003672                          2846  HEAVENMUSIC 
00003672  103C 004C               2847      MOVE.B #76, D0
00003676  123C 0000               2848      MOVE.B #0, D1
0000367A  7402                    2849      MOVE.L #2, D2
0000367C  4E4F                    2850      TRAP #15
0000367E  103C 004C               2851      MOVE.B #76, D0
00003682  123C 0001               2852      MOVE.B #1, D1
00003686  7400                    2853      MOVE.L #0, D2
00003688  4E4F                    2854      TRAP #15
0000368A  4C9F 0300               2855      MOVEM.W (A7)+, A0-A1
0000368E  4CDF 0007               2856      MOVEM.L (A7)+, D0-D2
00003692  4E75                    2857      RTS
00003694                          2858  HELLMUSIC
00003694  103C 004C               2859      MOVE.B #76, D0
00003698  123C 0000               2860      MOVE.B #0, D1
0000369C  7402                    2861      MOVE.L #2, D2
0000369E  4E4F                    2862      TRAP #15
000036A0  103C 004C               2863      MOVE.B #76, D0
000036A4  123C 0002               2864      MOVE.B #2, D1
000036A8  7400                    2865      MOVE.L #0,  D2
000036AA  4E4F                    2866      TRAP #15
000036AC  4C9F 0300               2867      MOVEM.W (A7)+, A0-A1
000036B0  4CDF 0007               2868      MOVEM.L (A7)+, D0-D2
000036B4  4E75                    2869      RTS
000036B6                          2870  
000036B6                          2871  FIREDSOUND
000036B6  48A7 E000               2872      MOVEM.W D0-D2, -(A7)
000036BA  48A7 00C0               2873      MOVEM.W A0-A1, -(A7)
000036BE  103C 0049               2874      MOVE.B #73, D0
000036C2  43F8 1035               2875      LEA PROJ_SOUND, A1
000036C6  4E4F                    2876      TRAP #15
000036C8  4C9F 0300               2877      MOVEM.W (A7)+, A0-A1
000036CC  4C9F 0007               2878      MOVEM.W (A7)+, D0-D2
000036D0  4E75                    2879      RTS
000036D0  4E75                    2880  -------------------- end include --------------------
000036D2                          2881  START
000036D2                          2882  
000036D2                          2883  ; --- INITIALIZATION -----------------------------------------------------------
000036D2  4279 00003782           2884              CLR.W LOADEDMAP
000036D8  007C 0700               2885              ORI.W   #$0700,SR
000036DC  4EB8 2624               2886              JSR     SYSINIT
000036E0  4EB8 296E               2887              JSR     PLAYERINIT
000036E4  4EB8 35D2               2888              JSR     AUDINIT
000036E8                          2889  
000036E8                          2890  LOOP
000036E8                          2891  
000036E8                          2892  ; --- UPDATE -------------------------------------------------------------------
000036E8                          2893  
000036E8                          2894  ; READ INPUT DEVICES
000036E8                          2895  
000036E8  4E41                    2896              TRAP    #KBDUPTN
000036EA                          2897  
000036EA                          2898  ; UPDATE GAME LOGIC 
000036EA                          2899  
000036EA                          2900  ; CHECK IF MUSIC IS ALREADY PLAYING 
000036EA  1039 00003784           2901              MOVE.B MUSICPLAYED, D0
000036F0  B07C 0001               2902              CMP #1, D0
000036F4  6700 0006               2903              BEQ NOMUSIC
000036F8  4EB8 3606               2904              JSR AUDPLAY
000036FC                          2905  ; GENERAL UPDATES
000036FC  4EB8 250E               2906  NOMUSIC     JSR ELEVATORUPDATE 
00003700  4EB8 2970               2907              JSR PLAYERUPD   
00003704  4EB8 10CC               2908              JSR MAPUPD
00003708                          2909  ; SHOTS LOGIC         
00003708  1039 0000376D           2910              MOVE.B  (KBDEDGE),D0
0000370E  C03C 00F0               2911              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
00003712  6718                    2912              BEQ.B .NOTFIRED
00003714  4EB8 36B6               2913              JSR FIREDSOUND
00003718  43F8 3518               2914              LEA     PROJINIT,A1
0000371C  45F8 357C               2915              LEA     PROJUPD,A2
00003720  47F8 3590               2916              LEA     PROJPLOT,A3
00003724  303C 0001               2917              MOVE.W  #1,D0
00003728  4EB8 27D6               2918              JSR     AGLADD
0000372C                          2919  .NOTFIRED
0000372C  4A79 00003778           2920              TST.W   (NPROJ)
00003732  6700 0006               2921              BEQ     .NOPROJ1
00003736  4EB8 27F0               2922              JSR     AGLUPD
0000373A                          2923  .NOPROJ1
0000373A                          2924  
0000373A                          2925  ; --- SYNC ---------------------------------------------------------------------
0000373A                          2926  
0000373A  4A39 0000376E           2927  .WINT       TST.B   (SCRINTCT)
00003740  67F8                    2928              BEQ     .WINT
00003742  4239 0000376E           2929              CLR.B   (SCRINTCT)
00003748  5239 00003770           2930              ADDQ.B  #1,(SCRINTFPS)
0000374E                          2931  
0000374E                          2932  ; --- PLOT ---------------------------------------------------------------------
0000374E                          2933              
0000374E  4EB8 1048               2934              JSR MAPPLOT     
00003752  4A79 00003778           2935              TST.W   (NPROJ)
00003758  6700 0006               2936              BEQ     .NOPROJ2
0000375C  4EB8 2814               2937              JSR     AGLPLOT
00003760  4EB8 34D0               2938  .NOPROJ2    JSR     PLAYERPLOT
00003764  4E40                    2939              TRAP    #SCRUPTN                    ; UPDATE DOUBLE BUFFER
00003766  6080                    2940              BRA     LOOP
00003768                          2941  
00003768  FFFF FFFF               2942              SIMHALT
0000376C                          2943              
0000376C                          2944              INCLUDE "VARS.X68" 
0000376C                          2945  ; ==============================================================================
0000376C                          2946  ; VARIABLES
0000376C                          2947  ; ==============================================================================
0000376C                          2948              
0000376C                          2949  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
0000376C                          2950              
0000376C                          2951  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃÂ PULSADO O NO, POR EJEMPLO MOVERSE
0000376D                          2952  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
0000376E                          2953  
0000376E                          2954  
0000376E                          2955  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
0000376E                          2956  
0000376E                          2957  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
0000376F                          2958  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00003770                          2959  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
00003772                          2960              DS.W    0
00003772                          2961  
00003772                          2962  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
00003772                          2963  
00003772= 0064                    2964  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
00003774= 0140                    2965  PLAYERPOSX      DC.W    SCRWIDTH/2
00003776= 00F0                    2966  PLAYERPOSY      DC.W    SCRHEIGH/2
00003778                          2967  
00003778                          2968  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
00003778                          2969  
00003778= 0000                    2970  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
0000377A                          2971  
0000377A                          2972  ; --- MAP RELATED VARIABLES ----------------------------------------------------
0000377A                          2973  
0000377A= 0000                    2974  BPOSX1  DC.W    0
0000377C= 0000                    2975  BPOSY1  DC.W    0
0000377E= 0020                    2976  BPOSX2  DC.W    32
00003780= 0020                    2977  BPOSY2  DC.W    32
00003782= 0000                    2978  LOADEDMAP   DC.W    0
00003784                          2979  
00003784                          2980  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
00003784                          2981  
00003784= 00                      2982  MUSICPLAYED DC.B    0
00003786                          2983              DS.W    0
00003786                          2984  
00003786                          2985  ; --- FPS RELATED VARIABLES ----------------------------------------------------
00003786                          2986  
00003786                          2987  REALFPS     DS.W    1
00003788= 47 4F 41 4C 3A 20 00    2988  STRFPS1     DC.B    'GOAL: ',0          ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
0000378F= 46 50 53 20 2D 20 ...   2989  STRFPS2     DC.B    'FPS - ACTUAL: ',0
0000379E= 46 50 53 00             2990  STRFPS3     DC.B    'FPS',0
000037A2                          2991  
000037A2                          2992  
000037A2                          2993  
000037A2                          2994  
000037A2                          2995  -------------------- end include --------------------
000037A2                          2996              INCLUDE "LIB/UTLVARS.X68"
000037A2                          2997  ; =============================================================================
000037A2                          2998  ; UTILITY VARIABLES
000037A2                          2999  ; =============================================================================
000037A2                          3000  
000037A2                          3001  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000037A4                          3002              DS.W    0
000037A4                          3003  -------------------- end include --------------------
000037A4                          3004              INCLUDE "LIB/DMMVARS.X68"
000037A4                          3005  ; =============================================================================
000037A4                          3006  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
000037A4                          3007  ; =============================================================================
000037A4                          3008  
000037C0                          3009              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
000037C0                          3010  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00004440                          3011              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00004440                          3012  -------------------- end include --------------------
00004440                          3013              
00004440                          3014              
00004440                          3015              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              27D6
AGLADD:END          27EC
AGLKILL             260E
AGLPLOT             2814
AGLPLOT:END         2834
AGLPLOT:LOOP        281C
AGLUPD              27F0
AGLUPD:END          280E
AGLUPD:LOOP         27F8
AUDINIT             35D2
AUDPLAY             3606
BPOSX1              377A
BPOSX2              377E
BPOSY1              377C
BPOSY2              3780
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                1244
DBHV                12B8
DDHL                116E
DDHV                118E
DF1HL               13E2
DF1HV               13C2
DF2HL               1454
DF2HV               1402
DGHE                11AE
DGHL                132C
DMMALLOC            25F4
DMMALLOC:END        260C
DMMBNUM             32
DMMBSIZE            40
DMMDATA             37C0
DMMFCOM             25CE
DMMFFND             25DC
DMMFIRST            2584
DMMFLOOP            25C2
DMMFRCOM            2596
DMMFREE             260E
DMMFRFND            25A4
DMMFRLOP            258A
DMMFRSTO            25BC
DMMINIT             2562
DMMINIT:LOOP        2570
DMMNEXT             25A6
DMMNEXTO            25DE
DMMSYSID            0
DRAWBLOCK           14A6
ELEVATORMUSIC       3654
ELEVATORPLOT        22EE
ELEVATORUPDATE      250E
ELEVATOR_MUSIC      100F
ENDBLOCK            14FE
ENDMAP              1510
ESMENU              2522
FIREDSOUND          36B6
FPSTEXTPOS          2A01
FRAMES_PER_SECOND   32
HEAVENMUSIC         3672
HEAVENSOUND         1000
HEAVEN_0            1900
HEAVEN_1            1A50
HEAVEN_END          1B8B
HEAVEN_ROOM         1CC6
HELLMUSIC           3694
HELLSOUND           1026
HELL_0              1E01
HELL_1              1F3C
HELL_END            2077
HELL_ROOM           21B2
HLSEL               2550
HVSEL               253E
JMPLIST             1126
KBDDOWN             53
KBDEDGE             376D
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             277A
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              2788
KBDUPD:LOOP         27CC
KBDUPD:PACK         27C8
KBDUPTN             1
KBDVAL              376C
LIMAPA1             29DC
LIMAPA2             2ADA
LIMAPA3             2CEA
LIMAPA4             2DE2
LIMAPA5             2EDA
LIMAPA6             3082
LIMAPA7             3236
LIMAPA8             332E
LOADEDMAP           3782
LOOP                36E8
MAP1NODOOR          157C
MAP1NOLIMIT1        2A1A
MAP1NOLIMIT2        2A46
MAP1NOLIMIT3        2A78
MAP1NOLIMIT4        2AA4
MAP1NOLIMITEND      2AD0
MAP2NODOOR1         15CA
MAP2NODOOR2         1600
MAP2NODOOR3         163E
MAP2NODOOR4         167C
MAP2NOLIMIT1        2B1E
MAP2NOLIMIT10       2CE0
MAP2NOLIMIT2        2B50
MAP2NOLIMIT3        2B82
MAP2NOLIMIT4        2BB4
MAP2NOLIMIT5        2BE6
MAP2NOLIMIT6        2C18
MAP2NOLIMIT7        2C4A
MAP2NOLIMIT8        2C7C
MAP2NOLIMIT9        2CAE
MAP3NODOOR          16CA
MAP3NOLIMIT1        2D28
MAP3NOLIMIT2        2D54
MAP3NOLIMIT3        2D80
MAP3NOLIMIT4        2DAC
MAP3NOLIMIT5        2DD8
MAP4NODOOR          1712
MAP4NOLIMIT1        2E20
MAP4NOLIMIT2        2E4C
MAP4NOLIMIT3        2E78
MAP4NOLIMIT4        2EA4
MAP4NOLIMIT5        2ED0
MAP5NODOOR          175A
MAP5NOLIMIT1        2F18
MAP5NOLIMIT2        2F44
MAP5NOLIMIT3        2F70
MAP5NOLIMIT4        2F9C
MAP5NOLIMIT5        2FC8
MAP5NOLIMIT6        2FF4
MAP5NOLIMIT7        3020
MAP5NOLIMIT8        304C
MAP5NOLIMIT9        3078
MAP6NODOOR1         17A8
MAP6NODOOR2         17DE
MAP6NODOOR3         181C
MAP6NODOOR4         185A
MAP6NOLIMIT1        30C0
MAP6NOLIMIT10       322C
MAP6NOLIMIT2        30EC
MAP6NOLIMIT3        3118
MAP6NOLIMIT5        3144
MAP6NOLIMIT6        3170
MAP6NOLIMIT7        319C
MAP6NOLIMIT8        31CE
MAP6NOLIMIT9        31FA
MAP7NODOOR          18AA
MAP7NOLIMIT1        3274
MAP7NOLIMIT2        32A0
MAP7NOLIMIT3        32CC
MAP7NOLIMIT4        32F8
MAP7NOLIMIT5        3324
MAP8NODOOR1         18FA
MAP8NOLIMIT1        336C
MAP8NOLIMIT2        3398
MAP8NOLIMIT3        33C4
MAP8NOLIMIT4        33F0
MAP8NOLIMIT5        341C
MAPA1               153A
MAPA2               1582
MAPA3               1682
MAPA4               16D0
MAPA5               1718
MAPA6               1760
MAPA7               1860
MAPA8               18B0
MAPPLOT             1048
MAPSEL              1060
MAPUPD              10CC
MOVEHOR             3484
MOVEHOR:NORIGHTEDGE  34A8
MOVEHOR:NOTLEFTEDGE  3494
MOVEVER             34AA
MOVEVER:NOLOWEREDGE  34CE
MOVEVER:NOTUPPEREDGE  34BA
MSCSEL              361E
MUSICPLAYED         3784
NEWLINE             14DA
NEXT                1118
NOLIMIT             3426
NOLIMIT:DOWN        346A
NOLIMIT:NOTMOVED    3480
NOLIMIT:RIGHT       3454
NOLIMIT:UP          343E
NOLIMITMENU         29C4
NOMUSIC             36FC
NOMUSIC:NOPROJ1     373A
NOMUSIC:NOPROJ2     3760
NOMUSIC:NOTFIRED    372C
NOMUSIC:WINT        373A
NPROJ               3778
PLAYERHEALTH        3772
PLAYERHEIGHT        20
PLAYERINIT          296E
PLAYERPLOT          34D0
PLAYERPOSX          3774
PLAYERPOSY          3776
PLAYERSPEED         4
PLAYERUPD           2970
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            3518
PROJINIT:FDOWN      3550
PROJINIT:FRIGHT     353E
PROJINIT:FUP        352E
PROJINIT:NOTFDOWN   355E
PROJINIT:SHOOT      3568
PROJPLOT            3590
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             357C
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             3786
SCRCYCCT            376F
SCRHEIGH            1E0
SCRINIT             265C
SCRINTCT            376E
SCRINTFPS           3770
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             26B2
SCRTIM              275A
SCRTIM1S            2768
SCRUPTN             0
SCRWIDTH            280
SNDPLTN             2
START               36D2
STRFPS1             3788
STRFPS2             378F
STRFPS3             379E
SYSINIT             2624
TRIANGLE            24B6
TRIANGLE:ISPOSITIVE  2504
TRIANGLE:UPWARDS    24D2
UTLINIT             283A
UTLRAND             2850
UTLRAND:RANDVEC     286E
UTLRNDIX            37A2
