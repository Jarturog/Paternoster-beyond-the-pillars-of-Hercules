000038B6 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 14/01/2023 20:24:02

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002D01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/14)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000  =00000002                 37  MOUUPTN     EQU     2                       ; MOUSE UPDATE TRAP NUMBER
00001000                            38  ;no lo usas SNDPLTN     EQU     3                       ; SOUND PLAY TRAP NUMBER
00001000                            39  
00001000                            40  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            41  
00001000  =00000001                 42  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 43  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            44  
00001000                            45  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000                            46  
00001000  =00000004                 47  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 48  PLAYERWIDTH     EQU     32
00001000  =00000020                 49  PLAYERHEIGHT    EQU     32
00001000                            50  
00001000                            51  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            52  
00001000  =00000010                 53  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 54  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 55  PROJSPEEDX      EQU     8
00001000  =00000008                 56  PROJSPEEDY      EQU     8
00001000                            57  
00001000                            58  ; --- MUSIC RELATED CONSTANTS --------------------------------------------------
00001000                            59  
00001000= 53 4E 44 2F 4D 55 ...     60  HEAVENSOUND DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     61  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     62  HELLSOUND   DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     63  PROJ_SOUND  DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            64  
00001048                            65  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001048                            66  
00001048  =FFFFFFFF                 67  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001048                            68  
00001048                            69  
00001048                            70  
00001048                            71  
00001048                            72  
00001048                            73  
00001048                            74  
00001048                            75  
00001048                            76  
00001048                            77  
00001048                            78  -------------------- end include --------------------
00001048                            79              INCLUDE "LIB/DMMCONST.X68"
00001048                            80  ; =============================================================================
00001048                            81  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                            82  ; =============================================================================
00001048                            83  
00001048  =00000040                 84  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                 85  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                 86  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                 87  -------------------- end include --------------------
00001048                            88              INCLUDE "LIB/UTLCONST.X68"         
00001048                            89  ; ==============================================================================
00001048                            90  ; UTIL CONSTANTS
00001048                            91  ; ==============================================================================
00001048                            92  
00001048  =00000008                 93  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001048  =00000008                 94  -------------------- end include --------------------
00001048                            95              INCLUDE "LIB/DMMCODE.X68"
00001048                            96  ; =============================================================================
00001048                            97  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                            98  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                            99  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                           100  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                           101  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                           102  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                           103  ; =============================================================================
00001048                           104  
00001048                           105  ; -----------------------------------------------------------------------------
00001048                           106  DMMINIT
00001048                           107  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                           108  ; INPUT    - NONE
00001048                           109  ; OUTPUT   - NONE
00001048                           110  ; MODIFIES - NONE
00001048                           111  ; -----------------------------------------------------------------------------
00001048  48E7 8080                112              MOVEM.L D0/A0,-(A7)
0000104C  41F9 00003940            113              LEA     DMMDATA,A0
00001052  303C 0031                114              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                115  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            116              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                117              DBRA.W  D0,.LOOP
00001064  4CDF 0101                118              MOVEM.L (A7)+,D0/A0
00001068  4E75                     119              RTS
0000106A                           120  
0000106A                           121  ; -----------------------------------------------------------------------------
0000106A                           122  DMMFIRST
0000106A                           123  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           124  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           125  ; INPUT    - NONE
0000106A                           126  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           127  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           128  ; -----------------------------------------------------------------------------
0000106A  41F9 00003940            129              LEA     DMMDATA,A0
00001070  4A58                     130  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                131              BNE     DMMFRFND
00001076  D1FC 0000003E            132              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 000045BF            133  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     134              BLT     DMMFRLOP
00001084  207C 00000000            135              MOVE.L  #0,A0
0000108A  4E75                     136  DMMFRFND    RTS
0000108C                           137  
0000108C                           138  ; -----------------------------------------------------------------------------
0000108C                           139  DMMNEXT
0000108C                           140  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           141  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           142  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           143  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           144  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           145  ; -----------------------------------------------------------------------------
0000108C  2F00                     146              MOVE.L  D0,-(A7)
0000108E  2008                     147              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            148              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            149              ADD.L   #DMMBSIZE,D0
0000109C  2040                     150              MOVE.L  D0,A0
0000109E  201F                     151              MOVE.L  (A7)+,D0
000010A0  60DA                     152              BRA     DMMFRCOM
000010A2                           153  
000010A2                           154  ; -----------------------------------------------------------------------------
000010A2                           155  DMMFRSTO
000010A2                           156  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           157  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           158  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           159  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           160  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           161  ; -----------------------------------------------------------------------------
000010A2  41F9 00003940            162              LEA     DMMDATA,A0
000010A8  B058                     163  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                164              BEQ     DMMFFND
000010AE  D1FC 0000003E            165              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 000045BF            166  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     167              BLT     DMMFLOOP
000010BC  207C 00000000            168              MOVE.L  #0,A0
000010C2  4E75                     169  DMMFFND     RTS
000010C4                           170  
000010C4                           171  ; -----------------------------------------------------------------------------
000010C4                           172  DMMNEXTO
000010C4                           173  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           174  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           175  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           176  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           177  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           178  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           179  ; -----------------------------------------------------------------------------
000010C4  2F00                     180              MOVE.L  D0,-(A7)
000010C6  2008                     181              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            182              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            183              ADD.L   #DMMBSIZE,D0
000010D4  2040                     184              MOVE.L  D0,A0
000010D6  201F                     185              MOVE.L  (A7)+,D0
000010D8  60DA                     186              BRA     DMMFCOM
000010DA                           187  
000010DA                           188  ; -----------------------------------------------------------------------------
000010DA                           189  DMMALLOC
000010DA                           190  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           191  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           192  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           193  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           194  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           195  ; -----------------------------------------------------------------------------
000010DA  3F00                     196              MOVE.W  D0,-(A7)
000010DC  4240                     197              CLR.W   D0
000010DE  4EB8 10A2                198              JSR     DMMFRSTO
000010E2  301F                     199              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            200              CMP.L   #0,A0
000010EA  6700 0006                201              BEQ     .END
000010EE  3140 FFFE                202              MOVE.W  D0,-2(A0)
000010F2  4E75                     203  .END        RTS
000010F4                           204  
000010F4                           205  ; -----------------------------------------------------------------------------
000010F4                           206  DMMFREE
000010F4                           207  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           208  ; SYSTEM (0)
000010F4                           209  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           210  ; OUTPUT   - NONE
000010F4                           211  ; MODIFIES - NONE
000010F4                           212  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                213              MOVEM.L D0/A0,-(A7)
000010F8  2008                     214              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            215              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     216              MOVE.L  D0,A0
00001102  4250                     217              CLR.W   (A0)
00001104  4CDF 0101                218              MOVEM.L (A7)+,D0/A0
00001108  4E75                     219              RTS
00001108  4E75                     220  -------------------- end include --------------------
0000110A                           221              INCLUDE "SYSTEM.X68"
0000110A                           222  ; ==============================================================================
0000110A                           223  ; SYSTEM
0000110A                           224  ; ==============================================================================
0000110A                           225              
0000110A                           226  ; ------------------------------------------------------------------------------
0000110A                           227  SYSINIT
0000110A                           228  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           229  ; INPUT    : NONE
0000110A                           230  ; OUTPUT   : NONE
0000110A                           231  ; MODIFIES : NONE
0000110A                           232  ; ------------------------------------------------------------------------------
0000110A                           233  
0000110A  21FC 000011A6 0080       234              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000127C 0084       235              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 000012CC 0088       236              MOVE.L  #MOUUPD,($80+MOUUPTN*4)
00001122  21FC 0000124E 0064       237              MOVE.L  #SCRTIM,($60+SCRINTN*4)
0000112A  21FC 0000125C 0068       238              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
00001132                           239              
00001132  4EB8 1048                240              JSR     DMMINIT
00001136  4EB9 00001150            241              JSR     SCRINIT
0000113C  4EB9 0000126E            242              JSR     KBDINIT
00001142  4EB9 000012CA            243              JSR     MOUINIT
00001148                           244              
00001148  40E7                     245              MOVE.W  SR,-(A7)
0000114A  0257 D8FF                246              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
0000114E  4E73                     247              RTE
00001150                           248              
00001150                           249  ; ------------------------------------------------------------------------------
00001150                           250  SCRINIT
00001150                           251  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001150                           252  ; ENABLE DOUBLE BUFFER.
00001150                           253  ; INPUT    : NONE
00001150                           254  ; OUTPUT   : NONE
00001150                           255  ; MODIFIES : NONE
00001150                           256  ; ------------------------------------------------------------------------------
00001150                           257  
00001150  48E7 F000                258              MOVEM.L D0-D3,-(A7)
00001154                           259  
00001154                           260              ; SET SCREEN RESOLUTION
00001154  103C 0021                261              MOVE.B  #33,D0
00001158  223C 028001E0            262              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
0000115E  4E4F                     263              TRAP    #15
00001160                           264              
00001160                           265              ; SET WINDOWED MODE
00001160  7201                     266              MOVE.L  #1,D1
00001162  4E4F                     267              TRAP    #15
00001164                           268              
00001164                           269              ; CLEAR SCREEN
00001164  103C 000B                270              MOVE.B  #11,D0
00001168  323C FF00                271              MOVE.W  #$FF00,D1
0000116C  4E4F                     272              TRAP    #15
0000116E                           273  
0000116E                           274              ; ENABLE DOUBLE BUFFER
0000116E  103C 005C                275              MOVE.B  #92,D0
00001172  123C 0011                276              MOVE.B  #17,D1
00001176  4E4F                     277              TRAP    #15
00001178                           278              
00001178                           279              ; ENABLE BOTH TIMED INTERRUPT
00001178  103C 0020                280              MOVE.B  #32,D0
0000117C  123C 0006                281              MOVE.B  #6,D1
00001180  143C 0081                282              MOVE.B  #$80|SCRINTN,D2
00001184  7614                     283              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001186  4E4F                     284              TRAP    #15
00001188  143C 0082                285              MOVE.B  #$80|SCRINTFPSN,D2
0000118C  263C 000003E8            286              MOVE.L  #1000,D3
00001192  4E4F                     287              TRAP    #15
00001194                           288              
00001194                           289              ; CLEAR INTERRUPT COUNTER
00001194  4279 000038EA            290              CLR.W   (SCRINTCT)
0000119A  4239 000038EC            291              CLR.B   (SCRINTFPS) 
000011A0                           292              
000011A0  4CDF 000F                293              MOVEM.L (A7)+,D0-D3
000011A4                           294              
000011A4  4E75                     295              RTS
000011A6                           296  
000011A6                           297  ; ------------------------------------------------------------------------------
000011A6                           298  SCRPLOT
000011A6                           299  ; UPDATES DOUBLE BUFFER
000011A6                           300  ; INPUT    : NONE
000011A6                           301  ; OUTPUT   : NONE
000011A6                           302  ; MODIFIES : NONE
000011A6                           303  ; ------------------------------------------------------------------------------
000011A6  48E7 E000                304              MOVEM.L D0-D2,-(A7)
000011AA  2F09                     305              MOVE.L  A1,-(A7)
000011AC                           306              
000011AC                           307              ; PLOT ACTUAL FPS AND GOAL FPS
000011AC                           308              
000011AC  103C 0051                309              MOVE.B  #81,D0
000011B0  7200                     310              MOVE.L  #$00000000,D1 ; FILL COLOR
000011B2  4E4F                     311              TRAP    #15
000011B4                           312              
000011B4  103C 0050                313              MOVE.B  #80,D0
000011B8  223C 00FFFFFF            314              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011BE  4E4F                     315              TRAP    #15
000011C0                           316              
000011C0  103C 000B                317              MOVE.B  #11,D0
000011C4  223C 00002D01            318              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011CA  4E4F                     319              TRAP    #15
000011CC                           320              
000011CC  43F9 00003904            321              LEA.L   STRFPS1,A1 
000011D2  103C 000E                322              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011D6  4E4F                     323              TRAP    #15
000011D8                           324              
000011D8  103C 000B                325              MOVE.B  #11,D0
000011DC  323C 3601                326              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E0  4E4F                     327              TRAP    #15
000011E2                           328              
000011E2  5E89                     329              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011E4  103C 000E                330              MOVE.B  #14,D0  
000011E8  4E4F                     331              TRAP    #15 
000011EA                           332              
000011EA  103C 000B                333              MOVE.B  #11,D0
000011EE  323C 4701                334              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011F2  4E4F                     335              TRAP    #15
000011F4                           336              
000011F4  D3FC 0000000F            337              ADDA.L  #15,A1 ; PLOT 'FPS'
000011FA  103C 000E                338              MOVE.B  #14,D0 
000011FE  4E4F                     339              TRAP    #15
00001200                           340              
00001200  0643 0014                341              ADD.W   #20,D3
00001204  103C 000B                342              MOVE.B  #11,D0
00001208  323C 3301                343              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
0000120C  4E4F                     344              TRAP    #15
0000120E                           345              
0000120E  7232                     346              MOVE.L  #FRAMES_PER_SECOND,D1
00001210  740A                     347              MOVE.L  #10,D2
00001212  103C 000F                348              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001216  4E4F                     349              TRAP    #15
00001218                           350              
00001218  0643 0014                351              ADD.W   #20,D3
0000121C  103C 000B                352              MOVE.B  #11,D0
00001220  323C 4401                353              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001224  4E4F                     354              TRAP    #15
00001226                           355              
00001226  4281                     356              CLR.L   D1
00001228  1239 00003902            357              MOVE.B  (REALFPS),D1
0000122E  740A                     358              MOVE.L  #10,D2
00001230  103C 000F                359              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001234  4E4F                     360              TRAP    #15
00001236                           361              
00001236                           362              ; SWITCH BUFFERS
00001236  103C 005E                363              MOVE.B  #94,D0
0000123A  4E4F                     364              TRAP    #15
0000123C                           365              
0000123C                           366              ; CLEAR HIDDEN BUFFER
0000123C  103C 000B                367              MOVE.B  #11,D0
00001240  323C FF00                368              MOVE.W  #$FF00,D1
00001244  4E4F                     369              TRAP    #15
00001246                           370              
00001246  225F                     371              MOVE.L  (A7)+,A1
00001248  4CDF 0007                372              MOVEM.L (A7)+,D0-D2
0000124C  4E73                     373              RTE
0000124E                           374              
0000124E                           375  ; ------------------------------------------------------------------------------
0000124E                           376  SCRTIM
0000124E                           377  ; TIMED INTERRUPT SERVICE ROUTINE
0000124E                           378  ; INPUT    : NONE
0000124E                           379  ; OUTPUT   : NONE
0000124E                           380  ; MODIFIES : NONE
0000124E                           381  ; ------------------------------------------------------------------------------
0000124E  5239 000038EA            382              ADDQ.B  #1,(SCRINTCT)
00001254  5239 000038EB            383              ADDQ.B  #1,(SCRCYCCT)
0000125A  4E73                     384              RTE
0000125C                           385              
0000125C                           386  ; ------------------------------------------------------------------------------
0000125C                           387  SCRTIM1S
0000125C                           388  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000125C                           389  ; INPUT    : NONE
0000125C                           390  ; OUTPUT   : NONE
0000125C                           391  ; MODIFIES : NONE
0000125C                           392  ; ------------------------------------------------------------------------------
0000125C  13F9 000038EC 00003902   393              MOVE.B  (SCRINTFPS),REALFPS
00001266  4239 000038EC            394              CLR.B   SCRINTFPS
0000126C  4E73                     395              RTE
0000126E                           396  
0000126E                           397  ; ------------------------------------------------------------------------------
0000126E                           398  KBDINIT
0000126E                           399  ; INIT KEYBOARD
0000126E                           400  ; INPUT    : NONE
0000126E                           401  ; OUTPUT   : NONE
0000126E                           402  ; MODIFIES : NONE
0000126E                           403  ; ------------------------------------------------------------------------------
0000126E  4239 000038E8            404              CLR.B   (KBDVAL)
00001274  4239 000038E9            405              CLR.B   (KBDEDGE)
0000127A  4E75                     406              RTS
0000127C                           407  
0000127C                           408  ; ------------------------------------------------------------------------------
0000127C                           409  KBDUPD
0000127C                           410  ; UPDATE KEYBOARD INFO.  
0000127C                           411  ; 7 -> FIRE DOWN
0000127C                           412  ; 6 -> FIRE RIGHT
0000127C                           413  ; 5 -> FIRE UP
0000127C                           414  ; 4 -> FIRE LEFT
0000127C                           415  ; 3 -> DOWN
0000127C                           416  ; 2 -> RIGHT
0000127C                           417  ; 1 -> UP
0000127C                           418  ; 0 -> LEFT
0000127C                           419  ; INPUT    : NONE
0000127C                           420  ; OUTPUT   : NONE
0000127C                           421  ; MODIFIES : NONE
0000127C                           422  ; ------------------------------------------------------------------------------
0000127C                           423  
0000127C  48E7 F000                424              MOVEM.L D0-D3,-(A7)
00001280                           425  
00001280                           426              ; READ FIRST PART
00001280  103C 0013                427              MOVE.B  #19,D0
00001284  223C 28272625            428              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000128A  4E4F                     429              TRAP    #15
0000128C                           430              
0000128C                           431              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000128C  4EB9 000012BC            432              JSR     .PACK
00001292                           433  
00001292                           434              ; READ SECOND PART
00001292  223C 53445741            435              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
00001298  4E4F                     436              TRAP    #15
0000129A                           437  
0000129A                           438              ; CONVERT TO DESIRED FORMAT
0000129A  4EB9 000012BC            439              JSR     .PACK
000012A0                           440              
000012A0                           441              ; COMPUTE KBDEDGE
000012A0  1039 000038E8            442              MOVE.B  (KBDVAL),D0
000012A6  4600                     443              NOT.B   D0
000012A8  C002                     444              AND.B   D2,D0
000012AA  13C0 000038E9            445              MOVE.B  D0,(KBDEDGE)
000012B0                           446              
000012B0                           447              ; STORE KBDVAL
000012B0  13C2 000038E8            448              MOVE.B  D2,(KBDVAL)
000012B6                           449              
000012B6  4CDF 000F                450              MOVEM.L (A7)+,D0-D3
000012BA                           451  
000012BA  4E73                     452              RTE
000012BC                           453              
000012BC  363C 0003                454  .PACK       MOVE.W  #3,D3
000012C0  E189                     455  .LOOP       LSL.L   #8,D1
000012C2  E312                     456              ROXL.B  #1,D2
000012C4  51CB FFFA                457              DBRA.W  D3,.LOOP
000012C8  4E75                     458              RTS
000012CA                           459  
000012CA                           460  ; ------------------------------------------------------------------------------
000012CA                           461  MOUINIT
000012CA                           462  ; INIT MOUSE
000012CA                           463  ; INPUT    : NONE
000012CA                           464  ; OUTPUT   : NONE
000012CA                           465  ; MODIFIES : NONE
000012CA                           466  ; ------------------------------------------------------------------------------
000012CA  4E75                     467              RTS
000012CC                           468  
000012CC                           469  
000012CC                           470  ; ------------------------------------------------------------------------------
000012CC                           471  MOUUPD
000012CC                           472  ; UPDATE MOUSE DOWN INFO  
000012CC                           473  ; INPUT    : NONE
000012CC                           474  ; OUTPUT   : NONE
000012CC                           475  ; MODIFIES : NONE
000012CC                           476  ; ------------------------------------------------------------------------------
000012CC  103C 003D                477              MOVE.B  #61,D0          ; READ MOUSE
000012D0  123C 0002                478              MOVE.B  #2,D1           ; MOUSE DOWN STATE
000012D4  4E4F                     479              TRAP    #15
000012D6  4E75                     480              RTS
000012D8                           481  
000012D8                           482  
000012D8                           483  
000012D8                           484  
000012D8                           485  
000012D8                           486  -------------------- end include --------------------
000012D8                           487              INCLUDE "LIB/AGLCODE.X68"
000012D8                           488  ; =============================================================================
000012D8                           489  ; AGENT MANAGEMENT
000012D8                           490  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012D8                           491  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012D8                           492  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012D8                           493  ; +8:END    : DATA (AGENT SPECIFIC)
000012D8                           494  ; =============================================================================
000012D8                           495  
000012D8                           496  ; -----------------------------------------------------------------------------
000012D8                           497  AGLADD
000012D8                           498  ; CREATES A NEW AGENT
000012D8                           499  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012D8                           500  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012D8                           501  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012D8                           502  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012D8                           503  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012D8                           504  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012D8                           505  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012D8                           506  ; OUTPUT   - NONE
000012D8                           507  ; MODIFIES - NONE
000012D8                           508  ; -----------------------------------------------------------------------------
000012D8  2F08                     509              MOVE.L  A0,-(A7)
000012DA  4EB8 10DA                510              JSR     DMMALLOC
000012DE  B1FC 00000000            511              CMP.L   #0,A0
000012E4  6700 0008                512              BEQ     .END
000012E8  20CA                     513              MOVE.L  A2,(A0)+
000012EA  20CB                     514              MOVE.L  A3,(A0)+
000012EC  4E91                     515              JSR     (A1)
000012EE  205F                     516  .END        MOVE.L  (A7)+,A0
000012F0  4E75                     517              RTS
000012F2                           518  
000012F2                           519  ; -----------------------------------------------------------------------------
000012F2                           520  AGLUPD
000012F2                           521  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012F2                           522  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012F2                           523  ; INPUT    - NONE
000012F2                           524  ; OUTPUT   - NONE
000012F2                           525  ; MODIFIES - NONE
000012F2                           526  ; -----------------------------------------------------------------------------
000012F2  48E7 00C0                527              MOVEM.L A0-A1,-(A7)
000012F6  4EB8 106A                528              JSR     DMMFIRST
000012FA  B1FC 00000000            529  .LOOP       CMP.L   #0,A0
00001300  6700 000E                530              BEQ     .END
00001304  2250                     531              MOVE.L  (A0),A1
00001306  5088                     532              ADD.L   #8,A0
00001308  4E91                     533              JSR     (A1)
0000130A  4EB8 108C                534              JSR     DMMNEXT
0000130E  60EA                     535              BRA     .LOOP
00001310  4CDF 0300                536  .END        MOVEM.L (A7)+,A0-A1
00001314  4E75                     537              RTS
00001316                           538  
00001316                           539  ; -----------------------------------------------------------------------------
00001316                           540  AGLPLOT
00001316                           541  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001316                           542  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001316                           543  ; INPUT    - NONE
00001316                           544  ; OUTPUT   - NONE
00001316                           545  ; MODIFIES - NONE
00001316                           546  ; -----------------------------------------------------------------------------
00001316  48E7 00C0                547              MOVEM.L A0-A1,-(A7)
0000131A  4EB8 106A                548              JSR     DMMFIRST
0000131E  B1FC 00000000            549  .LOOP       CMP.L   #0,A0
00001324  6700 0010                550              BEQ     .END
00001328  2268 0004                551              MOVE.L  4(A0),A1
0000132C  5088                     552              ADD.L   #8,A0
0000132E  4E91                     553              JSR     (A1)
00001330  4EB8 108C                554              JSR     DMMNEXT
00001334  60E8                     555              BRA     .LOOP
00001336  4CDF 0300                556  .END        MOVEM.L (A7)+,A0-A1
0000133A  4E75                     557              RTS
0000133C                           558  
0000133C                           559  ; -----------------------------------------------------------------------------
0000133C  =000010F4                560  AGLKILL     EQU     DMMFREE
0000133C                           561  ; KILLS THE AGENT BY RELEASING ITS MEMORY
0000133C                           562  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
0000133C                           563  ; OUTPUT   - NONE
0000133C                           564  ; MODIFIES - NONE
0000133C                           565  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
0000133C                           566  ; -----------------------------------------------------------------------------
0000133C                           567  -------------------- end include --------------------
0000133C                           568              INCLUDE "LIB/UTLCODE.X68"
0000133C                           569  ; =============================================================================
0000133C                           570  ; UTILITY CODE
0000133C                           571  ; =============================================================================
0000133C                           572  
0000133C                           573  ; -----------------------------------------------------------------------------
0000133C                           574  UTLINIT
0000133C                           575  ; INITIALIZES UTILITY CODE
0000133C                           576  ; INPUT    - NONE
0000133C                           577  ; OUTPUT   - NONE
0000133C                           578  ; MODIFIES - NONE
0000133C                           579  ; -----------------------------------------------------------------------------
0000133C  48E7 C000                580              MOVEM.L D0-D1,-(A7)
00001340  103C 0008                581              MOVE.B  #8,D0
00001344  4E4F                     582              TRAP    #15
00001346  13C1 00003922            583              MOVE.B  D1,(UTLRNDIX)
0000134C  4CDF 0003                584              MOVEM.L (A7)+,D0-D1
00001350  4E75                     585              RTS
00001352                           586  
00001352                           587  ; -----------------------------------------------------------------------------
00001352                           588  UTLPRINT
00001352                           589  ; PRINT SCREEN CENTERED TEXT
00001352                           590  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001352                           591  ;            D0.B SCREEN ROW TO PRINT TEXT
00001352                           592  ; OUTPUT   : D0.B NEXT ROW
00001352                           593  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001352                           594  ; -----------------------------------------------------------------------------
00001352  48E7 C0C0                595              MOVEM.L D0-D1/A0-A1,-(A7)
00001356  4201                     596              CLR.B   D1
00001358  2248                     597              MOVE.L  A0,A1
0000135A  4A18                     598  .LOOP       TST.B   (A0)+
0000135C  6700 0006                599              BEQ     .ENDLOOP
00001360  5201                     600              ADDQ.B  #1,D1
00001362  60F6                     601              BRA     .LOOP
00001364  E209                     602  .ENDLOOP    LSR.B   #1,D1
00001366  0401 0028                603              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000136A  4401                     604              NEG.B   D1
0000136C  E141                     605              ASL.W   #8,D1
0000136E  8240                     606              OR.W    D0,D1
00001370  103C 000B                607              MOVE.B  #11,D0
00001374  4E4F                     608              TRAP    #15
00001376  103C 000D                609              MOVE.B  #13,D0
0000137A  4E4F                     610              TRAP    #15
0000137C  4CDF 0303                611              MOVEM.L (A7)+,D0-D1/A0-A1
00001380  5200                     612              ADDQ.B  #1,D0
00001382  4E75                     613              RTS
00001384                           614  
00001384                           615  ; -----------------------------------------------------------------------------
00001384                           616  UTLRAND
00001384                           617  ; PROVIDES A PSEUDO-RANDOM BYTE
00001384                           618  ; INPUT    - NONE
00001384                           619  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001384                           620  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001384                           621  ; -----------------------------------------------------------------------------
00001384  2F08                     622              MOVE.L  A0,-(A7)
00001386  41F9 000013A2            623              LEA     .RANDVEC,A0
0000138C  4280                     624              CLR.L   D0
0000138E  1039 00003922            625              MOVE.B  (UTLRNDIX),D0
00001394  1030 0800                626              MOVE.B  (A0,D0.L),D0
00001398  5239 00003922            627              ADDQ.B  #1,(UTLRNDIX)
0000139E  205F                     628              MOVE.L  (A7)+,A0
000013A0  4E75                     629              RTS
000013A2                           630  
000013A2                           631  
000013A2= A2 EE 9A 0C F5 24 ...    632  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000013AA= 2A A3 51 26 E0 AC ...    633              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000013B2= 75 51 CA FD 33 EB ...    634              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000013BA= 60 CC E7 B8 9A EB ...    635              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013C2= 1D 76 B5 95 B0 89 ...    636              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013CA= 39 15 48 C9 6E CA ...    637              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013D2= 43 E7 E2 7C 37 25 ...    638              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013DA= E9 94 CE E9 E4 52 ...    639              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013E2= 37 6D 9A 84 A2 28 ...    640              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013EA= 19 E2 C6 77 80 D4 ...    641              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013F2= 0A 5A 32 67 33 C2 ...    642              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013FA= 59 80 DC 0E 57 FC ...    643              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001402= 8A AB BC F7 07 4D ...    644              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000140A= EF D5 77 6E 1E BB ...    645              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001412= D6 E0 2A 8F BD 28 ...    646              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
0000141A= 13 4F 66 EC 0A 64 ...    647              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001422= 56 52 9A 16 9B 90 ...    648              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000142A= 06 8A A4 F7 01 DA ...    649              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001432= F2 E7 77 28 B1 76 ...    650              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000143A= A4 42 E3 81 B1 67 ...    651              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001442= BF CE FA 16 BF 38 ...    652              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000144A= D1 8B 50 0C 5F 49 ...    653              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001452= DE 4C 14 A2 40 DC ...    654              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000145A= B6 9B 0A 38 5D AB ...    655              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001462= E2 1B DD 75 15 82 ...    656              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000146A= 8A 26 51 30 9F 47 ...    657              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001472= 1E 8A BB 71 C6 6E ...    658              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000147A= 9F 47 E5 34 94 27 ...    659              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001482= 7D 06 D6 BA 30 0F ...    660              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000148A= EC 7F 7E 03 CF 2D ...    661              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001492= 94 5B 23 F2 8B CD ...    662              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000149A= 74 33 EC B9 0F D5 ...    663              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000014A2                           664  
000014A2                           665  -------------------- end include --------------------
000014A2                           666              INCLUDE "BLOCKS.X68"
000014A2                           667      
000014A2                           668  MAPPLOT
000014A2  48E7 FF00                669          MOVEM.L D0-D7, -(A7)
000014A6  48E7 00FE                670          MOVEM.L A0-A6, -(A7)
000014AA  3239 000038FE            671             MOVE.W LOADEDMAP, D1
000014B0  C2FC 000C                672             MULU #12, D1
000014B4  3241                     673             MOVEA.W D1, A1
000014B6  4EE9 14BA                674             JMP MAPSEL(A1)
000014BA                           675  MAPSEL:
000014BA  4EF9 00002748            676             JMP ELEVATORPLOT
000014C0  4EF9 00001572            677             JMP NEXT
000014C6  41F9 00001D5A            678             LEA HEAVEN_0, A0
000014CC  4EF9 00001572            679             JMP NEXT
000014D2  41F9 00001EAA            680             LEA HEAVEN_1, A0
000014D8  4EF9 00001572            681             JMP NEXT
000014DE  41F9 00001FE5            682             LEA HEAVEN_END, A0
000014E4  4EF9 00001572            683             JMP NEXT
000014EA  41F9 00002120            684             LEA HEAVEN_ROOM, A0
000014F0  4EF9 00001572            685             JMP NEXT
000014F6  41F9 0000225B            686             LEA HELL_0, A0
000014FC  4EF9 00001572            687             JMP NEXT
00001502  41F9 00002396            688             LEA HELL_1, A0
00001508  4EF9 00001572            689             JMP NEXT
0000150E  41F9 000024D1            690             LEA HELL_END, A0
00001514  4EF9 00001572            691             JMP NEXT
0000151A  41F9 0000260C            692             LEA HELL_ROOM, A0
00001520  4EF9 00001572            693             JMP NEXT
00001526                           694  MAPUPD
00001526                           695              
00001526  3F00                     696              MOVE.W D0, -(A7)
00001528  3039 000038FE            697              MOVE.W LOADEDMAP, D0
0000152E  B07C 0001                698              CMP #1, D0
00001532  6700 0460                699              BEQ MAPA1
00001536  B07C 0002                700              CMP #2, D0
0000153A  6700 04A0                701              BEQ MAPA2
0000153E  B07C 0003                702              CMP #3, D0
00001542  6700 0598                703              BEQ MAPA3
00001546  B07C 0004                704              CMP #4, D0
0000154A  6700 05DE                705              BEQ MAPA4
0000154E  B07C 0005                706              CMP #5, D0
00001552  6700 061E                707              BEQ MAPA5
00001556  B07C 0006                708              CMP #6, D0
0000155A  6700 065E                709              BEQ MAPA6
0000155E  B07C 0007                710              CMP #7, D0
00001562  6700 0756                711              BEQ MAPA7
00001566  B07C 0008                712              CMP #8, D0
0000156A  6700 079E                713              BEQ MAPA8
0000156E  301F                     714              MOVE.W (A7)+, D0
00001570  4E75                     715              RTS
00001572                           716  
00001572                           717      
00001572                           718              
00001572                           719  NEXT
00001572  4281                     720             CLR.L D1
00001574  1218                     721             MOVE.B (A0)+,D1
00001576  C2FC 0006                722             MULU #6, D1
0000157A  2241                     723             MOVEA.L D1, A1
0000157C  4EE9 1580                724             JMP JMPLIST(A1)
00001580                           725             
00001580                           726  JMPLIST: 
00001580  4EF9 00001934            727              JMP NEWLINE ; 0 = END OF ROW
00001586  4EF9 00001608            728              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
0000158C  4EF9 0000169E            729              JMP DBHL    ; 2 = DRAW BRICK HELL
00001592  4EF9 00001712            730              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
00001598  4EF9 00001786            731              JMP DGHL    ; 4 = DRAW GRASS HELL
0000159E  4EF9 0000181C            732              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
000015A4  4EF9 0000183C            733              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
000015AA  4EF9 0000185C            734              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
000015B0  4EF9 000015C8            735              JMP DDHL    ; 8 = DRAW DOOR HELL
000015B6  4EF9 000015E8            736              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
000015BC  4EF9 000018AE            737              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
000015C2  4EF9 0000196A            738              JMP ENDMAP  ; 11 = END OF THE MAP
000015C8                           739              
000015C8                           740  DDHL
000015C8  2F3C 00111111            741      MOVE.L #$00111111, -(A7)
000015CE  2F3C 00111111            742      MOVE.L #$00111111, -(A7)
000015D4  4EB9 00001900            743      JSR DRAWBLOCK
000015DA  2C1F                     744      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000015DC  2C1F                     745      MOVE.L (A7)+, D6    
000015DE  4EB9 00001958            746      JSR ENDBLOCK
000015E4  4EF8 1572                747      JMP NEXT
000015E8                           748  DDHV
000015E8  2F3C 00FFFFFF            749      MOVE.L #$00FFFFFF, -(A7)
000015EE  2F3C 00FFFFFF            750      MOVE.L #$00FFFFFF, -(A7)
000015F4  4EB9 00001900            751      JSR DRAWBLOCK
000015FA  2C1F                     752      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000015FC  2C1F                     753      MOVE.L (A7)+, D6
000015FE  4EB9 00001958            754      JSR ENDBLOCK
00001604  4EF8 1572                755      JMP NEXT
00001608                           756  DGHE ;DRAW-GRASS-HEAVEN vvvR
00001608  2F3C 0099FF99            757      MOVE.L #$0099FF99, -(A7)
0000160E  2F3C 0099FF99            758      MOVE.L #$0099FF99, -(A7)
00001614  4EB9 00001900            759      JSR DRAWBLOCK
0000161A  2C1F                     760      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000161C  2C1F                     761      MOVE.L (A7)+, D6
0000161E                           762      ; SET PEN COLOR 
0000161E  103C 0050                763      MOVE.B #80, D0
00001622  223C 0000CC00            764      MOVE.L #$0000CC00, D1
00001628  4E4F                     765      TRAP #15
0000162A                           766      ;DRAW LINES   
0000162A  103C 0054                767      MOVE.B #84, D0 
0000162E                           768      ;LINEA 11 
0000162E  3239 000038F6            769      MOVE.W BPOSX1,D1
00001634  5C41                     770      ADD.W #6, D1
00001636  3439 000038F8            771      MOVE.W BPOSY1, D2
0000163C  5A42                     772      ADD.W #5, D2
0000163E  3639 000038F6            773      MOVE.W BPOSX1, D3
00001644  0643 0009                774      ADD.W #9, D3
00001648  3839 000038F8            775      MOVE.W BPOSY1, D4
0000164E  0644 000A                776      ADD.W #10, D4
00001652  4E4F                     777      TRAP #15
00001654                           778      ;LINEA 12
00001654  5041                     779      ADD.W #8, D1    
00001656  5043                     780      ADD.W #8, D3
00001658  4E4F                     781      TRAP #15
0000165A                           782      ;LINEA 13
0000165A  5041                     783      ADD.W #8, D1    
0000165C  5043                     784      ADD.W #8, D3
0000165E  4E4F                     785      TRAP #15
00001660                           786      ;LINEA 21
00001660  3239 000038F6            787      MOVE.W BPOSX1,D1
00001666  5C41                     788      ADD.W #6, D1
00001668  3439 000038F8            789      MOVE.W BPOSY1, D2
0000166E  0642 0014                790      ADD.W #20, D2
00001672  3639 000038F6            791      MOVE.W BPOSX1, D3
00001678  0643 0009                792      ADD.W #9, D3
0000167C  3839 000038F8            793      MOVE.W BPOSY1, D4
00001682  0644 0019                794      ADD.W #25, D4
00001686  4E4F                     795      TRAP #15
00001688                           796      ;LINEA 22
00001688  5041                     797      ADD.W #8, D1    
0000168A  5043                     798      ADD.W #8, D3
0000168C  4E4F                     799      TRAP #15
0000168E                           800      ;LINEA 23
0000168E  5041                     801      ADD.W #8, D1    
00001690  5043                     802      ADD.W #8, D3
00001692  4E4F                     803      TRAP #15
00001694  4EB9 00001958            804      JSR ENDBLOCK
0000169A  4EF8 1572                805      JMP NEXT
0000169E                           806  DBHL ;DRAW BRICK-HELL vvvR
0000169E                           807      
0000169E  2F3C 00010101            808      MOVE.L #$00010101, -(A7)
000016A4  2F3C 00666666            809      MOVE.L #$00666666, -(A7)
000016AA  4EB9 00001900            810      JSR DRAWBLOCK
000016B0  2C1F                     811      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000016B2  2C1F                     812      MOVE.L (A7)+, D6
000016B4                           813      ;DRAW HORIZONTAL LINE
000016B4  103C 0054                814      MOVE.B #84, D0 
000016B8  3239 000038F6            815      MOVE.W BPOSX1, D1
000016BE  3439 000038F8            816      MOVE.W BPOSY1, D2
000016C4  0642 0010                817      ADD.W #16, D2
000016C8  3639 000038F6            818      MOVE.W BPOSX1, D3
000016CE  0643 0020                819      ADD.W #32, D3
000016D2  3839 000038F8            820      MOVE.W BPOSY1, D4
000016D8  0644 0010                821      ADD.W #16, D4
000016DC  4E4F                     822      TRAP #15
000016DE                           823      ;DRAW VERTICAL LINE 
000016DE  3239 000038F6            824      MOVE.W BPOSX1, D1
000016E4  0641 0010                825      ADD.W #16, D1
000016E8  3439 000038F8            826      MOVE.W BPOSY1, D2
000016EE  0642 0010                827      ADD.W #16, D2
000016F2  3639 000038F6            828      MOVE.W BPOSX1, D3
000016F8  0643 0010                829      ADD.W #16, D3
000016FC  3839 000038F8            830      MOVE.W BPOSY1, D4
00001702  0644 0020                831      ADD.W #32, D4
00001706  4E4F                     832      TRAP #15
00001708  4EB9 00001958            833      JSR ENDBLOCK    
0000170E  4EF8 1572                834      JMP NEXT
00001712                           835  DBHV ;DRAW BRICK-HEAVEN vvvR
00001712                           836      
00001712  2F3C 00CCCCCC            837      MOVE.L #$00CCCCCC, -(A7)
00001718  2F3C 00D7EBFA            838      MOVE.L #$00D7EBFA, -(A7)
0000171E  4EB9 00001900            839      JSR DRAWBLOCK
00001724  2C1F                     840      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001726  2C1F                     841      MOVE.L (A7)+, D6
00001728                           842      ;DRAW HORIZONTAL LINE
00001728  103C 0054                843      MOVE.B #84, D0 
0000172C  3239 000038F6            844      MOVE.W BPOSX1, D1
00001732  3439 000038F8            845      MOVE.W BPOSY1, D2
00001738  0642 0010                846      ADD.W #16, D2
0000173C  3639 000038F6            847      MOVE.W BPOSX1, D3
00001742  0643 0020                848      ADD.W #32, D3
00001746  3839 000038F8            849      MOVE.W BPOSY1, D4
0000174C  0644 0010                850      ADD.W #16, D4
00001750  4E4F                     851      TRAP #15
00001752                           852      ;DRAW VERTICAL LINE 
00001752  3239 000038F6            853      MOVE.W BPOSX1, D1
00001758  0641 0010                854      ADD.W #16, D1
0000175C  3439 000038F8            855      MOVE.W BPOSY1, D2
00001762  0642 0010                856      ADD.W #16, D2
00001766  3639 000038F6            857      MOVE.W BPOSX1, D3
0000176C  0643 0010                858      ADD.W #16, D3
00001770  3839 000038F8            859      MOVE.W BPOSY1, D4
00001776  0644 0020                860      ADD.W #32, D4
0000177A  4E4F                     861      TRAP #15 
0000177C  4EB9 00001958            862      JSR ENDBLOCK
00001782  4EF8 1572                863      JMP NEXT
00001786                           864  DGHL ;DRAW GRASS HELL vvvR
00001786                           865  
00001786  2F3C 002255EE            866      MOVE.L #$002255EE, -(A7)
0000178C  2F3C 002255EE            867      MOVE.L #$002255EE, -(A7)
00001792  4EB9 00001900            868      JSR DRAWBLOCK
00001798  2C1F                     869      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000179A  2C1F                     870      MOVE.L (A7)+, D6
0000179C                           871      ; SET PEN COLOR 
0000179C  103C 0050                872      MOVE.B #80, D0
000017A0  223C 000000CC            873      MOVE.L #$000000CC, D1
000017A6  4E4F                     874      TRAP #15
000017A8                           875      ;DRAW LINES   
000017A8  103C 0054                876      MOVE.B #84, D0 
000017AC                           877      ;LINEA 11 
000017AC  3239 000038F6            878      MOVE.W BPOSX1,D1
000017B2  5C41                     879      ADD.W #6, D1
000017B4  3439 000038F8            880      MOVE.W BPOSY1, D2
000017BA  5A42                     881      ADD.W #5, D2
000017BC  3639 000038F6            882      MOVE.W BPOSX1, D3
000017C2  0643 0009                883      ADD.W #9, D3
000017C6  3839 000038F8            884      MOVE.W BPOSY1, D4
000017CC  0644 000A                885      ADD.W #10, D4
000017D0  4E4F                     886      TRAP #15
000017D2                           887      ;LINEA 12
000017D2  5041                     888      ADD.W #8, D1    
000017D4  5043                     889      ADD.W #8, D3
000017D6  4E4F                     890      TRAP #15
000017D8                           891      ;LINEA 13
000017D8  5041                     892      ADD.W #8, D1    
000017DA  5043                     893      ADD.W #8, D3
000017DC  4E4F                     894      TRAP #15
000017DE                           895      ;LINEA 21
000017DE  3239 000038F6            896      MOVE.W BPOSX1,D1
000017E4  5C41                     897      ADD.W #6, D1
000017E6  3439 000038F8            898      MOVE.W BPOSY1, D2
000017EC  0642 0014                899      ADD.W #20, D2
000017F0  3639 000038F6            900      MOVE.W BPOSX1, D3
000017F6  0643 0009                901      ADD.W #9, D3
000017FA  3839 000038F8            902      MOVE.W BPOSY1, D4
00001800  0644 0019                903      ADD.W #25, D4
00001804  4E4F                     904      TRAP #15
00001806                           905      ;LINEA 22
00001806  5041                     906      ADD.W #8, D1    
00001808  5043                     907      ADD.W #8, D3
0000180A  4E4F                     908      TRAP #15
0000180C                           909      ;LINEA 23
0000180C  5041                     910      ADD.W #8, D1    
0000180E  5043                     911      ADD.W #8, D3
00001810  4E4F                     912      TRAP #15
00001812  4EB9 00001958            913      JSR ENDBLOCK
00001818  4EF8 1572                914      JMP NEXT
0000181C                           915  
0000181C                           916  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
0000181C  2F3C 00CCCCCC            917      MOVE.L #$00CCCCCC, -(A7)
00001822  2F3C 00C6DAE9            918      MOVE.L #$00C6DAE9, -(A7)
00001828  4EB9 00001900            919      JSR DRAWBLOCK
0000182E  2C1F                     920      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001830  2C1F                     921      MOVE.L (A7)+, D6
00001832  4EB9 00001958            922      JSR ENDBLOCK
00001838  4EF8 1572                923      JMP NEXT
0000183C                           924  DF1HL ; DRAW FLOOR_1 HELL vvvR 
0000183C  2F3C 00010101            925      MOVE.L #$00010101, -(A7)
00001842  2F3C 00777777            926      MOVE.L #$00777777, -(A7)
00001848  4EB9 00001900            927      JSR DRAWBLOCK
0000184E  2C1F                     928      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001850  2C1F                     929      MOVE.L (A7)+, D6
00001852                           930  
00001852  4EB9 00001958            931      JSR ENDBLOCK
00001858  4EF8 1572                932      JMP NEXT
0000185C                           933      
0000185C                           934  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
0000185C  2F3C 00CCCCCC            935      MOVE.L #$00CCCCCC, -(A7)
00001862  2F3C 00C6DAE9            936      MOVE.L #$00C6DAE9, -(A7)
00001868  4EB9 00001900            937      JSR DRAWBLOCK
0000186E  2C1F                     938      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001870  2C1F                     939      MOVE.L (A7)+, D6
00001872                           940      ;SET NEW FILL COLOR  
00001872  103C 0051                941      MOVE.B #81, D0
00001876  223C 00D7EBFA            942      MOVE.L #$00D7EBFA, D1
0000187C  4E4F                     943      TRAP #15 
0000187E                           944      ;DRAW INSIDE SQUARE 
0000187E  103C 0057                945      MOVE.B #87, D0
00001882  3239 000038F6            946      MOVE.W BPOSX1, D1
00001888  5041                     947      ADD.W #8, D1
0000188A  3439 000038F8            948      MOVE.W BPOSY1, D2
00001890  5042                     949      ADD.W #8, D2
00001892  3639 000038FA            950      MOVE.W BPOSX2, D3
00001898  5143                     951      SUB.W #8, D3
0000189A  3839 000038FC            952      MOVE.W BPOSY2, D4
000018A0  5144                     953      SUB.W #8, D4
000018A2  4E4F                     954      TRAP #15
000018A4  4EB9 00001958            955      JSR ENDBLOCK
000018AA  4EF8 1572                956      JMP NEXT
000018AE                           957  DF2HL ; DRAW FLOOR_2 HELL vvvR
000018AE  2F3C 00010101            958      MOVE.L #$00010101, -(A7)
000018B4  2F3C 00777777            959      MOVE.L #$00777777, -(A7)
000018BA  4EB9 00001900            960      JSR DRAWBLOCK
000018C0  2C1F                     961      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018C2  2C1F                     962      MOVE.L (A7)+, D6
000018C4                           963      ;SET NEW FILL COLOR  
000018C4  103C 0051                964      MOVE.B #81, D0
000018C8  223C 00666666            965      MOVE.L #$00666666, D1
000018CE  4E4F                     966      TRAP #15 
000018D0                           967  ;DRAW INSIDE SQUARE 
000018D0  103C 0057                968      MOVE.B #87, D0
000018D4  3239 000038F6            969      MOVE.W BPOSX1, D1
000018DA  5041                     970      ADD.W #8, D1
000018DC  3439 000038F8            971      MOVE.W BPOSY1, D2
000018E2  5042                     972      ADD.W #8, D2
000018E4  3639 000038FA            973      MOVE.W BPOSX2, D3
000018EA  5143                     974      SUB.W #8, D3
000018EC  3839 000038FC            975      MOVE.W BPOSY2, D4
000018F2  5144                     976      SUB.W #8, D4
000018F4  4E4F                     977      TRAP #15
000018F6  4EB9 00001958            978      JSR ENDBLOCK
000018FC  4EF8 1572                979      JMP NEXT    
00001900                           980      
00001900                           981  DRAWBLOCK 
00001900                           982  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPUS COMO LONGS. 
00001900                           983      
00001900                           984      ;SET FILL COLOR  
00001900  103C 0051                985      MOVE.B #81, D0
00001904  222F 0004                986      MOVE.L 4(A7), D1
00001908  4E4F                     987      TRAP #15 
0000190A                           988      
0000190A                           989      ; SET PEN COLOR 
0000190A  103C 0050                990      MOVE.B #80, D0
0000190E  222F 0008                991      MOVE.L 8(A7), D1
00001912  4E4F                     992      TRAP #15 
00001914                           993  
00001914                           994      ;DRAW BLOCK 
00001914  103C 0057                995      MOVE.B #87, D0
00001918  3239 000038F6            996      MOVE.W BPOSX1, D1
0000191E  3439 000038F8            997      MOVE.W BPOSY1, D2
00001924  3639 000038FA            998      MOVE.W BPOSX2, D3
0000192A  3839 000038FC            999      MOVE.W BPOSY2, D4
00001930  4E4F                    1000      TRAP #15
00001932  4E75                    1001      RTS
00001934                          1002  
00001934                          1003  NEWLINE
00001934                          1004      ;RESET X POSITION
00001934  33FC 0000 000038F6      1005      MOVE.W #0, BPOSX1
0000193C  33FC 0020 000038FA      1006      MOVE.W #32, BPOSX2
00001944                          1007      ;ADD 33 TO Y POSITION
00001944  0679 0020 000038F8      1008      ADD.W #32, BPOSY1
0000194C  0679 0020 000038FC      1009      ADD.W #32, BPOSY2
00001954  4EF8 1572               1010      JMP NEXT
00001958                          1011     
00001958                          1012  ENDBLOCK
00001958                          1013      ;SET NEW BLOCK POSITION
00001958  0679 0020 000038F6      1014      ADD.W #32, BPOSX1
00001960  0679 0020 000038FA      1015      ADD.W #32, BPOSX2
00001968  4E75                    1016      RTS
0000196A                          1017  ENDMAP
0000196A                          1018      ;SET DEFAULT BLOCK POSITION
0000196A  33FC 0000 000038F6      1019      MOVE.W #0, BPOSX1
00001972  33FC 0000 000038F8      1020      MOVE.W #0, BPOSY1
0000197A  33FC 0020 000038FA      1021      MOVE.W #32, BPOSX2
00001982  33FC 0020 000038FC      1022      MOVE.W #32, BPOSY2
0000198A  4CDF 7F00               1023      MOVEM.L (A7)+, A0-A6
0000198E  4CDF 00FF               1024      MOVEM.L (A7)+, D0-D7
00001992  4E75                    1025      RTS
00001994                          1026      
00001994                          1027  
00001994                          1028  
00001994                          1029  MAPA1
00001994  301F                    1030      MOVE.W (A7)+, D0
00001996  48A7 F800               1031      MOVEM.W D0-D4, -(A7)
0000199A  3039 000038F0           1032      MOVE.W PLAYERPOSX, D0
000019A0  3239 000038F2           1033      MOVE.W PLAYERPOSY, D1
000019A6                          1034      ;GO TO THE NEXT ROOM DOOR
000019A6                          1035      ;FIRST LETS CHECH POS X
000019A6  B07C 0160               1036      CMP #352, D0  ; BGT = 352 > D0
000019AA  6E00 002A               1037      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019AE  B07C 0120               1038      CMP #288, D0
000019B2  6D00 0022               1039      BLT MAP1NODOOR
000019B6                          1040      ;NOW WE CHECK POS Y 
000019B6  B27C 01E0               1041      CMP #480, D1  ; 
000019BA  6E00 001A               1042      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019BE  B27C 01C0               1043      CMP #448, D1
000019C2  6D00 0012               1044      BLT MAP1NODOOR
000019C6  33FC 0020 000038F2      1045      MOVE.W #32, PLAYERPOSY
000019CE  33FC 0002 000038FE      1046      MOVE.W #2, LOADEDMAP
000019D6                          1047  MAP1NODOOR
000019D6  4C9F 001F               1048      MOVEM.W (A7)+, D0-D4
000019DA  4E75                    1049      RTS
000019DC                          1050      
000019DC                          1051  MAPA2
000019DC  301F                    1052      MOVE.W (A7)+, D0
000019DE  48A7 F800               1053      MOVEM.W D0-D4, -(A7)
000019E2  3039 000038F0           1054      MOVE.W PLAYERPOSX, D0
000019E8  3239 000038F2           1055      MOVE.W PLAYERPOSY, D1
000019EE                          1056      ;GO TO THE NEXT ROOM DOOR
000019EE                          1057      ;FIRST LETS CHECK POS X
000019EE  B07C 0160               1058      CMP #352, D0  ; BGT = 352 > D0
000019F2  6E00 0030               1059      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
000019F6  B07C 0120               1060      CMP #288, D0
000019FA  6D00 0028               1061      BLT MAP2NODOOR1
000019FE                          1062      ;NOW WE CHECK POS Y 
000019FE  B27C 01E0               1063      CMP #480, D1  ; 
00001A02  6E00 0020               1064      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A06  B27C 01C0               1065      CMP #448, D1
00001A0A  6D00 0018               1066      BLT MAP2NODOOR1
00001A0E  33FC 0020 000038F2      1067      MOVE.W #32, PLAYERPOSY
00001A16  33FC 0003 000038FE      1068      MOVE.W #3, LOADEDMAP
00001A1E  4C9F 001F               1069      MOVEM.W (A7)+, D0-D4
00001A22  4E75                    1070      RTS
00001A24                          1071  MAP2NODOOR1
00001A24                          1072      ;GO TO THE PREVIOUS ROOM DOOR
00001A24                          1073      ;FIRST LETS CHECK POS X
00001A24  B07C 0160               1074      CMP #352, D0  ; BGT = 352 > D0
00001A28  6E00 0030               1075      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A2C  B07C 0120               1076      CMP #288, D0
00001A30  6D00 0028               1077      BLT MAP2NODOOR2
00001A34                          1078      ;NOW WE CHECK POS Y 
00001A34  B27C 0020               1079      CMP #32, D1  ; 
00001A38  6E00 0020               1080      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A3C  B27C 0000               1081      CMP #0, D1
00001A40  6D00 0018               1082      BLT MAP2NODOOR2
00001A44  33FC 01A0 000038F2      1083      MOVE.W  #416, PLAYERPOSY
00001A4C  33FC 0001 000038FE      1084      MOVE.W #1, LOADEDMAP
00001A54  4C9F 001F               1085      MOVEM.W (A7)+, D0-D4
00001A58  4E75                    1086      RTS
00001A5A                          1087  
00001A5A                          1088  MAP2NODOOR2
00001A5A                          1089      ;GO TO THE LEFT HEAVEN'S ROOM
00001A5A  B07C 00A0               1090      CMP #160, D0  ; BGT = 352 > D0
00001A5E  6E00 0038               1091      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A62  B07C 0080               1092      CMP #128, D0
00001A66  6D00 0030               1093      BLT MAP2NODOOR3
00001A6A                          1094      ;NOW WE CHECK POS Y 
00001A6A  B27C 00AA               1095      CMP #170, D1  ; 
00001A6E  6E00 0028               1096      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A72  B27C 0078               1097      CMP #120, D1
00001A76  6D00 0020               1098      BLT MAP2NODOOR3
00001A7A  33FC 0130 000038F0      1099      MOVE.W #$130, PLAYERPOSX
00001A82  33FC 00B0 000038F2      1100      MOVE.W #$0B0, PLAYERPOSY
00001A8A  33FC 0004 000038FE      1101      MOVE.W #4, LOADEDMAP
00001A92  4C9F 001F               1102      MOVEM.W (A7)+, D0-D4
00001A96  4E75                    1103      RTS
00001A98                          1104  MAP2NODOOR3
00001A98                          1105      ;GO TO THE RIGHT HEAVEN'S ROOM
00001A98  B07C 01E0               1106      CMP #480, D0  ; BGT = 352 > D0
00001A9C  6E00 0038               1107      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AA0  B07C 01C0               1108      CMP #448, D0
00001AA4  6D00 0030               1109      BLT MAP2NODOOR4
00001AA8                          1110      ;NOW WE CHECK POS Y 
00001AA8  B27C 00AA               1111      CMP #170, D1  ; 
00001AAC  6E00 0028               1112      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AB0  B27C 0078               1113      CMP #120, D1
00001AB4  6D00 0020               1114      BLT MAP2NODOOR4
00001AB8  33FC 0130 000038F0      1115      MOVE.W #$130, PLAYERPOSX
00001AC0  33FC 00B0 000038F2      1116      MOVE.W #$0B0, PLAYERPOSY
00001AC8  33FC 0004 000038FE      1117      MOVE.W #4, LOADEDMAP
00001AD0  4C9F 001F               1118      MOVEM.W (A7)+, D0-D4
00001AD4  4E75                    1119      RTS
00001AD6                          1120  MAP2NODOOR4
00001AD6  4C9F 001F               1121      MOVEM.W (A7)+, D0-D4
00001ADA  4E75                    1122      RTS
00001ADC                          1123  MAPA3 
00001ADC  301F                    1124      MOVE.W (A7)+, D0
00001ADE  48A7 F800               1125      MOVEM.W D0-D4, -(A7)
00001AE2  3039 000038F0           1126      MOVE.W PLAYERPOSX, D0
00001AE8  3239 000038F2           1127      MOVE.W PLAYERPOSY, D1
00001AEE                          1128      ;GO TO THE PREVIOUS ROOM DOOR
00001AEE                          1129      ;FIRST LETS CHECK POS X
00001AEE  B07C 0160               1130      CMP #352, D0  ; BGT = 352 > D0
00001AF2  6E00 0030               1131      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AF6  B07C 0120               1132      CMP #288, D0
00001AFA  6D00 0028               1133      BLT MAP3NODOOR
00001AFE                          1134      ;NOW WE CHECK POS Y 
00001AFE  B27C 0020               1135      CMP #32, D1  ; 
00001B02  6E00 0020               1136      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B06  B27C 0000               1137      CMP #0, D1
00001B0A  6D00 0018               1138      BLT MAP3NODOOR
00001B0E  33FC 01A0 000038F2      1139      MOVE.W  #416, PLAYERPOSY
00001B16  33FC 0002 000038FE      1140      MOVE.W #2, LOADEDMAP
00001B1E  4C9F 001F               1141      MOVEM.W (A7)+, D0-D4
00001B22  4E75                    1142      RTS
00001B24                          1143  MAP3NODOOR
00001B24  4C9F 001F               1144      MOVEM.W (A7)+, D0-D4
00001B28  4E75                    1145      RTS
00001B2A                          1146  MAPA4
00001B2A  301F                    1147      MOVE.W (A7)+, D0
00001B2C  48A7 F800               1148      MOVEM.W D0-D4, -(A7)
00001B30  3039 000038F0           1149      MOVE.W PLAYERPOSX, D0
00001B36  3239 000038F2           1150      MOVE.W PLAYERPOSY, D1
00001B3C                          1151      ;GO BACK TO 2ND HEAVEN'S ROOM
00001B3C  B07C 0180               1152      CMP #384, D0  ; BGT = 352 > D0
00001B40  6E00 002A               1153      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B44  B07C 0104               1154      CMP #260, D0
00001B48  6D00 0022               1155      BLT MAP4NODOOR
00001B4C                          1156      ;NOW WE CHECK POS Y 
00001B4C  B27C 0080               1157      CMP #128, D1  ; 
00001B50  6E00 001A               1158      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B54  B27C 0060               1159      CMP #96, D1
00001B58  6D00 0012               1160      BLT MAP4NODOOR
00001B5C  33FC 00E0 000038F0      1161      MOVE.W  #224, PLAYERPOSX
00001B64  33FC 0002 000038FE      1162      MOVE.W #2, LOADEDMAP
00001B6C                          1163  MAP4NODOOR
00001B6C  4C9F 001F               1164      MOVEM.W (A7)+, D0-D4
00001B70  4E75                    1165      RTS
00001B72                          1166  ;;;;;;;;;;HELL
00001B72                          1167  MAPA5
00001B72  301F                    1168      MOVE.W (A7)+, D0
00001B74  48A7 F800               1169      MOVEM.W D0-D4, -(A7)
00001B78  3039 000038F0           1170      MOVE.W PLAYERPOSX, D0
00001B7E  3239 000038F2           1171      MOVE.W PLAYERPOSY, D1
00001B84                          1172      ;GO TO THE NEXT ROOM DOOR
00001B84                          1173      ;FIRST LETS CHECH POS X
00001B84  B07C 0160               1174      CMP #352, D0  ; BGT = 352 > D0
00001B88  6E00 002A               1175      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B8C  B07C 0120               1176      CMP #288, D0
00001B90  6D00 0022               1177      BLT MAP5NODOOR
00001B94                          1178      ;NOW WE CHECK POS Y 
00001B94  B27C 01E0               1179      CMP #480, D1  ; 
00001B98  6E00 001A               1180      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B9C  B27C 01C0               1181      CMP #448, D1
00001BA0  6D00 0012               1182      BLT MAP5NODOOR
00001BA4  33FC 0020 000038F2      1183      MOVE.W #32, PLAYERPOSY
00001BAC  33FC 0006 000038FE      1184      MOVE.W #6, LOADEDMAP
00001BB4                          1185  MAP5NODOOR
00001BB4  4C9F 001F               1186      MOVEM.W (A7)+, D0-D4
00001BB8  4E75                    1187      RTS
00001BBA                          1188      
00001BBA                          1189  MAPA6
00001BBA  301F                    1190      MOVE.W (A7)+, D0
00001BBC  48A7 F800               1191      MOVEM.W D0-D4, -(A7)
00001BC0  3039 000038F0           1192      MOVE.W PLAYERPOSX, D0
00001BC6  3239 000038F2           1193      MOVE.W PLAYERPOSY, D1
00001BCC                          1194      ;GO TO THE NEXT ROOM DOOR
00001BCC                          1195      ;FIRST LETS CHECK POS X
00001BCC  B07C 0160               1196      CMP #352, D0  ; BGT = 352 > D0
00001BD0  6E00 0030               1197      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BD4  B07C 0120               1198      CMP #288, D0
00001BD8  6D00 0028               1199      BLT MAP6NODOOR1
00001BDC                          1200      ;NOW WE CHECK POS Y 
00001BDC  B27C 01E0               1201      CMP #480, D1  ; 
00001BE0  6E00 0020               1202      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BE4  B27C 01C0               1203      CMP #448, D1
00001BE8  6D00 0018               1204      BLT MAP6NODOOR1
00001BEC  33FC 0020 000038F2      1205      MOVE.W #32, PLAYERPOSY
00001BF4  33FC 0007 000038FE      1206      MOVE.W #7, LOADEDMAP
00001BFC  4C9F 001F               1207      MOVEM.W (A7)+, D0-D4
00001C00  4E75                    1208      RTS
00001C02                          1209  MAP6NODOOR1
00001C02                          1210      ;GO TO THE PREVIOUS ROOM DOOR
00001C02                          1211      ;FIRST LETS CHECK POS X
00001C02  B07C 0160               1212      CMP #352, D0  ; BGT = 352 > D0
00001C06  6E00 0030               1213      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C0A  B07C 0120               1214      CMP #288, D0
00001C0E  6D00 0028               1215      BLT MAP6NODOOR2
00001C12                          1216      ;NOW WE CHECK POS Y 
00001C12  B27C 0020               1217      CMP #32, D1  ; 
00001C16  6E00 0020               1218      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C1A  B27C 0000               1219      CMP #0, D1
00001C1E  6D00 0018               1220      BLT MAP6NODOOR2
00001C22  33FC 01A0 000038F2      1221      MOVE.W  #416, PLAYERPOSY
00001C2A  33FC 0005 000038FE      1222      MOVE.W #5, LOADEDMAP
00001C32  4C9F 001F               1223      MOVEM.W (A7)+, D0-D4
00001C36  4E75                    1224      RTS
00001C38                          1225  MAP6NODOOR2
00001C38                          1226      ;CHECK FOR LEFT HELL ROOM
00001C38  B07C 0060               1227      CMP #96, D0  ; BGT = 352 > D0
00001C3C  6E00 0038               1228      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C40  B07C 0040               1229      CMP #64, D0
00001C44  6D00 0030               1230      BLT MAP6NODOOR3
00001C48                          1231      ;NOW WE CHECK POS Y 
00001C48  B27C 0180               1232      CMP #384, D1  ; 
00001C4C  6E00 0028               1233      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C50  B27C 0140               1234      CMP #320, D1
00001C54  6D00 0020               1235      BLT MAP6NODOOR3
00001C58  33FC 0130 000038F0      1236      MOVE.W #$130, PLAYERPOSX
00001C60  33FC 00B0 000038F2      1237      MOVE.W #$0B0, PLAYERPOSY
00001C68  33FC 0008 000038FE      1238      MOVE.W #8, LOADEDMAP
00001C70  4C9F 001F               1239      MOVEM.W (A7)+, D0-D4
00001C74  4E75                    1240      RTS
00001C76                          1241  MAP6NODOOR3
00001C76                          1242      ;CHECK FOR THE RIGHT HELL ROOM
00001C76  B07C 0240               1243      CMP #576, D0  ; BGT = 352 > D0
00001C7A  6E00 0038               1244      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C7E  B07C 021C               1245      CMP #540, D0
00001C82  6D00 0030               1246      BLT MAP6NODOOR4
00001C86                          1247      ;NOW WE CHECK POS Y 
00001C86  B27C 0180               1248      CMP #384, D1  ; 
00001C8A  6E00 0028               1249      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C8E  B27C 0140               1250      CMP #320, D1
00001C92  6D00 0020               1251      BLT MAP6NODOOR4
00001C96  33FC 0130 000038F0      1252      MOVE.W #$130, PLAYERPOSX
00001C9E  33FC 00B0 000038F2      1253      MOVE.W #$0B0, PLAYERPOSY
00001CA6  33FC 0008 000038FE      1254      MOVE.W #8, LOADEDMAP
00001CAE  4C9F 001F               1255      MOVEM.W (A7)+, D0-D4
00001CB2  4E75                    1256      RTS
00001CB4                          1257  MAP6NODOOR4
00001CB4  4C9F 001F               1258      MOVEM.W (A7)+, D0-D4
00001CB8  4E75                    1259      RTS
00001CBA                          1260  MAPA7 
00001CBA  301F                    1261      MOVE.W (A7)+, D0
00001CBC  48A7 F800               1262      MOVEM.W D0-D4, -(A7)
00001CC0  3039 000038F0           1263      MOVE.W PLAYERPOSX, D0
00001CC6  3239 000038F2           1264      MOVE.W PLAYERPOSY, D1
00001CCC                          1265      ;GO BACK TO PREVIOUS HELL'S ROOM
00001CCC  B07C 0180               1266      CMP #384, D0  ; BGT = 352 > D0
00001CD0  6E00 0032               1267      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CD4  B07C 0104               1268      CMP #260, D0
00001CD8  6D00 002A               1269      BLT MAP7NODOOR
00001CDC                          1270      ;NOW WE CHECK POS Y 
00001CDC  B27C 0020               1271      CMP #32, D1  ; 
00001CE0  6E00 0022               1272      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CE4  B27C 0000               1273      CMP #0, D1
00001CE8  6D00 001A               1274      BLT MAP7NODOOR
00001CEC  33FC 0140 000038F0      1275      MOVE.W  #320, PLAYERPOSX
00001CF4  33FC 01A0 000038F2      1276      MOVE.W #416, PLAYERPOSY
00001CFC  33FC 0006 000038FE      1277      MOVE.W #6, LOADEDMAP
00001D04                          1278  MAP7NODOOR
00001D04  4C9F 001F               1279      MOVEM.W (A7)+, D0-D4
00001D08  4E75                    1280      RTS
00001D0A                          1281  MAPA8
00001D0A                          1282       ;HELLS ROOM
00001D0A  301F                    1283      MOVE.W (A7)+, D0
00001D0C  48A7 F800               1284      MOVEM.W D0-D4, -(A7)
00001D10  3039 000038F0           1285      MOVE.W PLAYERPOSX, D0
00001D16  3239 000038F2           1286      MOVE.W PLAYERPOSY, D1
00001D1C                          1287      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D1C  B07C 0180               1288      CMP #384, D0  ; BGT = 352 > D0
00001D20  6E00 0032               1289      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D24  B07C 0104               1290      CMP #260, D0
00001D28  6D00 002A               1291      BLT MAP8NODOOR1
00001D2C                          1292      ;NOW WE CHECK POS Y 
00001D2C  B27C 0080               1293      CMP #128, D1  ; 
00001D30  6E00 0022               1294      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D34  B27C 0060               1295      CMP #96, D1
00001D38  6D00 001A               1296      BLT MAP8NODOOR1
00001D3C  33FC 0140 000038F0      1297      MOVE.W  #320, PLAYERPOSX
00001D44  33FC 0080 000038F2      1298      MOVE.W #128, PLAYERPOSY
00001D4C  33FC 0006 000038FE      1299      MOVE.W #6, LOADEDMAP
00001D54                          1300  MAP8NODOOR1
00001D54  4C9F 001F               1301      MOVEM.W (A7)+, D0-D4
00001D58  4E75                    1302      RTS
00001D5A                          1303  
00001D5A                          1304  
00001D5A                          1305  
00001D5A                          1306  
00001D5A                          1307  
00001D5A                          1308  
00001D5A                          1309  
00001D5A                          1310  
00001D5A                          1311  
00001D5A                          1312  
00001D5A                          1313  
00001D5A                          1314  
00001D5A                          1315  
00001D5A                          1316  -------------------- end include --------------------
00001D5A                          1317              INCLUDE "MAP.X68"
00001D5A                          1318  
00001D5A                          1319  ;MAP 0 INDICATES THAT WE ARE IN THE ELEVATOR MENU. 
00001D5A                          1320  
00001D5A                          1321  HEAVEN_0    ;MAP 1
00001D5A= 03 03 03 03 03 03 ...   1322      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00001D6F= 03 01 01 01 01 01 ...   1323      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
00001D84= 03 01 03 03 03 03 ...   1324      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
00001D99= 03 01 03 05 05 05 ...   1325      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00001DAE= 03 01 03 05 05 05 ...   1326      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DC3= 03 01 03 05 05 05 ...   1327      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001DD8= 03 01 03 05 05 05 ...   1328      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001DED= 03 01 03 05 05 05 ...   1329      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00001E02= 03 01 03 05 05 05 ...   1330      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E17= 03 01 03 05 05 05 ...   1331      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E2C= 03 01 03 05 05 05 ...   1332      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E41= 03 01 03 05 05 05 ...   1333      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E56= 03 01 03 05 05 05 ...   1334      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00001E6B= 03 01 03 03 03 03 ...   1335      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00001E80= 03 01 01 01 01 01 ...   1336      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001E95= 03 03 03 03 03 03 ...   1337      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001EAA                          1338          
00001EAA                          1339  HEAVEN_1    ;MAP 2
00001EAA= 03 03 03 03 03 03 ...   1340      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001EBF= 03 03 01 01 01 01 ...   1341      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
00001ED4= 03 03 03 03 03 03 ...   1342      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
00001EE9= 03 07 07 07 07 03 ...   1343      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001EFE= 03 07 07 07 07 03 ...   1344      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F13= 03 07 07 07 07 09 ...   1345      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
00001F28= 03 07 07 07 07 03 ...   1346      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
00001F3D= 03 07 07 07 07 03 ...   1347      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
00001F52= 03 03 03 03 03 03 ...   1348      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
00001F67= 03 01 01 01 01 03 ...   1349      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00001F7C= 03 01 01 01 01 01 ...   1350      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00001F91= 03 01 01 01 01 01 ...   1351      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001FA6= 03 01 01 01 01 01 ...   1352      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001FBB= 03 01 01 01 01 01 ...   1353      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00001FD0= 03 03 03 03 03 03 ...   1354      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00001FE5                          1355      
00001FE5                          1356  HEAVEN_END  ;MAP 3
00001FE5= 03 03 03 03 03 03 ...   1357      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00001FFA= 03 05 05 05 05 05 ...   1358      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
0000200F= 03 05 05 07 05 05 ...   1359      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00002024= 03 05 07 07 07 05 ...   1360      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00002039= 03 05 05 07 05 05 ...   1361      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
0000204E= 03 05 05 07 05 05 ...   1362      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00002063= 03 05 05 05 05 05 ...   1363      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00002078= 03 05 05 05 05 05 ...   1364      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
0000208D= 03 05 05 05 05 05 ...   1365      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
000020A2= 03 05 05 07 05 05 ...   1366      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000020B7= 03 05 07 07 07 05 ...   1367      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
000020CC= 03 05 05 07 05 05 ...   1368      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000020E1= 03 05 05 07 05 05 ...   1369      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000020F6= 03 05 05 05 05 05 ...   1370      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
0000210B= 03 03 03 03 03 03 ...   1371      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
00002120                          1372      
00002120                          1373  HEAVEN_ROOM ;MAP 4
00002120= 09 09 09 09 09 09 ...   1374      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002135= 09 09 09 09 09 09 ...   1375      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000214A= 09 09 09 09 09 09 ...   1376      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000215F= 09 09 09 09 09 09 ...   1377      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002174= 09 09 09 09 09 03 ...   1378      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
00002189= 09 09 09 09 09 03 ...   1379      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000219E= 09 09 09 09 09 03 ...   1380      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021B3= 09 09 09 09 09 03 ...   1381      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021C8= 09 09 09 09 09 03 ...   1382      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021DD= 09 09 09 09 09 03 ...   1383      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
000021F2= 09 09 09 09 09 03 ...   1384      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
00002207= 09 09 09 09 09 09 ...   1385      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000221C= 09 09 09 09 09 09 ...   1386      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002231= 09 09 09 09 09 09 ...   1387      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00002246= 09 09 09 09 09 09 ...   1388      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
0000225B                          1389      
0000225B                          1390  HELL_0  ;MAP 5
0000225B= 02 02 02 02 02 02 ...   1391      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
00002270= 02 06 06 06 06 06 ...   1392      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002285= 02 06 06 04 06 06 ...   1393      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
0000229A= 02 06 06 04 06 06 ...   1394      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
000022AF= 02 06 04 04 04 06 ...   1395      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
000022C4= 02 06 06 04 06 06 ...   1396      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
000022D9= 02 06 06 06 06 06 ...   1397      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000022EE= 02 02 02 02 02 02 ...   1398      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
00002303= 02 06 06 06 06 06 ...   1399      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002318= 02 06 06 06 06 06 ...   1400      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000232D= 02 06 06 06 06 06 ...   1401      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002342= 02 06 06 06 06 06 ...   1402      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002357= 02 06 06 06 06 06 ...   1403      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
0000236C= 02 06 06 06 06 06 ...   1404      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002381= 02 02 02 02 02 02 ...   1405      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00002396                          1406          
00002396                          1407  HELL_1      ;MAP 6
00002396= 02 02 02 02 02 02 ...   1408      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
000023AB= 02 06 06 06 06 06 ...   1409      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023C0= 02 06 06 06 06 06 ...   1410      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023D5= 02 06 06 06 06 06 ...   1411      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000023EA= 02 06 06 06 06 06 ...   1412      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000023FF= 02 06 06 06 06 06 ...   1413      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00002414= 02 06 06 06 06 06 ...   1414      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00002429= 02 06 06 06 06 06 ...   1415      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
0000243E= 02 06 06 06 06 06 ...   1416      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002453= 02 06 06 06 06 06 ...   1417      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002468= 02 02 08 02 02 02 ...   1418      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
0000247D= 02 06 06 06 02 02 ...   1419      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00002492= 02 06 06 06 02 02 ...   1420      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
000024A7= 02 06 06 06 02 02 ...   1421      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
000024BC= 02 02 02 02 02 02 ...   1422      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
000024D1                          1423          
000024D1                          1424  HELL_END    ;MAP 7
000024D1= 02 02 02 02 02 02 ...   1425      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
000024E6= 02 06 06 06 06 06 ...   1426      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000024FB= 02 06 06 06 06 06 ...   1427      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00002510= 02 06 06 06 06 06 ...   1428      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002525= 02 06 06 06 06 06 ...   1429      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000253A= 02 06 06 06 06 06 ...   1430      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
0000254F= 02 06 06 06 06 06 ...   1431      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002564= 02 06 06 06 06 06 ...   1432      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00002579= 02 06 06 06 06 06 ...   1433      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
0000258E= 02 06 06 06 06 06 ...   1434      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
000025A3= 02 06 06 06 06 06 ...   1435      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025B8= 02 06 06 06 06 06 ...   1436      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
000025CD= 02 06 06 06 06 06 ...   1437      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000025E2= 02 06 06 06 06 06 ...   1438      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
000025F7= 02 02 02 02 02 02 ...   1439      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
0000260C                          1440      
0000260C                          1441  HELL_ROOM   ;MAP 8
0000260C= 08 08 08 08 08 08 ...   1442      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002621= 08 08 08 08 08 08 ...   1443      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002636= 08 08 08 08 08 08 ...   1444      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000264B= 08 08 08 08 08 08 ...   1445      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002660= 08 08 08 08 08 02 ...   1446      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
00002675= 08 08 08 08 08 02 ...   1447      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000268A= 08 08 08 08 08 02 ...   1448      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
0000269F= 08 08 08 08 08 02 ...   1449      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026B4= 08 08 08 08 08 02 ...   1450      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026C9= 08 08 08 08 08 02 ...   1451      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
000026DE= 08 08 08 08 08 02 ...   1452      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
000026F3= 08 08 08 08 08 08 ...   1453      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002708= 08 08 08 08 08 08 ...   1454      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
0000271D= 08 08 08 08 08 08 ...   1455      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00002732= 08 08 08 08 08 08 ...   1456      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
00002747                          1457  
00002747                          1458  
00002747                          1459  
00002747                          1460  
00002747                          1461  
00002747                          1462  
00002747                          1463  
00002747                          1464  -------------------- end include --------------------
00002747                          1465              INCLUDE "ELEVATOR_MENU.X68"           
00002747  =000000CC               1466  COLBUTHL    EQU $000000CC
00002747  =00EEEEEE               1467  COLBUTHV    EQU $00EEEEEE
00002747                          1468  
00002747= 01                      1469      DC.B 1
00002748                          1470  ELEVATORPLOT
00002748                          1471      
00002748  4CDF 7F00               1472      MOVEM.L (A7)+, A0-A6
0000274C  4CDF 00FF               1473      MOVEM.L (A7)+, D0-D7
00002750                          1474  
00002750                          1475  
00002750                          1476  ;SET PEN COLOR  
00002750  103C 0050               1477      MOVE.B #80, D0
00002754  223C 00010101           1478      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
0000275A  4E4F                    1479      TRAP #15
0000275C                          1480      
0000275C                          1481  ;END SET PEN COLOR 
0000275C                          1482  
0000275C                          1483      ;DRAW LINES
0000275C                          1484  ;DRAW LINE 1 
0000275C  103C 0054               1485      MOVE.B #84, D0
00002760  323C 0000               1486      MOVE.W #0, D1
00002764  343C 0000               1487      MOVE.W #0, D2
00002768  363C 00A0               1488      MOVE.W #160, D3
0000276C  383C 0078               1489      MOVE.W #120, D4
00002770  4E4F                    1490      TRAP #15
00002772                          1491  
00002772                          1492  ;DRAW LINE 2
00002772  103C 0054               1493      MOVE.B #84, D0
00002776  323C 00A0               1494      MOVE.W #160, D1
0000277A  343C 0078               1495      MOVE.W #120, D2
0000277E  363C 00A0               1496      MOVE.W #160, D3
00002782  383C 01E0               1497      MOVE.W #480, D4
00002786  4E4F                    1498      TRAP #15
00002788                          1499      
00002788                          1500  ;DRAW LINE 3
00002788  103C 0054               1501      MOVE.B #84, D0
0000278C  323C 00A0               1502      MOVE.W #160, D1
00002790  343C 0078               1503      MOVE.W #120, D2
00002794  363C 01E0               1504      MOVE.W #480, D3
00002798  383C 0078               1505      MOVE.W #120, D4
0000279C  4E4F                    1506      TRAP #15
0000279E                          1507      
0000279E                          1508  ;DRAW LINE 4
0000279E  103C 0054               1509      MOVE.B #84, D0
000027A2  323C 01E0               1510      MOVE.W #480, D1
000027A6  343C 0078               1511      MOVE.W #120, D2
000027AA  363C 0280               1512      MOVE.W #640, D3
000027AE  383C 0000               1513      MOVE.W #0, D4
000027B2  4E4F                    1514      TRAP #15
000027B4                          1515      
000027B4                          1516  ;DRAW LINE 5
000027B4  103C 0054               1517      MOVE.B #84, D0
000027B8  323C 01E0               1518      MOVE.W #480, D1
000027BC  343C 0078               1519      MOVE.W #120, D2
000027C0  363C 01E0               1520      MOVE.W #480, D3
000027C4  383C 01E0               1521      MOVE.W #480, D4
000027C8  4E4F                    1522      TRAP #15
000027CA                          1523  
000027CA                          1524  ;DRAW LINE 6 (TO GIVE SHADE) 
000027CA  103C 0054               1525      MOVE.B #84, D0
000027CE  323C 0119               1526      MOVE.W #281, D1
000027D2  343C 015A               1527      MOVE.W #346, D2
000027D6  363C 0167               1528      MOVE.W #359, D3
000027DA  383C 015A               1529      MOVE.W #346, D4
000027DE  4E4F                    1530      TRAP #15
000027E0                          1531      
000027E0                          1532  ;DRAW LINE 7 (TO GIVE SHADE) 
000027E0  103C 0054               1533      MOVE.B #84, D0
000027E4  323C 011A               1534      MOVE.W #282, D1
000027E8  343C 015B               1535      MOVE.W #347, D2
000027EC  363C 0166               1536      MOVE.W #358, D3
000027F0  383C 015B               1537      MOVE.W #347, D4
000027F4  4E4F                    1538      TRAP #15
000027F6                          1539      
000027F6                          1540      ;END DRAW LINES
000027F6                          1541      
000027F6                          1542  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
000027F6  103C 0057               1543      MOVE.B #87, D0
000027FA  323C 0118               1544      MOVE.W #280, D1
000027FE  343C 00D2               1545      MOVE.W #210, D2
00002802  363C 0168               1546      MOVE.W #360, D3
00002806  383C 0159               1547      MOVE.W #345, D4
0000280A  4E4F                    1548      TRAP #15
0000280C                          1549      
0000280C                          1550  ;DRAW ELLIPSE FOR THE LIGHT
0000280C  103C 005B               1551      MOVE.B #91, D0
00002810  323C 00FA               1552      MOVE.W #250, D1
00002814  343C 0028               1553      MOVE.W #40, D2
00002818  363C 0186               1554      MOVE.W #390, D3
0000281C  383C 0050               1555      MOVE.W #80, D4
00002820  4E4F                    1556      TRAP #15
00002822                          1557      ;FILL SEGMENTS
00002822                          1558  ;FILL SEGMENT 1 LEFT WALL
00002822                          1559    ;SET FILL COLOR TO DARKER GREY, FOR W
00002822  103C 0051               1560      MOVE.B #81, D0
00002826                          1561      ;MOVE.L #$00969696, D1
00002826  223C 0020202F           1562      MOVE.L #$0020202F, D1
0000282C  4E4F                    1563      TRAP #15
0000282E                          1564      ;END SET FILL COLOR
0000282E  103C 0059               1565      MOVE.B #89, D0
00002832  323C 0064               1566      MOVE.W #100, D1
00002836  343C 0064               1567      MOVE.W #100, D2
0000283A  4E4F                    1568      TRAP #15
0000283C                          1569      
0000283C                          1570  ;FILL SEGMENT 2 CEILING
0000283C                          1571    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
0000283C  103C 0051               1572      MOVE.B #81, D0
00002840                          1573      ;MOVE.L #$00C0C0C0, D1
00002840  223C 00141424           1574      MOVE.L #$00141424,D1
00002846  4E4F                    1575      TRAP #15
00002848                          1576      ;END SET FILL COLOR
00002848  103C 0059               1577      MOVE.B #89, D0
0000284C  323C 0064               1578      MOVE.W #100, D1
00002850  343C 0032               1579      MOVE.W #50, D2
00002854  4E4F                    1580      TRAP #15
00002856                          1581      
00002856                          1582  ;FILL SEGMENT 3 RIGHT WALL
00002856                          1583    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00002856  103C 0051               1584      MOVE.B #81, D0
0000285A                          1585      ;MOVE.L #$00969696, D1
0000285A  223C 0020202F           1586      MOVE.L #$0020202F,D1
00002860  4E4F                    1587      TRAP #15
00002862                          1588      ;END SET FILL COLOR
00002862  103C 0059               1589      MOVE.B #89, D0
00002866  323C 0276               1590      MOVE.W #630, D1
0000286A  343C 01D6               1591      MOVE.W #470, D2
0000286E  4E4F                    1592      TRAP #15
00002870                          1593      
00002870                          1594  ;FILL SEGMENT 4 BACKGROUND WALL
00002870                          1595    ;SET FILL COLOR TO 
00002870  103C 0051               1596      MOVE.B #81, D0
00002874                          1597      ;MOVE.L #$00ABABAB, D1
00002874  223C 001A1A2A           1598      MOVE.L #$001A1A2A, D1
0000287A  4E4F                    1599      TRAP #15
0000287C                          1600      ;END SET FILL COLOR
0000287C  103C 0059               1601      MOVE.B #89, D0
00002880  323C 00F0               1602      MOVE.W #240, D1
00002884  343C 0140               1603      MOVE.W #320, D2
00002888  4E4F                    1604      TRAP #15
0000288A                          1605      
0000288A                          1606  ;FILL SEGMENT 5 PANEL 
0000288A                          1607    ;SET FILL COLOR TO 
0000288A  103C 0051               1608      MOVE.B #81, D0
0000288E                          1609      ;MOVE.L #$00AFAFAF, D1
0000288E  223C 001F1F2F           1610      MOVE.L #$001F1F2F, D1
00002894  4E4F                    1611      TRAP #15
00002896                          1612      ;END SET FILL COLOR
00002896  103C 0059               1613      MOVE.B #89, D0
0000289A  323C 011D               1614      MOVE.W #285, D1
0000289E  343C 00D7               1615      MOVE.W #215, D2
000028A2  4E4F                    1616      TRAP #15
000028A4                          1617      
000028A4                          1618  ;FILL ELLIPSE LIGHT 
000028A4                          1619    ;SET FILL COLOR TO 
000028A4  103C 0051               1620      MOVE.B #81, D0
000028A8                          1621      ;MOVE.L #$00A1E9E9, D1
000028A8  223C 000000FF           1622      MOVE.L #$000000FF, D1
000028AE  4E4F                    1623      TRAP #15
000028B0                          1624      ;END SET FILL COLOR
000028B0  103C 0059               1625      MOVE.B #89, D0
000028B4  323C 0140               1626      MOVE.W #320, D1
000028B8  343C 003C               1627      MOVE.W #60, D2
000028BC  4E4F                    1628      TRAP #15
000028BE                          1629  
000028BE                          1630  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
000028BE                          1631      ;SET FILL COLOR 
000028BE  103C 0051               1632      MOVE.B #81, D0
000028C2  223C 000000CC           1633      MOVE.L #COLBUTHL, D1
000028C8  4E4F                    1634      TRAP #15
000028CA                          1635      ;END SET FILL COLOR
000028CA  3F3C 0135               1636      MOVE.W #309, -(A7) ;COORDENADA Y 
000028CE  3F3C 0136               1637      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
000028D2  3F3C 0016               1638      MOVE.W #22, -(A7)
000028D6  4EB9 00002910           1639      JSR TRIANGLE
000028DC  3C1F                    1640      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
000028DE  3C1F                    1641      MOVE.W (A7)+, D6
000028E0  3C1F                    1642      MOVE.W (A7)+, D6
000028E2                          1643  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
000028E2                          1644     ;SET FILL COLOR
000028E2  48E7 FFFE               1645     MOVEM.L D0-D7/A0-A6, -(A7)
000028E6  103C 0051               1646     MOVE.B #81, D0
000028EA  223C 00EEEEEE           1647     MOVE.L #COLBUTHV, D1
000028F0  4E4F                    1648     TRAP #15
000028F2  4CDF 7FFF               1649     MOVEM.L (A7)+, D0-D7/A0-A6
000028F6                          1650      ;END SET FILL COLOR
000028F6  3F3C 00F9               1651     MOVE.W #249, -(A7) ;COORDENADA Y 
000028FA  3F3C 0136               1652     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
000028FE  3F3C FFEA               1653     MOVE.W #-22, -(A7)
00002902  4EB9 00002910           1654     JSR TRIANGLE
00002908  3C1F                    1655     MOVE.W (A7)+, D6
0000290A  3C1F                    1656     MOVE.W (A7)+, D6
0000290C  3C1F                    1657     MOVE.W (A7)+, D6
0000290E                          1658     ;MOVEM.L (A7)+, D0-D7/A0-A6
0000290E                          1659  
0000290E  4E75                    1660     RTS
00002910                          1661  ; ------------------------------------------------------------------------------
00002910                          1662  TRIANGLE
00002910                          1663  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
00002910                          1664  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
00002910                          1665  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
00002910                          1666  ;            SIDES LENGTH (WORD) IN THAT ORDER
00002910                          1667  ; OUTPUT   : NONE
00002910                          1668  ; MODIFIES : NONE
00002910                          1669  ; ------------------------------------------------------------------------------
00002910  48A7 F800               1670      MOVEM.W D0-D4, -(A7)
00002914                          1671      ; LINE FROM LEFT TO RIGHT
00002914  103C 0054               1672      MOVE.B  #84,D0      ; TASK NUMBER
00002918  322F 0010               1673      MOVE.W  16(A7),D1   ; X POSITION FROM
0000291C  342F 0012               1674      MOVE.W  18(A7),D2   ; Y POSITION FROM
00002920  3802                    1675      MOVE.W  D2,D4       ; Y POSITION TO
00002922  362F 000E               1676      MOVE.W  14(A7),D3   ; LENGTH
00002926                          1677      
00002926  6A00 0004               1678      BPL.W   .UPWARDS
0000292A  4443                    1679      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
0000292C                          1680  .UPWARDS
0000292C  D641                    1681      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
0000292E  4E4F                    1682      TRAP    #15         ; HORIZONTAL LINE DRAWN
00002930                          1683      ; LINE FROM RIGHT TO UP/DOWN
00002930  9641                    1684      SUB.W   D1,D3       ; I GET LENGTH IN D3
00002932  3001                    1685      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
00002934  D243                    1686      ADD.W   D3,D1       ; X POSITION FROM
00002936  E24B                    1687      LSR.W   #1,D3       ; LENGTH/2
00002938  D640                    1688      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
0000293A                          1689      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
0000293A  D86F 000E               1690      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
0000293E  103C 0054               1691      MOVE.B  #84,D0
00002942  4E4F                    1692      TRAP    #15
00002944                          1693      ; LINE FROM LEFT TO UP/DOWN
00002944  322F 0010               1694      MOVE.W  16(A7),D1   ; X POSITION FROM
00002948  4E4F                    1695      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
0000294A                          1696      
0000294A                          1697      ; FILLING TRIANGLE
0000294A  103C 0059               1698      MOVE.B  #89,D0
0000294E  5241                    1699      ADDQ.W  #1,D1
00002950  363C 0001               1700      MOVE.W  #1,D3
00002954  4A6F 000E               1701      TST.W   14(A7)
00002958  6A00 0004               1702      BPL.W   .ISPOSITIVE
0000295C  4443                    1703      NEG.W   D3
0000295E                          1704  .ISPOSITIVE
0000295E  D443                    1705      ADD.W   D3,D2
00002960  4E4F                    1706      TRAP    #15
00002962                          1707      
00002962  4C9F 001F               1708      MOVEM.W (A7)+,D0-D4
00002966  4E75                    1709      RTS
00002968                          1710      
00002968                          1711      
00002968                          1712  ELEVATORUPDATE ; 1 = up 3 = down
00002968  3F00                    1713      MOVE.W D0, -(A7)
0000296A  3039 000038FE           1714      MOVE.W LOADEDMAP, D0
00002970  B07C 0000               1715      CMP #0, D0
00002974  6700 0006               1716      BEQ ESMENU
00002978  301F                    1717      MOVE.W (A7)+, D0
0000297A  4E75                    1718      RTS
0000297C                          1719  ESMENU
0000297C  301F                    1720      MOVE.W (A7)+, D0
0000297E  0839 0005 000038E8      1721      BTST #5, KBDVAL
00002986  6600 0022               1722      BNE HLSEL
0000298A  0839 0007 000038E8      1723      BTST #7, KBDVAL
00002992  6600 0004               1724      BNE HVSEL
00002996  4E75                    1725      RTS
00002998                          1726  HVSEL   ;LOAD 1ST HEAVEN MAP
00002998  13FC 0000 00003900      1727      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
000029A0  33FC 0001 000038FE      1728      MOVE.W #1, LOADEDMAP    
000029A8  4E75                    1729      RTS
000029AA                          1730  HLSEL   ;LOAD 1ST HELL MAP
000029AA  13FC 0000 00003900      1731      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
000029B2  33FC 0005 000038FE      1732      MOVE.W #5, LOADEDMAP
000029BA  4E75                    1733      RTS
000029BC                          1734      
000029BC                          1735          
000029BC                          1736  
000029BC                          1737  
000029BC                          1738  
000029BC                          1739  
000029BC                          1740  -------------------- end include --------------------
000029BC                          1741              INCLUDE "PLAYER.X68"    
000029BC                          1742  ; ==============================================================================
000029BC                          1743  ; PLAYER MANAGEMENT
000029BC                          1744  ; ==============================================================================
000029BC                          1745              
000029BC                          1746  ; ------------------------------------------------------------------------------
000029BC                          1747  PLAYERINIT
000029BC                          1748  ; INITIALIZE PLAYER.
000029BC                          1749  ; INPUT    : NONE 
000029BC                          1750  ; OUTPUT   : NONE
000029BC                          1751  ; MODIFIES : NONE
000029BC                          1752  ; ------------------------------------------------------------------------------
000029BC  4E75                    1753              RTS
000029BE                          1754              
000029BE                          1755  ; ------------------------------------------------------------------------------
000029BE                          1756  PLAYERUPD
000029BE                          1757  ; UPDATES THE PLAYER.
000029BE                          1758  ; INPUT    : NONE 
000029BE                          1759  ; OUTPUT   : NONE
000029BE                          1760  ; MODIFIES : NONE
000029BE                          1761  ; ------------------------------------------------------------------------------
000029BE                          1762              ;;CHECK LIMITS IN MAPS
000029BE  3F00                    1763                  MOVE.W D0, -(A7)
000029C0  3039 000038FE           1764              MOVE.W LOADEDMAP, D0
000029C6  B07C 0000               1765              CMP #0, D0
000029CA  6700 0046               1766              BEQ NOLIMITMENU
000029CE  B07C 0001               1767              CMP #1, D0
000029D2  6700 0056               1768              BEQ LIMAPA1
000029D6  B07C 0002               1769              CMP #2, D0
000029DA  6700 014C               1770              BEQ LIMAPA2
000029DE  B07C 0003               1771              CMP #3, D0
000029E2  6700 0354               1772              BEQ LIMAPA3
000029E6  B07C 0004               1773              CMP #4, D0
000029EA  6700 0444               1774              BEQ LIMAPA4
000029EE  B07C 0005               1775              CMP #5, D0
000029F2  6700 0534               1776              BEQ LIMAPA5
000029F6  B07C 0006               1777              CMP #6, D0
000029FA  6700 06D4               1778              BEQ LIMAPA6
000029FE  B07C 0007               1779              CMP #7, D0
00002A02  6700 0880               1780              BEQ LIMAPA7
00002A06  B07C 0008               1781              CMP #8, D0
00002A0A  6700 0970               1782              BEQ LIMAPA8
00002A0E  301F                    1783              MOVE.W (A7)+, D0
00002A10                          1784  
00002A10  4E75                    1785              RTS
00002A12                          1786  NOLIMITMENU
00002A12  33FC 0080 000038F0      1787      MOVE.W #128, PLAYERPOSX
00002A1A  33FC 0080 000038F2      1788      MOVE.W #128, PLAYERPOSY
00002A22  301F                    1789      MOVE.W (A7)+, D0
00002A24  4EF9 00003474           1790      JMP NOLIMIT
00002A2A                          1791  LIMAPA1
00002A2A  301F                    1792      MOVE.W (A7)+, D0
00002A2C  48A7 F800               1793      MOVEM.W D0-D4, -(A7)
00002A30  3039 000038F0           1794      MOVE.W PLAYERPOSX, D0
00002A36  3239 000038F2           1795      MOVE.W PLAYERPOSY, D1
00002A3C                          1796      ;CHECK FOR WALLS IN MAP 1
00002A3C                          1797      ;CHECK UPPER WALL 
00002A3C  B07C 0280               1798      CMP #640, D0  ; BGT = 352 > D0
00002A40  6E00 0026               1799      BGT MAP1NOLIMIT1   
00002A44  B07C 0000               1800      CMP #0, D0
00002A48  6D00 001E               1801      BLT MAP1NOLIMIT1
00002A4C                          1802      ;NOW WE CHECK POS Y 
00002A4C  B27C 0060               1803      CMP #96, D1  ; 
00002A50  6E00 0016               1804      BGT MAP1NOLIMIT1    
00002A54  B27C 0000               1805      CMP #0, D1
00002A58  6D00 000E               1806      BLT MAP1NOLIMIT1
00002A5C                          1807      ;;;; AQUI PISA EL LIMITE
00002A5C  4C9F 001F               1808      MOVEM.W (A7)+, D0-D4
00002A60  5279 000038F2           1809      ADD.W #1, PLAYERPOSY
00002A66  4E75                    1810      RTS
00002A68                          1811  MAP1NOLIMIT1
00002A68                          1812      ;CHECK FOR RIGHT WALL   
00002A68  B07C 0220               1813      CMP #544, D0  ; BGT = 352 > D0
00002A6C  6E00 0026               1814      BGT MAP1NOLIMIT2    
00002A70  B07C 0200               1815      CMP #512, D0
00002A74  6D00 001E               1816      BLT MAP1NOLIMIT2
00002A78                          1817      ;NOW WE CHECK POS Y 
00002A78  B27C 0280               1818      CMP #640, D1  ; 
00002A7C  6E00 0016               1819      BGT MAP1NOLIMIT2    
00002A80  B27C 0000               1820      CMP #0, D1
00002A84  6D00 000E               1821      BLT MAP1NOLIMIT2
00002A88                          1822      ;;;; AQUI PISA EL LIMITE
00002A88  4C9F 001F               1823      MOVEM.W (A7)+, D0-D4
00002A8C  5379 000038F0           1824      SUB.W #1, PLAYERPOSX
00002A92  4E75                    1825      RTS
00002A94                          1826  MAP1NOLIMIT2 
00002A94                          1827      ;CHECK FOR BOTTOM-RIGHT WALL
00002A94  B07C 0280               1828      CMP #640, D0  ; BGT = 352 > D0
00002A98  6E00 002C               1829      BGT MAP1NOLIMIT3    
00002A9C  B07C 0140               1830      CMP #320, D0
00002AA0  6D00 0024               1831      BLT MAP1NOLIMIT3
00002AA4                          1832      ;NOW WE CHECK POS Y 
00002AA4  B27C 01E0               1833      CMP #480, D1  ; 
00002AA8  6E00 001C               1834      BGT MAP1NOLIMIT3    
00002AAC  B27C 0180               1835      CMP #384, D1
00002AB0  6D00 0014               1836      BLT MAP1NOLIMIT3
00002AB4                          1837      ;;;; AQUI PISA EL LIMITE
00002AB4  4C9F 001F               1838      MOVEM.W (A7)+, D0-D4
00002AB8  5279 000038F0           1839      ADD.W #1, PLAYERPOSX
00002ABE  5379 000038F2           1840      SUB.W #1, PLAYERPOSY
00002AC4  4E75                    1841      RTS
00002AC6                          1842  MAP1NOLIMIT3
00002AC6                          1843      ;CHECK FOR BOTTOM-LEFT WALL 
00002AC6  B07C 0120               1844      CMP #288, D0  ; BGT = 352 > D0
00002ACA  6E00 0026               1845      BGT MAP1NOLIMIT4    
00002ACE  B07C 0000               1846      CMP #0, D0
00002AD2  6D00 001E               1847      BLT MAP1NOLIMIT4
00002AD6                          1848      ;NOW WE CHECK POS Y 
00002AD6  B27C 01E0               1849      CMP #480, D1  ; 
00002ADA  6E00 0016               1850      BGT MAP1NOLIMIT4    
00002ADE  B27C 0180               1851      CMP #384, D1
00002AE2  6D00 000E               1852      BLT MAP1NOLIMIT4
00002AE6                          1853      ;;;; AQUI PISA EL LIMITE
00002AE6  4C9F 001F               1854      MOVEM.W (A7)+, D0-D4
00002AEA  5379 000038F2           1855      SUB.W #1, PLAYERPOSY
00002AF0  4E75                    1856      RTS
00002AF2                          1857  MAP1NOLIMIT4 
00002AF2                          1858      ;CHECK FOR BOTTOM-LEFT WALL 
00002AF2  B07C 0060               1859      CMP #96, D0  ; BGT = 352 > D0
00002AF6  6E00 0026               1860      BGT MAP1NOLIMITEND    
00002AFA  B07C 0000               1861      CMP #0, D0
00002AFE  6D00 001E               1862      BLT MAP1NOLIMITEND
00002B02                          1863      ;NOW WE CHECK POS Y 
00002B02  B27C 0280               1864      CMP #640, D1  ; 
00002B06  6E00 0016               1865      BGT MAP1NOLIMITEND    
00002B0A  B27C 0000               1866      CMP #0, D1
00002B0E  6D00 000E               1867      BLT MAP1NOLIMITEND
00002B12                          1868      ;;;; AQUI PISA EL LIMITE
00002B12  4C9F 001F               1869      MOVEM.W (A7)+, D0-D4
00002B16  5279 000038F0           1870      ADD.W #1, PLAYERPOSX
00002B1C  4E75                    1871      RTS
00002B1E                          1872  MAP1NOLIMITEND
00002B1E  4C9F 001F               1873      MOVEM.W (A7)+, D0-D4
00002B22  4EF9 00003474           1874      JMP NOLIMIT
00002B28                          1875      
00002B28                          1876  LIMAPA2
00002B28  301F                    1877      MOVE.W (A7)+, D0
00002B2A  48A7 F800               1878      MOVEM.W D0-D4, -(A7)
00002B2E  3039 000038F0           1879      MOVE.W PLAYERPOSX, D0
00002B34  3239 000038F2           1880      MOVE.W PLAYERPOSY, D1
00002B3A                          1881      ;CHECK FOR TOP-LEFT WALL 
00002B3A  B07C 0120               1882      CMP #288, D0  ; BGT = 352 > D0
00002B3E  6E00 002C               1883      BGT MAP2NOLIMIT1    
00002B42  B07C 0000               1884      CMP #0, D0
00002B46  6D00 0024               1885      BLT MAP2NOLIMIT1
00002B4A                          1886      ;NOW WE CHECK POS Y 
00002B4A  B27C 0060               1887      CMP #96, D1  ; 
00002B4E  6E00 001C               1888      BGT MAP2NOLIMIT1    
00002B52  B27C 0000               1889      CMP #0, D1
00002B56  6D00 0014               1890      BLT MAP2NOLIMIT1
00002B5A                          1891      ;;;; AQUI PISA EL LIMITE
00002B5A  4C9F 001F               1892      MOVEM.W (A7)+, D0-D4
00002B5E  5279 000038F2           1893      ADD.W #1, PLAYERPOSY
00002B64  5279 000038F0           1894      ADD.W #1, PLAYERPOSX
00002B6A  4E75                    1895      RTS
00002B6C                          1896  MAP2NOLIMIT1
00002B6C                          1897      ;CHECK FOR LEFT-UPPER-DOOR WALL
00002B6C  B07C 00C0               1898      CMP #192, D0  ; BGT = 352 > D0
00002B70  6E00 002C               1899      BGT MAP2NOLIMIT2    
00002B74  B07C 0000               1900      CMP #0, D0
00002B78  6D00 0024               1901      BLT MAP2NOLIMIT2
00002B7C                          1902      ;NOW WE CHECK POS Y 
00002B7C  B27C 009F               1903      CMP #159, D1  ; 
00002B80  6E00 001C               1904      BGT MAP2NOLIMIT2    
00002B84  B27C 0000               1905      CMP #0, D1
00002B88  6D00 0014               1906      BLT MAP2NOLIMIT2
00002B8C                          1907      ;;;; AQUI PISA EL LIMITE
00002B8C  4C9F 001F               1908      MOVEM.W (A7)+, D0-D4
00002B90  5279 000038F0           1909      ADD.W #1, PLAYERPOSX
00002B96  5279 000038F2           1910      ADD.W #1, PLAYERPOSY
00002B9C  4E75                    1911      RTS
00002B9E                          1912  MAP2NOLIMIT2
00002B9E                          1913      ;CHECK FOR LEFT-BOTTOM-DOOR WALL
00002B9E  B07C 00C0               1914      CMP #192, D0  ; BGT = 352 > D0
00002BA2  6E00 002C               1915      BGT MAP2NOLIMIT3    
00002BA6  B07C 0000               1916      CMP #0, D0
00002BAA  6D00 0024               1917      BLT MAP2NOLIMIT3
00002BAE                          1918      ;NOW WE CHECK POS Y 
00002BAE  B27C 01E0               1919      CMP #480, D1  ; 
00002BB2  6E00 001C               1920      BGT MAP2NOLIMIT3    
00002BB6  B27C 00A2               1921      CMP #162, D1
00002BBA  6D00 0014               1922      BLT MAP2NOLIMIT3
00002BBE                          1923      ;;;; AQUI PISA EL LIMITE
00002BBE  4C9F 001F               1924      MOVEM.W (A7)+, D0-D4
00002BC2  5279 000038F0           1925      ADD.W #1, PLAYERPOSX
00002BC8  5379 000038F2           1926      SUB.W #1, PLAYERPOSY
00002BCE  4E75                    1927      RTS
00002BD0                          1928  MAP2NOLIMIT3
00002BD0                          1929      ;CHECK FOR LEFT CORNER
00002BD0  B07C 00E0               1930      CMP #224, D0  ; BGT = 352 > D0
00002BD4  6E00 002C               1931      BGT MAP2NOLIMIT4    
00002BD8  B07C 0000               1932      CMP #0, D0
00002BDC  6D00 0024               1933      BLT MAP2NOLIMIT4
00002BE0                          1934      ;NOW WE CHECK POS Y 
00002BE0  B27C 01E0               1935      CMP #480, D1  ; 
00002BE4  6E00 001C               1936      BGT MAP2NOLIMIT4    
00002BE8  B27C 0100               1937      CMP #256, D1
00002BEC  6D00 0014               1938      BLT MAP2NOLIMIT4
00002BF0                          1939      ;;;; AQUI PISA EL LIMITE
00002BF0  4C9F 001F               1940      MOVEM.W (A7)+, D0-D4
00002BF4  5279 000038F0           1941      ADD.W #1, PLAYERPOSX
00002BFA  5379 000038F2           1942      SUB.W #1, PLAYERPOSY
00002C00  4E75                    1943      RTS
00002C02                          1944  MAP2NOLIMIT4
00002C02                          1945      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002C02  B07C 0120               1946      CMP #288, D0  ; BGT = 352 > D0
00002C06  6E00 002C               1947      BGT MAP2NOLIMIT5    
00002C0A  B07C 00E0               1948      CMP #224, D0
00002C0E  6D00 0024               1949      BLT MAP2NOLIMIT5
00002C12                          1950      ;NOW WE CHECK POS Y 
00002C12  B27C 01E0               1951      CMP #480, D1  ; 
00002C16  6E00 001C               1952      BGT MAP2NOLIMIT5    
00002C1A  B27C 0120               1953      CMP #288, D1
00002C1E  6D00 0014               1954      BLT MAP2NOLIMIT5
00002C22                          1955      ;;;; AQUI PISA EL LIMITE
00002C22  4C9F 001F               1956      MOVEM.W (A7)+, D0-D4
00002C26  5279 000038F0           1957      ADD.W #1, PLAYERPOSX
00002C2C  5379 000038F2           1958      SUB.W #1, PLAYERPOSY
00002C32  4E75                    1959      RTS
00002C34                          1960  MAP2NOLIMIT5
00002C34                          1961      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002C34  B07C 0280               1962      CMP #640, D0  ; BGT = 352 > D0
00002C38  6E00 002C               1963      BGT MAP2NOLIMIT6    
00002C3C  B07C 0140               1964      CMP #320, D0
00002C40  6D00 0024               1965      BLT MAP2NOLIMIT6
00002C44                          1966      ;NOW WE CHECK POS Y 
00002C44  B27C 01E0               1967      CMP #480, D1  ; 
00002C48  6E00 001C               1968      BGT MAP2NOLIMIT6    
00002C4C  B27C 0120               1969      CMP #288, D1
00002C50  6D00 0014               1970      BLT MAP2NOLIMIT6
00002C54                          1971      ;;;; AQUI PISA EL LIMITE
00002C54  4C9F 001F               1972      MOVEM.W (A7)+, D0-D4
00002C58  5379 000038F0           1973      SUB.W #1, PLAYERPOSX
00002C5E  5379 000038F2           1974      SUB.W #1, PLAYERPOSY
00002C64  4E75                    1975      RTS
00002C66                          1976  MAP2NOLIMIT6
00002C66                          1977  ;CHECK FOR RIGHT CORNER
00002C66  B07C 0280               1978      CMP #640, D0  ; BGT = 352 > D0
00002C6A  6E00 002C               1979      BGT MAP2NOLIMIT7    
00002C6E  B07C 0180               1980      CMP #384, D0
00002C72  6D00 0024               1981      BLT MAP2NOLIMIT7
00002C76                          1982      ;NOW WE CHECK POS Y 
00002C76  B27C 01E0               1983      CMP #480, D1  ; 
00002C7A  6E00 001C               1984      BGT MAP2NOLIMIT7    
00002C7E  B27C 0100               1985      CMP #256, D1
00002C82  6D00 0014               1986      BLT MAP2NOLIMIT7
00002C86                          1987      ;;;; AQUI PISA EL LIMITE
00002C86  4C9F 001F               1988      MOVEM.W (A7)+, D0-D4
00002C8A  5379 000038F0           1989      SUB.W #1, PLAYERPOSX
00002C90  5379 000038F2           1990      SUB.W #1, PLAYERPOSY
00002C96  4E75                    1991      RTS
00002C98                          1992  MAP2NOLIMIT7
00002C98                          1993      ;CHECK FOR RIGHT-BOTTOM-DOOR WALL
00002C98  B07C 0280               1994      CMP #640, D0  ; BGT = 352 > D0
00002C9C  6E00 002C               1995      BGT MAP2NOLIMIT8    
00002CA0  B07C 01A0               1996      CMP #416, D0
00002CA4  6D00 0024               1997      BLT MAP2NOLIMIT8
00002CA8                          1998      ;NOW WE CHECK POS Y 
00002CA8  B27C 01E0               1999      CMP #480, D1  ; 
00002CAC  6E00 001C               2000      BGT MAP2NOLIMIT8    
00002CB0  B27C 00A2               2001      CMP #162, D1
00002CB4  6D00 0014               2002      BLT MAP2NOLIMIT8
00002CB8                          2003      ;;;; AQUI PISA EL LIMITE
00002CB8  4C9F 001F               2004      MOVEM.W (A7)+, D0-D4
00002CBC  5379 000038F0           2005      SUB.W #1, PLAYERPOSX
00002CC2  5379 000038F2           2006      SUB.W #1, PLAYERPOSY
00002CC8  4E75                    2007      RTS
00002CCA                          2008  MAP2NOLIMIT8
00002CCA                          2009  ;CHECK FOR RIGHT-TOP-DOOR WALL
00002CCA  B07C 0280               2010      CMP #640, D0  ; BGT = 352 > D0
00002CCE  6E00 002C               2011      BGT MAP2NOLIMIT9    
00002CD2  B07C 01A0               2012      CMP #416, D0
00002CD6  6D00 0024               2013      BLT MAP2NOLIMIT9
00002CDA                          2014      ;NOW WE CHECK POS Y 
00002CDA  B27C 00A0               2015      CMP #160, D1  ; 
00002CDE  6E00 001C               2016      BGT MAP2NOLIMIT9    
00002CE2  B27C 0000               2017      CMP #0, D1
00002CE6  6D00 0014               2018      BLT MAP2NOLIMIT9
00002CEA                          2019      ;;;; AQUI PISA EL LIMITE
00002CEA  4C9F 001F               2020      MOVEM.W (A7)+, D0-D4
00002CEE  5379 000038F0           2021      SUB.W #1, PLAYERPOSX
00002CF4  5279 000038F2           2022      ADD.W #1, PLAYERPOSY
00002CFA  4E75                    2023      RTS
00002CFC                          2024  MAP2NOLIMIT9
00002CFC                          2025      ;CHECK FOR TOP RIGHT CORNER
00002CFC  B07C 0280               2026      CMP #640, D0  ; BGT = 352 > D0
00002D00  6E00 002C               2027      BGT MAP2NOLIMIT10    
00002D04  B07C 0140               2028      CMP #320, D0
00002D08  6D00 0024               2029      BLT MAP2NOLIMIT10
00002D0C                          2030      ;NOW WE CHECK POS Y 
00002D0C  B27C 0060               2031      CMP #96, D1  ; 
00002D10  6E00 001C               2032      BGT MAP2NOLIMIT10   
00002D14  B27C 0000               2033      CMP #0, D1
00002D18  6D00 0014               2034      BLT MAP2NOLIMIT10
00002D1C                          2035      ;;;; AQUI PISA EL LIMITE
00002D1C  4C9F 001F               2036      MOVEM.W (A7)+, D0-D4
00002D20  5379 000038F0           2037      SUB.W #1, PLAYERPOSX
00002D26  5279 000038F2           2038      ADD.W #1, PLAYERPOSY
00002D2C  4E75                    2039      RTS
00002D2E                          2040  MAP2NOLIMIT10
00002D2E  4C9F 001F               2041      MOVEM.W (A7)+, D0-D4
00002D32  4EF9 00003474           2042      JMP NOLIMIT
00002D38                          2043  LIMAPA3
00002D38  301F                    2044      MOVE.W (A7)+, D0
00002D3A  48A7 F800               2045      MOVEM.W D0-D4, -(A7)
00002D3E  3039 000038F0           2046      MOVE.W PLAYERPOSX, D0
00002D44  3239 000038F2           2047      MOVE.W PLAYERPOSY, D1
00002D4A                          2048      ;CHECK FOR TOP-LEFT WALL 
00002D4A  B07C 0120               2049      CMP #288, D0  ; BGT = 352 > D0
00002D4E  6E00 0026               2050      BGT MAP3NOLIMIT1    
00002D52  B07C 0000               2051      CMP #0, D0
00002D56  6D00 001E               2052      BLT MAP3NOLIMIT1
00002D5A                          2053      ;NOW WE CHECK POS Y 
00002D5A  B27C 0020               2054      CMP #32, D1  ; 
00002D5E  6E00 0016               2055      BGT MAP3NOLIMIT1    
00002D62  B27C 0000               2056      CMP #0, D1
00002D66  6D00 000E               2057      BLT MAP3NOLIMIT1
00002D6A                          2058      ;;;; AQUI PISA EL LIMITE
00002D6A  5279 000038F2           2059      ADD.W #1, PLAYERPOSY
00002D70  4C9F 001F               2060      MOVEM.W (A7)+, D0-D4
00002D74  4E75                    2061      RTS
00002D76                          2062  MAP3NOLIMIT1
00002D76                          2063      ;CHECK FOR LEFT WALL
00002D76  B07C 0020               2064      CMP #32, D0  ; BGT = 352 > D0
00002D7A  6E00 0026               2065      BGT MAP3NOLIMIT2    
00002D7E  B07C 0000               2066      CMP #0, D0
00002D82  6D00 001E               2067      BLT MAP3NOLIMIT2
00002D86                          2068      ;NOW WE CHECK POS Y 
00002D86  B27C 01E0               2069      CMP #480, D1  ; 
00002D8A  6E00 0016               2070      BGT MAP3NOLIMIT2    
00002D8E  B27C 0000               2071      CMP #0, D1
00002D92  6D00 000E               2072      BLT MAP3NOLIMIT2
00002D96                          2073      ;;;; AQUI PISA EL LIMITE
00002D96  5279 000038F0           2074      ADD.W #1, PLAYERPOSX
00002D9C  4C9F 001F               2075      MOVEM.W (A7)+, D0-D4
00002DA0  4E75                    2076      RTS
00002DA2                          2077  MAP3NOLIMIT2
00002DA2                          2078      ;CHECK FOR BOTTOM WALL
00002DA2  B07C 0280               2079      CMP #640, D0  ; BGT = 352 > D0
00002DA6  6E00 0026               2080      BGT MAP3NOLIMIT3    
00002DAA  B07C 0000               2081      CMP #0, D0
00002DAE  6D00 001E               2082      BLT MAP3NOLIMIT3
00002DB2                          2083      ;NOW WE CHECK POS Y 
00002DB2  B27C 01E0               2084      CMP #480, D1  ; 
00002DB6  6E00 0016               2085      BGT MAP3NOLIMIT3    
00002DBA  B27C 01A0               2086      CMP #416, D1
00002DBE  6D00 000E               2087      BLT MAP3NOLIMIT3
00002DC2                          2088      ;;;; AQUI PISA EL LIMITE
00002DC2  5379 000038F2           2089      SUB.W #1, PLAYERPOSY
00002DC8  4C9F 001F               2090      MOVEM.W (A7)+, D0-D4
00002DCC  4E75                    2091      RTS
00002DCE                          2092  MAP3NOLIMIT3
00002DCE                          2093      ;CHECK FOR RIGHT WALL
00002DCE  B07C 0280               2094      CMP #640, D0  ; BGT = 352 > D0
00002DD2  6E00 0026               2095      BGT MAP3NOLIMIT4    
00002DD6  B07C 0240               2096      CMP #576, D0
00002DDA  6D00 001E               2097      BLT MAP3NOLIMIT4
00002DDE                          2098      ;NOW WE CHECK POS Y 
00002DDE  B27C 01E0               2099      CMP #480, D1  ; 
00002DE2  6E00 0016               2100      BGT MAP3NOLIMIT4    
00002DE6  B27C 0000               2101      CMP #0, D1
00002DEA  6D00 000E               2102      BLT MAP3NOLIMIT4
00002DEE                          2103      ;;;; AQUI PISA EL LIMITE
00002DEE  5379 000038F0           2104      SUB.W #1, PLAYERPOSX
00002DF4  4C9F 001F               2105      MOVEM.W (A7)+, D0-D4
00002DF8  4E75                    2106      RTS
00002DFA                          2107  MAP3NOLIMIT4
00002DFA                          2108      ;CHECK TOP-RIGHT WALL
00002DFA  B07C 0280               2109      CMP #640, D0  ; BGT = 352 > D0
00002DFE  6E00 0026               2110      BGT MAP3NOLIMIT5    
00002E02  B07C 0160               2111      CMP #352, D0
00002E06  6D00 001E               2112      BLT MAP3NOLIMIT5
00002E0A                          2113      ;NOW WE CHECK POS Y 
00002E0A  B27C 0020               2114      CMP #32, D1  ; 
00002E0E  6E00 0016               2115      BGT MAP3NOLIMIT5    
00002E12  B27C 0000               2116      CMP #0, D1
00002E16  6D00 000E               2117      BLT MAP3NOLIMIT5
00002E1A                          2118      ;;;; AQUI PISA EL LIMITE
00002E1A  5279 000038F2           2119      ADD.W #1, PLAYERPOSY
00002E20  4C9F 001F               2120      MOVEM.W (A7)+, D0-D4
00002E24  4E75                    2121      RTS
00002E26                          2122  MAP3NOLIMIT5
00002E26  4C9F 001F               2123      MOVEM.W (A7)+, D0-D4
00002E2A  4EF9 00003474           2124      JMP NOLIMIT
00002E30                          2125      
00002E30                          2126  LIMAPA4
00002E30  301F                    2127      MOVE.W (A7)+, D0
00002E32  48A7 F800               2128      MOVEM.W D0-D4, -(A7)
00002E36  3039 000038F0           2129      MOVE.W PLAYERPOSX, D0
00002E3C  3239 000038F2           2130      MOVE.W PLAYERPOSY, D1
00002E42                          2131      ;CHECK FOR WALLS IN HEAVEN ROOM 4
00002E42                          2132      ;CHECK UPPER LEFT WALL 
00002E42  B07C 0120               2133      CMP #288, D0  ; BGT = 352 > D0
00002E46  6E00 0026               2134      BGT MAP4NOLIMIT1   
00002E4A  B07C 0000               2135      CMP #0, D0
00002E4E  6D00 001E               2136      BLT MAP4NOLIMIT1
00002E52                          2137      ;NOW WE CHECK POS Y 
00002E52  B27C 00A0               2138      CMP #160, D1  ; 
00002E56  6E00 0016               2139      BGT MAP4NOLIMIT1    
00002E5A  B27C 0000               2140      CMP #0, D1
00002E5E  6D00 000E               2141      BLT MAP4NOLIMIT1
00002E62                          2142      ;;;; AQUI PISA EL LIMITE
00002E62  4C9F 001F               2143      MOVEM.W (A7)+, D0-D4
00002E66  5279 000038F2           2144      ADD.W #1, PLAYERPOSY
00002E6C  4E75                    2145      RTS
00002E6E                          2146  MAP4NOLIMIT1
00002E6E                          2147      ;CHECK BOTTOM WALL
00002E6E  B07C 0280               2148      CMP #640, D0  ; BGT = 352 > D0
00002E72  6E00 0026               2149      BGT MAP4NOLIMIT2   
00002E76  B07C 0000               2150      CMP #0, D0
00002E7A  6D00 001E               2151      BLT MAP4NOLIMIT2
00002E7E                          2152      ;NOW WE CHECK POS Y 
00002E7E  B27C 01E0               2153      CMP #480, D1  ; 
00002E82  6E00 0016               2154      BGT MAP4NOLIMIT2    
00002E86  B27C 0120               2155      CMP #288, D1
00002E8A  6D00 000E               2156      BLT MAP4NOLIMIT2
00002E8E                          2157      ;;;; AQUI PISA EL LIMITE
00002E8E  4C9F 001F               2158      MOVEM.W (A7)+, D0-D4
00002E92  5379 000038F2           2159      SUB.W #1, PLAYERPOSY
00002E98  4E75                    2160      RTS
00002E9A                          2161  MAP4NOLIMIT2
00002E9A                          2162      ;CHECK LEFT WALL
00002E9A  B07C 00C0               2163      CMP #192, D0  ; BGT = 352 > D0
00002E9E  6E00 0026               2164      BGT MAP4NOLIMIT3   
00002EA2  B07C 0000               2165      CMP #0, D0
00002EA6  6D00 001E               2166      BLT MAP4NOLIMIT3
00002EAA                          2167      ;NOW WE CHECK POS Y 
00002EAA  B27C 01E0               2168      CMP #480, D1  ; 
00002EAE  6E00 0016               2169      BGT MAP4NOLIMIT3    
00002EB2  B27C 0000               2170      CMP #0, D1
00002EB6  6D00 000E               2171      BLT MAP4NOLIMIT3
00002EBA                          2172      ;;;; AQUI PISA EL LIMITE
00002EBA  4C9F 001F               2173      MOVEM.W (A7)+, D0-D4
00002EBE  5279 000038F0           2174      ADD.W #1, PLAYERPOSX
00002EC4  4E75                    2175      RTS
00002EC6                          2176  MAP4NOLIMIT3
00002EC6                          2177      ;CHECK RIGHT WALL
00002EC6  B07C 0280               2178      CMP #640, D0  ; BGT = 352 > D0
00002ECA  6E00 0026               2179      BGT MAP4NOLIMIT4   
00002ECE  B07C 01A0               2180      CMP #416, D0
00002ED2  6D00 001E               2181      BLT MAP4NOLIMIT4
00002ED6                          2182      ;NOW WE CHECK POS Y 
00002ED6  B27C 01E0               2183      CMP #480, D1  ; 
00002EDA  6E00 0016               2184      BGT MAP4NOLIMIT4    
00002EDE  B27C 0000               2185      CMP #0, D1
00002EE2  6D00 000E               2186      BLT MAP4NOLIMIT4
00002EE6                          2187      ;;;; AQUI PISA EL LIMITE
00002EE6  4C9F 001F               2188      MOVEM.W (A7)+, D0-D4
00002EEA  5379 000038F0           2189      SUB.W #1, PLAYERPOSX
00002EF0  4E75                    2190      RTS
00002EF2                          2191  MAP4NOLIMIT4
00002EF2                          2192  ;CHECK TOP RIGHT WALL
00002EF2  B07C 0280               2193      CMP #640, D0  ; BGT = 352 > D0
00002EF6  6E00 0026               2194      BGT MAP4NOLIMIT5   
00002EFA  B07C 0160               2195      CMP #352, D0
00002EFE  6D00 001E               2196      BLT MAP4NOLIMIT5
00002F02                          2197      ;NOW WE CHECK POS Y 
00002F02  B27C 00A0               2198      CMP #160, D1  ; 
00002F06  6E00 0016               2199      BGT MAP4NOLIMIT5    
00002F0A  B27C 0000               2200      CMP #0, D1
00002F0E  6D00 000E               2201      BLT MAP4NOLIMIT5
00002F12                          2202      ;;;; AQUI PISA EL LIMITE
00002F12  4C9F 001F               2203      MOVEM.W (A7)+, D0-D4
00002F16  5279 000038F2           2204      ADD.W #1, PLAYERPOSY
00002F1C  4E75                    2205      RTS
00002F1E                          2206  MAP4NOLIMIT5
00002F1E  4C9F 001F               2207      MOVEM.W (A7)+, D0-D4
00002F22  4EF9 00003474           2208      JMP NOLIMIT
00002F28                          2209  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;END HEAVEN MAPS
00002F28                          2210  LIMAPA5
00002F28  301F                    2211      MOVE.W (A7)+, D0
00002F2A  48A7 F800               2212      MOVEM.W D0-D4, -(A7)
00002F2E  3039 000038F0           2213      MOVE.W PLAYERPOSX, D0
00002F34  3239 000038F2           2214      MOVE.W PLAYERPOSY, D1
00002F3A                          2215      ;CHECK FOR WALLS IN MAP 5
00002F3A                          2216      ;CHECK UPPER WALL 
00002F3A  B07C 0280               2217      CMP #640, D0  ; BGT = 352 > D0
00002F3E  6E00 0026               2218      BGT MAP5NOLIMIT1   
00002F42  B07C 0000               2219      CMP #0, D0
00002F46  6D00 001E               2220      BLT MAP5NOLIMIT1
00002F4A                          2221      ;NOW WE CHECK POS Y 
00002F4A  B27C 0020               2222      CMP #32, D1  ; 
00002F4E  6E00 0016               2223      BGT MAP5NOLIMIT1    
00002F52  B27C 0000               2224      CMP #0, D1
00002F56  6D00 000E               2225      BLT MAP5NOLIMIT1
00002F5A                          2226      ;;;; AQUI PISA EL LIMITE
00002F5A  4C9F 001F               2227      MOVEM.W (A7)+, D0-D4
00002F5E  5279 000038F2           2228      ADD.W #1, PLAYERPOSY
00002F64  4E75                    2229      RTS
00002F66                          2230  MAP5NOLIMIT1
00002F66                          2231      ;CHECK FOR RIGHT WALL 
00002F66  B07C 0280               2232      CMP #640, D0  ; BGT = 352 > D0
00002F6A  6E00 0026               2233      BGT MAP5NOLIMIT2    
00002F6E  B07C 0240               2234      CMP #576, D0
00002F72  6D00 001E               2235      BLT MAP5NOLIMIT2
00002F76                          2236      ;NOW WE CHECK POS Y 
00002F76  B27C 01E0               2237      CMP #480, D1  ; 
00002F7A  6E00 0016               2238      BGT MAP5NOLIMIT2    
00002F7E  B27C 0000               2239      CMP #0, D1
00002F82  6D00 000E               2240      BLT MAP5NOLIMIT2
00002F86                          2241      ;;;; AQUI PISA EL LIMITE
00002F86  5379 000038F0           2242      SUB.W #1, PLAYERPOSX
00002F8C  4C9F 001F               2243      MOVEM.W (A7)+, D0-D4
00002F90  4E75                    2244      RTS
00002F92                          2245  MAP5NOLIMIT2
00002F92                          2246      ;CHECK LEFT WALL
00002F92  B07C 0020               2247          CMP #32, D0  ; BGT = 352 > D0
00002F96  6E00 0026               2248      BGT MAP5NOLIMIT3    
00002F9A  B07C 0000               2249      CMP #0, D0
00002F9E  6D00 001E               2250      BLT MAP5NOLIMIT3
00002FA2                          2251      ;NOW WE CHECK POS Y 
00002FA2  B27C 01E0               2252      CMP #480, D1  ; 
00002FA6  6E00 0016               2253      BGT MAP5NOLIMIT3    
00002FAA  B27C 0000               2254      CMP #0, D1
00002FAE  6D00 000E               2255      BLT MAP5NOLIMIT3
00002FB2                          2256      ;;;; AQUI PISA EL LIMITE
00002FB2  5279 000038F0           2257      ADD.W #1, PLAYERPOSX
00002FB8  4C9F 001F               2258      MOVEM.W (A7)+, D0-D4
00002FBC  4E75                    2259      RTS
00002FBE                          2260  MAP5NOLIMIT3
00002FBE                          2261      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00002FBE  B07C 0120               2262      CMP #288, D0  ; BGT = 352 > D0
00002FC2  6E00 0026               2263      BGT MAP5NOLIMIT4    
00002FC6  B07C 0000               2264      CMP #0, D0
00002FCA  6D00 001E               2265      BLT MAP5NOLIMIT4
00002FCE                          2266      ;NOW WE CHECK POS Y 
00002FCE  B27C 01E0               2267      CMP #480, D1  ; 
00002FD2  6E00 0016               2268      BGT MAP5NOLIMIT4    
00002FD6  B27C 01A0               2269      CMP #416, D1
00002FDA  6D00 000E               2270      BLT MAP5NOLIMIT4
00002FDE                          2271      ;;;; AQUI PISA EL LIMITE
00002FDE  4C9F 001F               2272      MOVEM.W (A7)+, D0-D4
00002FE2  5379 000038F2           2273      SUB.W #1, PLAYERPOSY
00002FE8  4E75                    2274      RTS
00002FEA                          2275  MAP5NOLIMIT4
00002FEA                          2276      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00002FEA  B07C 0280               2277      CMP #640, D0  ; BGT = 352 > D0
00002FEE  6E00 0026               2278      BGT MAP5NOLIMIT5    
00002FF2  B07C 0140               2279      CMP #320, D0
00002FF6  6D00 001E               2280      BLT MAP5NOLIMIT5
00002FFA                          2281      ;NOW WE CHECK POS Y 
00002FFA  B27C 01E0               2282      CMP #480, D1  ; 
00002FFE  6E00 0016               2283      BGT MAP5NOLIMIT5    
00003002  B27C 01A0               2284      CMP #416, D1
00003006  6D00 000E               2285      BLT MAP5NOLIMIT5
0000300A                          2286      ;;;; AQUI PISA EL LIMITE
0000300A  4C9F 001F               2287      MOVEM.W (A7)+, D0-D4
0000300E  5379 000038F2           2288      SUB.W #1, PLAYERPOSY
00003014  4E75                    2289      RTS
00003016                          2290  MAP5NOLIMIT5
00003016                          2291      ;CHECK FOR MIDDLE-LEFT WALL 1
00003016  B07C 0120               2292      CMP #288, D0  ; BGT = 352 > D0
0000301A  6E00 0026               2293      BGT MAP5NOLIMIT6    
0000301E  B07C 0000               2294      CMP #0, D0
00003022  6D00 001E               2295      BLT MAP5NOLIMIT6
00003026                          2296      ;NOW WE CHECK POS Y 
00003026  B27C 00F0               2297      CMP #240, D1  ; 
0000302A  6E00 0016               2298      BGT MAP5NOLIMIT6    
0000302E  B27C 00C0               2299      CMP #192, D1 ;224
00003032  6D00 000E               2300      BLT MAP5NOLIMIT6
00003036                          2301      ;;;; AQUI PISA EL LIMITE
00003036  4C9F 001F               2302      MOVEM.W (A7)+, D0-D4
0000303A  5379 000038F2           2303      SUB.W #1, PLAYERPOSY
00003040  4E75                    2304      RTS
00003042                          2305  MAP5NOLIMIT6
00003042                          2306      ;CHECK FOR MIDDLE-RIGHT WALL 1
00003042  B07C 0280               2307      CMP #640, D0  ; BGT = 352 > D0
00003046  6E00 0026               2308      BGT MAP5NOLIMIT7    
0000304A  B07C 0140               2309      CMP #320 , D0
0000304E  6D00 001E               2310      BLT MAP5NOLIMIT7
00003052                          2311      ;NOW WE CHECK POS Y 
00003052  B27C 00F0               2312      CMP #240, D1  ; 
00003056  6E00 0016               2313      BGT MAP5NOLIMIT7    
0000305A  B27C 00C0               2314      CMP #192, D1 ;224
0000305E  6D00 000E               2315      BLT MAP5NOLIMIT7
00003062                          2316      ;;;; AQUI PISA EL LIMITE
00003062  4C9F 001F               2317      MOVEM.W (A7)+, D0-D4
00003066  5379 000038F2           2318      SUB.W #1, PLAYERPOSY
0000306C  4E75                    2319      RTS
0000306E                          2320  MAP5NOLIMIT7
0000306E                          2321      ;CHECK FOR MIDDLE-RIGHT WALL 2
0000306E  B07C 0280               2322      CMP #640, D0  ; BGT = 352 > D0
00003072  6E00 0026               2323      BGT MAP5NOLIMIT8    
00003076  B07C 0140               2324      CMP #320 , D0
0000307A  6D00 001E               2325      BLT MAP5NOLIMIT8
0000307E                          2326      ;NOW WE CHECK POS Y 
0000307E  B27C 0100               2327      CMP #256, D1  ; 
00003082  6E00 0016               2328      BGT MAP5NOLIMIT8    
00003086  B27C 00F0               2329      CMP #240, D1 ;192
0000308A  6D00 000E               2330      BLT MAP5NOLIMIT8
0000308E                          2331      ;;;; AQUI PISA EL LIMITE
0000308E  4C9F 001F               2332      MOVEM.W (A7)+, D0-D4
00003092  5279 000038F2           2333      ADD.W #1, PLAYERPOSY
00003098  4E75                    2334      RTS
0000309A                          2335  MAP5NOLIMIT8
0000309A                          2336      ;CHECK FOR MIDDLE-LEFT WALL 2
0000309A  B07C 0120               2337      CMP #288, D0  ; BGT = 352 > D0
0000309E  6E00 0026               2338      BGT MAP5NOLIMIT9    
000030A2  B07C 0000               2339      CMP #0, D0
000030A6  6D00 001E               2340      BLT MAP5NOLIMIT9
000030AA                          2341      ;NOW WE CHECK POS Y 
000030AA  B27C 0100               2342      CMP #256, D1  ; 
000030AE  6E00 0016               2343      BGT MAP5NOLIMIT9    
000030B2  B27C 00F0               2344      CMP #240, D1 ;224
000030B6  6D00 000E               2345      BLT MAP5NOLIMIT9
000030BA                          2346      ;;;; AQUI PISA EL LIMITE
000030BA  4C9F 001F               2347      MOVEM.W (A7)+, D0-D4
000030BE  5279 000038F2           2348      ADD.W #1, PLAYERPOSY
000030C4  4E75                    2349      RTS
000030C6                          2350  MAP5NOLIMIT9
000030C6  4C9F 001F               2351      MOVEM.W (A7)+, D0-D4
000030CA  4EF9 00003474           2352      JMP NOLIMIT
000030D0                          2353  
000030D0                          2354      
000030D0                          2355  LIMAPA6
000030D0  301F                    2356      MOVE.W (A7)+, D0
000030D2  48A7 F800               2357      MOVEM.W D0-D4, -(A7)
000030D6  3039 000038F0           2358      MOVE.W PLAYERPOSX, D0
000030DC  3239 000038F2           2359      MOVE.W PLAYERPOSY, D1
000030E2                          2360      ;CHECK FOR WALLS IN MAP 5
000030E2                          2361      ;CHECK LEFT UPPER WALL 
000030E2  B07C 0120               2362      CMP #288, D0  ; BGT = 352 > D0
000030E6  6E00 0026               2363      BGT MAP6NOLIMIT1   
000030EA  B07C 0000               2364      CMP #0, D0
000030EE  6D00 001E               2365      BLT MAP6NOLIMIT1
000030F2                          2366      ;NOW WE CHECK POS Y 
000030F2  B27C 0020               2367      CMP #32, D1  ; 
000030F6  6E00 0016               2368      BGT MAP6NOLIMIT1    
000030FA  B27C 0000               2369      CMP #0, D1
000030FE  6D00 000E               2370      BLT MAP6NOLIMIT1
00003102                          2371      ;;;; AQUI PISA EL LIMITE
00003102  4C9F 001F               2372      MOVEM.W (A7)+, D0-D4
00003106  5279 000038F2           2373      ADD.W #1, PLAYERPOSY
0000310C  4E75                    2374      RTS
0000310E                          2375  MAP6NOLIMIT1
0000310E                          2376      ;CHECK LEFT WALL
0000310E  B07C 0020               2377      CMP #32, D0  ; BGT = 352 > D0
00003112  6E00 0026               2378      BGT MAP6NOLIMIT2    
00003116  B07C 0000               2379      CMP #0, D0
0000311A  6D00 001E               2380      BLT MAP6NOLIMIT2
0000311E                          2381      ;NOW WE CHECK POS Y 
0000311E  B27C 01E0               2382      CMP #480, D1  ; 
00003122  6E00 0016               2383      BGT MAP6NOLIMIT2    
00003126  B27C 0000               2384      CMP #0, D1
0000312A  6D00 000E               2385      BLT MAP6NOLIMIT2
0000312E                          2386      ;;;; AQUI PISA EL LIMITE
0000312E  5279 000038F0           2387      ADD.W #1, PLAYERPOSX
00003134  4C9F 001F               2388      MOVEM.W (A7)+, D0-D4
00003138  4E75                    2389      RTS
0000313A                          2390  MAP6NOLIMIT2
0000313A                          2391      ;CHECK FOR RIGHT WALL 
0000313A  B07C 0280               2392      CMP #640, D0  ; BGT = 352 > D0
0000313E  6E00 0026               2393      BGT MAP6NOLIMIT3    
00003142  B07C 0240               2394      CMP #576, D0
00003146  6D00 001E               2395      BLT MAP6NOLIMIT3
0000314A                          2396      ;NOW WE CHECK POS Y 
0000314A  B27C 01E0               2397      CMP #480, D1  ; 
0000314E  6E00 0016               2398      BGT MAP6NOLIMIT3    
00003152  B27C 0000               2399      CMP #0, D1
00003156  6D00 000E               2400      BLT MAP6NOLIMIT3
0000315A                          2401      ;;;; AQUI PISA EL LIMITE
0000315A  5379 000038F0           2402      SUB.W #1, PLAYERPOSX
00003160  4C9F 001F               2403      MOVEM.W (A7)+, D0-D4
00003164  4E75                    2404      RTS
00003166                          2405  MAP6NOLIMIT3
00003166                          2406      ;CHECK FOR BOTTOM WALL-LEFT-CORNER
00003166  B07C 0120               2407      CMP #288, D0  ; BGT = 352 > D0
0000316A  6E00 0026               2408      BGT MAP6NOLIMIT5   
0000316E  B07C 0000               2409      CMP #0, D0
00003172  6D00 001E               2410      BLT MAP6NOLIMIT5
00003176                          2411      ;NOW WE CHECK POS Y 
00003176  B27C 01E0               2412      CMP #480, D1  ; 
0000317A  6E00 0016               2413      BGT MAP6NOLIMIT5    
0000317E  B27C 01A0               2414      CMP #416, D1
00003182  6D00 000E               2415      BLT MAP6NOLIMIT5
00003186                          2416      ;;;; AQUI PISA EL LIMITE
00003186  4C9F 001F               2417      MOVEM.W (A7)+, D0-D4
0000318A  5379 000038F2           2418      SUB.W #1, PLAYERPOSY
00003190  4E75                    2419      RTS
00003192                          2420  MAP6NOLIMIT5
00003192                          2421      ;CHECK FOR BOTTOM WALL-RIGH-CORNER
00003192  B07C 0280               2422      CMP #640, D0  ; BGT = 352 > D0
00003196  6E00 0026               2423      BGT MAP6NOLIMIT6    
0000319A  B07C 0140               2424      CMP #320, D0
0000319E  6D00 001E               2425      BLT MAP6NOLIMIT6
000031A2                          2426      ;NOW WE CHECK POS Y 
000031A2  B27C 01E0               2427      CMP #480, D1  ; 
000031A6  6E00 0016               2428      BGT MAP6NOLIMIT6    
000031AA  B27C 01A0               2429      CMP #416, D1
000031AE  6D00 000E               2430      BLT MAP6NOLIMIT6
000031B2                          2431      ;;;; AQUI PISA EL LIMITE
000031B2  4C9F 001F               2432      MOVEM.W (A7)+, D0-D4
000031B6  5379 000038F2           2433      SUB.W #1, PLAYERPOSY
000031BC  4E75                    2434      RTS
000031BE                          2435  MAP6NOLIMIT6
000031BE                          2436      ;CHECK RIGHT-RIGHT ROOM WALL
000031BE  B07C 0280               2437      CMP #640, D0  ; BGT = 352 > D0
000031C2  6E00 0026               2438      BGT MAP6NOLIMIT7    
000031C6  B07C 0222               2439      CMP #546, D0
000031CA  6D00 001E               2440      BLT MAP6NOLIMIT7
000031CE                          2441      ;NOW WE CHECK POS Y 
000031CE  B27C 01E0               2442      CMP #480, D1  ; 
000031D2  6E00 0016               2443      BGT MAP6NOLIMIT7    
000031D6  B27C 0120               2444      CMP #288, D1
000031DA  6D00 000E               2445      BLT MAP6NOLIMIT7
000031DE                          2446      ;;;; AQUI PISA EL LIMITE
000031DE  4C9F 001F               2447      MOVEM.W (A7)+, D0-D4
000031E2  5379 000038F2           2448      SUB.W #1, PLAYERPOSY
000031E8  4E75                    2449      RTS
000031EA                          2450  MAP6NOLIMIT7
000031EA                          2451      ;CHECK FOR LEFT-RIGHT ROOM WALL
000031EA  B07C 0218               2452      CMP #536, D0  ; BGT = 352 > D0
000031EE  6E00 002C               2453      BGT MAP6NOLIMIT8    
000031F2  B07C 0160               2454      CMP #352, D0
000031F6  6D00 0024               2455      BLT MAP6NOLIMIT8
000031FA                          2456      ;NOW WE CHECK POS Y 
000031FA  B27C 01E0               2457      CMP #480, D1  ; 
000031FE  6E00 001C               2458      BGT MAP6NOLIMIT8    
00003202  B27C 0120               2459      CMP #288, D1
00003206  6D00 0014               2460      BLT MAP6NOLIMIT8
0000320A                          2461      ;;;; AQUI PISA EL LIMITE
0000320A  4C9F 001F               2462      MOVEM.W (A7)+, D0-D4
0000320E  5379 000038F0           2463      SUB.W #1, PLAYERPOSX
00003214  5379 000038F2           2464      SUB.W #1, PLAYERPOSY
0000321A  4E75                    2465      RTS
0000321C                          2466  MAP6NOLIMIT8
0000321C                          2467      ;CHECK LEFT-LEFT ROOM WALL
0000321C  B07C 003E               2468      CMP #62, D0  ; BGT = 352 > D0
00003220  6E00 0026               2469      BGT MAP6NOLIMIT9    
00003224  B07C 0000               2470      CMP #0, D0
00003228  6D00 001E               2471      BLT MAP6NOLIMIT9
0000322C                          2472      ;NOW WE CHECK POS Y 
0000322C  B27C 01E0               2473      CMP #480, D1  ; 
00003230  6E00 0016               2474      BGT MAP6NOLIMIT9    
00003234  B27C 0120               2475      CMP #288, D1
00003238  6D00 000E               2476      BLT MAP6NOLIMIT9
0000323C                          2477      ;;;; AQUI PISA EL LIMITE
0000323C  4C9F 001F               2478      MOVEM.W (A7)+, D0-D4
00003240  5379 000038F2           2479      SUB.W #1, PLAYERPOSY
00003246  4E75                    2480      RTS
00003248                          2481  MAP6NOLIMIT9
00003248                          2482      ;CHECK FOR RIGHT-LEFT ROOM WALL
00003248  B07C 0100               2483      CMP #256, D0  ; BGT = 352 > D0
0000324C  6E00 002C               2484      BGT MAP6NOLIMIT10   
00003250  B07C 0044               2485      CMP #68, D0
00003254  6D00 0024               2486      BLT MAP6NOLIMIT10
00003258                          2487      ;NOW WE CHECK POS Y 
00003258  B27C 01E0               2488      CMP #480, D1  ; 
0000325C  6E00 001C               2489      BGT MAP6NOLIMIT10   
00003260  B27C 0120               2490      CMP #288, D1
00003264  6D00 0014               2491      BLT MAP6NOLIMIT10
00003268                          2492      ;;;; AQUI PISA EL LIMITE
00003268  4C9F 001F               2493      MOVEM.W (A7)+, D0-D4
0000326C  5279 000038F0           2494      ADD.W #1, PLAYERPOSX
00003272  5379 000038F2           2495      SUB.W #1, PLAYERPOSY
00003278  4E75                    2496      RTS
0000327A                          2497  MAP6NOLIMIT10
0000327A  4C9F 001F               2498      MOVEM.W (A7)+, D0-D4
0000327E  4EF9 00003474           2499      JMP NOLIMIT
00003284                          2500  LIMAPA7
00003284  301F                    2501      MOVE.W (A7)+, D0
00003286  48A7 F800               2502      MOVEM.W D0-D4, -(A7)
0000328A  3039 000038F0           2503      MOVE.W PLAYERPOSX, D0
00003290  3239 000038F2           2504      MOVE.W PLAYERPOSY, D1
00003296                          2505      ;CHECK FOR TOP-LEFT WALL 
00003296  B07C 0120               2506      CMP #288, D0  ; BGT = 352 > D0
0000329A  6E00 0026               2507      BGT MAP7NOLIMIT1    
0000329E  B07C 0000               2508      CMP #0, D0
000032A2  6D00 001E               2509      BLT MAP7NOLIMIT1
000032A6                          2510      ;NOW WE CHECK POS Y 
000032A6  B27C 0020               2511      CMP #32, D1  ; 
000032AA  6E00 0016               2512      BGT MAP7NOLIMIT1    
000032AE  B27C 0000               2513      CMP #0, D1
000032B2  6D00 000E               2514      BLT MAP7NOLIMIT1
000032B6                          2515      ;;;; AQUI PISA EL LIMITE
000032B6  5279 000038F2           2516      ADD.W #1, PLAYERPOSY
000032BC  4C9F 001F               2517      MOVEM.W (A7)+, D0-D4
000032C0  4E75                    2518      RTS
000032C2                          2519  MAP7NOLIMIT1
000032C2                          2520      ;CHECK FOR LEFT WALL
000032C2  B07C 0020               2521      CMP #32, D0  ; BGT = 352 > D0
000032C6  6E00 0026               2522      BGT MAP7NOLIMIT2    
000032CA  B07C 0000               2523      CMP #0, D0
000032CE  6D00 001E               2524      BLT MAP7NOLIMIT2
000032D2                          2525      ;NOW WE CHECK POS Y 
000032D2  B27C 01E0               2526      CMP #480, D1  ; 
000032D6  6E00 0016               2527      BGT MAP7NOLIMIT2    
000032DA  B27C 0000               2528      CMP #0, D1
000032DE  6D00 000E               2529      BLT MAP7NOLIMIT2
000032E2                          2530      ;;;; AQUI PISA EL LIMITE
000032E2  5279 000038F0           2531      ADD.W #1, PLAYERPOSX
000032E8  4C9F 001F               2532      MOVEM.W (A7)+, D0-D4
000032EC  4E75                    2533      RTS
000032EE                          2534  MAP7NOLIMIT2
000032EE                          2535      ;CHECK FOR BOTTOM WALL
000032EE  B07C 0280               2536      CMP #640, D0  ; BGT = 352 > D0
000032F2  6E00 0026               2537      BGT MAP7NOLIMIT3    
000032F6  B07C 0000               2538      CMP #0, D0
000032FA  6D00 001E               2539      BLT MAP7NOLIMIT3
000032FE                          2540      ;NOW WE CHECK POS Y 
000032FE  B27C 01E0               2541      CMP #480, D1  ; 
00003302  6E00 0016               2542      BGT MAP7NOLIMIT3    
00003306  B27C 01A0               2543      CMP #416, D1
0000330A  6D00 000E               2544      BLT MAP7NOLIMIT3
0000330E                          2545      ;;;; AQUI PISA EL LIMITE
0000330E  5379 000038F2           2546      SUB.W #1, PLAYERPOSY
00003314  4C9F 001F               2547      MOVEM.W (A7)+, D0-D4
00003318  4E75                    2548      RTS
0000331A                          2549  MAP7NOLIMIT3
0000331A                          2550      ;CHECK FOR RIGHT WALL
0000331A  B07C 0280               2551      CMP #640, D0  ; BGT = 352 > D0
0000331E  6E00 0026               2552      BGT MAP7NOLIMIT4    
00003322  B07C 0240               2553      CMP #576, D0
00003326  6D00 001E               2554      BLT MAP7NOLIMIT4
0000332A                          2555      ;NOW WE CHECK POS Y 
0000332A  B27C 01E0               2556      CMP #480, D1  ; 
0000332E  6E00 0016               2557      BGT MAP7NOLIMIT4    
00003332  B27C 0000               2558      CMP #0, D1
00003336  6D00 000E               2559      BLT MAP7NOLIMIT4
0000333A                          2560      ;;;; AQUI PISA EL LIMITE
0000333A  5379 000038F0           2561      SUB.W #1, PLAYERPOSX
00003340  4C9F 001F               2562      MOVEM.W (A7)+, D0-D4
00003344  4E75                    2563      RTS
00003346                          2564  MAP7NOLIMIT4
00003346                          2565      ;CHECK TOP-RIGHT WALL
00003346  B07C 0280               2566      CMP #640, D0  ; BGT = 352 > D0
0000334A  6E00 0026               2567      BGT MAP7NOLIMIT5    
0000334E  B07C 0160               2568      CMP #352, D0
00003352  6D00 001E               2569      BLT MAP7NOLIMIT5
00003356                          2570      ;NOW WE CHECK POS Y 
00003356  B27C 0020               2571      CMP #32, D1  ; 
0000335A  6E00 0016               2572      BGT MAP7NOLIMIT5    
0000335E  B27C 0000               2573      CMP #0, D1
00003362  6D00 000E               2574      BLT MAP7NOLIMIT5
00003366                          2575      ;;;; AQUI PISA EL LIMITE
00003366  5279 000038F2           2576      ADD.W #1, PLAYERPOSY
0000336C  4C9F 001F               2577      MOVEM.W (A7)+, D0-D4
00003370  4E75                    2578      RTS
00003372                          2579  MAP7NOLIMIT5
00003372  4C9F 001F               2580      MOVEM.W (A7)+, D0-D4
00003376  4EF9 00003474           2581      JMP NOLIMIT
0000337C                          2582      
0000337C                          2583  LIMAPA8
0000337C  301F                    2584      MOVE.W (A7)+, D0
0000337E  48A7 F800               2585      MOVEM.W D0-D4, -(A7)
00003382  3039 000038F0           2586      MOVE.W PLAYERPOSX, D0
00003388  3239 000038F2           2587      MOVE.W PLAYERPOSY, D1
0000338E                          2588      ;CHECK FOR WALLS IN HEAVEN ROOM 4
0000338E                          2589      ;CHECK UPPER LEFT WALL 
0000338E  B07C 0120               2590      CMP #288, D0  ; BGT = 352 > D0
00003392  6E00 0026               2591      BGT MAP8NOLIMIT1   
00003396  B07C 0000               2592      CMP #0, D0
0000339A  6D00 001E               2593      BLT MAP8NOLIMIT1
0000339E                          2594      ;NOW WE CHECK POS Y 
0000339E  B27C 00A0               2595      CMP #160, D1  ; 
000033A2  6E00 0016               2596      BGT MAP8NOLIMIT1    
000033A6  B27C 0000               2597      CMP #0, D1
000033AA  6D00 000E               2598      BLT MAP8NOLIMIT1
000033AE                          2599      ;;;; AQUI PISA EL LIMITE
000033AE  4C9F 001F               2600      MOVEM.W (A7)+, D0-D4
000033B2  5279 000038F2           2601      ADD.W #1, PLAYERPOSY
000033B8  4E75                    2602      RTS
000033BA                          2603  MAP8NOLIMIT1
000033BA                          2604      ;CHECK BOTTOM WALL
000033BA  B07C 0280               2605      CMP #640, D0  ; BGT = 352 > D0
000033BE  6E00 0026               2606      BGT MAP8NOLIMIT2   
000033C2  B07C 0000               2607      CMP #0, D0
000033C6  6D00 001E               2608      BLT MAP8NOLIMIT2
000033CA                          2609      ;NOW WE CHECK POS Y 
000033CA  B27C 01E0               2610      CMP #480, D1  ; 
000033CE  6E00 0016               2611      BGT MAP8NOLIMIT2    
000033D2  B27C 0120               2612      CMP #288, D1
000033D6  6D00 000E               2613      BLT MAP8NOLIMIT2
000033DA                          2614      ;;;; AQUI PISA EL LIMITE
000033DA  4C9F 001F               2615      MOVEM.W (A7)+, D0-D4
000033DE  5379 000038F2           2616      SUB.W #1, PLAYERPOSY
000033E4  4E75                    2617      RTS
000033E6                          2618  MAP8NOLIMIT2
000033E6                          2619      ;CHECK LEFT WALL
000033E6  B07C 00C0               2620      CMP #192, D0  ; BGT = 352 > D0
000033EA  6E00 0026               2621      BGT MAP8NOLIMIT3   
000033EE  B07C 0000               2622      CMP #0, D0
000033F2  6D00 001E               2623      BLT MAP8NOLIMIT3
000033F6                          2624      ;NOW WE CHECK POS Y 
000033F6  B27C 01E0               2625      CMP #480, D1  ; 
000033FA  6E00 0016               2626      BGT MAP8NOLIMIT3    
000033FE  B27C 0000               2627      CMP #0, D1
00003402  6D00 000E               2628      BLT MAP8NOLIMIT3
00003406                          2629      ;;;; AQUI PISA EL LIMITE
00003406  4C9F 001F               2630      MOVEM.W (A7)+, D0-D4
0000340A  5279 000038F0           2631      ADD.W #1, PLAYERPOSX
00003410  4E75                    2632      RTS
00003412                          2633  MAP8NOLIMIT3
00003412                          2634      ;CHECK RIGHT WALL
00003412  B07C 0280               2635      CMP #640, D0  ; BGT = 352 > D0
00003416  6E00 0026               2636      BGT MAP8NOLIMIT4   
0000341A  B07C 01A0               2637      CMP #416, D0
0000341E  6D00 001E               2638      BLT MAP8NOLIMIT4
00003422                          2639      ;NOW WE CHECK POS Y 
00003422  B27C 01E0               2640      CMP #480, D1  ; 
00003426  6E00 0016               2641      BGT MAP8NOLIMIT4    
0000342A  B27C 0000               2642      CMP #0, D1
0000342E  6D00 000E               2643      BLT MAP8NOLIMIT4
00003432                          2644      ;;;; AQUI PISA EL LIMITE
00003432  4C9F 001F               2645      MOVEM.W (A7)+, D0-D4
00003436  5379 000038F0           2646      SUB.W #1, PLAYERPOSX
0000343C  4E75                    2647      RTS
0000343E                          2648  MAP8NOLIMIT4
0000343E                          2649  ;CHECK TOP RIGHT WALL
0000343E  B07C 0280               2650      CMP #640, D0  ; BGT = 352 > D0
00003442  6E00 0026               2651      BGT MAP8NOLIMIT5   
00003446  B07C 0160               2652      CMP #352, D0
0000344A  6D00 001E               2653      BLT MAP8NOLIMIT5
0000344E                          2654      ;NOW WE CHECK POS Y 
0000344E  B27C 00A0               2655      CMP #160, D1  ; 
00003452  6E00 0016               2656      BGT MAP8NOLIMIT5    
00003456  B27C 0000               2657      CMP #0, D1
0000345A  6D00 000E               2658      BLT MAP8NOLIMIT5
0000345E                          2659      ;;;; AQUI PISA EL LIMITE
0000345E  4C9F 001F               2660      MOVEM.W (A7)+, D0-D4
00003462  5279 000038F2           2661      ADD.W #1, PLAYERPOSY
00003468  4E75                    2662      RTS
0000346A                          2663  MAP8NOLIMIT5
0000346A  4C9F 001F               2664      MOVEM.W (A7)+, D0-D4
0000346E  4EF9 00003474           2665      JMP NOLIMIT
00003474                          2666      
00003474                          2667  NOLIMIT
00003474  3F00                    2668              MOVE.W  D0,-(A7)
00003476  0839 0000 000038E8      2669        BTST #0, KBDVAL         
0000347E  6700 000C               2670              BEQ .UP    
00003482  303C FFFC               2671              MOVE.W  #-PLAYERSPEED,D0     
00003486  4EB9 000034D2           2672        JSR   MOVEHOR 
0000348C  0839 0001 000038E8      2673  .UP   BTST #1, KBDVAL           
00003494  6700 000C               2674        BEQ   .RIGHT  
00003498  303C FFFC               2675              MOVE.W  #-PLAYERSPEED,D0      
0000349C  4EB9 000034F8           2676        JSR   MOVEVER
000034A2  0839 0002 000038E8      2677  .RIGHT    BTST #2, KBDVAL
000034AA  6700 000C               2678        BEQ   .DOWN  
000034AE  303C 0004               2679              MOVE.W  #PLAYERSPEED,D0     
000034B2  4EB9 000034D2           2680        JSR   MOVEHOR
000034B8  0839 0003 000038E8      2681  .DOWN     BTST #3, KBDVAL
000034C0  6700 000C               2682        BEQ   .NOTMOVED  
000034C4  303C 0004               2683              MOVE.W  #PLAYERSPEED,D0       
000034C8  4EB9 000034F8           2684        JSR   MOVEVER
000034CE  301F                    2685  .NOTMOVED     MOVE.W  (A7)+,D0
000034D0  4E75                    2686              RTS
000034D2                          2687  
000034D2  D179 000038F0           2688  MOVEHOR     ADD.W   D0,(PLAYERPOSX)
000034D8  6A00 0008               2689              BPL.W   .NOTLEFTEDGE
000034DC  4279 000038F0           2690              CLR.W   (PLAYERPOSX)
000034E2                          2691  .NOTLEFTEDGE
000034E2  0C79 0260 000038F0      2692              CMP.W   #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
000034EA  6D00 000A               2693              BLT.W   .NORIGHTEDGE
000034EE  33FC 0260 000038F0      2694              MOVE.W  #SCRWIDTH-PLAYERWIDTH,(PLAYERPOSX)
000034F6                          2695  .NORIGHTEDGE 
000034F6  4E75                    2696              RTS
000034F8                          2697              
000034F8  D179 000038F2           2698  MOVEVER     ADD.W   D0,(PLAYERPOSY)
000034FE  6A00 0008               2699              BPL.W   .NOTUPPEREDGE
00003502  4279 000038F2           2700              CLR.W   (PLAYERPOSY)
00003508                          2701  .NOTUPPEREDGE
00003508  0C79 01C0 000038F2      2702              CMP.W   #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
00003510  6D00 000A               2703              BLT.W   .NOLOWEREDGE
00003514  33FC 01C0 000038F2      2704              MOVE.W  #SCRHEIGH-PLAYERHEIGHT,(PLAYERPOSY)
0000351C                          2705  .NOLOWEREDGE 
0000351C  4E75                    2706              RTS
0000351E                          2707          
0000351E                          2708  ; ------------------------------------------------------------------------------
0000351E                          2709  PLAYERPLOT
0000351E                          2710  ; PLOT THE PLAYER.
0000351E                          2711  ; INPUT    : NONE 
0000351E                          2712  ; OUTPUT   : NONE
0000351E                          2713  ; MODIFIES : NONE
0000351E                          2714  ; ------------------------------------------------------------------------------
0000351E                          2715              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
0000351E  1F00                    2716              MOVE.B  D0,-(A7)
00003520  2F01                    2717              MOVE.L  D1,-(A7)
00003522  48A7 3800               2718        MOVEM.W D2-D4, -(A7)
00003526                          2719        
00003526  223C 00CC954E           2720        MOVE.L #$00CC954E,D1 ;PEN COLOR
0000352C  103C 0050               2721        MOVE.B #80,D0
00003530  4E4F                    2722        TRAP #15
00003532  223C 00B53866           2723        MOVE.L #$00B53866,D1 ;FILL COLOR
00003538  103C 0051               2724        MOVE.B #81,D0
0000353C  4E4F                    2725        TRAP #15
0000353E                          2726        ; SE DIBUJA EL CUADRADO
0000353E  3239 000038F0           2727        MOVE.W (PLAYERPOSX),D1    
00003544  3439 000038F2           2728        MOVE.W (PLAYERPOSY),D2      
0000354A  3601                    2729        MOVE.W D1,D3
0000354C  0643 0020               2730              ADD.W  #PLAYERWIDTH,D3  
00003550  3802                    2731        MOVE.W D2,D4
00003552  0644 0020               2732              ADD.W  #PLAYERHEIGHT,D4
00003556  103C 0057               2733        MOVE.B #87,D0
0000355A  4E4F                    2734        TRAP #15
0000355C                          2735        
0000355C  4C9F 001C               2736              MOVEM.W (A7)+,D2-D4
00003560  221F                    2737              MOVE.L  (A7)+,D1      
00003562  101F                    2738              MOVE.B  (A7)+,D0
00003564                          2739    
00003564  4E75                    2740        RTS
00003566                          2741  
00003566                          2742  
00003566                          2743  
00003566                          2744  
00003566                          2745  -------------------- end include --------------------
00003566                          2746              INCLUDE "PROJECTILE.X68"
00003566                          2747  ; ==============================================================================
00003566                          2748  ; PROJECTILE MANAGEMENT (AGENT)
00003566                          2749  ; PROJPOSX (W)  (A0)
00003566                          2750  ; PROJPOSY (W) 2(A0)
00003566                          2751  ; PROJVELX (W) 4(A0)
00003566                          2752  ; PROJVELY (W) 6(A0)
00003566                          2753  ; ==============================================================================
00003566                          2754  
00003566                          2755  ; ------------------------------------------------------------------------------
00003566                          2756  PROJINIT 
00003566                          2757  ; INITIALIZES THE PROJECTILE.
00003566                          2758  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00003566                          2759  ; OUTPUT   : NONE
00003566                          2760  ; MODIFIES : NONE
00003566                          2761  ; ------------------------------------------------------------------------------
00003566  2F00                    2762             MOVE.L  D0,-(A7)
00003568                          2763             
00003568  4280                    2764              CLR.L   D0
0000356A  0839 0004 000038E9      2765              BTST #4, (KBDEDGE)    
00003572  6700 0008               2766              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
00003576  0680 FFF80000           2767              ADD.L   #-PROJSPEEDX<<16,D0
0000357C  0839 0005 000038E9      2768  .FUP        BTST #5, (KBDEDGE)      
00003584  6700 0006               2769              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
00003588  0640 FFF8               2770              ADD.W   #-PROJSPEEDY,D0 
0000358C  0839 0006 000038E9      2771  .FRIGHT     BTST #6, (KBDEDGE)
00003594  6700 0008               2772              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
00003598  0680 00080000           2773              ADD.L   #PROJSPEEDX<<16,D0
0000359E  0839 0007 000038E9      2774  .FDOWN      BTST #7, (KBDEDGE)
000035A6  6700 0004               2775              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
000035AA  5040                    2776              ADD.W   #PROJSPEEDY,D0
000035AC  4A80                    2777  .NOTFDOWN   TST.L   D0
000035AE  6600 0006               2778              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
000035B2  303C 0008               2779              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
000035B6  20B9 000038F0           2780  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
000035BC  2140 0004               2781              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
000035C0  5279 000038F4           2782              ADD.W   #1,(NPROJ)
000035C6  201F                    2783              MOVE.L  (A7)+,D0
000035C8  4E75                    2784              RTS
000035CA                          2785              
000035CA                          2786  ; ------------------------------------------------------------------------------
000035CA                          2787  PROJUPD 
000035CA                          2788  ; UPDATES THE PROJECTILE.
000035CA                          2789  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
000035CA                          2790  ; OUTPUT   : NONE
000035CA                          2791  ; MODIFIES : NONE
000035CA                          2792  ; ------------------------------------------------------------------------------
000035CA  2F00                    2793              MOVE.L  D0,-(A7)
000035CC  2028 0004               2794              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
000035D0  D168 0002               2795              ADD.W   D0,2(A0)
000035D4  E088                    2796              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
000035D6  E088                    2797              LSR.L   #8,D0
000035D8  D150                    2798              ADD.W   D0,(A0) 
000035DA  201F                    2799              MOVE.L  (A7)+,D0
000035DC  4E75                    2800              RTS
000035DE                          2801      
000035DE                          2802  ; ------------------------------------------------------------------------------
000035DE                          2803  PROJPLOT 
000035DE                          2804  ; PLOTS THE PROJECTILE.
000035DE                          2805  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
000035DE                          2806  ; OUTPUT   : NONE
000035DE                          2807  ; MODIFIES : NONE
000035DE                          2808  ; ------------------------------------------------------------------------------
000035DE  1F00                    2809              MOVE.B  D0,-(A7)
000035E0  2F01                    2810              MOVE.L  D1,-(A7)
000035E2  48A7 3800               2811        MOVEM.W D2-D4, -(A7)
000035E6                          2812        
000035E6  223C 00C00FFE           2813        MOVE.L #$00C00FFE,D1 ;PEN COLOR
000035EC  103C 0050               2814        MOVE.B #80,D0
000035F0  4E4F                    2815        TRAP #15
000035F2  223C 00BFF006           2816        MOVE.L #$00BFF006,D1 ;FILL COLOR
000035F8  103C 0051               2817        MOVE.B #81,D0
000035FC  4E4F                    2818        TRAP #15
000035FE                          2819        ; SE DIBUJA EL CUADRADO
000035FE  3210                    2820        MOVE.W (A0),D1    
00003600  3428 0002               2821        MOVE.W 2(A0),D2     
00003604  3601                    2822        MOVE.W D1,D3
00003606  0643 0010               2823              ADD.W  #PROJWIDTH,D3    
0000360A  3802                    2824        MOVE.W D2,D4
0000360C  0644 0010               2825              ADD.W  #PROJHEIGHT,D4
00003610  103C 0057               2826        MOVE.B #87,D0
00003614  4E4F                    2827        TRAP #15
00003616                          2828        
00003616  4C9F 001C               2829              MOVEM.W (A7)+,D2-D4
0000361A  221F                    2830              MOVE.L  (A7)+,D1      
0000361C  101F                    2831              MOVE.B  (A7)+,D0
0000361E  4E75                    2832              RTS
00003620                          2833  
00003620                          2834  
00003620                          2835  -------------------- end include --------------------
00003620                          2836              INCLUDE "AUDIO.X68"
00003620                          2837     
00003620                          2838  ; =============================================================================
00003620                          2839  ; AUDIO MANAGEMENT
00003620                          2840  ; =============================================================================
00003620                          2841  
00003620                          2842  
00003620                          2843  ; -----------------------------------------------------------------------------
00003620                          2844  AUDINIT
00003620                          2845  ; CHANGES AUDIO TO PLAY
00003620                          2846  ; INPUT    - NONE
00003620                          2847  ; OUTPUT   - NONE
00003620                          2848  ; MODIFIES - NONE
00003620                          2849  ; -----------------------------------------------------------------------------
00003620                          2850      
00003620  48A7 E000               2851      MOVEM.W D0-D2, -(A7)
00003624  48A7 00C0               2852      MOVEM.W A0-A1, -(A7)
00003628                          2853  ;LOAD ELEVATOR MUSIC IN POS 0 
00003628  103C 0047               2854      MOVE.B #71, D0
0000362C  43F8 100F               2855      LEA ELEVATOR_MUSIC, A1
00003630  123C 0000               2856      MOVE.B #0, D1
00003634  4E4F                    2857      TRAP #15
00003636                          2858  ;LOAD HEAVEN MUSIC IN POS 1
00003636  43F8 1000               2859      LEA HEAVENSOUND, A1
0000363A  123C 0001               2860      MOVE.B #1, D1
0000363E  4E4F                    2861      TRAP #15
00003640                          2862  ;LOAD HELL MUSIC IN POS 2
00003640  43F8 1026               2863      LEA HELLSOUND, A1
00003644  123C 0002               2864      MOVE.B #2, D1
00003648  4E4F                    2865      TRAP #15
0000364A  4C9F 0300               2866      MOVEM.W (A7)+, A0-A1
0000364E  4C9F 0007               2867      MOVEM.W (A7)+, D0-D2
00003652                          2868  
00003652  4E75                    2869      RTS
00003654                          2870  
00003654                          2871  
00003654                          2872  ; -----------------------------------------------------------------------------
00003654                          2873  AUDPLAY
00003654                          2874  ; CHANGES AUDIO TO PLAY
00003654                          2875  ; INPUT    - NONE
00003654                          2876  ; OUTPUT   - NONE
00003654                          2877  ; MODIFIES - NONE
00003654                          2878  ; -----------------------------------------------------------------------------
00003654                          2879      
00003654  48E7 E000               2880      MOVEM.L D0-D2, -(A7)
00003658  48A7 00C0               2881      MOVEM.W A0-A1, -(A7)    
0000365C                          2882      
0000365C  3239 000038FE           2883      MOVE.W LOADEDMAP, D1
00003662  C2FC 0006               2884             MULU #6, D1
00003666  3241                    2885             MOVEA.W D1, A1
00003668  4EE9 366C               2886             JMP MSCSEL(A1)
0000366C                          2887  MSCSEL:
0000366C  4EF9 000036A2           2888             JMP ELEVATORMUSIC
00003672                          2889             
00003672  4EF9 000036C0           2890             JMP HEAVENMUSIC
00003678                          2891             
00003678  4EF9 000036C0           2892             JMP HEAVENMUSIC
0000367E                          2893             
0000367E  4EF9 000036C0           2894             JMP HEAVENMUSIC
00003684                          2895             
00003684  4EF9 000036C0           2896             JMP HEAVENMUSIC
0000368A                          2897             
0000368A  4EF9 000036E2           2898             JMP HELLMUSIC
00003690                          2899             
00003690  4EF9 000036E2           2900             JMP HELLMUSIC
00003696                          2901             
00003696  4EF9 000036E2           2902             JMP HELLMUSIC
0000369C                          2903             
0000369C  4EF9 000036E2           2904             JMP HELLMUSIC
000036A2                          2905             
000036A2                          2906  
000036A2                          2907  ELEVATORMUSIC
000036A2  103C 004C               2908      MOVE.B #76, D0
000036A6  123C 0000               2909      MOVE.B #0, D1
000036AA  7400                    2910      MOVE.L #0, D2
000036AC  4E4F                    2911      TRAP #15
000036AE  4C9F 0300               2912      MOVEM.W (A7)+, A0-A1
000036B2  4CDF 0007               2913      MOVEM.L (A7)+, D0-D2
000036B6  13FC 0001 00003900      2914      MOVE.B #1, MUSICPLAYED
000036BE  4E75                    2915      RTS
000036C0                          2916  
000036C0                          2917  HEAVENMUSIC 
000036C0  103C 004C               2918      MOVE.B #76, D0
000036C4  123C 0000               2919      MOVE.B #0, D1
000036C8  7402                    2920      MOVE.L #2, D2
000036CA  4E4F                    2921      TRAP #15
000036CC  103C 004C               2922      MOVE.B #76, D0
000036D0  123C 0001               2923      MOVE.B #1, D1
000036D4  7400                    2924      MOVE.L #0, D2
000036D6  4E4F                    2925      TRAP #15
000036D8  4C9F 0300               2926      MOVEM.W (A7)+, A0-A1
000036DC  4CDF 0007               2927      MOVEM.L (A7)+, D0-D2
000036E0  4E75                    2928      RTS
000036E2                          2929  HELLMUSIC
000036E2  103C 004C               2930      MOVE.B #76, D0
000036E6  123C 0000               2931      MOVE.B #0, D1
000036EA  7402                    2932      MOVE.L #2, D2
000036EC  4E4F                    2933      TRAP #15
000036EE  103C 004C               2934      MOVE.B #76, D0
000036F2  123C 0002               2935      MOVE.B #2, D1
000036F6  7400                    2936      MOVE.L #0,  D2
000036F8  4E4F                    2937      TRAP #15
000036FA  4C9F 0300               2938      MOVEM.W (A7)+, A0-A1
000036FE  4CDF 0007               2939      MOVEM.L (A7)+, D0-D2
00003702  4E75                    2940      RTS
00003704                          2941  
00003704                          2942  FIREDSOUND
00003704  48A7 E000               2943      MOVEM.W D0-D2, -(A7)
00003708  48A7 00C0               2944      MOVEM.W A0-A1, -(A7)
0000370C  103C 0049               2945      MOVE.B #73, D0
00003710  43F8 1035               2946      LEA PROJ_SOUND, A1
00003714  4E4F                    2947      TRAP #15
00003716  4C9F 0300               2948      MOVEM.W (A7)+, A0-A1
0000371A  4C9F 0007               2949      MOVEM.W (A7)+, D0-D2
0000371E  4E75                    2950      RTS
0000371E  4E75                    2951  -------------------- end include --------------------
00003720                          2952              INCLUDE "STATES.X68"
00003720                          2953  ; =============================================================================
00003720                          2954  ; GAME STATE MANAGEMENT
00003720                          2955  ; =============================================================================
00003720                          2956  
00003720                          2957  ; -----------------------------------------------------------------------------
00003720                          2958  STAINIT
00003720                          2959  ; INITALIZES THE STATE MANAGER
00003720                          2960  ; INPUT    - NONE
00003720                          2961  ; OUTPUT   - NONE
00003720                          2962  ; MODIFIES - NONE
00003720                          2963  ; -----------------------------------------------------------------------------
00003720  33FC FFFF 0000391E      2964              MOVE.W  #STANONE,(STACUR)
00003728  4279 00003920           2965              CLR.W   (STANEXT)
0000372E  4E75                    2966              RTS
00003730                          2967  
00003730                          2968  ; -----------------------------------------------------------------------------
00003730                          2969  STAUPD
00003730                          2970  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00003730                          2971  ; INPUT    - NONE
00003730                          2972  ; OUTPUT   - NONE
00003730                          2973  ; MODIFIES - NONE
00003730                          2974  ; -----------------------------------------------------------------------------
00003730  48E7 8080               2975              MOVEM.L D0/A0,-(A7)
00003734  4280                    2976              CLR.L   D0
00003736  3039 00003920           2977              MOVE.W  (STANEXT),D0
0000373C  B079 0000391E           2978              CMP.W   (STACUR),D0
00003742  6700 0012               2979              BEQ     .DOUPD
00003746  33C0 0000391E           2980              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
0000374C  E588                    2981              LSL.L   #2,D0
0000374E  2040                    2982              MOVE.L  D0,A0
00003750  2068 376E               2983              MOVE.L  .INITBL(A0),A0
00003754  4E90                    2984              JSR     (A0)
00003756  4280                    2985  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00003758  3039 0000391E           2986              MOVE.W  (STACUR),D0
0000375E  E588                    2987              LSL.L   #2,D0
00003760  2040                    2988              MOVE.L  D0,A0
00003762  2068 3776               2989              MOVE.L  .UPDTBL(A0),A0
00003766  4E90                    2990              JSR     (A0)
00003768  4CDF 0101               2991              MOVEM.L (A7)+,D0/A0
0000376C  4E75                    2992              RTS
0000376E= 00003822 000037A4       2993  .INITBL     DC.L    ISCINIT,GAMINIT *,STAEMPTY,STAEMPTY
00003776= 00003824 000037B2       2994  .UPDTBL     DC.L    ISCUPD,GAMUPD *,WINUPD,GOVUPD
0000377E                          2995  
0000377E                          2996  ; -----------------------------------------------------------------------------
0000377E                          2997  STAPLOT
0000377E                          2998  ; PERFORMS STATE PLOT
0000377E                          2999  ; INPUT    - NONE
0000377E                          3000  ; OUTPUT   - NONE
0000377E                          3001  ; MODIFIES - NONE
0000377E                          3002  ; -----------------------------------------------------------------------------
0000377E  48E7 8080               3003              MOVEM.L D0/A0,-(A7)
00003782  4280                    3004              CLR.L   D0
00003784  3039 0000391E           3005              MOVE.W  (STACUR),D0
0000378A  E588                    3006              LSL.L   #2,D0
0000378C  2040                    3007              MOVE.L  D0,A0
0000378E  2068 379A               3008              MOVE.L  .PLTTBL(A0),A0
00003792  4E90                    3009              JSR     (A0)
00003794  4CDF 0101               3010              MOVEM.L (A7)+,D0/A0
00003798  4E75                    3011              RTS
0000379A= 0000383E 0000380C       3012  .PLTTBL     DC.L    ISCPLOT,GAMPLOT *,WINPLOT,GOVPLOT
000037A2                          3013  
000037A2                          3014  ; -----------------------------------------------------------------------------
000037A2                          3015  STAEMPTY
000037A2                          3016  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000037A2                          3017  ; INPUT    - NONE
000037A2                          3018  ; OUTPUT   - NONE
000037A2                          3019  ; MODIFIES - NONE
000037A2                          3020  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000037A2                          3021  ; -----------------------------------------------------------------------------
000037A2  4E75                    3022              RTS
000037A4                          3023  
000037A4                          3024  
000037A4                          3025  
000037A4                          3026  
000037A4                          3027  
000037A4                          3028  
000037A4                          3029  
000037A4                          3030  
000037A4                          3031  
000037A4                          3032  -------------------- end include --------------------
000037A4                          3033              INCLUDE "GAME.X68"
000037A4                          3034  ; ==============================================================================
000037A4                          3035  ; GAME MANAGEMENT
000037A4                          3036  ; ==============================================================================
000037A4                          3037  
000037A4                          3038  ; ------------------------------------------------------------------------------
000037A4                          3039  GAMINIT
000037A4                          3040  ; INITIALIZES GAME.
000037A4                          3041  ; INPUT    : NONE
000037A4                          3042  ; OUTPUT   : NONE
000037A4                          3043  ; MODIFIES : NONE
000037A4                          3044  ; ------------------------------------------------------------------------------
000037A4  4279 000038FE           3045              CLR.W LOADEDMAP
000037AA  4EB8 29BC               3046              JSR     PLAYERINIT
000037AE  6000 FE70               3047              BRA     AUDINIT
000037B2                          3048  
000037B2                          3049  ; ------------------------------------------------------------------------------
000037B2                          3050  GAMUPD
000037B2                          3051  ; UPDATES THE GAME
000037B2                          3052  ; INPUT    : NONE
000037B2                          3053  ; OUTPUT   : NONE
000037B2                          3054  ; MODIFIES : NONE
000037B2                          3055  ; ------------------------------------------------------------------------------
000037B2  48E7 8070               3056              MOVEM.L D0/A1-A3,-(A7)
000037B6                          3057              
000037B6                          3058              ; CHECK IF MUSIC IS ALREADY PLAYING 
000037B6  1039 00003900           3059              MOVE.B MUSICPLAYED, D0
000037BC  B07C 0001               3060              CMP #1, D0
000037C0  6700 0006               3061              BEQ NOMUSIC
000037C4  4EB8 3654               3062              JSR AUDPLAY
000037C8                          3063  ; GENERAL UPDATES
000037C8  4EB8 2968               3064  NOMUSIC     JSR ELEVATORUPDATE 
000037CC  4EB8 29BE               3065              JSR PLAYERUPD   
000037D0  4EB8 1526               3066              JSR MAPUPD
000037D4                          3067  ; SHOTS LOGIC         
000037D4  1039 000038E9           3068              MOVE.B  (KBDEDGE),D0
000037DA  C03C 00F0               3069              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
000037DE  6718                    3070              BEQ.B .NOTFIRED
000037E0  4EB8 3704               3071              JSR FIREDSOUND
000037E4  43F8 3566               3072              LEA     PROJINIT,A1
000037E8  45F8 35CA               3073              LEA     PROJUPD,A2
000037EC  47F8 35DE               3074              LEA     PROJPLOT,A3
000037F0  303C 0001               3075              MOVE.W  #1,D0
000037F4  4EB8 12D8               3076              JSR     AGLADD
000037F8                          3077  .NOTFIRED
000037F8  4A79 000038F4           3078              TST.W   (NPROJ)
000037FE  6700 0006               3079              BEQ     .NOPROJ1
00003802  4EB8 12F2               3080              JSR     AGLUPD
00003806                          3081  .NOPROJ1
00003806  4CDF 0E01               3082              MOVEM.L (A7)+,D0/A1-A3
0000380A  4E75                    3083              RTS
0000380C                          3084  
0000380C                          3085  ; ------------------------------------------------------------------------------
0000380C                          3086  GAMPLOT
0000380C                          3087  ; PLOTS THE GAME
0000380C                          3088  ; INPUT    : NONE
0000380C                          3089  ; OUTPUT   : NONE
0000380C                          3090  ; MODIFIES : NONE
0000380C                          3091  ; ------------------------------------------------------------------------------
0000380C  4EB8 14A2               3092              JSR MAPPLOT     
00003810  4A79 000038F4           3093              TST.W   (NPROJ)
00003816  6700 0006               3094              BEQ     .NOPROJ2
0000381A  4EB8 1316               3095              JSR     AGLPLOT
0000381E  6000 FCFE               3096  .NOPROJ2    BRA     PLAYERPLOT
00003822                          3097  
00003822                          3098  
00003822                          3099  
00003822                          3100  
00003822                          3101  
00003822                          3102  
00003822                          3103  -------------------- end include --------------------
00003822                          3104              INCLUDE "INTRO.X68"
00003822                          3105  ; ==============================================================================
00003822                          3106  ; INTRO SCREEN
00003822                          3107  ; ==============================================================================
00003822                          3108  
00003822                          3109  ; ------------------------------------------------------------------------------
00003822                          3110  ISCINIT
00003822                          3111  ; INTRO SCREEN INIT
00003822                          3112  ; INPUT    : NONE
00003822                          3113  ; OUTPUT   : NONE
00003822                          3114  ; MODIFIES : NONE
00003822                          3115  ; ------------------------------------------------------------------------------
00003822  4E75                    3116              RTS
00003824                          3117  
00003824                          3118  ; ------------------------------------------------------------------------------
00003824                          3119  ISCUPD
00003824                          3120  ; INTRO SCREEN UPDATE
00003824                          3121  ; INPUT    : NONE
00003824                          3122  ; OUTPUT   : NONE
00003824                          3123  ; MODIFIES : NONE
00003824                          3124  ; ------------------------------------------------------------------------------
00003824  103C 003D               3125              MOVE.B  #61,D0          ; READ MOUSE
00003828  123C 0002               3126              MOVE.B  #2,D1           ; MOUSE DOWN STATE
0000382C  4E4F                    3127              TRAP    #15
0000382E  0200 000F               3128              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00003832  6708                    3129              BEQ.B   .DONE ; IF NO CLICK
00003834  33FC 0001 00003920      3130              MOVE.W  #1,(STANEXT)
0000383C                          3131  .DONE
0000383C  4E75                    3132              RTS
0000383E                          3133  ; ------------------------------------------------------------------------------
0000383E                          3134  ISCPLOT
0000383E                          3135  ; INTRO SCREEN PLOT
0000383E                          3136  ; INPUT    : NONE
0000383E                          3137  ; OUTPUT   : NONE
0000383E                          3138  ; MODIFIES : NONE
0000383E                          3139  ; ------------------------------------------------------------------------------
0000383E  48E7 C080               3140              MOVEM.L D0-D1/A0,-(A7)
00003842                          3141              
00003842  4281                    3142              CLR.L   D1
00003844  103C 0051               3143              MOVE.B  #81,D0
00003848  4E4F                    3144              TRAP    #15
0000384A                          3145              
0000384A  41F9 00003878           3146              LEA     .TITLE,A0
00003850  103C 000A               3147              MOVE.B  #10,D0
00003854  4EB8 1352               3148              JSR     UTLPRINT
00003858                          3149              
00003858  0839 0004 000038EB      3150              BTST.B  #4,(SCRCYCCT)
00003860  6700 0010               3151              BEQ     .DONE
00003864                          3152              
00003864  41F9 0000389D           3153              LEA     .HINT,A0
0000386A  103C 0019               3154              MOVE.B  #25,D0
0000386E  4EB8 1352               3155              JSR     UTLPRINT
00003872                          3156              
00003872  4CDF 0103               3157  .DONE       MOVEM.L (A7)+,D0-D1/A0
00003876                          3158  
00003876  4E75                    3159              RTS
00003878= 50 41 54 45 52 4E ...   3160  .TITLE      DC.B    'PATERNOSTER: LAS COLUMNAS DEL OLIMPO',0
0000389D= 43 4C 49 43 4B 20 ...   3161  .HINT       DC.B    'CLICK ANYWHERE TO START',0
000038B6                          3162              DS.W    0
000038B6                          3163  
000038B6                          3164  
000038B6                          3165  
000038B6                          3166  
000038B6                          3167  
000038B6                          3168  
000038B6                          3169  
000038B6                          3170  
000038B6                          3171  -------------------- end include --------------------
000038B6                          3172  START
000038B6                          3173  
000038B6                          3174  ; --- INITIALIZATION -----------------------------------------------------------
000038B6                          3175  
000038B6  007C 0700               3176              ORI.W   #$0700,SR
000038BA  4EB8 110A               3177              JSR     SYSINIT
000038BE                          3178              *JSR     UTLINIT
000038BE  4EB8 3720               3179              JSR     STAINIT
000038C2                          3180  
000038C2                          3181  .LOOP
000038C2                          3182  
000038C2                          3183  ; --- UPDATE -------------------------------------------------------------------
000038C2                          3184  
000038C2                          3185  ; READ INPUT DEVICES
000038C2                          3186  
000038C2  4E41                    3187              TRAP    #KBDUPTN
000038C4                          3188  
000038C4                          3189  ; UPDATE GAME LOGIC
000038C4                          3190  
000038C4  4EB8 3730               3191              JSR     STAUPD
000038C8                          3192  
000038C8                          3193  ; --- SYNC ---------------------------------------------------------------------
000038C8                          3194  
000038C8  4A39 000038EA           3195  .WINT       TST.B   (SCRINTCT)
000038CE  67F8                    3196              BEQ     .WINT
000038D0  4239 000038EA           3197              CLR.B   (SCRINTCT)
000038D6  5239 000038EC           3198              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
000038DC                          3199  
000038DC                          3200  ; --- PLOT ---------------------------------------------------------------------
000038DC                          3201              
000038DC  4EB8 377E               3202              JSR     STAPLOT
000038E0                          3203              
000038E0  4E40                    3204              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
000038E2                          3205  
000038E2  60DE                    3206              BRA     .LOOP
000038E4                          3207              
000038E4  FFFF FFFF               3208              SIMHALT
000038E8                          3209              
000038E8                          3210              INCLUDE "VARS.X68"
000038E8                          3211  ; ==============================================================================
000038E8                          3212  ; VARIABLES
000038E8                          3213  ; ==============================================================================
000038E8                          3214              
000038E8                          3215  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000038E8                          3216              
000038E8                          3217  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
000038E9                          3218  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
000038EA                          3219  
000038EA                          3220  
000038EA                          3221  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
000038EA                          3222  
000038EA                          3223  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000038EB                          3224  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
000038EC                          3225  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
000038EE                          3226              DS.W    0
000038EE                          3227  
000038EE                          3228  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
000038EE                          3229  
000038EE= 0064                    3230  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
000038F0= 0140                    3231  PLAYERPOSX      DC.W    SCRWIDTH/2
000038F2= 00F0                    3232  PLAYERPOSY      DC.W    SCRHEIGH/2
000038F4                          3233  
000038F4                          3234  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
000038F4                          3235  
000038F4= 0000                    3236  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
000038F6                          3237  
000038F6                          3238  ; --- MAP RELATED VARIABLES ----------------------------------------------------
000038F6                          3239  
000038F6= 0000                    3240  BPOSX1  DC.W    0
000038F8= 0000                    3241  BPOSY1  DC.W    0
000038FA= 0020                    3242  BPOSX2  DC.W    32
000038FC= 0020                    3243  BPOSY2  DC.W    32
000038FE= 0000                    3244  LOADEDMAP   DC.W    0
00003900                          3245  
00003900                          3246  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
00003900                          3247  
00003900= 00                      3248  MUSICPLAYED DC.B    0
00003902                          3249              DS.W    0
00003902                          3250  
00003902                          3251  ; --- FPS RELATED VARIABLES ----------------------------------------------------
00003902                          3252  
00003902                          3253  REALFPS     DS.W    1
00003904= 47 4F 41 4C 3A 20 00    3254  STRFPS1     DC.B    'GOAL: ',0   ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
0000390B= 46 50 53 20 2D 20 ...   3255  STRFPS2     DC.B    'FPS - ACTUAL: ',0
0000391A= 46 50 53 00             3256  STRFPS3     DC.B    'FPS',0
0000391E                          3257  
0000391E                          3258  ; --- STATE RELATED VARIABLES --------------------------------------------------
0000391E                          3259  
0000391E                          3260  STACUR      DS.W    1                       ; CURRENT STATE
00003920                          3261  STANEXT     DS.W    1                       ; NEXT STATE
00003922                          3262  
00003922                          3263  
00003922                          3264  
00003922                          3265  
00003922                          3266  
00003922                          3267  -------------------- end include --------------------
00003922                          3268              INCLUDE "LIB/UTLVARS.X68"
00003922                          3269  ; =============================================================================
00003922                          3270  ; UTILITY VARIABLES
00003922                          3271  ; =============================================================================
00003922                          3272  
00003922                          3273  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00003924                          3274              DS.W    0
00003924                          3275  -------------------- end include --------------------
00003924                          3276              INCLUDE "LIB/DMMVARS.X68"
00003924                          3277  ; =============================================================================
00003924                          3278  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
00003924                          3279  ; =============================================================================
00003924                          3280  
00003940                          3281              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00003940                          3282  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
000045C0                          3283              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
000045C0                          3284  -------------------- end include --------------------
000045C0                          3285  
000045C0                          3286              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12D8
AGLADD:END          12EE
AGLKILL             10F4
AGLPLOT             1316
AGLPLOT:END         1336
AGLPLOT:LOOP        131E
AGLUPD              12F2
AGLUPD:END          1310
AGLUPD:LOOP         12FA
AUDINIT             3620
AUDPLAY             3654
BPOSX1              38F6
BPOSX2              38FA
BPOSY1              38F8
BPOSY2              38FC
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                169E
DBHV                1712
DDHL                15C8
DDHV                15E8
DF1HL               183C
DF1HV               181C
DF2HL               18AE
DF2HV               185C
DGHE                1608
DGHL                1786
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             3940
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           1900
ELEVATORMUSIC       36A2
ELEVATORPLOT        2748
ELEVATORUPDATE      2968
ELEVATOR_MUSIC      100F
ENDBLOCK            1958
ENDMAP              196A
ESMENU              297C
FIREDSOUND          3704
FPSTEXTPOS          2D01
FRAMES_PER_SECOND   32
GAMINIT             37A4
GAMPLOT             380C
GAMPLOT:NOPROJ2     381E
GAMUPD              37B2
HEAVENMUSIC         36C0
HEAVENSOUND         1000
HEAVEN_0            1D5A
HEAVEN_1            1EAA
HEAVEN_END          1FE5
HEAVEN_ROOM         2120
HELLMUSIC           36E2
HELLSOUND           1026
HELL_0              225B
HELL_1              2396
HELL_END            24D1
HELL_ROOM           260C
HLSEL               29AA
HVSEL               2998
ISCINIT             3822
ISCPLOT             383E
ISCPLOT:DONE        3872
ISCPLOT:HINT        389D
ISCPLOT:TITLE       3878
ISCUPD              3824
ISCUPD:DONE         383C
JMPLIST             1580
KBDDOWN             53
KBDEDGE             38E9
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             126E
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              127C
KBDUPD:LOOP         12C0
KBDUPD:PACK         12BC
KBDUPTN             1
KBDVAL              38E8
LIMAPA1             2A2A
LIMAPA2             2B28
LIMAPA3             2D38
LIMAPA4             2E30
LIMAPA5             2F28
LIMAPA6             30D0
LIMAPA7             3284
LIMAPA8             337C
LOADEDMAP           38FE
MAP1NODOOR          19D6
MAP1NOLIMIT1        2A68
MAP1NOLIMIT2        2A94
MAP1NOLIMIT3        2AC6
MAP1NOLIMIT4        2AF2
MAP1NOLIMITEND      2B1E
MAP2NODOOR1         1A24
MAP2NODOOR2         1A5A
MAP2NODOOR3         1A98
MAP2NODOOR4         1AD6
MAP2NOLIMIT1        2B6C
MAP2NOLIMIT10       2D2E
MAP2NOLIMIT2        2B9E
MAP2NOLIMIT3        2BD0
MAP2NOLIMIT4        2C02
MAP2NOLIMIT5        2C34
MAP2NOLIMIT6        2C66
MAP2NOLIMIT7        2C98
MAP2NOLIMIT8        2CCA
MAP2NOLIMIT9        2CFC
MAP3NODOOR          1B24
MAP3NOLIMIT1        2D76
MAP3NOLIMIT2        2DA2
MAP3NOLIMIT3        2DCE
MAP3NOLIMIT4        2DFA
MAP3NOLIMIT5        2E26
MAP4NODOOR          1B6C
MAP4NOLIMIT1        2E6E
MAP4NOLIMIT2        2E9A
MAP4NOLIMIT3        2EC6
MAP4NOLIMIT4        2EF2
MAP4NOLIMIT5        2F1E
MAP5NODOOR          1BB4
MAP5NOLIMIT1        2F66
MAP5NOLIMIT2        2F92
MAP5NOLIMIT3        2FBE
MAP5NOLIMIT4        2FEA
MAP5NOLIMIT5        3016
MAP5NOLIMIT6        3042
MAP5NOLIMIT7        306E
MAP5NOLIMIT8        309A
MAP5NOLIMIT9        30C6
MAP6NODOOR1         1C02
MAP6NODOOR2         1C38
MAP6NODOOR3         1C76
MAP6NODOOR4         1CB4
MAP6NOLIMIT1        310E
MAP6NOLIMIT10       327A
MAP6NOLIMIT2        313A
MAP6NOLIMIT3        3166
MAP6NOLIMIT5        3192
MAP6NOLIMIT6        31BE
MAP6NOLIMIT7        31EA
MAP6NOLIMIT8        321C
MAP6NOLIMIT9        3248
MAP7NODOOR          1D04
MAP7NOLIMIT1        32C2
MAP7NOLIMIT2        32EE
MAP7NOLIMIT3        331A
MAP7NOLIMIT4        3346
MAP7NOLIMIT5        3372
MAP8NODOOR1         1D54
MAP8NOLIMIT1        33BA
MAP8NOLIMIT2        33E6
MAP8NOLIMIT3        3412
MAP8NOLIMIT4        343E
MAP8NOLIMIT5        346A
MAPA1               1994
MAPA2               19DC
MAPA3               1ADC
MAPA4               1B2A
MAPA5               1B72
MAPA6               1BBA
MAPA7               1CBA
MAPA8               1D0A
MAPPLOT             14A2
MAPSEL              14BA
MAPUPD              1526
MOUINIT             12CA
MOUUPD              12CC
MOUUPTN             2
MOVEHOR             34D2
MOVEHOR:NORIGHTEDGE  34F6
MOVEHOR:NOTLEFTEDGE  34E2
MOVEVER             34F8
MOVEVER:NOLOWEREDGE  351C
MOVEVER:NOTUPPEREDGE  3508
MSCSEL              366C
MUSICPLAYED         3900
NEWLINE             1934
NEXT                1572
NOLIMIT             3474
NOLIMIT:DOWN        34B8
NOLIMIT:NOTMOVED    34CE
NOLIMIT:RIGHT       34A2
NOLIMIT:UP          348C
NOLIMITMENU         2A12
NOMUSIC             37C8
NOMUSIC:NOPROJ1     3806
NOMUSIC:NOTFIRED    37F8
NPROJ               38F4
PLAYERHEALTH        38EE
PLAYERHEIGHT        20
PLAYERINIT          29BC
PLAYERPLOT          351E
PLAYERPOSX          38F0
PLAYERPOSY          38F2
PLAYERSPEED         4
PLAYERUPD           29BE
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            3566
PROJINIT:FDOWN      359E
PROJINIT:FRIGHT     358C
PROJINIT:FUP        357C
PROJINIT:NOTFDOWN   35AC
PROJINIT:SHOOT      35B6
PROJPLOT            35DE
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             35CA
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             3902
SCRCYCCT            38EB
SCRHEIGH            1E0
SCRINIT             1150
SCRINTCT            38EA
SCRINTFPS           38EC
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             11A6
SCRTIM              124E
SCRTIM1S            125C
SCRUPTN             0
SCRWIDTH            280
STACUR              391E
STAEMPTY            37A2
STAINIT             3720
STANEXT             3920
STANONE             FFFFFFFF
STAPLOT             377E
STAPLOT:PLTTBL      379A
START               38B6
START:LOOP          38C2
START:WINT          38C8
STAUPD              3730
STAUPD:DOUPD        3756
STAUPD:INITBL       376E
STAUPD:UPDTBL       3776
STRFPS1             3904
STRFPS2             390B
STRFPS3             391A
SYSINIT             110A
TRIANGLE            2910
TRIANGLE:ISPOSITIVE  295E
TRIANGLE:UPWARDS    292C
UTLCHRWD            8
UTLINIT             133C
UTLPRINT            1352
UTLPRINT:ENDLOOP    1364
UTLPRINT:LOOP       135A
UTLRAND             1384
UTLRAND:RANDVEC     13A2
UTLRNDIX            3922
