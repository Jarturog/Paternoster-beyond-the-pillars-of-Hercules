00002796 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 16/01/2023 16:56:56

00000000                             1  ; ==============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; ==============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              INCLUDE "CONST.X68"
00001000                            11  ; ==============================================================================
00001000                            12  ; CONSTANTS
00001000                            13  ; ==============================================================================
00001000                            14  
00001000                            15  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
00001000                            16  
00001000  =00000280                 17  SCRWIDTH            EQU    640      ; SCREEN WIDTH
00001000  =000001E0                 18  SCRHEIGH            EQU    480      ; SCREEN HEIGHT
00001000  =00000032                 19  FRAMES_PER_SECOND   EQU     50      ; DESIRED SCREEN FRAMES PER SECOND
00001000  =00002D01                 20  FPSTEXTPOS          EQU    (SCRWIDTH/14)<<8|1
00001000                            21  
00001000                            22  ; --- KEYCODES -----------------------------------------------------------------
00001000                            23  
00001000  =00000041                 24  KBDLEFT     EQU     'A'
00001000  =00000057                 25  KBDUP       EQU     'W'
00001000  =00000044                 26  KBDRIGHT    EQU     'D'
00001000  =00000053                 27  KBDDOWN     EQU     'S'
00001000  =00000025                 28  KBDFLEFT    EQU     $25
00001000  =00000026                 29  KBDFUP      EQU     $26
00001000  =00000027                 30  KBDFRIGHT   EQU     $27
00001000  =00000028                 31  KBDFDOWN    EQU     $28
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS -------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPTN     EQU     1                       ; KEYBOARD UPDATE TRAP NUMBER
00001000                            37  ;no lo usas SNDPLTN     EQU     3                       ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPT NUMBERS --------------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                       ; TIMED INTERRUPT NUMBER
00001000  =00000002                 42  SCRINTFPSN  EQU     2                       ; 1 SECOND TIMED INTERRUPT NUMBER
00001000                            43  
00001000                            44  ; --- PLAYER RELATED CONSTANTS -------------------------------------------------
00001000                            45  
00001000  =00000004                 46  PLAYERSPEED     EQU     4                       ; SPEED OF MAIN PLAYER
00001000  =00000020                 47  PLAYERWIDTH     EQU     32
00001000  =00000020                 48  PLAYERHEIGHT    EQU     32
00001000                            49  
00001000                            50  ; --- PROJECTILE RELATED CONSTANTS ---------------------------------------------
00001000                            51  
00001000  =00000010                 52  PROJWIDTH       EQU     PLAYERWIDTH/2
00001000  =00000010                 53  PROJHEIGHT      EQU     PLAYERHEIGHT/2
00001000  =00000008                 54  PROJSPEEDX      EQU     8
00001000  =00000008                 55  PROJSPEEDY      EQU     8
00001000                            56  
00001000                            57  ; --- MUSIC RELATED CONSTANTS --------------------------------------------------
00001000                            58  
00001000= 53 4E 44 2F 4D 55 ...     59  HEAVENSOUND     DC.B 'SND/MUSIC1.WAV',0
0000100F= 53 4E 44 2F 45 4C ...     60  ELEVATOR_MUSIC  DC.B 'SND/ELEVATOR_MUSIC.WAV',0
00001026= 53 4E 44 2F 4D 55 ...     61  HELLSOUND       DC.B 'SND/MUSIC2.WAV',0
00001035= 53 4E 44 2F 50 52 ...     62  PROJ_SOUND      DC.B    'SND/PROJ_SOUND.WAV',0
00001048                            63  
00001048                            64  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001048                            65  
00001048  =FFFFFFFF                 66  STANONE     EQU     -1                      ; NON-EXISTENT STATE NUMBER
00001048                            67  
00001048                            68  ; --- MAP RELATED CONSTANTS ----------------------------------------------------
00001048                            69  
00001048  =00000014                 70  BLOCKSROW   EQU     20                      ; BLOCKS PER ROW
00001048  =0000000F                 71  BLOCKSCOL   EQU     15                      ; BLOCKS PER COLUMN
00001048  =00000020                 72  BLOCKSIZE   EQU     32                      ; BLOCK SIZE IN PIXELS
00001048                            73  
00001048                            74  ; --- ELEVATOR RELATED CONSTANTS -----------------------------------------------
00001048                            75  
00001048  =000000CC                 76  COLBUTHL    EQU     $000000CC
00001048  =00EEEEEE                 77  COLBUTHV    EQU     $00EEEEEE
00001048                            78  
00001048                            79  ; --- INTRO RELATED CONSTANTS --------------------------------------------------
00001048                            80  
00001048  =000000D5                 81  BTONPOSX    EQU     SCRWIDTH/3
00001048  =00000170                 82  BTONPOSY    EQU     SCRHEIGH-112
00001048  =000000DA                 83  BTONWIDTH   EQU     218
00001048  =00000020                 84  BTONHEIGHT  EQU     32
00001048                            85  
00001048                            86  ; --- OBSTACLE RELATED CONSTANTS -----------------------------------------------
00001048                            87  
00001048  =00000020                 88  OBSWIDTH    EQU     32
00001048  =00000020                 89  OBSHEIGHT   EQU     32
00001048  =00000008                 90  MAXOBSXROOM EQU     8
00001048                            91  
00001048                            92  
00001048                            93  
00001048                            94  
00001048                            95  
00001048                            96  
00001048                            97  
00001048                            98  
00001048                            99  
00001048                           100  
00001048                           101  
00001048                           102  
00001048                           103  
00001048                           104  
00001048                           105  -------------------- end include --------------------
00001048                           106              INCLUDE "LIB/DMMCONST.X68"
00001048                           107  ; =============================================================================
00001048                           108  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001048                           109  ; =============================================================================
00001048                           110  
00001048  =00000040                111  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001048  =00000032                112  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001048  =00000000                113  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001048  =00000000                114  -------------------- end include --------------------
00001048                           115              INCLUDE "LIB/UTLCONST.X68"         
00001048                           116  ; ==============================================================================
00001048                           117  ; UTIL CONSTANTS
00001048                           118  ; ==============================================================================
00001048                           119  
00001048  =00000008                120  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001048  =00000008                121  -------------------- end include --------------------
00001048                           122              INCLUDE "LIB/DMMCODE.X68"
00001048                           123  ; =============================================================================
00001048                           124  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001048                           125  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001048                           126  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001048                           127  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001048                           128  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001048                           129  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001048                           130  ; =============================================================================
00001048                           131  
00001048                           132  ; -----------------------------------------------------------------------------
00001048                           133  DMMINIT
00001048                           134  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001048                           135  ; INPUT    - NONE
00001048                           136  ; OUTPUT   - NONE
00001048                           137  ; MODIFIES - NONE
00001048                           138  ; -----------------------------------------------------------------------------
00001048  48E7 8080                139              MOVEM.L D0/A0,-(A7)
0000104C  41F9 00002880            140              LEA     DMMDATA,A0
00001052  303C 0031                141              MOVE.W  #DMMBNUM-1,D0
00001056  30BC 0000                142  .LOOP       MOVE.W  #DMMSYSID,(A0)
0000105A  D1FC 00000040            143              ADD.L   #DMMBSIZE,A0
00001060  51C8 FFF4                144              DBRA.W  D0,.LOOP
00001064  4CDF 0101                145              MOVEM.L (A7)+,D0/A0
00001068  4E75                     146              RTS
0000106A                           147  
0000106A                           148  ; -----------------------------------------------------------------------------
0000106A                           149  DMMFIRST
0000106A                           150  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000106A                           151  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000106A                           152  ; INPUT    - NONE
0000106A                           153  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000106A                           154  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000106A                           155  ; -----------------------------------------------------------------------------
0000106A  41F9 00002880            156              LEA     DMMDATA,A0
00001070  4A58                     157  DMMFRLOP    TST.W   (A0)+
00001072  6600 0016                158              BNE     DMMFRFND
00001076  D1FC 0000003E            159              ADD.L   #DMMBSIZE-2,A0
0000107C  B1FC 000034FF            160  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001082  6DEC                     161              BLT     DMMFRLOP
00001084  207C 00000000            162              MOVE.L  #0,A0
0000108A  4E75                     163  DMMFRFND    RTS
0000108C                           164  
0000108C                           165  ; -----------------------------------------------------------------------------
0000108C                           166  DMMNEXT
0000108C                           167  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
0000108C                           168  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000108C                           169  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
0000108C                           170  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000108C                           171  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000108C                           172  ; -----------------------------------------------------------------------------
0000108C  2F00                     173              MOVE.L  D0,-(A7)
0000108E  2008                     174              MOVE.L  A0,D0
00001090  C0BC FFFFFFC0            175              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001096  0680 00000040            176              ADD.L   #DMMBSIZE,D0
0000109C  2040                     177              MOVE.L  D0,A0
0000109E  201F                     178              MOVE.L  (A7)+,D0
000010A0  60DA                     179              BRA     DMMFRCOM
000010A2                           180  
000010A2                           181  ; -----------------------------------------------------------------------------
000010A2                           182  DMMFRSTO
000010A2                           183  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010A2                           184  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010A2                           185  ; INPUT    - D0.W : ID TO SEARCH
000010A2                           186  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010A2                           187  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010A2                           188  ; -----------------------------------------------------------------------------
000010A2  41F9 00002880            189              LEA     DMMDATA,A0
000010A8  B058                     190  DMMFLOOP    CMP.W   (A0)+,D0
000010AA  6700 0016                191              BEQ     DMMFFND
000010AE  D1FC 0000003E            192              ADD.L   #DMMBSIZE-2,A0
000010B4  B1FC 000034FF            193  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000010BA  6DEC                     194              BLT     DMMFLOOP
000010BC  207C 00000000            195              MOVE.L  #0,A0
000010C2  4E75                     196  DMMFFND     RTS
000010C4                           197  
000010C4                           198  ; -----------------------------------------------------------------------------
000010C4                           199  DMMNEXTO
000010C4                           200  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000010C4                           201  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000010C4                           202  ; INPUT    - D0.W : ID TO SEARCH
000010C4                           203  ;            A0   : POINTER WITHIN THE CURRENT SLOT
000010C4                           204  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000010C4                           205  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010C4                           206  ; -----------------------------------------------------------------------------
000010C4  2F00                     207              MOVE.L  D0,-(A7)
000010C6  2008                     208              MOVE.L  A0,D0
000010C8  C0BC FFFFFFC0            209              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010CE  0680 00000040            210              ADD.L   #DMMBSIZE,D0
000010D4  2040                     211              MOVE.L  D0,A0
000010D6  201F                     212              MOVE.L  (A7)+,D0
000010D8  60DA                     213              BRA     DMMFCOM
000010DA                           214  
000010DA                           215  ; -----------------------------------------------------------------------------
000010DA                           216  DMMALLOC
000010DA                           217  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000010DA                           218  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000010DA                           219  ; INPUT    - D0.W : ID TO ASSIGN
000010DA                           220  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000010DA                           221  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010DA                           222  ; -----------------------------------------------------------------------------
000010DA  3F00                     223              MOVE.W  D0,-(A7)
000010DC  4240                     224              CLR.W   D0
000010DE  4EB8 10A2                225              JSR     DMMFRSTO
000010E2  301F                     226              MOVE.W  (A7)+,D0
000010E4  B1FC 00000000            227              CMP.L   #0,A0
000010EA  6700 0006                228              BEQ     .END
000010EE  3140 FFFE                229              MOVE.W  D0,-2(A0)
000010F2  4E75                     230  .END        RTS
000010F4                           231  
000010F4                           232  ; -----------------------------------------------------------------------------
000010F4                           233  DMMFREE
000010F4                           234  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010F4                           235  ; SYSTEM (0)
000010F4                           236  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010F4                           237  ; OUTPUT   - NONE
000010F4                           238  ; MODIFIES - NONE
000010F4                           239  ; -----------------------------------------------------------------------------
000010F4  48E7 8080                240              MOVEM.L D0/A0,-(A7)
000010F8  2008                     241              MOVE.L  A0,D0
000010FA  C0BC FFFFFFC0            242              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001100  2040                     243              MOVE.L  D0,A0
00001102  4250                     244              CLR.W   (A0)
00001104  4CDF 0101                245              MOVEM.L (A7)+,D0/A0
00001108  4E75                     246              RTS
00001108  4E75                     247  -------------------- end include --------------------
0000110A                           248              INCLUDE "SYSTEM.X68"
0000110A                           249  ; ==============================================================================
0000110A                           250  ; SYSTEM
0000110A                           251  ; ==============================================================================
0000110A                           252              
0000110A                           253  ; ------------------------------------------------------------------------------
0000110A                           254  SYSINIT
0000110A                           255  ; INITIALIZE SYSTEM AND ENABLES INTERRUPTIONS
0000110A                           256  ; INPUT    : NONE
0000110A                           257  ; OUTPUT   : NONE
0000110A                           258  ; MODIFIES : NONE
0000110A                           259  ; ------------------------------------------------------------------------------
0000110A                           260  
0000110A  21FC 00001198 0080       261              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001112  21FC 0000126E 0084       262              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
0000111A  21FC 00001240 0064       263              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001122  21FC 0000124E 0068       264              MOVE.L  #SCRTIM1S,($60+SCRINTFPSN*4)
0000112A                           265              
0000112A  4EB8 1048                266              JSR     DMMINIT
0000112E  4EB9 00001142            267              JSR     SCRINIT
00001134  4EB9 00001260            268              JSR     KBDINIT 
0000113A                           269              
0000113A  40E7                     270              MOVE.W  SR,-(A7)
0000113C  0257 D8FF                271              ANDI.W  #$D8FF,(A7)     ; ENABLES INTERRUPTIONS AND 
00001140  4E73                     272              RTE
00001142                           273              
00001142                           274  ; ------------------------------------------------------------------------------
00001142                           275  SCRINIT
00001142                           276  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001142                           277  ; ENABLE DOUBLE BUFFER.
00001142                           278  ; INPUT    : NONE
00001142                           279  ; OUTPUT   : NONE
00001142                           280  ; MODIFIES : NONE
00001142                           281  ; ------------------------------------------------------------------------------
00001142                           282  
00001142  48E7 F000                283              MOVEM.L D0-D3,-(A7)
00001146                           284  
00001146                           285              ; SET SCREEN RESOLUTION
00001146  103C 0021                286              MOVE.B  #33,D0
0000114A  223C 028001E0            287              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001150  4E4F                     288              TRAP    #15
00001152                           289              
00001152                           290              ; SET WINDOWED MODE
00001152  7201                     291              MOVE.L  #1,D1
00001154  4E4F                     292              TRAP    #15
00001156                           293              
00001156                           294              ; CLEAR SCREEN
00001156  103C 000B                295              MOVE.B  #11,D0
0000115A  323C FF00                296              MOVE.W  #$FF00,D1
0000115E  4E4F                     297              TRAP    #15
00001160                           298  
00001160                           299              ; ENABLE DOUBLE BUFFER
00001160  103C 005C                300              MOVE.B  #92,D0
00001164  123C 0011                301              MOVE.B  #17,D1
00001168  4E4F                     302              TRAP    #15
0000116A                           303              
0000116A                           304              ; ENABLE BOTH TIMED INTERRUPT
0000116A  103C 0020                305              MOVE.B  #32,D0
0000116E  123C 0006                306              MOVE.B  #6,D1
00001172  143C 0081                307              MOVE.B  #$80|SCRINTN,D2
00001176  7614                     308              MOVE.L  #1000/FRAMES_PER_SECOND,D3
00001178  4E4F                     309              TRAP    #15
0000117A  143C 0082                310              MOVE.B  #$80|SCRINTFPSN,D2
0000117E  263C 000003E8            311              MOVE.L  #1000,D3
00001184  4E4F                     312              TRAP    #15
00001186                           313              
00001186                           314              ; CLEAR INTERRUPT COUNTER
00001186  4279 000027CA            315              CLR.W   (SCRINTCT)
0000118C  4239 000027CC            316              CLR.B   (SCRINTFPS) 
00001192                           317              
00001192  4CDF 000F                318              MOVEM.L (A7)+,D0-D3
00001196                           319              
00001196  4E75                     320              RTS
00001198                           321  
00001198                           322  ; ------------------------------------------------------------------------------
00001198                           323  SCRPLOT
00001198                           324  ; UPDATES DOUBLE BUFFER
00001198                           325  ; INPUT    : NONE
00001198                           326  ; OUTPUT   : NONE
00001198                           327  ; MODIFIES : NONE
00001198                           328  ; ------------------------------------------------------------------------------
00001198  48E7 E000                329              MOVEM.L D0-D2,-(A7)
0000119C  2F09                     330              MOVE.L  A1,-(A7)
0000119E                           331              
0000119E                           332              ; PLOT ACTUAL FPS AND GOAL FPS
0000119E                           333              
0000119E  103C 0051                334              MOVE.B  #81,D0
000011A2  7200                     335              MOVE.L  #$00000000,D1 ; FILL COLOR
000011A4  4E4F                     336              TRAP    #15
000011A6                           337              
000011A6  103C 0050                338              MOVE.B  #80,D0
000011AA  223C 00FFFFFF            339              MOVE.L  #$00FFFFFF,D1 ; PEN COLOR
000011B0  4E4F                     340              TRAP    #15
000011B2                           341              
000011B2  103C 000B                342              MOVE.B  #11,D0
000011B6  223C 00002D01            343              MOVE.L  #FPSTEXTPOS,D1 ; SET FPS TEXT POSITION
000011BC  4E4F                     344              TRAP    #15
000011BE                           345              
000011BE  43F9 0000282C            346              LEA.L   STRFPS1,A1 
000011C4  103C 000E                347              MOVE.B  #14,D0  ; PLOT 'GOAL: '
000011C8  4E4F                     348              TRAP    #15
000011CA                           349              
000011CA  103C 000B                350              MOVE.B  #11,D0
000011CE  323C 3601                351              MOVE.W  #FPSTEXTPOS+9<<8,D1 ; SET NEXT FPS TEXT POSITION
000011D2  4E4F                     352              TRAP    #15
000011D4                           353              
000011D4  5E89                     354              ADDA.L  #7,A1 ; PLOT 'FPS - ACTUAL: '
000011D6  103C 000E                355              MOVE.B  #14,D0  
000011DA  4E4F                     356              TRAP    #15 
000011DC                           357              
000011DC  103C 000B                358              MOVE.B  #11,D0
000011E0  323C 4701                359              MOVE.W  #FPSTEXTPOS+26<<8,D1 ; SET NEXT FPS TEXT POSITION
000011E4  4E4F                     360              TRAP    #15
000011E6                           361              
000011E6  D3FC 0000000F            362              ADDA.L  #15,A1 ; PLOT 'FPS'
000011EC  103C 000E                363              MOVE.B  #14,D0 
000011F0  4E4F                     364              TRAP    #15
000011F2                           365              
000011F2  0643 0014                366              ADD.W   #20,D3
000011F6  103C 000B                367              MOVE.B  #11,D0
000011FA  323C 3301                368              MOVE.W  #FPSTEXTPOS+6<<8,D1 ; SET FPS NUMBER POSITION
000011FE  4E4F                     369              TRAP    #15
00001200                           370              
00001200  7232                     371              MOVE.L  #FRAMES_PER_SECOND,D1
00001202  740A                     372              MOVE.L  #10,D2
00001204  103C 000F                373              MOVE.B  #15,D0  ; PLOT GOAL NUMBER OF FPS
00001208  4E4F                     374              TRAP    #15
0000120A                           375              
0000120A  0643 0014                376              ADD.W   #20,D3
0000120E  103C 000B                377              MOVE.B  #11,D0
00001212  323C 4401                378              MOVE.W  #FPSTEXTPOS+23<<8,D1 ; SET FPS NUMBER POSITION
00001216  4E4F                     379              TRAP    #15
00001218                           380              
00001218  4281                     381              CLR.L   D1
0000121A  1239 0000282A            382              MOVE.B  (REALFPS),D1
00001220  740A                     383              MOVE.L  #10,D2
00001222  103C 000F                384              MOVE.B  #15,D0  ; PLOT REAL NUMBER OF FPS
00001226  4E4F                     385              TRAP    #15
00001228                           386              
00001228                           387              ; SWITCH BUFFERS
00001228  103C 005E                388              MOVE.B  #94,D0
0000122C  4E4F                     389              TRAP    #15
0000122E                           390              
0000122E                           391              ; CLEAR HIDDEN BUFFER
0000122E  103C 000B                392              MOVE.B  #11,D0
00001232  323C FF00                393              MOVE.W  #$FF00,D1
00001236  4E4F                     394              TRAP    #15
00001238                           395              
00001238  225F                     396              MOVE.L  (A7)+,A1
0000123A  4CDF 0007                397              MOVEM.L (A7)+,D0-D2
0000123E  4E73                     398              RTE
00001240                           399              
00001240                           400  ; ------------------------------------------------------------------------------
00001240                           401  SCRTIM
00001240                           402  ; TIMED INTERRUPT SERVICE ROUTINE
00001240                           403  ; INPUT    : NONE
00001240                           404  ; OUTPUT   : NONE
00001240                           405  ; MODIFIES : NONE
00001240                           406  ; ------------------------------------------------------------------------------
00001240  5239 000027CA            407              ADDQ.B  #1,(SCRINTCT)
00001246  5239 000027CB            408              ADDQ.B  #1,(SCRCYCCT)
0000124C  4E73                     409              RTE
0000124E                           410              
0000124E                           411  ; ------------------------------------------------------------------------------
0000124E                           412  SCRTIM1S
0000124E                           413  ; TIMED INTERRUPT SERVICE ROUTINE FOR ONE SECOND
0000124E                           414  ; INPUT    : NONE
0000124E                           415  ; OUTPUT   : NONE
0000124E                           416  ; MODIFIES : NONE
0000124E                           417  ; ------------------------------------------------------------------------------
0000124E  13F9 000027CC 0000282A   418              MOVE.B  (SCRINTFPS),REALFPS
00001258  4239 000027CC            419              CLR.B   SCRINTFPS
0000125E  4E73                     420              RTE
00001260                           421  
00001260                           422  ; ------------------------------------------------------------------------------
00001260                           423  KBDINIT
00001260                           424  ; INIT KEYBOARD
00001260                           425  ; INPUT    : NONE
00001260                           426  ; OUTPUT   : NONE
00001260                           427  ; MODIFIES : NONE
00001260                           428  ; ------------------------------------------------------------------------------
00001260  4239 000027C8            429              CLR.B   (KBDVAL)
00001266  4239 000027C9            430              CLR.B   (KBDEDGE)
0000126C  4E75                     431              RTS
0000126E                           432  
0000126E                           433  ; ------------------------------------------------------------------------------
0000126E                           434  KBDUPD
0000126E                           435  ; UPDATE KEYBOARD INFO.  
0000126E                           436  ; 7 -> FIRE DOWN
0000126E                           437  ; 6 -> FIRE RIGHT
0000126E                           438  ; 5 -> FIRE UP
0000126E                           439  ; 4 -> FIRE LEFT
0000126E                           440  ; 3 -> DOWN
0000126E                           441  ; 2 -> RIGHT
0000126E                           442  ; 1 -> UP
0000126E                           443  ; 0 -> LEFT
0000126E                           444  ; INPUT    : NONE
0000126E                           445  ; OUTPUT   : NONE
0000126E                           446  ; MODIFIES : NONE
0000126E                           447  ; ------------------------------------------------------------------------------
0000126E                           448  
0000126E  48E7 F000                449              MOVEM.L D0-D3,-(A7)
00001272                           450  
00001272                           451              ; READ FIRST PART
00001272  103C 0013                452              MOVE.B  #19,D0
00001276  223C 28272625            453              MOVE.L  #KBDFDOWN<<24|KBDFRIGHT<<16|KBDFUP<<8|KBDFLEFT,D1 ;DEVUELVE FF SI ESTÃ PULSADA LA TECLA ESPECIFICADA, 00 SI NO. 
0000127C  4E4F                     454              TRAP    #15
0000127E                           455              
0000127E                           456              ; CONVERT TO DESIRED FORMAT (DEJA EL RESULTADO EN D2 EN EL ORDEN ESPECIFICADO ARRIBA) 
0000127E  4EB9 000012AE            457              JSR     .PACK
00001284                           458  
00001284                           459              ; READ SECOND PART
00001284  223C 53445741            460              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000128A  4E4F                     461              TRAP    #15
0000128C                           462  
0000128C                           463              ; CONVERT TO DESIRED FORMAT
0000128C  4EB9 000012AE            464              JSR     .PACK
00001292                           465              
00001292                           466              ; COMPUTE KBDEDGE
00001292  1039 000027C8            467              MOVE.B  (KBDVAL),D0
00001298  4600                     468              NOT.B   D0
0000129A  C002                     469              AND.B   D2,D0
0000129C  13C0 000027C9            470              MOVE.B  D0,(KBDEDGE)
000012A2                           471              
000012A2                           472              ; STORE KBDVAL
000012A2  13C2 000027C8            473              MOVE.B  D2,(KBDVAL)
000012A8                           474              
000012A8  4CDF 000F                475              MOVEM.L (A7)+,D0-D3
000012AC                           476  
000012AC  4E73                     477              RTE
000012AE                           478              
000012AE  363C 0003                479  .PACK       MOVE.W  #3,D3
000012B2  E189                     480  .LOOP       LSL.L   #8,D1
000012B4  E312                     481              ROXL.B  #1,D2
000012B6  51CB FFFA                482              DBRA.W  D3,.LOOP
000012BA  4E75                     483              RTS
000012BC                           484  
000012BC                           485  
000012BC                           486  
000012BC                           487  -------------------- end include --------------------
000012BC                           488              INCLUDE "LIB/AGLCODE.X68"
000012BC                           489  ; =============================================================================
000012BC                           490  ; AGENT MANAGEMENT
000012BC                           491  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000012BC                           492  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000012BC                           493  ; +4 - LONG : PLOT SUBROUTINE POINTER
000012BC                           494  ; +8:END    : DATA (AGENT SPECIFIC)
000012BC                           495  ; =============================================================================
000012BC                           496  
000012BC                           497  ; -----------------------------------------------------------------------------
000012BC                           498  AGLADD
000012BC                           499  ; CREATES A NEW AGENT
000012BC                           500  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000012BC                           501  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000012BC                           502  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000012BC                           503  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000012BC                           504  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000012BC                           505  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000012BC                           506  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000012BC                           507  ; OUTPUT   - NONE
000012BC                           508  ; MODIFIES - NONE
000012BC                           509  ; -----------------------------------------------------------------------------
000012BC  2F08                     510              MOVE.L  A0,-(A7)
000012BE  4EB8 10DA                511              JSR     DMMALLOC
000012C2  B1FC 00000000            512              CMP.L   #0,A0
000012C8  6700 0008                513              BEQ     .END
000012CC  20CA                     514              MOVE.L  A2,(A0)+
000012CE  20CB                     515              MOVE.L  A3,(A0)+
000012D0  4E91                     516              JSR     (A1)
000012D2  205F                     517  .END        MOVE.L  (A7)+,A0
000012D4  4E75                     518              RTS
000012D6                           519  
000012D6                           520  ; -----------------------------------------------------------------------------
000012D6                           521  AGLUPD
000012D6                           522  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012D6                           523  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012D6                           524  ; INPUT    - NONE
000012D6                           525  ; OUTPUT   - NONE
000012D6                           526  ; MODIFIES - NONE
000012D6                           527  ; -----------------------------------------------------------------------------
000012D6  48E7 00C0                528              MOVEM.L A0-A1,-(A7)
000012DA  4EB8 106A                529              JSR     DMMFIRST
000012DE  B1FC 00000000            530  .LOOP       CMP.L   #0,A0
000012E4  6700 000E                531              BEQ     .END
000012E8  2250                     532              MOVE.L  (A0),A1
000012EA  5088                     533              ADD.L   #8,A0
000012EC  4E91                     534              JSR     (A1)
000012EE  4EB8 108C                535              JSR     DMMNEXT
000012F2  60EA                     536              BRA     .LOOP
000012F4  4CDF 0300                537  .END        MOVEM.L (A7)+,A0-A1
000012F8  4E75                     538              RTS
000012FA                           539  
000012FA                           540  ; -----------------------------------------------------------------------------
000012FA                           541  AGLPLOT
000012FA                           542  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012FA                           543  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012FA                           544  ; INPUT    - NONE
000012FA                           545  ; OUTPUT   - NONE
000012FA                           546  ; MODIFIES - NONE
000012FA                           547  ; -----------------------------------------------------------------------------
000012FA  48E7 00C0                548              MOVEM.L A0-A1,-(A7)
000012FE  4EB8 106A                549              JSR     DMMFIRST
00001302  B1FC 00000000            550  .LOOP       CMP.L   #0,A0
00001308  6700 0010                551              BEQ     .END
0000130C  2268 0004                552              MOVE.L  4(A0),A1
00001310  5088                     553              ADD.L   #8,A0
00001312  4E91                     554              JSR     (A1)
00001314  4EB8 108C                555              JSR     DMMNEXT
00001318  60E8                     556              BRA     .LOOP
0000131A  4CDF 0300                557  .END        MOVEM.L (A7)+,A0-A1
0000131E  4E75                     558              RTS
00001320                           559  
00001320                           560  ; -----------------------------------------------------------------------------
00001320  =000010F4                561  AGLKILL     EQU     DMMFREE
00001320                           562  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001320                           563  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001320                           564  ; OUTPUT   - NONE
00001320                           565  ; MODIFIES - NONE
00001320                           566  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001320                           567  ; -----------------------------------------------------------------------------
00001320                           568  -------------------- end include --------------------
00001320                           569              INCLUDE "LIB/UTLCODE.X68"
00001320                           570  ; =============================================================================
00001320                           571  ; UTILITY CODE
00001320                           572  ; =============================================================================
00001320                           573  
00001320                           574  ; -----------------------------------------------------------------------------
00001320                           575  UTLINIT
00001320                           576  ; INITIALIZES UTILITY CODE
00001320                           577  ; INPUT    - NONE
00001320                           578  ; OUTPUT   - NONE
00001320                           579  ; MODIFIES - NONE
00001320                           580  ; -----------------------------------------------------------------------------
00001320  48E7 C000                581              MOVEM.L D0-D1,-(A7)
00001324  103C 0008                582              MOVE.B  #8,D0
00001328  4E4F                     583              TRAP    #15
0000132A  13C1 0000284C            584              MOVE.B  D1,(UTLRNDIX)
00001330  4CDF 0003                585              MOVEM.L (A7)+,D0-D1
00001334  4E75                     586              RTS
00001336                           587  
00001336                           588  ; -----------------------------------------------------------------------------
00001336                           589  UTLPRINT
00001336                           590  ; PRINT SCREEN CENTERED TEXT
00001336                           591  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001336                           592  ;            D0.B SCREEN ROW TO PRINT TEXT
00001336                           593  ; OUTPUT   : D0.B NEXT ROW
00001336                           594  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001336                           595  ; -----------------------------------------------------------------------------
00001336  48E7 C0C0                596              MOVEM.L D0-D1/A0-A1,-(A7)
0000133A  4201                     597              CLR.B   D1
0000133C  2248                     598              MOVE.L  A0,A1
0000133E  4A18                     599  .LOOP       TST.B   (A0)+
00001340  6700 0006                600              BEQ     .ENDLOOP
00001344  5201                     601              ADDQ.B  #1,D1
00001346  60F6                     602              BRA     .LOOP
00001348  E209                     603  .ENDLOOP    LSR.B   #1,D1
0000134A  0401 0028                604              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000134E  4401                     605              NEG.B   D1
00001350  E141                     606              ASL.W   #8,D1
00001352  8240                     607              OR.W    D0,D1
00001354  103C 000B                608              MOVE.B  #11,D0
00001358  4E4F                     609              TRAP    #15
0000135A  103C 000D                610              MOVE.B  #13,D0
0000135E  4E4F                     611              TRAP    #15
00001360  4CDF 0303                612              MOVEM.L (A7)+,D0-D1/A0-A1
00001364  5200                     613              ADDQ.B  #1,D0
00001366  4E75                     614              RTS
00001368                           615  
00001368                           616  ; -----------------------------------------------------------------------------
00001368                           617  UTLCHCOLL
00001368                           618  ; CHECKS COLLISION
00001368                           619  ; INPUT    - D0.W X0 COORDINATE
00001368                           620  ;            D1.W Y0 COORDINATE
00001368                           621  ;            D2.W X1 COORDINATE
00001368                           622  ;            D3.W Y1 COORDINATE
00001368                           623  ;            D4.W WIDTH 0
00001368                           624  ;            D5.W WIDTH 1
00001368                           625  ;            D6.W HEIGHT 0
00001368                           626  ;            D7.W HEIGHT 1
00001368                           627  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
00001368                           628  ; MODIFIES - NONE
00001368                           629  ; -----------------------------------------------------------------------------
00001368  48A7 0F00                630              MOVEM.W D4-D7,-(A7)
0000136C  D840                     631              ADD.W   D0,D4
0000136E  B842                     632              CMP.W   D2,D4
00001370  6F00 0022                633              BLE     .NOCOL
00001374  DA42                     634              ADD.W   D2,D5
00001376  BA40                     635              CMP.W   D0,D5
00001378  6F00 001A                636              BLE     .NOCOL
0000137C  DC41                     637              ADD.W   D1,D6
0000137E  BC43                     638              CMP.W   D3,D6
00001380  6F00 0012                639              BLE     .NOCOL
00001384  DE43                     640              ADD.W   D3,D7
00001386  BE41                     641              CMP.W   D1,D7
00001388  6F00 000A                642              BLE     .NOCOL
0000138C  103C 00FF                643              MOVE.B  #$FF,D0
00001390  6000 0004                644              BRA     .END
00001394  4200                     645  .NOCOL      CLR.B   D0
00001396  4C9F 00F0                646  .END        MOVEM.W (A7)+,D4-D7
0000139A  4E75                     647              RTS
0000139C                           648  
0000139C                           649  ; -----------------------------------------------------------------------------
0000139C                           650  UTLRAND
0000139C                           651  ; PROVIDES A PSEUDO-RANDOM BYTE
0000139C                           652  ; INPUT    - NONE
0000139C                           653  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
0000139C                           654  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000139C                           655  ; -----------------------------------------------------------------------------
0000139C  2F08                     656              MOVE.L  A0,-(A7)
0000139E  41F9 000013BA            657              LEA     .RANDVEC,A0
000013A4  4280                     658              CLR.L   D0
000013A6  1039 0000284C            659              MOVE.B  (UTLRNDIX),D0
000013AC  1030 0800                660              MOVE.B  (A0,D0.L),D0
000013B0  5239 0000284C            661              ADDQ.B  #1,(UTLRNDIX)
000013B6  205F                     662              MOVE.L  (A7)+,A0
000013B8  4E75                     663              RTS
000013BA                           664  
000013BA                           665  
000013BA= A2 EE 9A 0C F5 24 ...    666  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000013C2= 2A A3 51 26 E0 AC ...    667              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000013CA= 75 51 CA FD 33 EB ...    668              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000013D2= 60 CC E7 B8 9A EB ...    669              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013DA= 1D 76 B5 95 B0 89 ...    670              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013E2= 39 15 48 C9 6E CA ...    671              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013EA= 43 E7 E2 7C 37 25 ...    672              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013F2= E9 94 CE E9 E4 52 ...    673              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013FA= 37 6D 9A 84 A2 28 ...    674              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001402= 19 E2 C6 77 80 D4 ...    675              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
0000140A= 0A 5A 32 67 33 C2 ...    676              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001412= 59 80 DC 0E 57 FC ...    677              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000141A= 8A AB BC F7 07 4D ...    678              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001422= EF D5 77 6E 1E BB ...    679              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
0000142A= D6 E0 2A 8F BD 28 ...    680              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001432= 13 4F 66 EC 0A 64 ...    681              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
0000143A= 56 52 9A 16 9B 90 ...    682              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001442= 06 8A A4 F7 01 DA ...    683              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
0000144A= F2 E7 77 28 B1 76 ...    684              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001452= A4 42 E3 81 B1 67 ...    685              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000145A= BF CE FA 16 BF 38 ...    686              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001462= D1 8B 50 0C 5F 49 ...    687              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000146A= DE 4C 14 A2 40 DC ...    688              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001472= B6 9B 0A 38 5D AB ...    689              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000147A= E2 1B DD 75 15 82 ...    690              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001482= 8A 26 51 30 9F 47 ...    691              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
0000148A= 1E 8A BB 71 C6 6E ...    692              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001492= 9F 47 E5 34 94 27 ...    693              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000149A= 7D 06 D6 BA 30 0F ...    694              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000014A2= EC 7F 7E 03 CF 2D ...    695              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000014AA= 94 5B 23 F2 8B CD ...    696              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000014B2= 74 33 EC B9 0F D5 ...    697              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000014BA                           698  
000014BA                           699  
000014BA                           700  
000014BA                           701  -------------------- end include --------------------
000014BA                           702              INCLUDE "BLOCKS.X68"
000014BA                           703  
000014BA                           704  ; -----------------------------------------------------------------------------
000014BA                           705  ISBLWHICHCOLL 
000014BA                           706  ; CHECKS IF THE BLOCK IN D4 PRODUCES COLLISIONS
000014BA                           707  ; INPUT    - D4.B
000014BA                           708  ; OUTPUT   - ALL 1'S IF D4.L PRODUCES COLLISIONS, ALL 0'S IF NOT
000014BA                           709  ; MODIFIES - D4.L, A0
000014BA                           710  ; -----------------------------------------------------------------------------
000014BA  41F9 000027DE            711              LEA.L   BLWHICHCOLL, A0
000014C0  4A10                     712  .BNEXTCHCK  TST.B   (A0)
000014C2  6712                     713              BEQ.B   .BNOCOLL
000014C4  B810                     714              CMP.B   (A0),D4
000014C6  6704                     715              BEQ.B   .BCOLL
000014C8  5288                     716              ADDA.L  #1,A0
000014CA  60F4                     717              BRA     .BNEXTCHCK
000014CC  0084 FFFFFFFF            718  .BCOLL      ORI.L   #$FFFFFFFF, D4
000014D2  6000 0004                719              BRA     .BEND
000014D6  4284                     720  .BNOCOLL    CLR.L   D4
000014D8                           721  .BEND
000014D8  4E75                     722              RTS
000014DA                           723  
000014DA                           724  ; -----------------------------------------------------------------------------
000014DA                           725  BLKCOLL 
000014DA                           726  ; DETECTS BLOCK COLLISIONS
000014DA                           727  ; INPUT    - D0 TOP LEFT CORNER OF OBJECT, D1 BOTTOM RIGHT, WHERE UPPER WORD
000014DA                           728  ;            IS THE X COORDINATE AND LOWER WORD Y COORDINATE
000014DA                           729  ; OUTPUT   - ALL 1'S IN THE THE REGISTER THAT COLLIDES WITH A BLOCK
000014DA                           730  ;            THAT CANNOT BE TRAVERSED. THESE ARE D0 FOR LEFT UPPER BLOCK,
000014DA                           731  ;            D1 FOR RIGHT UPPER BLOCK, D2 FOR LEFT LOWER BLOCK AND D3 FOR 
000014DA                           732  ;            RIGHT LOWER BLOCK
000014DA                           733  ; MODIFIES - D0.L, D1.L, D2.L, D3.L
000014DA                           734  ; -----------------------------------------------------------------------------
000014DA  48E7 0EC0                735              MOVEM.L D4-D6/A0-A1,-(A7)
000014DE                           736              
000014DE  7810                     737              MOVE.L  #16,D4
000014E0  3400                     738              MOVE.W  D0,D2   ; D2 CONTAINS X LEFT
000014E2  E8A8                     739              LSR.L   D4,D0   ; D0 CONTAINS Y UPPER
000014E4  3601                     740              MOVE.W  D1,D3   ; D3 CONTAINS X RIGHT
000014E6  E8A9                     741              LSR.L   D4,D1   ; D1 CONTAINS Y LOWER
000014E8                           742              
000014E8  48C0                     743              EXT.L   D0
000014EA  48C1                     744              EXT.L   D1
000014EC  48C2                     745              EXT.L   D2
000014EE  48C3                     746              EXT.L   D3
000014F0                           747              
000014F0  80FC 0020                748              DIVU.W  #BLOCKSIZE,D0   ; LEFT BLOCK
000014F4  82FC 0020                749              DIVU.W  #BLOCKSIZE,D1   ; RIGHT BLOCK
000014F8  84FC 0020                750              DIVU.W  #BLOCKSIZE,D2   ; UPPER BLOCK
000014FC  86FC 0020                751              DIVU.W  #BLOCKSIZE,D3   ; LOWER BLOCK
00001500                           752              
00001500  48C0                     753              EXT.L   D0
00001502  48C1                     754              EXT.L   D1
00001504  48C2                     755              EXT.L   D2
00001506  48C3                     756              EXT.L   D3
00001508                           757              
00001508  7815                     758              MOVE.L  #BLOCKSROW+1,D4 ; +1 BECAUSE OF NULL
0000150A  C8C2                     759              MULU.W  D2,D4           ; INDEX OF COLUMN OF UPPER LEFT AND RIGHT BLOCKS
0000150C  7A15                     760              MOVE.L  #BLOCKSROW+1,D5 ; +1 BECAUSE OF NULL
0000150E  CAC3                     761              MULU.W  D3,D5           ; INDEX OF COLUMN OF LOWER LEFT AND RIGHT BLOCKS
00001510                           762              
00001510  3C39 000027E2            763              MOVE.W  (LOADEDMAP),D6
00001516  48C6                     764              EXT.L   D6
00001518  CCFC 0004                765              MULU    #4,D6
0000151C  41F9 00002804            766              LEA.L   MAPLIST,A0
00001522  D1C6                     767              ADDA.L  D6,A0
00001524  2050                     768              MOVEA.L (A0),A0         ; CURRENT MAP ADDRESS
00001526                           769              
00001526  2248                     770              MOVEA.L A0,A1
00001528  D3C5                     771              ADDA.L  D5,A1   
0000152A  D3C1                     772              ADDA.L  D1,A1           ; RIGHT LOWER BLOCK
0000152C  1611                     773              MOVE.B  (A1),D3         ; STORING BOTTOM RIGHT BLOCK IN D3
0000152E                           774              
0000152E  2248                     775              MOVEA.L A0,A1
00001530  D3C5                     776              ADDA.L  D5,A1   
00001532  D3C0                     777              ADDA.L  D0,A1           ; LEFT LOWER BLOCK
00001534  1411                     778              MOVE.B  (A1),D2         ; STORING BOTTOM LEFT BLOCK IN D2
00001536                           779              
00001536  2248                     780              MOVEA.L A0,A1
00001538  D3C4                     781              ADDA.L  D4,A1   
0000153A  D3C1                     782              ADDA.L  D1,A1           ; RIGHT UPPER BLOCK
0000153C  1211                     783              MOVE.B  (A1),D1         ; STORING TOP RIGHT BLOCK IN D1
0000153E                           784              
0000153E  2248                     785              MOVEA.L A0,A1
00001540  D3C4                     786              ADDA.L  D4,A1   
00001542  D3C0                     787              ADDA.L  D0,A1           ; LEFT UPPER BLOCK
00001544  1011                     788              MOVE.B  (A1),D0         ; STORING TOP LEFT BLOCK IN D0
00001546                           789              
00001546  1800                     790              MOVE.B  D0,D4
00001548  4EB8 14BA                791              JSR     ISBLWHICHCOLL
0000154C  2004                     792              MOVE.L  D4,D0
0000154E                           793              
0000154E  1801                     794              MOVE.B  D1,D4
00001550  4EB8 14BA                795              JSR     ISBLWHICHCOLL
00001554  2204                     796              MOVE.L  D4,D1
00001556                           797              
00001556  1802                     798              MOVE.B  D2,D4
00001558  4EB8 14BA                799              JSR     ISBLWHICHCOLL
0000155C  2404                     800              MOVE.L  D4,D2
0000155E                           801              
0000155E  1803                     802              MOVE.B  D3,D4
00001560  4EB8 14BA                803              JSR     ISBLWHICHCOLL
00001564  2604                     804              MOVE.L  D4,D3
00001566                           805              
00001566  4CDF 0370                806              MOVEM.L (A7)+,D4-D6/A0-A1
0000156A                           807              
0000156A  4E75                     808              RTS
0000156C                           809  
0000156C                           810  ; -----------------------------------------------------------------------------
0000156C                           811  BLOCKSPLOT
0000156C                           812  ; INPUT    - 
0000156C                           813  ; OUTPUT   - 
0000156C                           814  ; MODIFIES - 
0000156C                           815  ; -----------------------------------------------------------------------------
0000156C                           816  
0000156C  48E7 FF00                817          MOVEM.L D0-D7, -(A7)
00001570  48E7 00FE                818          MOVEM.L A0-A6, -(A7)
00001574  3239 000027E2            819             MOVE.W LOADEDMAP, D1
0000157A  C2FC 000C                820             MULU #12, D1
0000157E  3241                     821             MOVEA.W D1, A1
00001580  4EE9 1584                822             JMP MAPSEL(A1)
00001584                           823  MAPSEL:
00001584  41F9 00003500            824             LEA HEAVEN_0, A0
0000158A  4EF9 000015E4            825             JMP NEXT
00001590  41F9 00003650            826             LEA HEAVEN_1, A0
00001596  4EF9 000015E4            827             JMP NEXT
0000159C  41F9 0000378B            828             LEA HEAVEN_END, A0
000015A2  4EF9 000015E4            829             JMP NEXT
000015A8  41F9 000038C6            830             LEA HEAVEN_ROOM, A0
000015AE  4EF9 000015E4            831             JMP NEXT
000015B4  41F9 00003A01            832             LEA HELL_0, A0
000015BA  4EF9 000015E4            833             JMP NEXT
000015C0  41F9 00003B3C            834             LEA HELL_1, A0
000015C6  4EF9 000015E4            835             JMP NEXT
000015CC  41F9 00003C77            836             LEA HELL_END, A0
000015D2  4EF9 000015E4            837             JMP NEXT
000015D8  41F9 00003DB2            838             LEA HELL_ROOM, A0
000015DE  4EF9 000015E4            839             JMP NEXT
000015E4                           840              
000015E4                           841  NEXT
000015E4  4281                     842             CLR.L D1
000015E6  1218                     843             MOVE.B (A0)+,D1
000015E8  C2FC 0006                844             MULU #6, D1
000015EC  2241                     845             MOVEA.L D1, A1
000015EE  4EE9 15F2                846             JMP JMPLIST(A1)
000015F2                           847             
000015F2                           848  JMPLIST: 
000015F2  4EF9 000019A6            849              JMP NEWLINE ; 0 = END OF ROW
000015F8  4EF9 0000167A            850              JMP DGHE    ; 1 = DRAW GRASS HEAVEN 
000015FE  4EF9 00001710            851              JMP DBHL    ; 2 = DRAW BRICK HELL
00001604  4EF9 00001784            852              JMP DBHV    ; 3 = DRAW BRICK HEAVEN
0000160A  4EF9 000017F8            853              JMP DGHL    ; 4 = DRAW GRASS HELL
00001610  4EF9 0000188E            854              JMP DF1HV   ; 5 = DRAW FLOOR 1 HEAVEN
00001616  4EF9 000018AE            855              JMP DF1HL   ; 6 = DRAW FLOOR 1 HELL
0000161C  4EF9 000018CE            856              JMP DF2HV   ; 7 = DRAW FLOOR 2 HEAVEN
00001622  4EF9 0000163A            857              JMP DDHL    ; 8 = DRAW DOOR HELL
00001628  4EF9 0000165A            858              JMP DDHV    ; 9 = DRAW DOOR HEAVEN
0000162E  4EF9 00001920            859              JMP DF2HL   ; 10 = DRAW FLOOR 2 HELL
00001634  4EF9 000019DC            860              JMP ENDMAP  ; 11 = END OF THE MAP
0000163A                           861              
0000163A                           862  DDHL
0000163A  2F3C 00111111            863      MOVE.L #$00111111, -(A7)
00001640  2F3C 00111111            864      MOVE.L #$00111111, -(A7)
00001646  4EB9 00001972            865      JSR DRAWBLOCK
0000164C  2C1F                     866      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000164E  2C1F                     867      MOVE.L (A7)+, D6    
00001650  4EB9 000019CA            868      JSR ENDBLOCK
00001656  4EF8 15E4                869      JMP NEXT
0000165A                           870  DDHV
0000165A  2F3C 00FFFFFF            871      MOVE.L #$00FFFFFF, -(A7)
00001660  2F3C 00FFFFFF            872      MOVE.L #$00FFFFFF, -(A7)
00001666  4EB9 00001972            873      JSR DRAWBLOCK
0000166C  2C1F                     874      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000166E  2C1F                     875      MOVE.L (A7)+, D6
00001670  4EB9 000019CA            876      JSR ENDBLOCK
00001676  4EF8 15E4                877      JMP NEXT
0000167A                           878  DGHE ;DRAW-GRASS-HEAVEN vvvR
0000167A  2F3C 0099FF99            879      MOVE.L #$0099FF99, -(A7)
00001680  2F3C 0099FF99            880      MOVE.L #$0099FF99, -(A7)
00001686  4EB9 00001972            881      JSR DRAWBLOCK
0000168C  2C1F                     882      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000168E  2C1F                     883      MOVE.L (A7)+, D6
00001690                           884      ; SET PEN COLOR 
00001690  103C 0050                885      MOVE.B #80, D0
00001694  223C 0000CC00            886      MOVE.L #$0000CC00, D1
0000169A  4E4F                     887      TRAP #15
0000169C                           888      ;DRAW LINES   
0000169C  103C 0054                889      MOVE.B #84, D0 
000016A0                           890      ;LINEA 11 
000016A0  3239 000027D6            891      MOVE.W BPOSX1,D1
000016A6  5C41                     892      ADD.W #6, D1
000016A8  3439 000027D8            893      MOVE.W BPOSY1, D2
000016AE  5A42                     894      ADD.W #5, D2
000016B0  3639 000027D6            895      MOVE.W BPOSX1, D3
000016B6  0643 0009                896      ADD.W #9, D3
000016BA  3839 000027D8            897      MOVE.W BPOSY1, D4
000016C0  0644 000A                898      ADD.W #10, D4
000016C4  4E4F                     899      TRAP #15
000016C6                           900      ;LINEA 12
000016C6  5041                     901      ADD.W #8, D1    
000016C8  5043                     902      ADD.W #8, D3
000016CA  4E4F                     903      TRAP #15
000016CC                           904      ;LINEA 13
000016CC  5041                     905      ADD.W #8, D1    
000016CE  5043                     906      ADD.W #8, D3
000016D0  4E4F                     907      TRAP #15
000016D2                           908      ;LINEA 21
000016D2  3239 000027D6            909      MOVE.W BPOSX1,D1
000016D8  5C41                     910      ADD.W #6, D1
000016DA  3439 000027D8            911      MOVE.W BPOSY1, D2
000016E0  0642 0014                912      ADD.W #20, D2
000016E4  3639 000027D6            913      MOVE.W BPOSX1, D3
000016EA  0643 0009                914      ADD.W #9, D3
000016EE  3839 000027D8            915      MOVE.W BPOSY1, D4
000016F4  0644 0019                916      ADD.W #25, D4
000016F8  4E4F                     917      TRAP #15
000016FA                           918      ;LINEA 22
000016FA  5041                     919      ADD.W #8, D1    
000016FC  5043                     920      ADD.W #8, D3
000016FE  4E4F                     921      TRAP #15
00001700                           922      ;LINEA 23
00001700  5041                     923      ADD.W #8, D1    
00001702  5043                     924      ADD.W #8, D3
00001704  4E4F                     925      TRAP #15
00001706  4EB9 000019CA            926      JSR ENDBLOCK
0000170C  4EF8 15E4                927      JMP NEXT
00001710                           928  DBHL ;DRAW BRICK-HELL vvvR
00001710                           929      
00001710  2F3C 00010101            930      MOVE.L #$00010101, -(A7)
00001716  2F3C 00666666            931      MOVE.L #$00666666, -(A7)
0000171C  4EB9 00001972            932      JSR DRAWBLOCK
00001722  2C1F                     933      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001724  2C1F                     934      MOVE.L (A7)+, D6
00001726                           935      ;DRAW HORIZONTAL LINE
00001726  103C 0054                936      MOVE.B #84, D0 
0000172A  3239 000027D6            937      MOVE.W BPOSX1, D1
00001730  3439 000027D8            938      MOVE.W BPOSY1, D2
00001736  0642 0010                939      ADD.W #16, D2
0000173A  3639 000027D6            940      MOVE.W BPOSX1, D3
00001740  0643 0020                941      ADD.W #32, D3
00001744  3839 000027D8            942      MOVE.W BPOSY1, D4
0000174A  0644 0010                943      ADD.W #16, D4
0000174E  4E4F                     944      TRAP #15
00001750                           945      ;DRAW VERTICAL LINE 
00001750  3239 000027D6            946      MOVE.W BPOSX1, D1
00001756  0641 0010                947      ADD.W #16, D1
0000175A  3439 000027D8            948      MOVE.W BPOSY1, D2
00001760  0642 0010                949      ADD.W #16, D2
00001764  3639 000027D6            950      MOVE.W BPOSX1, D3
0000176A  0643 0010                951      ADD.W #16, D3
0000176E  3839 000027D8            952      MOVE.W BPOSY1, D4
00001774  0644 0020                953      ADD.W #32, D4
00001778  4E4F                     954      TRAP #15
0000177A  4EB9 000019CA            955      JSR ENDBLOCK    
00001780  4EF8 15E4                956      JMP NEXT
00001784                           957  DBHV ;DRAW BRICK-HEAVEN vvvR
00001784                           958      
00001784  2F3C 00CCCCCC            959      MOVE.L #$00CCCCCC, -(A7)
0000178A  2F3C 00D7EBFA            960      MOVE.L #$00D7EBFA, -(A7)
00001790  4EB9 00001972            961      JSR DRAWBLOCK
00001796  2C1F                     962      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001798  2C1F                     963      MOVE.L (A7)+, D6
0000179A                           964      ;DRAW HORIZONTAL LINE
0000179A  103C 0054                965      MOVE.B #84, D0 
0000179E  3239 000027D6            966      MOVE.W BPOSX1, D1
000017A4  3439 000027D8            967      MOVE.W BPOSY1, D2
000017AA  0642 0010                968      ADD.W #16, D2
000017AE  3639 000027D6            969      MOVE.W BPOSX1, D3
000017B4  0643 0020                970      ADD.W #32, D3
000017B8  3839 000027D8            971      MOVE.W BPOSY1, D4
000017BE  0644 0010                972      ADD.W #16, D4
000017C2  4E4F                     973      TRAP #15
000017C4                           974      ;DRAW VERTICAL LINE 
000017C4  3239 000027D6            975      MOVE.W BPOSX1, D1
000017CA  0641 0010                976      ADD.W #16, D1
000017CE  3439 000027D8            977      MOVE.W BPOSY1, D2
000017D4  0642 0010                978      ADD.W #16, D2
000017D8  3639 000027D6            979      MOVE.W BPOSX1, D3
000017DE  0643 0010                980      ADD.W #16, D3
000017E2  3839 000027D8            981      MOVE.W BPOSY1, D4
000017E8  0644 0020                982      ADD.W #32, D4
000017EC  4E4F                     983      TRAP #15 
000017EE  4EB9 000019CA            984      JSR ENDBLOCK
000017F4  4EF8 15E4                985      JMP NEXT
000017F8                           986  DGHL ;DRAW GRASS HELL vvvR
000017F8                           987  
000017F8  2F3C 002255EE            988      MOVE.L #$002255EE, -(A7)
000017FE  2F3C 002255EE            989      MOVE.L #$002255EE, -(A7)
00001804  4EB9 00001972            990      JSR DRAWBLOCK
0000180A  2C1F                     991      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
0000180C  2C1F                     992      MOVE.L (A7)+, D6
0000180E                           993      ; SET PEN COLOR 
0000180E  103C 0050                994      MOVE.B #80, D0
00001812  223C 000000CC            995      MOVE.L #$000000CC, D1
00001818  4E4F                     996      TRAP #15
0000181A                           997      ;DRAW LINES   
0000181A  103C 0054                998      MOVE.B #84, D0 
0000181E                           999      ;LINEA 11 
0000181E  3239 000027D6           1000      MOVE.W BPOSX1,D1
00001824  5C41                    1001      ADD.W #6, D1
00001826  3439 000027D8           1002      MOVE.W BPOSY1, D2
0000182C  5A42                    1003      ADD.W #5, D2
0000182E  3639 000027D6           1004      MOVE.W BPOSX1, D3
00001834  0643 0009               1005      ADD.W #9, D3
00001838  3839 000027D8           1006      MOVE.W BPOSY1, D4
0000183E  0644 000A               1007      ADD.W #10, D4
00001842  4E4F                    1008      TRAP #15
00001844                          1009      ;LINEA 12
00001844  5041                    1010      ADD.W #8, D1    
00001846  5043                    1011      ADD.W #8, D3
00001848  4E4F                    1012      TRAP #15
0000184A                          1013      ;LINEA 13
0000184A  5041                    1014      ADD.W #8, D1    
0000184C  5043                    1015      ADD.W #8, D3
0000184E  4E4F                    1016      TRAP #15
00001850                          1017      ;LINEA 21
00001850  3239 000027D6           1018      MOVE.W BPOSX1,D1
00001856  5C41                    1019      ADD.W #6, D1
00001858  3439 000027D8           1020      MOVE.W BPOSY1, D2
0000185E  0642 0014               1021      ADD.W #20, D2
00001862  3639 000027D6           1022      MOVE.W BPOSX1, D3
00001868  0643 0009               1023      ADD.W #9, D3
0000186C  3839 000027D8           1024      MOVE.W BPOSY1, D4
00001872  0644 0019               1025      ADD.W #25, D4
00001876  4E4F                    1026      TRAP #15
00001878                          1027      ;LINEA 22
00001878  5041                    1028      ADD.W #8, D1    
0000187A  5043                    1029      ADD.W #8, D3
0000187C  4E4F                    1030      TRAP #15
0000187E                          1031      ;LINEA 23
0000187E  5041                    1032      ADD.W #8, D1    
00001880  5043                    1033      ADD.W #8, D3
00001882  4E4F                    1034      TRAP #15
00001884  4EB9 000019CA           1035      JSR ENDBLOCK
0000188A  4EF8 15E4               1036      JMP NEXT
0000188E                          1037  
0000188E                          1038  DF1HV ; DRAW FLOOR_1 HEAVEN vvvR
0000188E  2F3C 00CCCCCC           1039      MOVE.L #$00CCCCCC, -(A7)
00001894  2F3C 00C6DAE9           1040      MOVE.L #$00C6DAE9, -(A7)
0000189A  4EB9 00001972           1041      JSR DRAWBLOCK
000018A0  2C1F                    1042      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018A2  2C1F                    1043      MOVE.L (A7)+, D6
000018A4  4EB9 000019CA           1044      JSR ENDBLOCK
000018AA  4EF8 15E4               1045      JMP NEXT
000018AE                          1046  DF1HL ; DRAW FLOOR_1 HELL vvvR 
000018AE  2F3C 00010101           1047      MOVE.L #$00010101, -(A7)
000018B4  2F3C 00777777           1048      MOVE.L #$00777777, -(A7)
000018BA  4EB9 00001972           1049      JSR DRAWBLOCK
000018C0  2C1F                    1050      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018C2  2C1F                    1051      MOVE.L (A7)+, D6
000018C4                          1052  
000018C4  4EB9 000019CA           1053      JSR ENDBLOCK
000018CA  4EF8 15E4               1054      JMP NEXT
000018CE                          1055      
000018CE                          1056  DF2HV ;DRAW FLOOR_2 HEAVEN vvvR
000018CE  2F3C 00CCCCCC           1057      MOVE.L #$00CCCCCC, -(A7)
000018D4  2F3C 00C6DAE9           1058      MOVE.L #$00C6DAE9, -(A7)
000018DA  4EB9 00001972           1059      JSR DRAWBLOCK
000018E0  2C1F                    1060      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
000018E2  2C1F                    1061      MOVE.L (A7)+, D6
000018E4                          1062      ;SET NEW FILL COLOR  
000018E4  103C 0051               1063      MOVE.B #81, D0
000018E8  223C 00D7EBFA           1064      MOVE.L #$00D7EBFA, D1
000018EE  4E4F                    1065      TRAP #15 
000018F0                          1066      ;DRAW INSIDE SQUARE 
000018F0  103C 0057               1067      MOVE.B #87, D0
000018F4  3239 000027D6           1068      MOVE.W BPOSX1, D1
000018FA  5041                    1069      ADD.W #8, D1
000018FC  3439 000027D8           1070      MOVE.W BPOSY1, D2
00001902  5042                    1071      ADD.W #8, D2
00001904  3639 000027DA           1072      MOVE.W BPOSX2, D3
0000190A  5143                    1073      SUB.W #8, D3
0000190C  3839 000027DC           1074      MOVE.W BPOSY2, D4
00001912  5144                    1075      SUB.W #8, D4
00001914  4E4F                    1076      TRAP #15
00001916  4EB9 000019CA           1077      JSR ENDBLOCK
0000191C  4EF8 15E4               1078      JMP NEXT
00001920                          1079  DF2HL ; DRAW FLOOR_2 HELL vvvR
00001920  2F3C 00010101           1080      MOVE.L #$00010101, -(A7)
00001926  2F3C 00777777           1081      MOVE.L #$00777777, -(A7)
0000192C  4EB9 00001972           1082      JSR DRAWBLOCK
00001932  2C1F                    1083      MOVE.L (A7)+, D6 ;RETURN SP TO ORIGINAL STATE
00001934  2C1F                    1084      MOVE.L (A7)+, D6
00001936                          1085      ;SET NEW FILL COLOR  
00001936  103C 0051               1086      MOVE.B #81, D0
0000193A  223C 00666666           1087      MOVE.L #$00666666, D1
00001940  4E4F                    1088      TRAP #15 
00001942                          1089  ;DRAW INSIDE SQUARE 
00001942  103C 0057               1090      MOVE.B #87, D0
00001946  3239 000027D6           1091      MOVE.W BPOSX1, D1
0000194C  5041                    1092      ADD.W #8, D1
0000194E  3439 000027D8           1093      MOVE.W BPOSY1, D2
00001954  5042                    1094      ADD.W #8, D2
00001956  3639 000027DA           1095      MOVE.W BPOSX2, D3
0000195C  5143                    1096      SUB.W #8, D3
0000195E  3839 000027DC           1097      MOVE.W BPOSY2, D4
00001964  5144                    1098      SUB.W #8, D4
00001966  4E4F                    1099      TRAP #15
00001968  4EB9 000019CA           1100      JSR ENDBLOCK
0000196E  4EF8 15E4               1101      JMP NEXT    
00001972                          1102      
00001972                          1103  DRAWBLOCK 
00001972                          1104  ;SE TIENE QUE PONER EN LA PILA EL PEN COLOR PRIMERO Y EL FILL COLOR DESPU?S COMO LONGS. 
00001972                          1105      
00001972                          1106      ;SET FILL COLOR  
00001972  103C 0051               1107      MOVE.B #81, D0
00001976  222F 0004               1108      MOVE.L 4(A7), D1
0000197A  4E4F                    1109      TRAP #15 
0000197C                          1110      
0000197C                          1111      ; SET PEN COLOR 
0000197C  103C 0050               1112      MOVE.B #80, D0
00001980  222F 0008               1113      MOVE.L 8(A7), D1
00001984  4E4F                    1114      TRAP #15 
00001986                          1115  
00001986                          1116      ;DRAW BLOCK 
00001986  103C 0057               1117      MOVE.B #87, D0
0000198A  3239 000027D6           1118      MOVE.W BPOSX1, D1
00001990  3439 000027D8           1119      MOVE.W BPOSY1, D2
00001996  3639 000027DA           1120      MOVE.W BPOSX2, D3
0000199C  3839 000027DC           1121      MOVE.W BPOSY2, D4
000019A2  4E4F                    1122      TRAP #15
000019A4  4E75                    1123      RTS
000019A6                          1124  
000019A6                          1125  NEWLINE
000019A6                          1126      ;RESET X POSITION
000019A6  33FC 0000 000027D6      1127      MOVE.W #0, BPOSX1
000019AE  33FC 0020 000027DA      1128      MOVE.W #32, BPOSX2
000019B6                          1129      ;ADD 33 TO Y POSITION
000019B6  0679 0020 000027D8      1130      ADD.W #32, BPOSY1
000019BE  0679 0020 000027DC      1131      ADD.W #32, BPOSY2
000019C6  4EF8 15E4               1132      JMP NEXT
000019CA                          1133     
000019CA                          1134  ENDBLOCK
000019CA                          1135      ;SET NEW BLOCK POSITION
000019CA  0679 0020 000027D6      1136      ADD.W #32, BPOSX1
000019D2  0679 0020 000027DA      1137      ADD.W #32, BPOSX2
000019DA  4E75                    1138      RTS
000019DC                          1139  ENDMAP
000019DC                          1140      ;SET DEFAULT BLOCK POSITION
000019DC  33FC 0000 000027D6      1141      MOVE.W #0, BPOSX1
000019E4  33FC 0000 000027D8      1142      MOVE.W #0, BPOSY1
000019EC  33FC 0020 000027DA      1143      MOVE.W #32, BPOSX2
000019F4  33FC 0020 000027DC      1144      MOVE.W #32, BPOSY2
000019FC  4CDF 7F00               1145      MOVEM.L (A7)+, A0-A6
00001A00  4CDF 00FF               1146      MOVEM.L (A7)+, D0-D7
00001A04  4E75                    1147      RTS
00001A06                          1148      
00001A06                          1149  
00001A06                          1150  
00001A06                          1151  
00001A06                          1152  -------------------- end include --------------------
00001A06                          1153              INCLUDE "MAP.X68"
00001A06                          1154  
00001A06                          1155  ; -----------------------------------------------------------------------------
00001A06                          1156  MAPUPD
00001A06                          1157  ; INPUT    - 
00001A06                          1158  ; OUTPUT   - 
00001A06                          1159  ; MODIFIES - A0
00001A06                          1160  ; -----------------------------------------------------------------------------
00001A06  3F00                    1161              MOVE.W D0,-(A7)
00001A08                          1162              
00001A08  3039 000027E2           1163              MOVE.W  LOADEDMAP, D0
00001A0E                          1164              
00001A0E  48C0                    1165              EXT.L   D0
00001A10  C0FC 0004               1166              MULU    #4,D0
00001A14  41F9 000027E4           1167              LEA.L   MAPUPDLIST,A0
00001A1A  D1C0                    1168              ADDA.L  D0,A0
00001A1C  2050                    1169              MOVEA.L (A0),A0
00001A1E  4ED0                    1170              JMP     (A0)
00001A20                          1171  
00001A20                          1172  
00001A20                          1173  MAPA1
00001A20  301F                    1174      MOVE.W (A7)+, D0
00001A22  48A7 F800               1175      MOVEM.W D0-D4, -(A7)
00001A26  3039 000027D0           1176      MOVE.W PLAYERPOSX, D0
00001A2C  3239 000027D2           1177      MOVE.W PLAYERPOSY, D1
00001A32                          1178      ;GO TO THE NEXT ROOM DOOR
00001A32                          1179      ;FIRST LETS CHECH POS X
00001A32  B07C 0160               1180      CMP #352, D0  ; BGT = 352 > D0
00001A36  6E00 002A               1181      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A3A  B07C 0120               1182      CMP #288, D0
00001A3E  6D00 0022               1183      BLT MAP1NODOOR
00001A42                          1184      ;NOW WE CHECK POS Y 
00001A42  B27C 01E0               1185      CMP #480, D1  ; 
00001A46  6E00 001A               1186      BGT MAP1NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A4A  B27C 01C0               1187      CMP #448, D1
00001A4E  6D00 0012               1188      BLT MAP1NODOOR
00001A52  33FC 0020 000027D2      1189      MOVE.W #32, PLAYERPOSY
00001A5A  33FC 0001 000027E2      1190      MOVE.W #1, LOADEDMAP
00001A62                          1191  MAP1NODOOR
00001A62  4C9F 001F               1192      MOVEM.W (A7)+, D0-D4
00001A66  4E75                    1193      RTS
00001A68                          1194      
00001A68                          1195  MAPA2
00001A68  301F                    1196      MOVE.W (A7)+, D0
00001A6A  48A7 F800               1197      MOVEM.W D0-D4, -(A7)
00001A6E  3039 000027D0           1198      MOVE.W PLAYERPOSX, D0
00001A74  3239 000027D2           1199      MOVE.W PLAYERPOSY, D1
00001A7A                          1200      ;GO TO THE NEXT ROOM DOOR
00001A7A                          1201      ;FIRST LETS CHECK POS X
00001A7A  B07C 0160               1202      CMP #352, D0  ; BGT = 352 > D0
00001A7E  6E00 0030               1203      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A82  B07C 0120               1204      CMP #288, D0
00001A86  6D00 0028               1205      BLT MAP2NODOOR1
00001A8A                          1206      ;NOW WE CHECK POS Y 
00001A8A  B27C 01E0               1207      CMP #480, D1  ; 
00001A8E  6E00 0020               1208      BGT MAP2NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001A92  B27C 01C0               1209      CMP #448, D1
00001A96  6D00 0018               1210      BLT MAP2NODOOR1
00001A9A  33FC 0020 000027D2      1211      MOVE.W #32, PLAYERPOSY
00001AA2  33FC 0002 000027E2      1212      MOVE.W #2, LOADEDMAP
00001AAA  4C9F 001F               1213      MOVEM.W (A7)+, D0-D4
00001AAE  4E75                    1214      RTS
00001AB0                          1215  MAP2NODOOR1
00001AB0                          1216      ;GO TO THE PREVIOUS ROOM DOOR
00001AB0                          1217      ;FIRST LETS CHECK POS X
00001AB0  B07C 0160               1218      CMP #352, D0  ; BGT = 352 > D0
00001AB4  6E00 0030               1219      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AB8  B07C 0120               1220      CMP #288, D0
00001ABC  6D00 0028               1221      BLT MAP2NODOOR2
00001AC0                          1222      ;NOW WE CHECK POS Y 
00001AC0  B27C 0020               1223      CMP #32, D1  ; 
00001AC4  6E00 0020               1224      BGT MAP2NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AC8  B27C 0000               1225      CMP #0, D1
00001ACC  6D00 0018               1226      BLT MAP2NODOOR2
00001AD0  33FC 01A0 000027D2      1227      MOVE.W  #416, PLAYERPOSY
00001AD8  33FC 0000 000027E2      1228      MOVE.W #0, LOADEDMAP
00001AE0  4C9F 001F               1229      MOVEM.W (A7)+, D0-D4
00001AE4  4E75                    1230      RTS
00001AE6                          1231  
00001AE6                          1232  MAP2NODOOR2
00001AE6                          1233      ;GO TO THE LEFT HEAVEN'S ROOM
00001AE6  B07C 00A0               1234      CMP #160, D0  ; BGT = 352 > D0
00001AEA  6E00 0038               1235      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AEE  B07C 0080               1236      CMP #128, D0
00001AF2  6D00 0030               1237      BLT MAP2NODOOR3
00001AF6                          1238      ;NOW WE CHECK POS Y 
00001AF6  B27C 00AA               1239      CMP #170, D1  ; 
00001AFA  6E00 0028               1240      BGT MAP2NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001AFE  B27C 0078               1241      CMP #120, D1
00001B02  6D00 0020               1242      BLT MAP2NODOOR3
00001B06  33FC 0130 000027D0      1243      MOVE.W #$130, PLAYERPOSX
00001B0E  33FC 00B0 000027D2      1244      MOVE.W #$0B0, PLAYERPOSY
00001B16  33FC 0003 000027E2      1245      MOVE.W #3, LOADEDMAP
00001B1E  4C9F 001F               1246      MOVEM.W (A7)+, D0-D4
00001B22  4E75                    1247      RTS
00001B24                          1248  MAP2NODOOR3
00001B24                          1249      ;GO TO THE RIGHT HEAVEN'S ROOM
00001B24  B07C 01E0               1250      CMP #480, D0  ; BGT = 352 > D0
00001B28  6E00 0038               1251      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B2C  B07C 01C0               1252      CMP #448, D0
00001B30  6D00 0030               1253      BLT MAP2NODOOR4
00001B34                          1254      ;NOW WE CHECK POS Y 
00001B34  B27C 00AA               1255      CMP #170, D1  ; 
00001B38  6E00 0028               1256      BGT MAP2NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B3C  B27C 0078               1257      CMP #120, D1
00001B40  6D00 0020               1258      BLT MAP2NODOOR4
00001B44  33FC 0130 000027D0      1259      MOVE.W #$130, PLAYERPOSX
00001B4C  33FC 00B0 000027D2      1260      MOVE.W #$0B0, PLAYERPOSY
00001B54  33FC 0003 000027E2      1261      MOVE.W #3, LOADEDMAP
00001B5C  4C9F 001F               1262      MOVEM.W (A7)+, D0-D4
00001B60  4E75                    1263      RTS
00001B62                          1264  MAP2NODOOR4
00001B62  4C9F 001F               1265      MOVEM.W (A7)+, D0-D4
00001B66  4E75                    1266      RTS
00001B68                          1267  MAPA3 
00001B68  301F                    1268      MOVE.W (A7)+, D0
00001B6A  48A7 F800               1269      MOVEM.W D0-D4, -(A7)
00001B6E  3039 000027D0           1270      MOVE.W PLAYERPOSX, D0
00001B74  3239 000027D2           1271      MOVE.W PLAYERPOSY, D1
00001B7A                          1272      ;GO TO THE PREVIOUS ROOM DOOR
00001B7A                          1273      ;FIRST LETS CHECK POS X
00001B7A  B07C 0160               1274      CMP #352, D0  ; BGT = 352 > D0
00001B7E  6E00 0030               1275      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B82  B07C 0120               1276      CMP #288, D0
00001B86  6D00 0028               1277      BLT MAP3NODOOR
00001B8A                          1278      ;NOW WE CHECK POS Y 
00001B8A  B27C 0020               1279      CMP #32, D1  ; 
00001B8E  6E00 0020               1280      BGT MAP3NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001B92  B27C 0000               1281      CMP #0, D1
00001B96  6D00 0018               1282      BLT MAP3NODOOR
00001B9A  33FC 01A0 000027D2      1283      MOVE.W  #416, PLAYERPOSY
00001BA2  33FC 0001 000027E2      1284      MOVE.W #1, LOADEDMAP
00001BAA  4C9F 001F               1285      MOVEM.W (A7)+, D0-D4
00001BAE  4E75                    1286      RTS
00001BB0                          1287  MAP3NODOOR
00001BB0  4C9F 001F               1288      MOVEM.W (A7)+, D0-D4
00001BB4  4E75                    1289      RTS
00001BB6                          1290  MAPA4
00001BB6  301F                    1291      MOVE.W (A7)+, D0
00001BB8  48A7 F800               1292      MOVEM.W D0-D4, -(A7)
00001BBC  3039 000027D0           1293      MOVE.W PLAYERPOSX, D0
00001BC2  3239 000027D2           1294      MOVE.W PLAYERPOSY, D1
00001BC8                          1295      ;GO BACK TO 2ND HEAVEN'S ROOM
00001BC8  B07C 0180               1296      CMP #384, D0  ; BGT = 352 > D0
00001BCC  6E00 002A               1297      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BD0  B07C 0104               1298      CMP #260, D0
00001BD4  6D00 0022               1299      BLT MAP4NODOOR
00001BD8                          1300      ;NOW WE CHECK POS Y 
00001BD8  B27C 0080               1301      CMP #128, D1  ; 
00001BDC  6E00 001A               1302      BGT MAP4NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001BE0  B27C 0060               1303      CMP #96, D1
00001BE4  6D00 0012               1304      BLT MAP4NODOOR
00001BE8  33FC 00E0 000027D0      1305      MOVE.W  #224, PLAYERPOSX
00001BF0  33FC 0001 000027E2      1306      MOVE.W #1, LOADEDMAP
00001BF8                          1307  MAP4NODOOR
00001BF8  4C9F 001F               1308      MOVEM.W (A7)+, D0-D4
00001BFC  4E75                    1309      RTS
00001BFE                          1310  ;;;;;;;;;;HELL
00001BFE                          1311  MAPA5
00001BFE  301F                    1312      MOVE.W (A7)+, D0
00001C00  48A7 F800               1313      MOVEM.W D0-D4, -(A7)
00001C04  3039 000027D0           1314      MOVE.W PLAYERPOSX, D0
00001C0A  3239 000027D2           1315      MOVE.W PLAYERPOSY, D1
00001C10                          1316      ;GO TO THE NEXT ROOM DOOR
00001C10                          1317      ;FIRST LETS CHECH POS X
00001C10  B07C 0160               1318      CMP #352, D0  ; BGT = 352 > D0
00001C14  6E00 002A               1319      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C18  B07C 0120               1320      CMP #288, D0
00001C1C  6D00 0022               1321      BLT MAP5NODOOR
00001C20                          1322      ;NOW WE CHECK POS Y 
00001C20  B27C 01E0               1323      CMP #480, D1  ; 
00001C24  6E00 001A               1324      BGT MAP5NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C28  B27C 01C0               1325      CMP #448, D1
00001C2C  6D00 0012               1326      BLT MAP5NODOOR
00001C30  33FC 0020 000027D2      1327      MOVE.W #32, PLAYERPOSY
00001C38  33FC 0005 000027E2      1328      MOVE.W #5, LOADEDMAP
00001C40                          1329  MAP5NODOOR
00001C40  4C9F 001F               1330      MOVEM.W (A7)+, D0-D4
00001C44  4E75                    1331      RTS
00001C46                          1332      
00001C46                          1333  MAPA6
00001C46  301F                    1334      MOVE.W (A7)+, D0
00001C48  48A7 F800               1335      MOVEM.W D0-D4, -(A7)
00001C4C  3039 000027D0           1336      MOVE.W PLAYERPOSX, D0
00001C52  3239 000027D2           1337      MOVE.W PLAYERPOSY, D1
00001C58                          1338      ;GO TO THE NEXT ROOM DOOR
00001C58                          1339      ;FIRST LETS CHECK POS X
00001C58  B07C 0160               1340      CMP #352, D0  ; BGT = 352 > D0
00001C5C  6E00 0030               1341      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C60  B07C 0120               1342      CMP #288, D0
00001C64  6D00 0028               1343      BLT MAP6NODOOR1
00001C68                          1344      ;NOW WE CHECK POS Y 
00001C68  B27C 01E0               1345      CMP #480, D1  ; 
00001C6C  6E00 0020               1346      BGT MAP6NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C70  B27C 01C0               1347      CMP #448, D1
00001C74  6D00 0018               1348      BLT MAP6NODOOR1
00001C78  33FC 0020 000027D2      1349      MOVE.W #32, PLAYERPOSY
00001C80  33FC 0006 000027E2      1350      MOVE.W #6, LOADEDMAP
00001C88  4C9F 001F               1351      MOVEM.W (A7)+, D0-D4
00001C8C  4E75                    1352      RTS
00001C8E                          1353  MAP6NODOOR1
00001C8E                          1354      ;GO TO THE PREVIOUS ROOM DOOR
00001C8E                          1355      ;FIRST LETS CHECK POS X
00001C8E  B07C 0160               1356      CMP #352, D0  ; BGT = 352 > D0
00001C92  6E00 0030               1357      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001C96  B07C 0120               1358      CMP #288, D0
00001C9A  6D00 0028               1359      BLT MAP6NODOOR2
00001C9E                          1360      ;NOW WE CHECK POS Y 
00001C9E  B27C 0020               1361      CMP #32, D1  ; 
00001CA2  6E00 0020               1362      BGT MAP6NODOOR2    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CA6  B27C 0000               1363      CMP #0, D1
00001CAA  6D00 0018               1364      BLT MAP6NODOOR2
00001CAE  33FC 01A0 000027D2      1365      MOVE.W  #416, PLAYERPOSY
00001CB6  33FC 0004 000027E2      1366      MOVE.W #4, LOADEDMAP
00001CBE  4C9F 001F               1367      MOVEM.W (A7)+, D0-D4
00001CC2  4E75                    1368      RTS
00001CC4                          1369  MAP6NODOOR2
00001CC4                          1370      ;CHECK FOR LEFT HELL ROOM
00001CC4  B07C 0060               1371      CMP #96, D0  ; BGT = 352 > D0
00001CC8  6E00 0038               1372      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CCC  B07C 0040               1373      CMP #64, D0
00001CD0  6D00 0030               1374      BLT MAP6NODOOR3
00001CD4                          1375      ;NOW WE CHECK POS Y 
00001CD4  B27C 0180               1376      CMP #384, D1  ; 
00001CD8  6E00 0028               1377      BGT MAP6NODOOR3    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001CDC  B27C 0140               1378      CMP #320, D1
00001CE0  6D00 0020               1379      BLT MAP6NODOOR3
00001CE4  33FC 0130 000027D0      1380      MOVE.W #$130, PLAYERPOSX
00001CEC  33FC 00B0 000027D2      1381      MOVE.W #$0B0, PLAYERPOSY
00001CF4  33FC 0007 000027E2      1382      MOVE.W #7, LOADEDMAP
00001CFC  4C9F 001F               1383      MOVEM.W (A7)+, D0-D4
00001D00  4E75                    1384      RTS
00001D02                          1385  MAP6NODOOR3
00001D02                          1386      ;CHECK FOR THE RIGHT HELL ROOM
00001D02  B07C 0240               1387      CMP #576, D0  ; BGT = 352 > D0
00001D06  6E00 0038               1388      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D0A  B07C 021C               1389      CMP #540, D0
00001D0E  6D00 0030               1390      BLT MAP6NODOOR4
00001D12                          1391      ;NOW WE CHECK POS Y 
00001D12  B27C 0180               1392      CMP #384, D1  ; 
00001D16  6E00 0028               1393      BGT MAP6NODOOR4    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D1A  B27C 0140               1394      CMP #320, D1
00001D1E  6D00 0020               1395      BLT MAP6NODOOR4
00001D22  33FC 0130 000027D0      1396      MOVE.W #$130, PLAYERPOSX
00001D2A  33FC 00B0 000027D2      1397      MOVE.W #$0B0, PLAYERPOSY
00001D32  33FC 0007 000027E2      1398      MOVE.W #7, LOADEDMAP
00001D3A  4C9F 001F               1399      MOVEM.W (A7)+, D0-D4
00001D3E  4E75                    1400      RTS
00001D40                          1401  MAP6NODOOR4
00001D40  4C9F 001F               1402      MOVEM.W (A7)+, D0-D4
00001D44  4E75                    1403      RTS
00001D46                          1404  MAPA7 
00001D46  301F                    1405      MOVE.W (A7)+, D0
00001D48  48A7 F800               1406      MOVEM.W D0-D4, -(A7)
00001D4C  3039 000027D0           1407      MOVE.W PLAYERPOSX, D0
00001D52  3239 000027D2           1408      MOVE.W PLAYERPOSY, D1
00001D58                          1409      ;GO BACK TO PREVIOUS HELL'S ROOM
00001D58  B07C 0180               1410      CMP #384, D0  ; BGT = 352 > D0
00001D5C  6E00 0032               1411      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D60  B07C 0104               1412      CMP #260, D0
00001D64  6D00 002A               1413      BLT MAP7NODOOR
00001D68                          1414      ;NOW WE CHECK POS Y 
00001D68  B27C 0020               1415      CMP #32, D1  ; 
00001D6C  6E00 0022               1416      BGT MAP7NODOOR    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001D70  B27C 0000               1417      CMP #0, D1
00001D74  6D00 001A               1418      BLT MAP7NODOOR
00001D78  33FC 0140 000027D0      1419      MOVE.W  #320, PLAYERPOSX
00001D80  33FC 01A0 000027D2      1420      MOVE.W #416, PLAYERPOSY
00001D88  33FC 0005 000027E2      1421      MOVE.W #5, LOADEDMAP
00001D90                          1422  MAP7NODOOR
00001D90  4C9F 001F               1423      MOVEM.W (A7)+, D0-D4
00001D94  4E75                    1424      RTS
00001D96                          1425  MAPA8
00001D96                          1426       ;HELLS ROOM
00001D96  301F                    1427      MOVE.W (A7)+, D0
00001D98  48A7 F800               1428      MOVEM.W D0-D4, -(A7)
00001D9C  3039 000027D0           1429      MOVE.W PLAYERPOSX, D0
00001DA2  3239 000027D2           1430      MOVE.W PLAYERPOSY, D1
00001DA8                          1431      ;GO BACK TO PREVIOUS HELL'S ROOM
00001DA8  B07C 0180               1432      CMP #384, D0  ; BGT = 352 > D0
00001DAC  6E00 0032               1433      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001DB0  B07C 0104               1434      CMP #260, D0
00001DB4  6D00 002A               1435      BLT MAP8NODOOR1
00001DB8                          1436      ;NOW WE CHECK POS Y 
00001DB8  B27C 0080               1437      CMP #128, D1  ; 
00001DBC  6E00 0022               1438      BGT MAP8NODOOR1    ;IT'S NOT INSIDE THE DOOR'S COORDINATES
00001DC0  B27C 0060               1439      CMP #96, D1
00001DC4  6D00 001A               1440      BLT MAP8NODOOR1
00001DC8  33FC 0140 000027D0      1441      MOVE.W  #320, PLAYERPOSX
00001DD0  33FC 0080 000027D2      1442      MOVE.W #128, PLAYERPOSY
00001DD8  33FC 0005 000027E2      1443      MOVE.W #5, LOADEDMAP
00001DE0                          1444  MAP8NODOOR1
00001DE0  4C9F 001F               1445      MOVEM.W (A7)+, D0-D4
00001DE4  4E75                    1446      RTS
00001DE6                          1447  
00001DE6                          1448  
00001DE6                          1449  -------------------- end include --------------------
00001DE6                          1450              INCLUDE "ELEVATOR.X68"           
00001DE6                          1451  ELEVATORINIT
00001DE6  6000 04A2               1452      BRA     AUDINIT
00001DEA                          1453  
00001DEA                          1454  ELEVATORPLOT
00001DEA                          1455      
00001DEA  48E7 FFFE               1456      MOVEM.L D0-D7/A0-A6,-(A7)
00001DEE                          1457  
00001DEE                          1458  
00001DEE                          1459  ;SET PEN COLOR  
00001DEE  103C 0050               1460      MOVE.B #80, D0
00001DF2  223C 00010101           1461      MOVE.L #$00010101, D1 ; TODO 0 NO FUNCIONA PORQUE NO VE LAS LINEAS. 
00001DF8  4E4F                    1462      TRAP #15
00001DFA                          1463      
00001DFA                          1464  ;END SET PEN COLOR 
00001DFA                          1465  
00001DFA                          1466      ;DRAW LINES
00001DFA                          1467  ;DRAW LINE 1 
00001DFA  103C 0054               1468      MOVE.B #84, D0
00001DFE  323C 0000               1469      MOVE.W #0, D1
00001E02  343C 0000               1470      MOVE.W #0, D2
00001E06  363C 00A0               1471      MOVE.W #160, D3
00001E0A  383C 0078               1472      MOVE.W #120, D4
00001E0E  4E4F                    1473      TRAP #15
00001E10                          1474  
00001E10                          1475  ;DRAW LINE 2
00001E10  103C 0054               1476      MOVE.B #84, D0
00001E14  323C 00A0               1477      MOVE.W #160, D1
00001E18  343C 0078               1478      MOVE.W #120, D2
00001E1C  363C 00A0               1479      MOVE.W #160, D3
00001E20  383C 01E0               1480      MOVE.W #480, D4
00001E24  4E4F                    1481      TRAP #15
00001E26                          1482      
00001E26                          1483  ;DRAW LINE 3
00001E26  103C 0054               1484      MOVE.B #84, D0
00001E2A  323C 00A0               1485      MOVE.W #160, D1
00001E2E  343C 0078               1486      MOVE.W #120, D2
00001E32  363C 01E0               1487      MOVE.W #480, D3
00001E36  383C 0078               1488      MOVE.W #120, D4
00001E3A  4E4F                    1489      TRAP #15
00001E3C                          1490      
00001E3C                          1491  ;DRAW LINE 4
00001E3C  103C 0054               1492      MOVE.B #84, D0
00001E40  323C 01E0               1493      MOVE.W #480, D1
00001E44  343C 0078               1494      MOVE.W #120, D2
00001E48  363C 0280               1495      MOVE.W #640, D3
00001E4C  383C 0000               1496      MOVE.W #0, D4
00001E50  4E4F                    1497      TRAP #15
00001E52                          1498      
00001E52                          1499  ;DRAW LINE 5
00001E52  103C 0054               1500      MOVE.B #84, D0
00001E56  323C 01E0               1501      MOVE.W #480, D1
00001E5A  343C 0078               1502      MOVE.W #120, D2
00001E5E  363C 01E0               1503      MOVE.W #480, D3
00001E62  383C 01E0               1504      MOVE.W #480, D4
00001E66  4E4F                    1505      TRAP #15
00001E68                          1506  
00001E68                          1507  ;DRAW LINE 6 (TO GIVE SHADE) 
00001E68  103C 0054               1508      MOVE.B #84, D0
00001E6C  323C 0119               1509      MOVE.W #281, D1
00001E70  343C 015A               1510      MOVE.W #346, D2
00001E74  363C 0167               1511      MOVE.W #359, D3
00001E78  383C 015A               1512      MOVE.W #346, D4
00001E7C  4E4F                    1513      TRAP #15
00001E7E                          1514      
00001E7E                          1515  ;DRAW LINE 7 (TO GIVE SHADE) 
00001E7E  103C 0054               1516      MOVE.B #84, D0
00001E82  323C 011A               1517      MOVE.W #282, D1
00001E86  343C 015B               1518      MOVE.W #347, D2
00001E8A  363C 0166               1519      MOVE.W #358, D3
00001E8E  383C 015B               1520      MOVE.W #347, D4
00001E92  4E4F                    1521      TRAP #15
00001E94                          1522      
00001E94                          1523      ;END DRAW LINES
00001E94                          1524      
00001E94                          1525  ;DRAW RECTANGLE THAT CONTAINS BUTTONS
00001E94  103C 0057               1526      MOVE.B #87, D0
00001E98  323C 0118               1527      MOVE.W #280, D1
00001E9C  343C 00D2               1528      MOVE.W #210, D2
00001EA0  363C 0168               1529      MOVE.W #360, D3
00001EA4  383C 0159               1530      MOVE.W #345, D4
00001EA8  4E4F                    1531      TRAP #15
00001EAA                          1532      
00001EAA                          1533  ;DRAW ELLIPSE FOR THE LIGHT
00001EAA  103C 005B               1534      MOVE.B #91, D0
00001EAE  323C 00FA               1535      MOVE.W #250, D1
00001EB2  343C 0028               1536      MOVE.W #40, D2
00001EB6  363C 0186               1537      MOVE.W #390, D3
00001EBA  383C 0050               1538      MOVE.W #80, D4
00001EBE  4E4F                    1539      TRAP #15
00001EC0                          1540      ;FILL SEGMENTS
00001EC0                          1541  ;FILL SEGMENT 1 LEFT WALL
00001EC0                          1542    ;SET FILL COLOR TO DARKER GREY, FOR W
00001EC0  103C 0051               1543      MOVE.B #81, D0
00001EC4                          1544      ;MOVE.L #$00969696, D1
00001EC4  223C 0020202F           1545      MOVE.L #$0020202F, D1
00001ECA  4E4F                    1546      TRAP #15
00001ECC                          1547      ;END SET FILL COLOR
00001ECC  103C 0059               1548      MOVE.B #89, D0
00001ED0  323C 0064               1549      MOVE.W #100, D1
00001ED4  343C 0064               1550      MOVE.W #100, D2
00001ED8  4E4F                    1551      TRAP #15
00001EDA                          1552      
00001EDA                          1553  ;FILL SEGMENT 2 CEILING
00001EDA                          1554    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00001EDA  103C 0051               1555      MOVE.B #81, D0
00001EDE                          1556      ;MOVE.L #$00C0C0C0, D1
00001EDE  223C 00141424           1557      MOVE.L #$00141424,D1
00001EE4  4E4F                    1558      TRAP #15
00001EE6                          1559      ;END SET FILL COLOR
00001EE6  103C 0059               1560      MOVE.B #89, D0
00001EEA  323C 0064               1561      MOVE.W #100, D1
00001EEE  343C 0032               1562      MOVE.W #50, D2
00001EF2  4E4F                    1563      TRAP #15
00001EF4                          1564      
00001EF4                          1565  ;FILL SEGMENT 3 RIGHT WALL
00001EF4                          1566    ;SET FILL COLOR TO LIGHTER GREY, FOR CEILING 
00001EF4  103C 0051               1567      MOVE.B #81, D0
00001EF8                          1568      ;MOVE.L #$00969696, D1
00001EF8  223C 0020202F           1569      MOVE.L #$0020202F,D1
00001EFE  4E4F                    1570      TRAP #15
00001F00                          1571      ;END SET FILL COLOR
00001F00  103C 0059               1572      MOVE.B #89, D0
00001F04  323C 0276               1573      MOVE.W #630, D1
00001F08  343C 01D6               1574      MOVE.W #470, D2
00001F0C  4E4F                    1575      TRAP #15
00001F0E                          1576      
00001F0E                          1577  ;FILL SEGMENT 4 BACKGROUND WALL
00001F0E                          1578    ;SET FILL COLOR TO 
00001F0E  103C 0051               1579      MOVE.B #81, D0
00001F12                          1580      ;MOVE.L #$00ABABAB, D1
00001F12  223C 001A1A2A           1581      MOVE.L #$001A1A2A, D1
00001F18  4E4F                    1582      TRAP #15
00001F1A                          1583      ;END SET FILL COLOR
00001F1A  103C 0059               1584      MOVE.B #89, D0
00001F1E  323C 00F0               1585      MOVE.W #240, D1
00001F22  343C 0140               1586      MOVE.W #320, D2
00001F26  4E4F                    1587      TRAP #15
00001F28                          1588      
00001F28                          1589  ;FILL SEGMENT 5 PANEL 
00001F28                          1590    ;SET FILL COLOR TO 
00001F28  103C 0051               1591      MOVE.B #81, D0
00001F2C                          1592      ;MOVE.L #$00AFAFAF, D1
00001F2C  223C 001F1F2F           1593      MOVE.L #$001F1F2F, D1
00001F32  4E4F                    1594      TRAP #15
00001F34                          1595      ;END SET FILL COLOR
00001F34  103C 0059               1596      MOVE.B #89, D0
00001F38  323C 011D               1597      MOVE.W #285, D1
00001F3C  343C 00D7               1598      MOVE.W #215, D2
00001F40  4E4F                    1599      TRAP #15
00001F42                          1600      
00001F42                          1601  ;FILL ELLIPSE LIGHT 
00001F42                          1602    ;SET FILL COLOR TO 
00001F42  103C 0051               1603      MOVE.B #81, D0
00001F46                          1604      ;MOVE.L #$00A1E9E9, D1
00001F46  223C 000000FF           1605      MOVE.L #$000000FF, D1
00001F4C  4E4F                    1606      TRAP #15
00001F4E                          1607      ;END SET FILL COLOR
00001F4E  103C 0059               1608      MOVE.B #89, D0
00001F52  323C 0140               1609      MOVE.W #320, D1
00001F56  343C 003C               1610      MOVE.W #60, D2
00001F5A  4E4F                    1611      TRAP #15
00001F5C                          1612  
00001F5C                          1613  ;DRAW DOWNWARDS TRIANGLE FOR ELEVATOR BUTTON 1
00001F5C                          1614      ;SET FILL COLOR 
00001F5C  103C 0051               1615      MOVE.B #81, D0
00001F60  223C 000000CC           1616      MOVE.L #COLBUTHL, D1
00001F66  4E4F                    1617      TRAP #15
00001F68                          1618      ;END SET FILL COLOR
00001F68  3F3C 0135               1619      MOVE.W #309, -(A7) ;COORDENADA Y 
00001F6C  3F3C 0136               1620      MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00001F70  3F3C 0016               1621      MOVE.W #22, -(A7)
00001F74  4EB9 00001FAA           1622      JSR TRIANGLE
00001F7A  3C1F                    1623      MOVE.W (A7)+, D6                        ARTURO SE TE OLVIDO LIMPIAR LA PILA 
00001F7C  3C1F                    1624      MOVE.W (A7)+, D6
00001F7E  3C1F                    1625      MOVE.W (A7)+, D6
00001F80                          1626  ;DRAW UPWARDS TRIANGLE FOR ELEVATOR BUTTON 2
00001F80                          1627     ;SET FILL COLOR
00001F80  103C 0051               1628     MOVE.B #81, D0
00001F84  223C 00EEEEEE           1629     MOVE.L #COLBUTHV, D1
00001F8A  4E4F                    1630     TRAP #15
00001F8C                          1631     
00001F8C                          1632      ;END SET FILL COLOR
00001F8C  3F3C 00F9               1633     MOVE.W #249, -(A7) ;COORDENADA Y 
00001F90  3F3C 0136               1634     MOVE.W #310, -(A7) ;320 ES EL CENTRO. LA LONGITUD SERA 22 
00001F94  3F3C FFEA               1635     MOVE.W #-22, -(A7)
00001F98  4EB9 00001FAA           1636     JSR TRIANGLE
00001F9E  3C1F                    1637     MOVE.W (A7)+, D6
00001FA0  3C1F                    1638     MOVE.W (A7)+, D6
00001FA2  3C1F                    1639     MOVE.W (A7)+, D6
00001FA4  4CDF 7FFF               1640     MOVEM.L (A7)+, D0-D7/A0-A6
00001FA8                          1641  
00001FA8  4E75                    1642     RTS
00001FAA                          1643  ; ------------------------------------------------------------------------------
00001FAA                          1644  TRIANGLE
00001FAA                          1645  ; DRAWS AN ALMOST EQUILATERAL TRIANGLE. THE TRIANGLE WILL BE UPWARDS ORIENTATED 
00001FAA                          1646  ; IF THE SIDES LENGTH IS NEGATIVE, OTHERWHISTE IT WILL BE DOWNWARDS ORIENTATED
00001FAA                          1647  ; INPUT    : TRIANGLE LEFT CORNER POSITION Y (WORD), POSITION X (WORD) AND
00001FAA                          1648  ;            SIDES LENGTH (WORD) IN THAT ORDER
00001FAA                          1649  ; OUTPUT   : NONE
00001FAA                          1650  ; MODIFIES : NONE
00001FAA                          1651  ; ------------------------------------------------------------------------------
00001FAA  48A7 F800               1652      MOVEM.W D0-D4, -(A7)
00001FAE                          1653      ; LINE FROM LEFT TO RIGHT
00001FAE  103C 0054               1654      MOVE.B  #84,D0      ; TASK NUMBER
00001FB2  322F 0010               1655      MOVE.W  16(A7),D1   ; X POSITION FROM
00001FB6  342F 0012               1656      MOVE.W  18(A7),D2   ; Y POSITION FROM
00001FBA  3802                    1657      MOVE.W  D2,D4       ; Y POSITION TO
00001FBC  362F 000E               1658      MOVE.W  14(A7),D3   ; LENGTH
00001FC0                          1659      
00001FC0  6A00 0004               1660      BPL.W   .UPWARDS
00001FC4  4443                    1661      NEG.W   D3          ; TURNING LENGTH INTO POSITIVE
00001FC6                          1662  .UPWARDS
00001FC6  D641                    1663      ADD.W   D1,D3       ; TURNING LENGTH INTO POSITION (Y POSITION TO)
00001FC8  4E4F                    1664      TRAP    #15         ; HORIZONTAL LINE DRAWN
00001FCA                          1665      ; LINE FROM RIGHT TO UP/DOWN
00001FCA  9641                    1666      SUB.W   D1,D3       ; I GET LENGTH IN D3
00001FCC  3001                    1667      MOVE.W  D1,D0       ; I GET X POSITION FROM IN DO
00001FCE  D243                    1668      ADD.W   D3,D1       ; X POSITION FROM
00001FD0  E24B                    1669      LSR.W   #1,D3       ; LENGTH/2
00001FD2  D640                    1670      ADD.W   D0,D3       ; X POSITION TO (LAST X POSITION FROM + LENGTH/2)
00001FD4                          1671      ; HEIGHT OF TRIANGLE = LENGTH*0.5*(3^0.5) =~ LENGTH*0.8 =~ LENGTH
00001FD4  D86F 000E               1672      ADD.W   14(A7),D4   ; Y POSITION TO (LENGTH + Y POSITION)
00001FD8  103C 0054               1673      MOVE.B  #84,D0
00001FDC  4E4F                    1674      TRAP    #15
00001FDE                          1675      ; LINE FROM LEFT TO UP/DOWN
00001FDE  322F 0010               1676      MOVE.W  16(A7),D1   ; X POSITION FROM
00001FE2  4E4F                    1677      TRAP    #15         ; ALL THE OTHERS COORDINATES ARE THE SAME
00001FE4                          1678      
00001FE4                          1679      ; FILLING TRIANGLE
00001FE4  103C 0059               1680      MOVE.B  #89,D0
00001FE8  5241                    1681      ADDQ.W  #1,D1
00001FEA  363C 0001               1682      MOVE.W  #1,D3
00001FEE  4A6F 000E               1683      TST.W   14(A7)
00001FF2  6A00 0004               1684      BPL.W   .ISPOSITIVE
00001FF6  4443                    1685      NEG.W   D3
00001FF8                          1686  .ISPOSITIVE
00001FF8  D443                    1687      ADD.W   D3,D2
00001FFA  4E4F                    1688      TRAP    #15
00001FFC                          1689      
00001FFC  4C9F 001F               1690      MOVEM.W (A7)+,D0-D4
00002000  4E75                    1691      RTS
00002002                          1692      
00002002                          1693  ; ------------------------------------------------------------------------------
00002002                          1694  ELEVATORUPDATE ; 1 = up 3 = down
00002002                          1695  ; INPUT    : 
00002002                          1696  ; OUTPUT   : 
00002002                          1697  ; MODIFIES : 
00002002                          1698  ; ------------------------------------------------------------------------------
00002002  4EB9 00002306           1699      JSR  ELEVATORMUSIC  
00002008  0839 0005 000027C8      1700      BTST #5, KBDVAL
00002010  6600 002A               1701      BNE .HLSEL
00002014  0839 0007 000027C8      1702      BTST #7, KBDVAL
0000201C  6600 0004               1703      BNE .HVSEL
00002020  4E75                    1704      RTS
00002022                          1705  .HVSEL  ;LOAD 1ST HEAVEN MAP
00002022  33FC 0002 00002848      1706      MOVE.W  #2,(STANEXT)
0000202A  13FC 0000 00002828      1707      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HEAVEN MUSIC
00002032  33FC 0000 000027E2      1708      MOVE.W #0, LOADEDMAP    
0000203A  4E75                    1709      RTS
0000203C                          1710  .HLSEL  ;LOAD 1ST HELL MAP
0000203C  33FC 0002 00002848      1711      MOVE.W  #2,(STANEXT)
00002044  13FC 0000 00002828      1712      MOVE.B #0, MUSICPLAYED ;TO BE ABLE TO LOAD HELL MUSIC
0000204C  33FC 0004 000027E2      1713      MOVE.W #4, LOADEDMAP
00002054  4E75                    1714      RTS
00002056                          1715      
00002056                          1716          
00002056                          1717  
00002056                          1718  
00002056                          1719  
00002056                          1720  
00002056                          1721  
00002056                          1722  
00002056                          1723  
00002056                          1724  
00002056                          1725  
00002056                          1726  
00002056                          1727  
00002056                          1728  -------------------- end include --------------------
00002056                          1729              INCLUDE "PLAYER.X68"    
00002056                          1730  ; ==============================================================================
00002056                          1731  ; PLAYER MANAGEMENT
00002056                          1732  ; ==============================================================================
00002056                          1733              
00002056                          1734  ; ------------------------------------------------------------------------------
00002056                          1735  PLAYERUPD
00002056                          1736  ; UPDATES THE PLAYER.
00002056                          1737  ; INPUT    : NONE 
00002056                          1738  ; OUTPUT   : NONE
00002056                          1739  ; MODIFIES : NONE
00002056                          1740  ; ------------------------------------------------------------------------------
00002056  48E7 F000               1741              MOVEM.L D0-D3,-(A7)
0000205A                          1742              ; CHECK COLLISIONS
0000205A                          1743              ; TOP LEFT CORNER
0000205A  3039 000027D0           1744              MOVE.W  (PLAYERPOSX),D0
00002060  E188                    1745              LSL.L   #8,D0
00002062  E188                    1746              LSL.L   #8,D0
00002064  3039 000027D2           1747              MOVE.W  (PLAYERPOSY),D0
0000206A                          1748              
0000206A  3239 000027D0           1749              MOVE.W  (PLAYERPOSX),D1
00002070  0641 0020               1750              ADD.W   #PLAYERWIDTH,D1
00002074  E189                    1751              LSL.L   #8,D1
00002076  E189                    1752              LSL.L   #8,D1
00002078  3239 000027D2           1753              MOVE.W  (PLAYERPOSY),D1
0000207E  0641 0020               1754              ADD.W   #PLAYERHEIGHT,D1
00002082                          1755              
00002082  4EB8 14DA               1756              JSR BLKCOLL    
00002086                          1757                              
00002086  0839 0000 000027C8      1758              BTST #0, KBDVAL         ; SI NO VA HACIA LA IZQUIERDA
0000208E  6700 001E               1759              BEQ .NOLEFT
00002092  5979 000027D0           1760              SUB.W   #PLAYERSPEED,(PLAYERPOSX)
00002098  4A80                    1761              TST.L   D0              ; SI HAY COLISIONES CON D0
0000209A  6600 000C               1762              BNE .LEFT             
0000209E  4A83                    1763              TST.L   D3              ; SI HAY COLISIONES CON D3
000020A0  6600 0006               1764              BNE .LEFT
000020A4  6000 0008               1765              BRA  .NOLEFT
000020A8  5879 000027D0           1766  .LEFT       ADD.W   #PLAYERSPEED,(PLAYERPOSX)
000020AE                          1767  .NOLEFT     
000020AE  0839 0001 000027C8      1768              BTST #1, KBDVAL         ; SI NO VA ARRIBA
000020B6  6700 001E               1769              BEQ .NOUP
000020BA  5979 000027D2           1770              SUB.W   #PLAYERSPEED,(PLAYERPOSY)
000020C0  4A80                    1771              TST.L   D0              ; SI HAY COLISIONES CON D0
000020C2  6600 000C               1772              BNE .UP             
000020C6  4A81                    1773              TST.L   D1              ; SI HAY COLISIONES CON D1
000020C8  6600 0006               1774              BNE .UP
000020CC  6000 0008               1775              BRA .NOUP
000020D0  5879 000027D2           1776  .UP         ADD.W   #PLAYERSPEED,(PLAYERPOSY)
000020D6                          1777  .NOUP       
000020D6  0839 0002 000027C8      1778              BTST #2, KBDVAL         ; SI NO VA HACIA LA DERECHA
000020DE  6700 001E               1779              BEQ .NORIGHT
000020E2  5879 000027D0           1780              ADD.W   #PLAYERSPEED,(PLAYERPOSX)
000020E8  4A81                    1781              TST.L   D1              ; SI HAY COLISIONES CON D1
000020EA  6600 000C               1782              BNE .RIGHT             
000020EE  4A82                    1783              TST.L   D2              ; SI HAY COLISIONES CON D2
000020F0  6600 0006               1784              BNE .RIGHT
000020F4  6000 0008               1785              BRA .NORIGHT
000020F8  5979 000027D0           1786  .RIGHT      SUB.W   #PLAYERSPEED,(PLAYERPOSX)
000020FE                          1787  .NORIGHT    
000020FE  0839 0003 000027C8      1788              BTST #3, KBDVAL         ; SI NO VA ABAJO
00002106  6700 001E               1789              BEQ .NODOWN             
0000210A  5879 000027D2           1790              ADD.W   #PLAYERSPEED,(PLAYERPOSY)
00002110  4A82                    1791              TST.L   D2              ; SI HAY COLISIONES CON D2
00002112  6600 000C               1792              BNE .DOWN             
00002116  4A83                    1793              TST.L   D3              ; SI HAY COLISIONES CON D3
00002118  6600 0006               1794              BNE .DOWN             
0000211C  6000 0008               1795              BRA .NODOWN             
00002120  5979 000027D2           1796  .DOWN       SUB.W   #PLAYERSPEED,(PLAYERPOSY)
00002126                          1797  .NODOWN     
00002126  4CDF 000F               1798              MOVEM.L (A7)+,D0-D3
0000212A  4E75                    1799              RTS
0000212C                          1800          
0000212C                          1801  ; ------------------------------------------------------------------------------
0000212C                          1802  PLAYERPLOT
0000212C                          1803  ; PLOT THE PLAYER.
0000212C                          1804  ; INPUT    : NONE 
0000212C                          1805  ; OUTPUT   : NONE
0000212C                          1806  ; MODIFIES : NONE
0000212C                          1807  ; ------------------------------------------------------------------------------
0000212C                          1808              ; *** DIBUJAMOS CUADRADO, ESTO LO PODREMOS BORRAR LUEGO AL SUSTITUIRLO POR EL JUGADOR ***
0000212C  1F00                    1809              MOVE.B  D0,-(A7)
0000212E  2F01                    1810              MOVE.L  D1,-(A7)
00002130  48A7 3800               1811        MOVEM.W D2-D4, -(A7)
00002134                          1812        
00002134  223C 00CC954E           1813        MOVE.L #$00CC954E,D1 ;PEN COLOR
0000213A  103C 0050               1814        MOVE.B #80,D0
0000213E  4E4F                    1815        TRAP #15
00002140  223C 00B53866           1816        MOVE.L #$00B53866,D1 ;FILL COLOR
00002146  103C 0051               1817        MOVE.B #81,D0
0000214A  4E4F                    1818        TRAP #15
0000214C                          1819        ; SE DIBUJA EL CUADRADO
0000214C  3239 000027D0           1820        MOVE.W (PLAYERPOSX),D1    
00002152  3439 000027D2           1821        MOVE.W (PLAYERPOSY),D2      
00002158  3601                    1822        MOVE.W D1,D3
0000215A  0643 0020               1823              ADD.W  #PLAYERWIDTH,D3  
0000215E  3802                    1824        MOVE.W D2,D4
00002160  0644 0020               1825              ADD.W  #PLAYERHEIGHT,D4
00002164  103C 0057               1826        MOVE.B #87,D0
00002168  4E4F                    1827        TRAP #15
0000216A                          1828        
0000216A  4C9F 001C               1829              MOVEM.W (A7)+,D2-D4
0000216E  221F                    1830              MOVE.L  (A7)+,D1      
00002170  101F                    1831              MOVE.B  (A7)+,D0
00002172                          1832    
00002172  4E75                    1833        RTS
00002174                          1834  
00002174                          1835  
00002174                          1836  
00002174                          1837  
00002174                          1838  
00002174                          1839  -------------------- end include --------------------
00002174                          1840              INCLUDE "PROJECTILE.X68"
00002174                          1841  ; ==============================================================================
00002174                          1842  ; PROJECTILE MANAGEMENT (AGENT)
00002174                          1843  ; PROJPOSX (W)  (A0)
00002174                          1844  ; PROJPOSY (W) 2(A0)
00002174                          1845  ; PROJVELX (W) 4(A0)
00002174                          1846  ; PROJVELY (W) 6(A0)
00002174                          1847  ; ==============================================================================
00002174                          1848  
00002174                          1849  ; ------------------------------------------------------------------------------
00002174                          1850  PROJINIT 
00002174                          1851  ; INITIALIZES THE PROJECTILE.
00002174                          1852  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00002174                          1853  ; OUTPUT   : NONE
00002174                          1854  ; MODIFIES : NONE
00002174                          1855  ; ------------------------------------------------------------------------------
00002174  2F00                    1856             MOVE.L  D0,-(A7)
00002176                          1857             
00002176  4280                    1858              CLR.L   D0
00002178  0839 0004 000027C9      1859              BTST #4, (KBDEDGE)    
00002180  6700 0008               1860              BEQ .FUP ; SI SALTA ES PORQUE NO HA DISPARADO A LA IZQUIERDA
00002184  0680 FFF80000           1861              ADD.L   #-PROJSPEEDX<<16,D0
0000218A  0839 0005 000027C9      1862  .FUP        BTST #5, (KBDEDGE)      
00002192  6700 0006               1863              BEQ .FRIGHT ; SI SALTA ES PORQUE NO HA DISPARADO ARRIBA
00002196  0640 FFF8               1864              ADD.W   #-PROJSPEEDY,D0 
0000219A  0839 0006 000027C9      1865  .FRIGHT     BTST #6, (KBDEDGE)
000021A2  6700 0008               1866              BEQ .FDOWN ; SI SALTA ES PORQUE NO HA DISPARADO A LA DERECHA
000021A6  0680 00080000           1867              ADD.L   #PROJSPEEDX<<16,D0
000021AC  0839 0007 000027C9      1868  .FDOWN      BTST #7, (KBDEDGE)
000021B4  6700 0004               1869              BEQ .NOTFDOWN ; SI SALTA ES PORQUE NO HA DISPARADO ABAJO
000021B8  5040                    1870              ADD.W   #PROJSPEEDY,D0
000021BA  4A80                    1871  .NOTFDOWN   TST.L   D0
000021BC  6600 0006               1872              BNE.L .SHOOT ; SI EN D0 NO HAY NADA ES PORQUE SE HAN ANULADO DISPAROS CONTRARIOS
000021C0  303C 0008               1873              MOVE.W  #PROJSPEEDY,D0 ; POR PREDETERMINADO DISPARA ABAJO SI SE ANULAN
000021C4  20B9 000027D0           1874  .SHOOT      MOVE.L  (PLAYERPOSX),(A0)
000021CA  2140 0004               1875              MOVE.L  D0,4(A0) ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD 
000021CE  5279 000027D4           1876              ADD.W   #1,(NPROJ)
000021D4  201F                    1877              MOVE.L  (A7)+,D0
000021D6  4E75                    1878              RTS
000021D8                          1879    
000021D8                          1880  ; ------------------------------------------------------------------------------
000021D8                          1881  PROJUPD 
000021D8                          1882  ; UPDATES THE PROJECTILE.
000021D8                          1883  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
000021D8                          1884  ; OUTPUT   : NONE
000021D8                          1885  ; MODIFIES : NONE
000021D8                          1886  ; ------------------------------------------------------------------------------
000021D8  48E7 F000               1887              MOVEM.L  D0-D3,-(A7)
000021DC  2028 0004               1888              MOVE.L  4(A0),D0 ; COMO X E Y ESTN JUNTOS EN MEMORIA HAGO UNA SOLA OPERACIN LONG WORD
000021E0  D168 0002               1889              ADD.W   D0,2(A0)
000021E4  E088                    1890              LSR.L   #8,D0 ; LAS SUMAS SE TIENEN QUE HACER APARTE PARA QUE SI HAY OVERFLOW NO SE AFECTEN ENTRE ELLAS
000021E6  E088                    1891              LSR.L   #8,D0
000021E8  D150                    1892              ADD.W   D0,(A0) 
000021EA                          1893              
000021EA                          1894              ; CHECK COLLISIONS
000021EA                          1895              ; TOP LEFT CORNER
000021EA  3010                    1896              MOVE.W  (A0),D0
000021EC  E188                    1897              LSL.L   #8,D0
000021EE  E188                    1898              LSL.L   #8,D0
000021F0  3028 0002               1899              MOVE.W  2(A0),D0
000021F4                          1900              
000021F4  3210                    1901              MOVE.W  (A0),D1
000021F6  0641 0010               1902              ADD.W   #PROJWIDTH,D1
000021FA  E189                    1903              LSL.L   #8,D1
000021FC  E189                    1904              LSL.L   #8,D1
000021FE  3228 0002               1905              MOVE.W  2(A0),D1
00002202  0641 0010               1906              ADD.W   #PROJHEIGHT,D1
00002206                          1907  
00002206  4EB8 14DA               1908              JSR BLKCOLL
0000220A  4A80                    1909              TST.L   D0
0000220C  6600 0028               1910              BNE.L   .PROJCOLL
00002210  4A81                    1911              TST.L   D1
00002212  6600 0022               1912              BNE.L   .PROJCOLL
00002216  4A82                    1913              TST.L   D2
00002218  6600 001C               1914              BNE.L   .PROJCOLL
0000221C  4A83                    1915              TST.L   D3
0000221E  6600 0016               1916              BNE.L   .PROJCOLL
00002222                          1917  .PROJNOCOLL 
00002222  4EB8 1368               1918              JSR     UTLCHCOLL ; CHECKS COLLISION BETWEEN OBSTACLE AND PROJECTILE
00002226  4A00                    1919              TST.B   D0
00002228  6700 0018               1920              BEQ     .PROJNOHIT 
0000222C  5088                    1921              ADD.L   #8,A0 ;     PQ??????????????
0000222E  4EB9 00002792           1922              JSR     OBSHIT  ; HITS OBSTACLE
00002234  2049                    1923              MOVE.L  A1,A0 ; PQ ????????
00002236                          1924              
00002236  4EB8 10F4               1925  .PROJCOLL   JSR AGLKILL
0000223A  5379 000027D4           1926              SUB.W   #1,(NPROJ)
00002240  60E0                    1927              BRA     .PROJNOCOLL
00002242                          1928              
00002242  4CDF 000F               1929  .PROJNOHIT  MOVEM.L  (A7)+,D0-D3
00002246  4E75                    1930              RTS
00002248                          1931              
00002248                          1932  
00002248                          1933  ; ------------------------------------------------------------------------------
00002248                          1934  PROJPLOT 
00002248                          1935  ; PLOTS THE PROJECTILE.
00002248                          1936  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES  
00002248                          1937  ; OUTPUT   : NONE
00002248                          1938  ; MODIFIES : NONE
00002248                          1939  ; ------------------------------------------------------------------------------
00002248  1F00                    1940              MOVE.B  D0,-(A7)
0000224A  2F01                    1941              MOVE.L  D1,-(A7)
0000224C  48A7 3800               1942        MOVEM.W D2-D4, -(A7)
00002250                          1943        
00002250  223C 00C00FFE           1944        MOVE.L #$00C00FFE,D1 ;PEN COLOR
00002256  103C 0050               1945        MOVE.B #80,D0
0000225A  4E4F                    1946        TRAP #15
0000225C  223C 00BFF006           1947        MOVE.L #$00BFF006,D1 ;FILL COLOR
00002262  103C 0051               1948        MOVE.B #81,D0
00002266  4E4F                    1949        TRAP #15
00002268                          1950        ; SE DIBUJA EL CUADRADO
00002268  3210                    1951        MOVE.W (A0),D1    
0000226A  3428 0002               1952        MOVE.W 2(A0),D2     
0000226E  3601                    1953        MOVE.W D1,D3
00002270  0643 0010               1954              ADD.W  #PROJWIDTH,D3    
00002274  3802                    1955        MOVE.W D2,D4
00002276  0644 0010               1956              ADD.W  #PROJHEIGHT,D4
0000227A  103C 0057               1957        MOVE.B #87,D0
0000227E  4E4F                    1958        TRAP #15
00002280                          1959        
00002280  4C9F 001C               1960              MOVEM.W (A7)+,D2-D4
00002284  221F                    1961              MOVE.L  (A7)+,D1      
00002286  101F                    1962              MOVE.B  (A7)+,D0
00002288  4E75                    1963              RTS
0000228A                          1964  
0000228A                          1965  
0000228A                          1966  
0000228A                          1967  
0000228A                          1968  
0000228A                          1969  -------------------- end include --------------------
0000228A                          1970              INCLUDE "AUDIO.X68"
0000228A                          1971     
0000228A                          1972  ; =============================================================================
0000228A                          1973  ; AUDIO MANAGEMENT
0000228A                          1974  ; =============================================================================
0000228A                          1975  
0000228A                          1976  
0000228A                          1977  ; -----------------------------------------------------------------------------
0000228A                          1978  AUDINIT
0000228A                          1979  ; CHANGES AUDIO TO PLAY
0000228A                          1980  ; INPUT    - NONE
0000228A                          1981  ; OUTPUT   - NONE
0000228A                          1982  ; MODIFIES - NONE
0000228A                          1983  ; -----------------------------------------------------------------------------
0000228A                          1984      
0000228A  48A7 E000               1985      MOVEM.W D0-D2, -(A7)
0000228E  48A7 00C0               1986      MOVEM.W A0-A1, -(A7)
00002292                          1987  ;LOAD ELEVATOR MUSIC IN POS 0 
00002292  103C 0047               1988      MOVE.B #71, D0
00002296  43F8 100F               1989      LEA ELEVATOR_MUSIC, A1
0000229A  123C 0000               1990      MOVE.B #0, D1
0000229E  4E4F                    1991      TRAP #15
000022A0                          1992  ;LOAD HEAVEN MUSIC IN POS 1
000022A0  43F8 1000               1993      LEA HEAVENSOUND, A1
000022A4  123C 0001               1994      MOVE.B #1, D1
000022A8  4E4F                    1995      TRAP #15
000022AA                          1996  ;LOAD HELL MUSIC IN POS 2
000022AA  43F8 1026               1997      LEA HELLSOUND, A1
000022AE  123C 0002               1998      MOVE.B #2, D1
000022B2  4E4F                    1999      TRAP #15
000022B4  4C9F 0300               2000      MOVEM.W (A7)+, A0-A1
000022B8  4C9F 0007               2001      MOVEM.W (A7)+, D0-D2
000022BC                          2002  
000022BC  4E75                    2003      RTS
000022BE                          2004  
000022BE                          2005  
000022BE                          2006  ; -----------------------------------------------------------------------------
000022BE                          2007  AUDPLAY
000022BE                          2008  ; CHANGES AUDIO TO PLAY
000022BE                          2009  ; INPUT    - NONE
000022BE                          2010  ; OUTPUT   - NONE
000022BE                          2011  ; MODIFIES - NONE
000022BE                          2012  ; -----------------------------------------------------------------------------
000022BE                          2013      
000022BE  48E7 E000               2014      MOVEM.L D0-D2, -(A7)
000022C2  48A7 00C0               2015      MOVEM.W A0-A1, -(A7)    
000022C6                          2016      
000022C6  3239 000027E2           2017      MOVE.W LOADEDMAP, D1
000022CC  C2FC 0006               2018             MULU #6, D1
000022D0  3241                    2019             MOVEA.W D1, A1
000022D2  4EE9 22D6               2020             JMP MSCSEL(A1)
000022D6                          2021  MSCSEL:
000022D6                          2022             
000022D6  4EF9 00002324           2023             JMP HEAVENMUSIC
000022DC                          2024             
000022DC  4EF9 00002324           2025             JMP HEAVENMUSIC
000022E2                          2026             
000022E2  4EF9 00002324           2027             JMP HEAVENMUSIC
000022E8                          2028             
000022E8  4EF9 00002324           2029             JMP HEAVENMUSIC
000022EE                          2030             
000022EE  4EF9 00002346           2031             JMP HELLMUSIC
000022F4                          2032             
000022F4  4EF9 00002346           2033             JMP HELLMUSIC
000022FA                          2034             
000022FA  4EF9 00002346           2035             JMP HELLMUSIC
00002300                          2036             
00002300  4EF9 00002346           2037             JMP HELLMUSIC
00002306                          2038             
00002306                          2039  
00002306                          2040  ELEVATORMUSIC
00002306  48A7 E000               2041      MOVEM.W D0-D2 ,-(A7)
0000230A  103C 004C               2042      MOVE.B #76, D0
0000230E  123C 0000               2043      MOVE.B #0, D1
00002312  7400                    2044      MOVE.L #0, D2
00002314  4E4F                    2045      TRAP #15
00002316  4C9F 0007               2046      MOVEM.W (A7)+, D0-D2 
0000231A  13FC 0001 00002828      2047      MOVE.B #1, MUSICPLAYED
00002322  4E75                    2048      RTS
00002324                          2049  
00002324                          2050  HEAVENMUSIC 
00002324  103C 004C               2051      MOVE.B #76, D0
00002328  123C 0000               2052      MOVE.B #0, D1
0000232C  7402                    2053      MOVE.L #2, D2
0000232E  4E4F                    2054      TRAP #15
00002330  103C 004C               2055      MOVE.B #76, D0
00002334  123C 0001               2056      MOVE.B #1, D1
00002338  7400                    2057      MOVE.L #0, D2
0000233A  4E4F                    2058      TRAP #15
0000233C  4C9F 0300               2059      MOVEM.W (A7)+, A0-A1
00002340  4CDF 0007               2060      MOVEM.L (A7)+, D0-D2
00002344  4E75                    2061      RTS
00002346                          2062  HELLMUSIC
00002346  103C 004C               2063      MOVE.B #76, D0
0000234A  123C 0000               2064      MOVE.B #0, D1
0000234E  7402                    2065      MOVE.L #2, D2
00002350  4E4F                    2066      TRAP #15
00002352  103C 004C               2067      MOVE.B #76, D0
00002356  123C 0002               2068      MOVE.B #2, D1
0000235A  7400                    2069      MOVE.L #0,  D2
0000235C  4E4F                    2070      TRAP #15
0000235E  4C9F 0300               2071      MOVEM.W (A7)+, A0-A1
00002362  4CDF 0007               2072      MOVEM.L (A7)+, D0-D2
00002366  4E75                    2073      RTS
00002368                          2074  
00002368                          2075  FIREDSOUND
00002368  48A7 E000               2076      MOVEM.W D0-D2, -(A7)
0000236C  48A7 00C0               2077      MOVEM.W A0-A1, -(A7)
00002370  103C 0049               2078      MOVE.B #73, D0
00002374  43F8 1035               2079      LEA PROJ_SOUND, A1
00002378  4E4F                    2080      TRAP #15
0000237A  4C9F 0300               2081      MOVEM.W (A7)+, A0-A1
0000237E  4C9F 0007               2082      MOVEM.W (A7)+, D0-D2
00002382  4E75                    2083      RTS
00002384                          2084  
00002384                          2085  -------------------- end include --------------------
00002384                          2086              INCLUDE "STATES.X68"
00002384                          2087  ; =============================================================================
00002384                          2088  ; GAME STATE MANAGEMENT
00002384                          2089  ; =============================================================================
00002384                          2090  
00002384                          2091  ; -----------------------------------------------------------------------------
00002384                          2092  STAINIT
00002384                          2093  ; INITALIZES THE STATE MANAGER
00002384                          2094  ; INPUT    - NONE
00002384                          2095  ; OUTPUT   - NONE
00002384                          2096  ; MODIFIES - NONE
00002384                          2097  ; -----------------------------------------------------------------------------
00002384  33FC FFFF 00002846      2098              MOVE.W  #STANONE,(STACUR)
0000238C  4279 00002848           2099              CLR.W   (STANEXT)
00002392  4E75                    2100              RTS
00002394                          2101  
00002394                          2102  ; -----------------------------------------------------------------------------
00002394                          2103  STAUPD
00002394                          2104  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00002394                          2105  ; INPUT    - NONE
00002394                          2106  ; OUTPUT   - NONE
00002394                          2107  ; MODIFIES - NONE
00002394                          2108  ; -----------------------------------------------------------------------------
00002394  48E7 8080               2109              MOVEM.L D0/A0,-(A7)
00002398  4280                    2110              CLR.L   D0
0000239A  3039 00002848           2111              MOVE.W  (STANEXT),D0
000023A0  B079 00002846           2112              CMP.W   (STACUR),D0
000023A6  6700 0012               2113              BEQ     .DOUPD
000023AA  33C0 00002846           2114              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
000023B0  E588                    2115              LSL.L   #2,D0
000023B2  2040                    2116              MOVE.L  D0,A0
000023B4  2068 23D2               2117              MOVE.L  .INITBL(A0),A0
000023B8  4E90                    2118              JSR     (A0)
000023BA  4280                    2119  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
000023BC  3039 00002846           2120              MOVE.W  (STACUR),D0
000023C2  E588                    2121              LSL.L   #2,D0
000023C4  2040                    2122              MOVE.L  D0,A0
000023C6  2068 23E2               2123              MOVE.L  .UPDTBL(A0),A0
000023CA  4E90                    2124              JSR     (A0)
000023CC  4CDF 0101               2125              MOVEM.L (A7)+,D0/A0
000023D0  4E75                    2126              RTS
000023D2= 0000241E 00001DE6 ...   2127  .INITBL     DC.L    STAEMPTY,ELEVATORINIT,GAMINIT,ENDGINIT
000023E2= 00002526 00002002 ...   2128  .UPDTBL     DC.L    ISCUPD,ELEVATORUPDATE,GAMUPD,ENDGUPD
000023F2                          2129  
000023F2                          2130  ; -----------------------------------------------------------------------------
000023F2                          2131  STAPLOT
000023F2                          2132  ; PERFORMS STATE PLOT
000023F2                          2133  ; INPUT    - NONE
000023F2                          2134  ; OUTPUT   - NONE
000023F2                          2135  ; MODIFIES - NONE
000023F2                          2136  ; -----------------------------------------------------------------------------
000023F2  48E7 8080               2137              MOVEM.L D0/A0,-(A7)
000023F6  4280                    2138              CLR.L   D0
000023F8  3039 00002846           2139              MOVE.W  (STACUR),D0
000023FE  E588                    2140              LSL.L   #2,D0
00002400  2040                    2141              MOVE.L  D0,A0
00002402  2068 240E               2142              MOVE.L  .PLTTBL(A0),A0
00002406  4E90                    2143              JSR     (A0)
00002408  4CDF 0101               2144              MOVEM.L (A7)+,D0/A0
0000240C  4E75                    2145              RTS
0000240E= 0000257A 00001DEA ...   2146  .PLTTBL     DC.L    ISCPLOT,ELEVATORPLOT,GAMPLOT,ENDGPLOT
0000241E                          2147  
0000241E                          2148  ; -----------------------------------------------------------------------------
0000241E                          2149  STAEMPTY
0000241E                          2150  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
0000241E                          2151  ; INPUT    - NONE
0000241E                          2152  ; OUTPUT   - NONE
0000241E                          2153  ; MODIFIES - NONE
0000241E                          2154  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
0000241E                          2155  ; -----------------------------------------------------------------------------
0000241E  4E75                    2156              RTS
00002420                          2157  
00002420                          2158  
00002420                          2159  
00002420                          2160  
00002420                          2161  
00002420                          2162  
00002420                          2163  
00002420                          2164  
00002420                          2165  
00002420                          2166  
00002420                          2167  
00002420                          2168  
00002420                          2169  
00002420                          2170  -------------------- end include --------------------
00002420                          2171              INCLUDE "GAME.X68"
00002420                          2172  ; ==============================================================================
00002420                          2173  ; GAME MANAGEMENT
00002420                          2174  ; ==============================================================================
00002420                          2175  
00002420                          2176  ; ------------------------------------------------------------------------------
00002420                          2177  GAMINIT
00002420                          2178  ; INITIALIZES THE GAME
00002420                          2179  ; INPUT    : NONE
00002420                          2180  ; OUTPUT   : NONE
00002420                          2181  ; MODIFIES : NONE
00002420                          2182  ; ------------------------------------------------------------------------------
00002420  48A7 FC00               2183              MOVEM.W D0-D5,-(A7)
00002424  48E7 0070               2184              MOVEM.L A1-A3,-(A7)
00002428                          2185              
00002428  4EB8 139C               2186              JSR UTLRAND
0000242C  6000 0004               2187              BRA .1STRTRY
00002430  5F40                    2188  .1STROOM    SUB.W   #MAXOBSXROOM-1,D0
00002432  B07C 0008               2189  .1STRTRY    CMP.W   #MAXOBSXROOM,D0
00002436  6E00 FFF8               2190              BGT.W   .1STROOM
0000243A                          2191              
0000243A  3A00                    2192              MOVE.W  D0,D5
0000243C                          2193              
0000243C  4EB8 139C               2194              JSR UTLRAND
00002440  6000 0004               2195              BRA .2NDRTRY
00002444  5F40                    2196  .2NDROOM    SUB.W   #MAXOBSXROOM-1,D0
00002446  B07C 0008               2197  .2NDRTRY    CMP.W   #MAXOBSXROOM,D0
0000244A  6E00 FFF8               2198              BGT.W   .2NDROOM
0000244E                          2199              
0000244E  3400                    2200              MOVE.W  D0,D2
00002450                          2201              
00002450  4EB8 139C               2202              JSR UTLRAND
00002454  6000 0004               2203              BRA .3RDRTRY
00002458  5F40                    2204  .3RDROOM    SUB.W   #MAXOBSXROOM-1,D0
0000245A  B07C 0008               2205  .3RDRTRY    CMP.W   #MAXOBSXROOM,D0
0000245E  6E00 FFF8               2206              BGT.W   .3RDROOM
00002462                          2207              
00002462  3600                    2208              MOVE.W  D0,D3
00002464                          2209              
00002464  4EB8 139C               2210              JSR UTLRAND
00002468  6000 0004               2211              BRA .4THRTRY
0000246C  5F40                    2212  .4THROOM    SUB.W   #MAXOBSXROOM-1,D0
0000246E  B07C 0008               2213  .4THRTRY    CMP.W   #MAXOBSXROOM,D0
00002472  6E00 FFF8               2214              BGT.W   .4THROOM
00002476                          2215              
00002476  3800                    2216              MOVE.W  D0,D4
00002478                          2217              ; TOTAL OBSTACLES
00002478                          2218  
00002478  D042                    2219              ADD.W   D2,D0
0000247A  D043                    2220              ADD.W   D3,D0
0000247C  D045                    2221              ADD.W   D5,D0
0000247E  33C0 0000284A           2222              MOVE.W  D0,(NOBS)
00002484  3239 000027E2           2223              MOVE.W  (LOADEDMAP),D1
0000248A                          2224              ; AGLADD
0000248A  43F9 000026C6           2225              LEA     OBSINIT,A1
00002490  45F8 241E               2226              LEA     STAEMPTY,A2
00002494  47F9 00002742           2227              LEA     OBSPLOT,A3
0000249A  303C 0002               2228              MOVE.W  #2,D0
0000249E                          2229              
0000249E                          2230  .LOOP1      
0000249E  4EB8 12BC               2231              JSR     AGLADD
000024A2  51CD FFFA               2232              DBRA.W  D5,.LOOP1
000024A6                          2233              
000024A6  5241                    2234              ADDQ.W  #1,D1
000024A8  4EB8 12BC               2235  .LOOP2      JSR     AGLADD
000024AC  51CA FFFA               2236              DBRA.W  D2,.LOOP2
000024B0                          2237              
000024B0  5241                    2238              ADDQ.W  #1,D1
000024B2  4EB8 12BC               2239  .LOOP3      JSR     AGLADD
000024B6  51CB FFFA               2240              DBRA.W  D3,.LOOP3
000024BA                          2241          
000024BA  5241                    2242              ADDQ.W  #1,D1
000024BC  4EB8 12BC               2243  .LOOP4      JSR     AGLADD
000024C0  51CC FFFA               2244              DBRA.W  D4,.LOOP4
000024C4                          2245  
000024C4  4CDF 0E00               2246              MOVEM.L (A7)+,A1-A3
000024C8  4C9F 003F               2247              MOVEM.W (A7)+,D0-D5
000024CC  4E75                    2248              RTS
000024CE                          2249              
000024CE                          2250  
000024CE                          2251  ; ------------------------------------------------------------------------------
000024CE                          2252  GAMUPD
000024CE                          2253  ; UPDATES THE GAME
000024CE                          2254  ; INPUT    : NONE
000024CE                          2255  ; OUTPUT   : NONE
000024CE                          2256  ; MODIFIES : NONE
000024CE                          2257  ; ------------------------------------------------------------------------------
000024CE  48E7 8070               2258              MOVEM.L D0/A1-A3,-(A7)
000024D2                          2259              
000024D2                          2260              ; CHECK IF MUSIC IS ALREADY PLAYING 
000024D2  1039 00002828           2261              MOVE.B MUSICPLAYED, D0
000024D8  B07C 0001               2262              CMP #1, D0
000024DC  6700 0006               2263              BEQ .NOMUSIC
000024E0  4EB8 22BE               2264              JSR AUDPLAY
000024E4                          2265  ; GENERAL UPDATES
000024E4  4EB8 2056               2266  .NOMUSIC    JSR PLAYERUPD   
000024E8  4EB8 1A06               2267              JSR MAPUPD
000024EC                          2268  ; SHOTS LOGIC         
000024EC  1039 000027C9           2269              MOVE.B  (KBDEDGE),D0
000024F2  C03C 00F0               2270              AND.B #%11110000,D0 ; SI DA CERO NO HA DISPARADO
000024F6  6718                    2271              BEQ.B .NOTFIRED
000024F8  4EB8 2368               2272              JSR FIREDSOUND
000024FC  43F8 2174               2273              LEA     PROJINIT,A1
00002500  45F8 21D8               2274              LEA     PROJUPD,A2
00002504  47F8 2248               2275              LEA     PROJPLOT,A3
00002508  303C 0001               2276              MOVE.W  #1,D0
0000250C  4EB8 12BC               2277              JSR     AGLADD
00002510                          2278  .NOTFIRED
00002510  4EB8 12D6               2279              JSR     AGLUPD
00002514  4CDF 0E01               2280              MOVEM.L (A7)+,D0/A1-A3
00002518  4E75                    2281              RTS
0000251A                          2282  
0000251A                          2283  ; ------------------------------------------------------------------------------
0000251A                          2284  GAMPLOT
0000251A                          2285  ; PLOTS THE GAME
0000251A                          2286  ; INPUT    : NONE
0000251A                          2287  ; OUTPUT   : NONE
0000251A                          2288  ; MODIFIES : NONE
0000251A                          2289  ; ------------------------------------------------------------------------------
0000251A  4EB8 156C               2290              JSR     BLOCKSPLOT  
0000251E  4EB8 12FA               2291              JSR     AGLPLOT
00002522  6000 FC08               2292              BRA     PLAYERPLOT
00002526                          2293  
00002526                          2294  
00002526                          2295  
00002526                          2296  
00002526                          2297  
00002526                          2298  
00002526                          2299  
00002526                          2300  
00002526                          2301  
00002526                          2302  
00002526                          2303  
00002526                          2304  
00002526                          2305  -------------------- end include --------------------
00002526                          2306              INCLUDE "INTRO.X68"
00002526                          2307  ; ==============================================================================
00002526                          2308  ; INTRO SCREEN
00002526                          2309  ; ==============================================================================
00002526                          2310  
00002526                          2311  ; ------------------------------------------------------------------------------
00002526                          2312  ISCUPD
00002526                          2313  ; INTRO SCREEN UPDATE
00002526                          2314  ; INPUT    : NONE
00002526                          2315  ; OUTPUT   : NONE
00002526                          2316  ; MODIFIES : NONE
00002526                          2317  ; ------------------------------------------------------------------------------
00002526  48E7 E000               2318              MOVEM.L D0-D2,-(A7)
0000252A                          2319              
0000252A  103C 000B               2320              MOVE.B  #11,D0          ; SET POINTER
0000252E  223C 00D50170           2321              MOVE.L  #BTONPOSX<<16|BTONPOSY,D1
00002534  4E4F                    2322              TRAP    #15
00002536                          2323              
00002536  103C 003D               2324              MOVE.B  #61,D0          ; READ MOUSE
0000253A  123C 0002               2325              MOVE.B  #2,D1           ; MOUSE DOWN STATE
0000253E  4E4F                    2326              TRAP    #15
00002540  0200 000F               2327              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002544  672E                    2328              BEQ.B   .DONE           ; IF NO CLICK
00002546                          2329              
00002546  4282                    2330              CLR.L       D2
00002548  3401                    2331              MOVE.W      D1,D2       ; D2 IS MOUSE X
0000254A  0442 00D5               2332              SUB.W   #BTONPOSX,D2
0000254E  6D00 0024               2333              BLT     .DONE
00002552                          2334              
00002552  4841                    2335              SWAP        D1          ; D1 IS MOUSE Y
00002554  0441 0170               2336              SUB.W   #BTONPOSY,D1
00002558  6D00 001A               2337              BLT     .DONE
0000255C                          2338              
0000255C  0C42 00DA               2339              CMPI.W  #BTONWIDTH,D2
00002560  6E00 0012               2340              BGT     .DONE
00002564  0C41 0020               2341              CMPI.W  #BTONHEIGHT,D1
00002568  6E00 000A               2342              BGT     .DONE           ; IF CLICKED OUTSIDE THE AREA
0000256C                          2343              
0000256C                          2344              
0000256C  33FC 0001 00002848      2345              MOVE.W  #1,(STANEXT)
00002574                          2346  .DONE
00002574  4CDF 0007               2347              MOVEM.L (A7)+,D0-D2
00002578  4E75                    2348              RTS
0000257A                          2349  ; ------------------------------------------------------------------------------
0000257A                          2350  ISCPLOT
0000257A                          2351  ; INTRO SCREEN PLOT
0000257A                          2352  ; INPUT    : NONE
0000257A                          2353  ; OUTPUT   : NONE
0000257A                          2354  ; MODIFIES : NONE
0000257A                          2355  ; ------------------------------------------------------------------------------
0000257A  48E7 F880               2356              MOVEM.L D0-D4/A0,-(A7)
0000257E                          2357              
0000257E  303C 0050               2358              MOVE.W  #80, D0
00002582  223C 00FFFFFF           2359              MOVE.L  #$00FFFFFF, D1 ; PEN COLOR
00002588  4E4F                    2360              TRAP    #15
0000258A                          2361              
0000258A  303C 0057               2362              MOVE.W  #87, D0
0000258E  323C 00D5               2363              MOVE.W  #BTONPOSX, D1 ; DRAW BUTTON
00002592  343C 0170               2364              MOVE.W  #BTONPOSY, D2
00002596  363C 01AF               2365              MOVE.W  #BTONPOSX+BTONWIDTH, D3
0000259A  383C 0190               2366              MOVE.W  #BTONPOSY+BTONHEIGHT, D4
0000259E  4E4F                    2367              TRAP    #15
000025A0                          2368              
000025A0  4281                    2369              CLR.L   D1
000025A2  103C 0051               2370              MOVE.B  #81,D0
000025A6  4E4F                    2371              TRAP    #15
000025A8                          2372              
000025A8  41F9 000025D6           2373              LEA     .TITLE,A0
000025AE  103C 000A               2374              MOVE.B  #10,D0
000025B2  4EB8 1336               2375              JSR     UTLPRINT
000025B6                          2376              
000025B6  0839 0004 000027CB      2377              BTST.B  #4,(SCRCYCCT)
000025BE  6700 0010               2378              BEQ     .DONE
000025C2                          2379              
000025C2  41F9 00002602           2380              LEA     .HINT,A0
000025C8  103C 0019               2381              MOVE.B  #25,D0
000025CC  4EB8 1336               2382              JSR     UTLPRINT
000025D0                          2383              
000025D0  4CDF 011F               2384  .DONE       MOVEM.L (A7)+,D0-D4/A0
000025D4                          2385  
000025D4  4E75                    2386              RTS
000025D6= 50 41 54 45 52 4E ...   2387  .TITLE      DC.B    'PATERNOSTER: Beyond the pillars of Hercules',0
00002602= 43 4C 49 43 4B 20 ...   2388  .HINT       DC.B    'CLICK HERE TO START',0
00002616                          2389              DS.W    0
00002616                          2390  
00002616                          2391  
00002616                          2392  
00002616                          2393  
00002616                          2394  
00002616                          2395  
00002616                          2396  
00002616                          2397  
00002616                          2398  
00002616                          2399  
00002616                          2400  -------------------- end include --------------------
00002616                          2401              INCLUDE "ENDGAME.X68"
00002616                          2402  ; ==============================================================================
00002616                          2403  ; VICTORY SCREEN
00002616                          2404  ; ==============================================================================
00002616                          2405  
00002616                          2406  ; ------------------------------------------------------------------------------
00002616                          2407  ENDGINIT
00002616                          2408  ; END GAME SCREEN INIT
00002616                          2409  ; INPUT    : NONE
00002616                          2410  ; OUTPUT   : NONE
00002616                          2411  ; MODIFIES : NONE
00002616                          2412  ; ------------------------------------------------------------------------------
00002616                          2413  
00002616                          2414              ; GUARDAR SU RECORD EN UN FICHERO
00002616                          2415              ; LEER FICHERO QUE GUARDE LOS RECORDS Y GUARDAR EN MEMORIA
00002616  4E75                    2416              RTS
00002618                          2417  ; ------------------------------------------------------------------------------
00002618                          2418  ENDGUPD
00002618                          2419  ; END GAME SCREEN UPDATE
00002618                          2420  ; INPUT    : NONE
00002618                          2421  ; OUTPUT   : NONE
00002618                          2422  ; MODIFIES : NONE
00002618                          2423  ; ------------------------------------------------------------------------------
00002618  103C 003D               2424              MOVE.B  #61,D0          ; READ MOUSE
0000261C  123C 0002               2425              MOVE.B  #2,D1           ; MOUSE DOWN STATE
00002620  4E4F                    2426              TRAP    #15
00002622  0200 000F               2427              ANDI.B  #%00001111, D0  ; MIDDLE, DOUBLE, LEFT AND RIGHT MASK
00002626  6708                    2428              BEQ.B   .DONE           ; IF NO CLICK
00002628  33FC 0001 00002848      2429              MOVE.W  #1,(STANEXT)
00002630                          2430  .DONE
00002630  4E75                    2431              RTS
00002632                          2432  
00002632                          2433  ; ------------------------------------------------------------------------------
00002632                          2434  ENDGPLOT
00002632                          2435  ; END GAME SCREEN PLOT
00002632                          2436  ; INPUT    : NONE
00002632                          2437  ; OUTPUT   : NONE
00002632                          2438  ; MODIFIES : NONE
00002632                          2439  ; ------------------------------------------------------------------------------
00002632  48E7 C080               2440              MOVEM.L D0-D1/A0,-(A7)
00002636                          2441              
00002636  4281                    2442              CLR.L   D1
00002638  103C 0051               2443              MOVE.B  #81,D0
0000263C  4E4F                    2444              TRAP    #15
0000263E                          2445              
0000263E  41F9 0000267A           2446              LEA     .TXT1,A0
00002644  103C 000A               2447              MOVE.B  #10,D0
00002648  4EB8 1336               2448              JSR     UTLPRINT
0000264C                          2449              
0000264C  0839 0008 000027CB      2450              BTST.B  #8,(SCRCYCCT)
00002654  6700 0010               2451              BEQ     .NOTPRINT
00002658                          2452              
00002658  41F9 00002694           2453              LEA     .TXT2,A0
0000265E  103C 0019               2454              MOVE.B  #25,D0
00002662  4EB8 1336               2455              JSR     UTLPRINT
00002666                          2456              
00002666                          2457  .NOTPRINT
00002666  41F9 000026AC           2458              LEA     .TXT3,A0
0000266C  103C 0019               2459              MOVE.B  #25,D0
00002670  4EB8 1336               2460              JSR     UTLPRINT
00002674                          2461              
00002674                          2462              ; MOSTRAR FICHERO QUE GUARDE LOS RECORDS
00002674                          2463              
00002674  4CDF 0103               2464              MOVEM.L (A7)+,D0-D1/A0
00002678                          2465  
00002678  4E75                    2466              RTS
0000267A= 59 4F 55 52 20 52 ...   2467  .TXT1       DC.B    'YOUR RECORD THIS TIME WAS',0
00002694= 43 4C 49 43 4B 20 ...   2468  .TXT2       DC.B    'CLICK ANYWHERE TO START',0
000026AC= 48 45 52 45 20 41 ...   2469  .TXT3       DC.B    'HERE ARE THE BEST RECORDS',0
000026C6                          2470              DS.W    0
000026C6                          2471  
000026C6                          2472  
000026C6                          2473  
000026C6                          2474  
000026C6                          2475  
000026C6                          2476  -------------------- end include --------------------
000026C6                          2477              INCLUDE "OBSTACLE.X68"
000026C6                          2478  ; ==============================================================================
000026C6                          2479  ; OBSTACLE MANAGEMENT (AGENT)
000026C6                          2480  ; OBSPOSX (W)  (A0)
000026C6                          2481  ; OBSPOSY (W) 2(A0)
000026C6                          2482  ; OBSMAP  (W) 4(A0)
000026C6                          2483  ; ==============================================================================
000026C6                          2484  
000026C6                          2485  ; ------------------------------------------------------------------------------
000026C6                          2486  OBSINIT
000026C6                          2487  ; INITIALIZES AN OBSTACLE
000026C6                          2488  ; INPUT    : D1.W IS MAP'S OBSTACLE
000026C6                          2489  ; OUTPUT   : NONE
000026C6                          2490  ; MODIFIES : NONE
000026C6                          2491  ; ------------------------------------------------------------------------------
000026C6                          2492  
000026C6  48E7 FE00               2493          MOVEM.L D0-D6,-(A7)
000026CA                          2494          
000026CA  3141 0004               2495          MOVE.W  D1,4(A0)
000026CE  4EB8 139C               2496  .OORANH JSR UTLRAND
000026D2  E348                    2497          LSL.W   #1,D0 ; x2
000026D4  B07C 01E0               2498          CMP.W   #SCRHEIGH,D0
000026D8  6E00 FFF4               2499          BGT.W   .OORANH ; OUT OF RANGE HEIGHT
000026DC  3200                    2500          MOVE.W  D0,D1
000026DE  4EB8 139C               2501  .OORANW JSR UTLRAND
000026E2  E348                    2502          LSL.W   #1,D0 ; x2
000026E4  B07C 0280               2503          CMP.W   #SCRWIDTH,D0
000026E8  6E00 FFF4               2504          BGT.W   .OORANW ; OUT OF RANGE WIDTH
000026EC                          2505          
000026EC  3800                    2506          MOVE.W  D0,D4   ; OBSPOSX
000026EE  3A01                    2507          MOVE.W  D1,D5   ; OBSPOSY
000026F0                          2508          ; CHECK COLLISIONS
000026F0                          2509          ; TOP LEFT CORNER
000026F0  4840                    2510          SWAP.W  D0
000026F2  3001                    2511          MOVE.W  D1,D0
000026F4                          2512          
000026F4  0641 0020               2513          ADD.W   #OBSHEIGHT,D1
000026F8  4841                    2514          SWAP.W  D1
000026FA  3204                    2515          MOVE.W  D4,D1
000026FC  0641 0020               2516          ADD.W   #OBSWIDTH,D1
00002700                          2517          
00002700  3C39 000027E2           2518          MOVE.W  (LOADEDMAP),D6
00002706  33E8 0004 000027E2      2519          MOVE.W  4(A0),(LOADEDMAP)
0000270E  4EB8 14DA               2520          JSR BLKCOLL
00002712  33C6 000027E2           2521          MOVE.W  D6,(LOADEDMAP)
00002718  4A80                    2522          TST.L   D0
0000271A  6600 FFB2               2523          BNE.L   .OORANH 
0000271E  4A81                    2524          TST.L   D1
00002720  6600 FFAC               2525          BNE.L   .OORANH 
00002724  4A82                    2526          TST.L   D2
00002726  6600 FFA6               2527          BNE.L   .OORANH 
0000272A  4A83                    2528          TST.L   D3
0000272C  6600 FFA0               2529          BNE.L   .OORANH 
00002730                          2530          
00002730  3084                    2531          MOVE.W  D4,(A0)
00002732  3145 0002               2532          MOVE.W  D5,2(A0)
00002736                          2533          
00002736  5279 0000284A           2534          ADD.W   #1,(NOBS)
0000273C                          2535          
0000273C  4CDF 007F               2536          MOVEM.L (A7)+,D0-D6
00002740  4E75                    2537          RTS
00002742                          2538  
00002742                          2539  ; ------------------------------------------------------------------------------
00002742                          2540  OBSPLOT
00002742                          2541  ; PLOTS AN OBSTACLE
00002742                          2542  ; INPUT    : NONE
00002742                          2543  ; OUTPUT   : NONE
00002742                          2544  ; MODIFIES : NONE
00002742                          2545  ; ------------------------------------------------------------------------------
00002742  1F00                    2546          MOVE.B  D0,-(A7)
00002744  2F01                    2547          MOVE.L  D1,-(A7)
00002746  48A7 3800               2548          MOVEM.W D2-D4, -(A7)
0000274A                          2549          
0000274A  3228 0004               2550          MOVE.W  4(A0),D1
0000274E  B279 000027E2           2551          CMP.W   (LOADEDMAP),D1
00002754  6600 0032               2552          BNE     .NOPLOT          ; IT IS NOT FROM THIS MAP
00002758                          2553          
00002758  223C 00AA4411           2554          MOVE.L #$00AA4411,D1 ;PEN COLOR
0000275E  103C 0050               2555          MOVE.B #80,D0
00002762  4E4F                    2556          TRAP #15
00002764  223C 003322EE           2557          MOVE.L #$003322EE,D1 ;FILL COLOR
0000276A  103C 0051               2558          MOVE.B #81,D0
0000276E  4E4F                    2559          TRAP #15
00002770                          2560          ; SE DIBUJA EL CUADRADO
00002770  3210                    2561          MOVE.W (A0),D1  
00002772  3428 0002               2562          MOVE.W 2(A0),D2   
00002776  3601                    2563          MOVE.W D1,D3
00002778  0643 0020               2564          ADD.W  #OBSWIDTH,D3 
0000277C  3802                    2565          MOVE.W D2,D4
0000277E  0644 0020               2566          ADD.W  #OBSHEIGHT,D4
00002782  103C 0057               2567          MOVE.B #87,D0
00002786  4E4F                    2568          TRAP #15
00002788                          2569  .NOPLOT   
00002788  4C9F 001C               2570          MOVEM.W (A7)+,D2-D4
0000278C  221F                    2571          MOVE.L  (A7)+,D1      
0000278E  101F                    2572          MOVE.B  (A7)+,D0
00002790                          2573          
00002790  4E75                    2574          RTS
00002792                          2575          
00002792                          2576  ; ------------------------------------------------------------------------------
00002792                          2577  OBSHIT
00002792                          2578  ; DELETES AN OBSTACLE BECAUSE IT WAS HIT
00002792                          2579  ; INPUT    : A0 POINTING LOCAL MEMORY
00002792                          2580  ; OUTPUT   : NONE
00002792                          2581  ; MODIFIES : NONE
00002792                          2582  ; ------------------------------------------------------------------------------
00002792  6000 E960               2583          BRA     AGLKILL
00002796                          2584  
00002796                          2585  
00002796                          2586  
00002796                          2587  -------------------- end include --------------------
00002796                          2588  START
00002796                          2589  
00002796                          2590  ; --- INITIALIZATION -----------------------------------------------------------
00002796                          2591  
00002796  007C 0700               2592              ORI.W   #$0700,SR
0000279A  4EB8 110A               2593              JSR     SYSINIT
0000279E  4EB8 2384               2594              JSR     STAINIT
000027A2                          2595  
000027A2                          2596  .LOOP
000027A2                          2597  
000027A2                          2598  ; --- UPDATE -------------------------------------------------------------------
000027A2                          2599  
000027A2                          2600  ; READ INPUT DEVICES
000027A2                          2601  
000027A2  4E41                    2602              TRAP    #KBDUPTN
000027A4                          2603  
000027A4                          2604  ; UPDATE GAME LOGIC
000027A4                          2605  
000027A4  4EB8 2394               2606              JSR     STAUPD
000027A8                          2607  
000027A8                          2608  ; --- SYNC ---------------------------------------------------------------------
000027A8                          2609  
000027A8  4A39 000027CA           2610  .WINT       TST.B   (SCRINTCT)
000027AE  67F8                    2611              BEQ     .WINT
000027B0  4239 000027CA           2612              CLR.B   (SCRINTCT)
000027B6  5239 000027CC           2613              ADDQ.B  #1,(SCRINTFPS) ; ONE MORE FRAME
000027BC                          2614  
000027BC                          2615  ; --- PLOT ---------------------------------------------------------------------
000027BC                          2616              
000027BC  4EB8 23F2               2617              JSR     STAPLOT
000027C0                          2618              
000027C0  4E40                    2619              TRAP    #SCRUPTN                ; UPDATE DOUBLE BUFFER
000027C2                          2620  
000027C2  60DE                    2621              BRA     .LOOP
000027C4                          2622              
000027C4  FFFF FFFF               2623              SIMHALT
000027C8                          2624              
000027C8                          2625              INCLUDE "VARS.X68"
000027C8                          2626  ; ==============================================================================
000027C8                          2627  ; VARIABLES
000027C8                          2628  ; ==============================================================================
000027C8                          2629              
000027C8                          2630  ; --- KEYBOARD RELATED VARIABLES -----------------------------------------------
000027C8                          2631              
000027C8                          2632  KBDVAL      DS.B    1                       ; KEY STATE ;PARA COMPROBAR SI ESTÃ PULSADO O NO, POR EJEMPLO MOVERSE
000027C9                          2633  KBDEDGE     DS.B    1                       ; KEY EDGE  ;PARA COMPROBAR SI SE ACABA DE PULSAR O NO, POR EJEMPLO DISPARAR
000027CA                          2634  
000027CA                          2635  
000027CA                          2636  ; --- TIMED INTERRUPT RELATED VARIABLES ----------------------------------------
000027CA                          2637  
000027CA                          2638  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000027CB                          2639  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
000027CC                          2640  SCRINTFPS   DS.B    1                       ; INTERRUPTIONS IN 1 SECOND
000027CE                          2641              DS.W    0
000027CE                          2642  
000027CE                          2643  ; --- PLAYER RELATED VARIABLES -------------------------------------------------
000027CE                          2644  
000027CE= 0064                    2645  PLAYERHEALTH    DC.W    $64 ;100 EN HEX. DC.B ES PARA STRINGS Y DA ERROR ASI QUE USAMOS DC.W AUNQUE NO HICIERA FALTA
000027D0= 0140                    2646  PLAYERPOSX      DC.W    SCRWIDTH/2
000027D2= 00F0                    2647  PLAYERPOSY      DC.W    SCRHEIGH/2
000027D4                          2648  
000027D4                          2649  ; --- PROJECTILE RELATED VARIABLES ---------------------------------------------
000027D4                          2650  
000027D4= 0000                    2651  NPROJ       DC.W    0   ; NUMBER OF PROJECTILES
000027D6                          2652  
000027D6                          2653  ; --- BLOCKS RELATED VARIABLES -------------------------------------------------
000027D6                          2654  
000027D6= 0000                    2655  BPOSX1      DC.W    0
000027D8= 0000                    2656  BPOSY1      DC.W    0
000027DA= 0020                    2657  BPOSX2      DC.W    32
000027DC= 0020                    2658  BPOSY2      DC.W    32
000027DE= 02 03 00                2659  BLWHICHCOLL DC.B    2,3,0 ; BLOCKS WHICH PRODUCES COLLISIONS, ENDS WITH NULL
000027E1                          2660  
000027E1                          2661  ; --- MAP RELATED VARIABLES ----------------------------------------------------
000027E1                          2662  
000027E2= 0000                    2663  LOADEDMAP   DC.W    0                       ; CURRENT MAP
000027E4= 00001A20 00001A68 ...   2664  MAPUPDLIST  DC.L    MAPA1,MAPA2,MAPA3,MAPA4,MAPA5,MAPA6,MAPA7,MAPA8
00002804= 00003500 00003650 ...   2665  MAPLIST     DC.L    HEAVEN_0,HEAVEN_1,HEAVEN_END,HEAVEN_ROOM,HELL_0,HELL_1,HELL_END,HELL_ROOM,0 
00002828                          2666  
00002828                          2667  ; --- MUSIC RELATED VARIABLES --------------------------------------------------
00002828                          2668  
00002828= 00                      2669  MUSICPLAYED DC.B    0
0000282A                          2670              DS.W    0
0000282A                          2671  
0000282A                          2672  ; --- FPS RELATED VARIABLES ----------------------------------------------------
0000282A                          2673  
0000282A                          2674  REALFPS     DS.W    1
0000282C= 47 4F 41 4C 3A 20 00    2675  STRFPS1     DC.B    'GOAL: ',0   ; THESE STRINGS MUST BE IN THIS ORDER IN MEMORY
00002833= 46 50 53 20 2D 20 ...   2676  STRFPS2     DC.B    'FPS - ACTUAL: ',0
00002842= 46 50 53 00             2677  STRFPS3     DC.B    'FPS',0
00002846                          2678  
00002846                          2679  ; --- STATE RELATED VARIABLES --------------------------------------------------
00002846                          2680  
00002846                          2681  STACUR      DS.W    1                       ; CURRENT STATE
00002848                          2682  STANEXT     DS.W    1                       ; NEXT STATE
0000284A                          2683  
0000284A                          2684  ; --- OBSTACLE RELATED VARIABLES -----------------------------------------------
0000284A                          2685  
0000284A= 0000                    2686  NOBS        DC.W    0                       ; NUMBER OF OBSTACLES
0000284C                          2687  
0000284C                          2688  
0000284C                          2689  
0000284C                          2690  
0000284C                          2691  
0000284C                          2692  
0000284C                          2693  
0000284C                          2694  
0000284C                          2695  
0000284C                          2696  
0000284C                          2697  
0000284C                          2698  
0000284C                          2699  
0000284C                          2700  -------------------- end include --------------------
0000284C                          2701              INCLUDE "LIB/UTLVARS.X68"
0000284C                          2702  ; =============================================================================
0000284C                          2703  ; UTILITY VARIABLES
0000284C                          2704  ; =============================================================================
0000284C                          2705  
0000284C                          2706  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000284E                          2707              DS.W    0
0000284E                          2708  -------------------- end include --------------------
0000284E                          2709              INCLUDE "LIB/DMMVARS.X68"
0000284E                          2710  ; =============================================================================
0000284E                          2711  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
0000284E                          2712  ; =============================================================================
0000284E                          2713  
00002880                          2714              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00002880                          2715  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00003500                          2716              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00003500                          2717  -------------------- end include --------------------
00003500                          2718              INCLUDE "DATA/MAPDATA.X68"
00003500                          2719  
00003500                          2720  HEAVEN_0    ;MAP 1
00003500= 03 03 03 03 03 03 ...   2721      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0
00003515= 03 01 01 01 01 01 ...   2722      DC.B 3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0
0000352A= 03 01 03 03 03 03 ...   2723      DC.B 3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0
0000353F= 03 01 03 05 05 05 ...   2724      DC.B 3,1,3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,1,3,0
00003554= 03 01 03 05 05 05 ...   2725      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00003569= 03 01 03 05 05 05 ...   2726      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
0000357E= 03 01 03 05 05 05 ...   2727      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
00003593= 03 01 03 05 05 05 ...   2728      DC.B 3,1,3,5,5,5,5,7,7,7,7,7,7,5,5,5,5,3,1,3,0
000035A8= 03 01 03 05 05 05 ...   2729      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000035BD= 03 01 03 05 05 05 ...   2730      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000035D2= 03 01 03 05 05 05 ...   2731      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000035E7= 03 01 03 05 05 05 ...   2732      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
000035FC= 03 01 03 05 05 05 ...   2733      DC.B 3,1,3,5,5,5,5,5,5,7,7,5,5,5,5,5,5,3,1,3,0
00003611= 03 01 03 03 03 03 ...   2734      DC.B 3,1,3,3,3,3,3,3,3,7,7,3,3,3,3,3,3,3,1,3,0
00003626= 03 01 01 01 01 01 ...   2735      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
0000363B= 03 03 03 03 03 03 ...   2736      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
00003650                          2737          
00003650                          2738  HEAVEN_1    ;MAP 2
00003650= 03 03 03 03 03 03 ...   2739      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
00003665= 03 03 01 01 01 01 ...   2740      DC.B 3,3,1,1,1,1,1,1,3,5,5,3,1,1,1,1,1,1,3,3,0
0000367A= 03 03 03 03 03 03 ...   2741      DC.B 3,3,3,3,3,3,3,3,3,5,5,3,3,3,3,3,3,3,3,3,0
0000368F= 03 07 07 07 07 03 ...   2742      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
000036A4= 03 07 07 07 07 03 ...   2743      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
000036B9= 03 07 07 07 07 09 ...   2744      DC.B 3,7,7,7,7,9,5,7,7,7,7,7,7,5,9,7,7,7,7,3,0
000036CE= 03 07 07 07 07 03 ...   2745      DC.B 3,7,7,7,7,3,5,7,7,7,7,7,7,5,3,7,7,7,7,3,0
000036E3= 03 07 07 07 07 03 ...   2746      DC.B 3,7,7,7,7,3,5,5,5,7,7,5,5,5,3,7,7,7,7,3,0
000036F8= 03 03 03 03 03 03 ...   2747      DC.B 3,3,3,3,3,3,5,5,5,7,7,5,5,5,3,3,3,3,3,3,0
0000370D= 03 01 01 01 01 03 ...   2748      DC.B 3,1,1,1,1,3,3,5,5,7,7,5,5,3,3,1,1,1,1,3,0
00003722= 03 01 01 01 01 01 ...   2749      DC.B 3,1,1,1,1,1,3,3,3,7,7,3,3,3,1,1,1,1,1,3,0
00003737= 03 01 01 01 01 01 ...   2750      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
0000374C= 03 01 01 01 01 01 ...   2751      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00003761= 03 01 01 01 01 01 ...   2752      DC.B 3,1,1,1,1,1,1,1,3,7,7,3,1,1,1,1,1,1,1,3,0
00003776= 03 03 03 03 03 03 ...   2753      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,11
0000378B                          2754      
0000378B                          2755  HEAVEN_END  ;MAP 3
0000378B= 03 03 03 03 03 03 ...   2756      DC.B 3,3,3,3,3,3,3,3,3,9,9,3,3,3,3,3,3,3,3,3,0
000037A0= 03 05 05 05 05 05 ...   2757      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
000037B5= 03 05 05 07 05 05 ...   2758      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
000037CA= 03 05 07 07 07 05 ...   2759      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
000037DF= 03 05 05 07 05 05 ...   2760      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
000037F4= 03 05 05 07 05 05 ...   2761      DC.B 3,5,5,7,5,5,5,7,7,7,7,7,7,5,5,5,7,5,5,3,0
00003809= 03 05 05 05 05 05 ...   2762      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
0000381E= 03 05 05 05 05 05 ...   2763      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00003833= 03 05 05 05 05 05 ...   2764      DC.B 3,5,5,5,5,5,5,5,5,7,7,5,5,5,5,5,5,5,5,3,0
00003848= 03 05 05 07 05 05 ...   2765      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000385D= 03 05 07 07 07 05 ...   2766      DC.B 3,5,7,7,7,5,5,5,5,7,7,5,5,5,5,7,7,7,5,3,0
00003872= 03 05 05 07 05 05 ...   2767      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
00003887= 03 05 05 07 05 05 ...   2768      DC.B 3,5,5,7,5,5,5,5,5,7,7,5,5,5,5,5,7,5,5,3,0
0000389C= 03 05 05 05 05 05 ...   2769      DC.B 3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,3,0
000038B1= 03 03 03 03 03 03 ...   2770      DC.B 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,11
000038C6                          2771      
000038C6                          2772  HEAVEN_ROOM ;MAP 4
000038C6= 09 09 09 09 09 09 ...   2773      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000038DB= 09 09 09 09 09 09 ...   2774      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000038F0= 09 09 09 09 09 09 ...   2775      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
00003905= 09 09 09 09 09 09 ...   2776      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
0000391A= 09 09 09 09 09 03 ...   2777      DC.B 9,9,9,9,9,3,3,3,3,9,9,3,3,3,3,9,9,9,9,9,0
0000392F= 09 09 09 09 09 03 ...   2778      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00003944= 09 09 09 09 09 03 ...   2779      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00003959= 09 09 09 09 09 03 ...   2780      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
0000396E= 09 09 09 09 09 03 ...   2781      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00003983= 09 09 09 09 09 03 ...   2782      DC.B 9,9,9,9,9,3,7,7,7,7,7,7,7,7,3,9,9,9,9,9,0
00003998= 09 09 09 09 09 03 ...   2783      DC.B 9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,9,9,9,9,9,0
000039AD= 09 09 09 09 09 09 ...   2784      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000039C2= 09 09 09 09 09 09 ...   2785      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000039D7= 09 09 09 09 09 09 ...   2786      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0
000039EC= 09 09 09 09 09 09 ...   2787      DC.B 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11
00003A01                          2788      
00003A01                          2789  HELL_0  ;MAP 5
00003A01= 02 02 02 02 02 02 ...   2790      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0
00003A16= 02 06 06 06 06 06 ...   2791      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003A2B= 02 06 06 04 06 06 ...   2792      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00003A40= 02 06 06 04 06 06 ...   2793      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00003A55= 02 06 04 04 04 06 ...   2794      DC.B 2,6,4,4,4,6,6,6,6,6,6,6,6,6,6,4,4,4,6,2,0
00003A6A= 02 06 06 04 06 06 ...   2795      DC.B 2,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,4,6,6,2,0
00003A7F= 02 06 06 06 06 06 ...   2796      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003A94= 02 02 02 02 02 02 ...   2797      DC.B 2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,0
00003AA9= 02 06 06 06 06 06 ...   2798      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003ABE= 02 06 06 06 06 06 ...   2799      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003AD3= 02 06 06 06 06 06 ...   2800      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003AE8= 02 06 06 06 06 06 ...   2801      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003AFD= 02 06 06 06 06 06 ...   2802      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003B12= 02 06 06 06 06 06 ...   2803      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003B27= 02 02 02 02 02 02 ...   2804      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00003B3C                          2805          
00003B3C                          2806  HELL_1      ;MAP 6
00003B3C= 02 02 02 02 02 02 ...   2807      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00003B51= 02 06 06 06 06 06 ...   2808      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003B66= 02 06 06 06 06 06 ...   2809      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003B7B= 02 06 06 06 06 06 ...   2810      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003B90= 02 06 06 06 06 06 ...   2811      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003BA5= 02 06 06 06 06 06 ...   2812      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00003BBA= 02 06 06 06 06 06 ...   2813      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00003BCF= 02 06 06 06 06 06 ...   2814      DC.B 2,6,6,6,6,6,6,6,4,4,4,4,6,6,6,6,6,6,6,2,0
00003BE4= 02 06 06 06 06 06 ...   2815      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003BF9= 02 06 06 06 06 06 ...   2816      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003C0E= 02 02 08 02 02 02 ...   2817      DC.B 2,2,8,2,2,2,2,2,6,6,6,6,2,2,2,2,2,8,2,2,0
00003C23= 02 06 06 06 02 02 ...   2818      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00003C38= 02 06 06 06 02 02 ...   2819      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00003C4D= 02 06 06 06 02 02 ...   2820      DC.B 2,6,6,6,2,2,2,2,6,6,6,6,2,2,2,2,6,6,6,2,0
00003C62= 02 02 02 02 02 02 ...   2821      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,11
00003C77                          2822          
00003C77                          2823  HELL_END    ;MAP 7
00003C77= 02 02 02 02 02 02 ...   2824      DC.B 2,2,2,2,2,2,2,2,2,8,8,2,2,2,2,2,2,2,2,2,0
00003C8C= 02 06 06 06 06 06 ...   2825      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003CA1= 02 06 06 06 06 06 ...   2826      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003CB6= 02 06 06 06 06 06 ...   2827      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003CCB= 02 06 06 06 06 06 ...   2828      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003CE0= 02 06 06 06 06 06 ...   2829      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003CF5= 02 06 06 06 06 06 ...   2830      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003D0A= 02 06 06 06 06 06 ...   2831      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003D1F= 02 06 06 06 06 06 ...   2832      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00003D34= 02 06 06 06 06 06 ...   2833      DC.B 2,6,6,6,6,6,6,4,4,4,4,4,4,6,6,6,6,6,6,2,0
00003D49= 02 06 06 06 06 06 ...   2834      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003D5E= 02 06 06 06 06 06 ...   2835      DC.B 2,6,6,6,6,6,6,6,6,4,4,6,6,6,6,6,6,6,6,2,0
00003D73= 02 06 06 06 06 06 ...   2836      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003D88= 02 06 06 06 06 06 ...   2837      DC.B 2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,0
00003D9D= 02 02 02 02 02 02 ...   2838      DC.B 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11
00003DB2                          2839      
00003DB2                          2840  HELL_ROOM   ;MAP 8
00003DB2= 08 08 08 08 08 08 ...   2841      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003DC7= 08 08 08 08 08 08 ...   2842      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003DDC= 08 08 08 08 08 08 ...   2843      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003DF1= 08 08 08 08 08 08 ...   2844      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003E06= 08 08 08 08 08 02 ...   2845      DC.B 8,8,8,8,8,2,2,2,2,8,8,2,2,2,2,8,8,8,8,8,0
00003E1B= 08 08 08 08 08 02 ...   2846      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003E30= 08 08 08 08 08 02 ...   2847      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003E45= 08 08 08 08 08 02 ...   2848      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003E5A= 08 08 08 08 08 02 ...   2849      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003E6F= 08 08 08 08 08 02 ...   2850      DC.B 8,8,8,8,8,2,6,6,6,6,6,6,6,6,2,8,8,8,8,8,0
00003E84= 08 08 08 08 08 02 ...   2851      DC.B 8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,0
00003E99= 08 08 08 08 08 08 ...   2852      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003EAE= 08 08 08 08 08 08 ...   2853      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003EC3= 08 08 08 08 08 08 ...   2854      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0
00003ED8= 08 08 08 08 08 08 ...   2855      DC.B 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,11
00003EED                          2856  
00003EEE= 0000                    2857      DC.W    0
00003EF0                          2858  
00003EF0                          2859  
00003EF0                          2860  
00003EF0                          2861  
00003EF0                          2862  
00003EF0                          2863  
00003EF0                          2864  
00003EF0                          2865  
00003EF0                          2866  
00003EF0                          2867  -------------------- end include --------------------
00003EF0                          2868              INCLUDE "DATA/INTRODATA.X68"
00003EF0                          2869  
00003EF0                          2870  BITMAP
00003EF0                          2871  ; aqu van los pxeles
00003EF0                          2872  -------------------- end include --------------------
00003EF0                          2873  
00003EF0                          2874              END     START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              12BC
AGLADD:END          12D2
AGLKILL             10F4
AGLPLOT             12FA
AGLPLOT:END         131A
AGLPLOT:LOOP        1302
AGLUPD              12D6
AGLUPD:END          12F4
AGLUPD:LOOP         12DE
AUDINIT             228A
AUDPLAY             22BE
BITMAP              3EF0
BLKCOLL             14DA
BLOCKSCOL           F
BLOCKSIZE           20
BLOCKSPLOT          156C
BLOCKSROW           14
BLWHICHCOLL         27DE
BPOSX1              27D6
BPOSX2              27DA
BPOSY1              27D8
BPOSY2              27DC
BTONHEIGHT          20
BTONPOSX            D5
BTONPOSY            170
BTONWIDTH           DA
COLBUTHL            CC
COLBUTHV            EEEEEE
DBHL                1710
DBHV                1784
DDHL                163A
DDHV                165A
DF1HL               18AE
DF1HV               188E
DF2HL               1920
DF2HV               18CE
DGHE                167A
DGHL                17F8
DMMALLOC            10DA
DMMALLOC:END        10F2
DMMBNUM             32
DMMBSIZE            40
DMMDATA             2880
DMMFCOM             10B4
DMMFFND             10C2
DMMFIRST            106A
DMMFLOOP            10A8
DMMFRCOM            107C
DMMFREE             10F4
DMMFRFND            108A
DMMFRLOP            1070
DMMFRSTO            10A2
DMMINIT             1048
DMMINIT:LOOP        1056
DMMNEXT             108C
DMMNEXTO            10C4
DMMSYSID            0
DRAWBLOCK           1972
ELEVATORINIT        1DE6
ELEVATORMUSIC       2306
ELEVATORPLOT        1DEA
ELEVATORUPDATE      2002
ELEVATORUPDATE:HLSEL  203C
ELEVATORUPDATE:HVSEL  2022
ELEVATOR_MUSIC      100F
ENDBLOCK            19CA
ENDGINIT            2616
ENDGPLOT            2632
ENDGPLOT:NOTPRINT   2666
ENDGPLOT:TXT1       267A
ENDGPLOT:TXT2       2694
ENDGPLOT:TXT3       26AC
ENDGUPD             2618
ENDGUPD:DONE        2630
ENDMAP              19DC
FIREDSOUND          2368
FPSTEXTPOS          2D01
FRAMES_PER_SECOND   32
GAMINIT             2420
GAMINIT:1STROOM     2430
GAMINIT:1STRTRY     2432
GAMINIT:2NDROOM     2444
GAMINIT:2NDRTRY     2446
GAMINIT:3RDROOM     2458
GAMINIT:3RDRTRY     245A
GAMINIT:4THROOM     246C
GAMINIT:4THRTRY     246E
GAMINIT:LOOP1       249E
GAMINIT:LOOP2       24A8
GAMINIT:LOOP3       24B2
GAMINIT:LOOP4       24BC
GAMPLOT             251A
GAMUPD              24CE
GAMUPD:NOMUSIC      24E4
GAMUPD:NOTFIRED     2510
HEAVENMUSIC         2324
HEAVENSOUND         1000
HEAVEN_0            3500
HEAVEN_1            3650
HEAVEN_END          378B
HEAVEN_ROOM         38C6
HELLMUSIC           2346
HELLSOUND           1026
HELL_0              3A01
HELL_1              3B3C
HELL_END            3C77
HELL_ROOM           3DB2
ISBLWHICHCOLL       14BA
ISBLWHICHCOLL:BCOLL  14CC
ISBLWHICHCOLL:BEND  14D8
ISBLWHICHCOLL:BNEXTCHCK  14C0
ISBLWHICHCOLL:BNOCOLL  14D6
ISCPLOT             257A
ISCPLOT:DONE        25D0
ISCPLOT:HINT        2602
ISCPLOT:TITLE       25D6
ISCUPD              2526
ISCUPD:DONE         2574
JMPLIST             15F2
KBDDOWN             53
KBDEDGE             27C9
KBDFDOWN            28
KBDFLEFT            25
KBDFRIGHT           27
KBDFUP              26
KBDINIT             1260
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              126E
KBDUPD:LOOP         12B2
KBDUPD:PACK         12AE
KBDUPTN             1
KBDVAL              27C8
LOADEDMAP           27E2
MAP1NODOOR          1A62
MAP2NODOOR1         1AB0
MAP2NODOOR2         1AE6
MAP2NODOOR3         1B24
MAP2NODOOR4         1B62
MAP3NODOOR          1BB0
MAP4NODOOR          1BF8
MAP5NODOOR          1C40
MAP6NODOOR1         1C8E
MAP6NODOOR2         1CC4
MAP6NODOOR3         1D02
MAP6NODOOR4         1D40
MAP7NODOOR          1D90
MAP8NODOOR1         1DE0
MAPA1               1A20
MAPA2               1A68
MAPA3               1B68
MAPA4               1BB6
MAPA5               1BFE
MAPA6               1C46
MAPA7               1D46
MAPA8               1D96
MAPLIST             2804
MAPSEL              1584
MAPUPD              1A06
MAPUPDLIST          27E4
MAXOBSXROOM         8
MSCSEL              22D6
MUSICPLAYED         2828
NEWLINE             19A6
NEXT                15E4
NOBS                284A
NPROJ               27D4
OBSHEIGHT           20
OBSHIT              2792
OBSINIT             26C6
OBSINIT:OORANH      26CE
OBSINIT:OORANW      26DE
OBSPLOT             2742
OBSPLOT:NOPLOT      2788
OBSWIDTH            20
PLAYERHEALTH        27CE
PLAYERHEIGHT        20
PLAYERPLOT          212C
PLAYERPOSX          27D0
PLAYERPOSY          27D2
PLAYERSPEED         4
PLAYERUPD           2056
PLAYERUPD:DOWN      2120
PLAYERUPD:LEFT      20A8
PLAYERUPD:NODOWN    2126
PLAYERUPD:NOLEFT    20AE
PLAYERUPD:NORIGHT   20FE
PLAYERUPD:NOUP      20D6
PLAYERUPD:RIGHT     20F8
PLAYERUPD:UP        20D0
PLAYERWIDTH         20
PROJHEIGHT          10
PROJINIT            2174
PROJINIT:FDOWN      21AC
PROJINIT:FRIGHT     219A
PROJINIT:FUP        218A
PROJINIT:NOTFDOWN   21BA
PROJINIT:SHOOT      21C4
PROJPLOT            2248
PROJSPEEDX          8
PROJSPEEDY          8
PROJUPD             21D8
PROJUPD:PROJCOLL    2236
PROJUPD:PROJNOCOLL  2222
PROJUPD:PROJNOHIT   2242
PROJWIDTH           10
PROJ_SOUND          1035
REALFPS             282A
SCRCYCCT            27CB
SCRHEIGH            1E0
SCRINIT             1142
SCRINTCT            27CA
SCRINTFPS           27CC
SCRINTFPSN          2
SCRINTN             1
SCRPLOT             1198
SCRTIM              1240
SCRTIM1S            124E
SCRUPTN             0
SCRWIDTH            280
STACUR              2846
STAEMPTY            241E
STAINIT             2384
STANEXT             2848
STANONE             FFFFFFFF
STAPLOT             23F2
STAPLOT:PLTTBL      240E
START               2796
START:LOOP          27A2
START:WINT          27A8
STAUPD              2394
STAUPD:DOUPD        23BA
STAUPD:INITBL       23D2
STAUPD:UPDTBL       23E2
STRFPS1             282C
STRFPS2             2833
STRFPS3             2842
SYSINIT             110A
TRIANGLE            1FAA
TRIANGLE:ISPOSITIVE  1FF8
TRIANGLE:UPWARDS    1FC6
UTLCHCOLL           1368
UTLCHCOLL:END       1396
UTLCHCOLL:NOCOL     1394
UTLCHRWD            8
UTLINIT             1320
UTLPRINT            1336
UTLPRINT:ENDLOOP    1348
UTLPRINT:LOOP       133E
UTLRAND             139C
UTLRAND:RANDVEC     13BA
UTLRNDIX            284C
